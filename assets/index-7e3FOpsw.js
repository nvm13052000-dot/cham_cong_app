(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var bw={exports:{}},d0={},Lw={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gu=Symbol.for("react.element"),MI=Symbol.for("react.portal"),VI=Symbol.for("react.fragment"),BI=Symbol.for("react.strict_mode"),UI=Symbol.for("react.profiler"),jI=Symbol.for("react.provider"),WI=Symbol.for("react.context"),HI=Symbol.for("react.forward_ref"),zI=Symbol.for("react.suspense"),$I=Symbol.for("react.memo"),GI=Symbol.for("react.lazy"),Zv=Symbol.iterator;function KI(t){return t===null||typeof t!="object"?null:(t=Zv&&t[Zv]||t["@@iterator"],typeof t=="function"?t:null)}var Mw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vw=Object.assign,Bw={};function _l(t,e,r){this.props=t,this.context=e,this.refs=Bw,this.updater=r||Mw}_l.prototype.isReactComponent={};_l.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_l.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Uw(){}Uw.prototype=_l.prototype;function Um(t,e,r){this.props=t,this.context=e,this.refs=Bw,this.updater=r||Mw}var jm=Um.prototype=new Uw;jm.constructor=Um;Vw(jm,_l.prototype);jm.isPureReactComponent=!0;var e_=Array.isArray,jw=Object.prototype.hasOwnProperty,Wm={current:null},Ww={key:!0,ref:!0,__self:!0,__source:!0};function Hw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)jw.call(e,n)&&!Ww.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:gu,type:t,key:s,ref:a,props:i,_owner:Wm.current}}function XI(t,e){return{$$typeof:gu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hm(t){return typeof t=="object"&&t!==null&&t.$$typeof===gu}function qI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var t_=/\/+/g;function dd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qI(""+t.key):e.toString(36)}function Hf(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case gu:case MI:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+dd(a,0):n,e_(i)?(r="",t!=null&&(r=t.replace(t_,"$&/")+"/"),Hf(i,e,r,"",function(c){return c})):i!=null&&(Hm(i)&&(i=XI(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(t_,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",e_(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+dd(s,o);a+=Hf(s,e,r,l,i)}else if(l=KI(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+dd(s,o++),a+=Hf(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function cf(t,e,r){if(t==null)return t;var n=[],i=0;return Hf(t,n,"","",function(s){return e.call(r,s,i++)}),n}function YI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},zf={transition:null},QI={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:zf,ReactCurrentOwner:Wm};function zw(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:cf,forEach:function(t,e,r){cf(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return cf(t,function(){e++}),e},toArray:function(t){return cf(t,function(e){return e})||[]},only:function(t){if(!Hm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ye.Component=_l;Ye.Fragment=VI;Ye.Profiler=UI;Ye.PureComponent=Um;Ye.StrictMode=BI;Ye.Suspense=zI;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QI;Ye.act=zw;Ye.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Vw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Wm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)jw.call(e,l)&&!Ww.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:gu,type:t.type,key:i,ref:s,props:n,_owner:a}};Ye.createContext=function(t){return t={$$typeof:WI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:jI,_context:t},t.Consumer=t};Ye.createElement=Hw;Ye.createFactory=function(t){var e=Hw.bind(null,t);return e.type=t,e};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(t){return{$$typeof:HI,render:t}};Ye.isValidElement=Hm;Ye.lazy=function(t){return{$$typeof:GI,_payload:{_status:-1,_result:t},_init:YI}};Ye.memo=function(t,e){return{$$typeof:$I,type:t,compare:e===void 0?null:e}};Ye.startTransition=function(t){var e=zf.transition;zf.transition={};try{t()}finally{zf.transition=e}};Ye.unstable_act=zw;Ye.useCallback=function(t,e){return tn.current.useCallback(t,e)};Ye.useContext=function(t){return tn.current.useContext(t)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};Ye.useEffect=function(t,e){return tn.current.useEffect(t,e)};Ye.useId=function(){return tn.current.useId()};Ye.useImperativeHandle=function(t,e,r){return tn.current.useImperativeHandle(t,e,r)};Ye.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};Ye.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};Ye.useMemo=function(t,e){return tn.current.useMemo(t,e)};Ye.useReducer=function(t,e,r){return tn.current.useReducer(t,e,r)};Ye.useRef=function(t){return tn.current.useRef(t)};Ye.useState=function(t){return tn.current.useState(t)};Ye.useSyncExternalStore=function(t,e,r){return tn.current.useSyncExternalStore(t,e,r)};Ye.useTransition=function(){return tn.current.useTransition()};Ye.version="18.3.1";Lw.exports=Ye;var Pe=Lw.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JI=Pe,ZI=Symbol.for("react.element"),eC=Symbol.for("react.fragment"),tC=Object.prototype.hasOwnProperty,rC=JI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nC={key:!0,ref:!0,__self:!0,__source:!0};function $w(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)tC.call(e,n)&&!nC.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:ZI,type:t,key:s,ref:a,props:i,_owner:rC.current}}d0.Fragment=eC;d0.jsx=$w;d0.jsxs=$w;bw.exports=d0;var F=bw.exports,Gw={exports:{}},In={},Kw={exports:{}},Xw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ce,V){var X=ce.length;ce.push(V);e:for(;0<X;){var oe=X-1>>>1,b=ce[oe];if(0<i(b,V))ce[oe]=V,ce[X]=b,X=oe;else break e}}function r(ce){return ce.length===0?null:ce[0]}function n(ce){if(ce.length===0)return null;var V=ce[0],X=ce.pop();if(X!==V){ce[0]=X;e:for(var oe=0,b=ce.length,j=b>>>1;oe<j;){var z=2*(oe+1)-1,K=ce[z],q=z+1,se=ce[q];if(0>i(K,X))q<b&&0>i(se,K)?(ce[oe]=se,ce[q]=X,oe=q):(ce[oe]=K,ce[z]=X,oe=z);else if(q<b&&0>i(se,X))ce[oe]=se,ce[q]=X,oe=q;else break e}}return V}function i(ce,V){var X=ce.sortIndex-V.sortIndex;return X!==0?X:ce.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],f=1,h=null,d=3,p=!1,g=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(ce){for(var V=r(c);V!==null;){if(V.callback===null)n(c);else if(V.startTime<=ce)n(c),V.sortIndex=V.expirationTime,e(l,V);else break;V=r(c)}}function P(ce){if(m=!1,x(ce),!g)if(r(l)!==null)g=!0,Te(W);else{var V=r(c);V!==null&&ge(P,V.startTime-ce)}}function W(ce,V){g=!1,m&&(m=!1,w(k),k=-1),p=!0;var X=d;try{for(x(V),h=r(l);h!==null&&(!(h.expirationTime>V)||ce&&!R());){var oe=h.callback;if(typeof oe=="function"){h.callback=null,d=h.priorityLevel;var b=oe(h.expirationTime<=V);V=t.unstable_now(),typeof b=="function"?h.callback=b:h===r(l)&&n(l),x(V)}else n(l);h=r(l)}if(h!==null)var j=!0;else{var z=r(c);z!==null&&ge(P,z.startTime-V),j=!1}return j}finally{h=null,d=X,p=!1}}var M=!1,y=null,k=-1,S=5,I=-1;function R(){return!(t.unstable_now()-I<S)}function C(){if(y!==null){var ce=t.unstable_now();I=ce;var V=!0;try{V=y(!0,ce)}finally{V?N():(M=!1,y=null)}}else M=!1}var N;if(typeof E=="function")N=function(){E(C)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,pe=_e.port2;_e.port1.onmessage=C,N=function(){pe.postMessage(null)}}else N=function(){_(C,0)};function Te(ce){y=ce,M||(M=!0,N())}function ge(ce,V){k=_(function(){ce(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ce){ce.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,Te(W))},t.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ce?Math.floor(1e3/ce):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ce){switch(d){case 1:case 2:case 3:var V=3;break;default:V=d}var X=d;d=V;try{return ce()}finally{d=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ce,V){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var X=d;d=ce;try{return V()}finally{d=X}},t.unstable_scheduleCallback=function(ce,V,X){var oe=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?oe+X:oe):X=oe,ce){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=X+b,ce={id:f++,callback:V,priorityLevel:ce,startTime:X,expirationTime:b,sortIndex:-1},X>oe?(ce.sortIndex=X,e(c,ce),r(l)===null&&ce===r(c)&&(m?(w(k),k=-1):m=!0,ge(P,X-oe))):(ce.sortIndex=b,e(l,ce),g||p||(g=!0,Te(W))),ce},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(ce){var V=d;return function(){var X=d;d=V;try{return ce.apply(this,arguments)}finally{d=X}}}})(Xw);Kw.exports=Xw;var iC=Kw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sC=Pe,Sn=iC;function me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qw=new Set,Fc={};function qa(t,e){Jo(t,e),Jo(t+"Capture",e)}function Jo(t,e){for(Fc[t]=e,t=0;t<e.length;t++)qw.add(e[t])}var Qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fp=Object.prototype.hasOwnProperty,aC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r_={},n_={};function oC(t){return fp.call(n_,t)?!0:fp.call(r_,t)?!1:aC.test(t)?n_[t]=!0:(r_[t]=!0,!1)}function lC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cC(t,e,r,n){if(e===null||typeof e>"u"||lC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function rn(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Ar={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ar[t]=new rn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ar[e]=new rn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ar[t]=new rn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ar[t]=new rn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ar[t]=new rn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ar[t]=new rn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ar[t]=new rn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ar[t]=new rn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ar[t]=new rn(t,5,!1,t.toLowerCase(),null,!1,!1)});var zm=/[\-:]([a-z])/g;function $m(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(zm,$m);Ar[e]=new rn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(zm,$m);Ar[e]=new rn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(zm,$m);Ar[e]=new rn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ar[t]=new rn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ar.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ar[t]=new rn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gm(t,e,r,n){var i=Ar.hasOwnProperty(e)?Ar[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cC(e,r,i,n)&&(r=null),n||i===null?oC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var as=sC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uf=Symbol.for("react.element"),To=Symbol.for("react.portal"),ko=Symbol.for("react.fragment"),Km=Symbol.for("react.strict_mode"),hp=Symbol.for("react.profiler"),Yw=Symbol.for("react.provider"),Qw=Symbol.for("react.context"),Xm=Symbol.for("react.forward_ref"),dp=Symbol.for("react.suspense"),pp=Symbol.for("react.suspense_list"),qm=Symbol.for("react.memo"),xs=Symbol.for("react.lazy"),Jw=Symbol.for("react.offscreen"),i_=Symbol.iterator;function Bl(t){return t===null||typeof t!="object"?null:(t=i_&&t[i_]||t["@@iterator"],typeof t=="function"?t:null)}var Ot=Object.assign,pd;function ql(t){if(pd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);pd=e&&e[1]||""}return`
`+pd+t}var md=!1;function gd(t,e){if(!t||md)return"";md=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{md=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ql(t):""}function uC(t){switch(t.tag){case 5:return ql(t.type);case 16:return ql("Lazy");case 13:return ql("Suspense");case 19:return ql("SuspenseList");case 0:case 2:case 15:return t=gd(t.type,!1),t;case 11:return t=gd(t.type.render,!1),t;case 1:return t=gd(t.type,!0),t;default:return""}}function mp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ko:return"Fragment";case To:return"Portal";case hp:return"Profiler";case Km:return"StrictMode";case dp:return"Suspense";case pp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qw:return(t.displayName||"Context")+".Consumer";case Yw:return(t._context.displayName||"Context")+".Provider";case Xm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qm:return e=t.displayName||null,e!==null?e:mp(t.type)||"Memo";case xs:e=t._payload,t=t._init;try{return mp(t(e))}catch{}}return null}function fC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mp(e);case 8:return e===Km?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Zw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hC(t){var e=Zw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ff(t){t._valueTracker||(t._valueTracker=hC(t))}function eE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Zw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function uh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gp(t,e){var r=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function s_(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=zs(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tE(t,e){e=e.checked,e!=null&&Gm(t,"checked",e,!1)}function vp(t,e){tE(t,e);var r=zs(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_p(t,e.type,r):e.hasOwnProperty("defaultValue")&&_p(t,e.type,zs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function a_(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function _p(t,e,r){(e!=="number"||uh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Yl=Array.isArray;function Vo(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+zs(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(me(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function o_(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(me(92));if(Yl(r)){if(1<r.length)throw Error(me(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:zs(r)}}function rE(t,e){var r=zs(e.value),n=zs(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function l_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function nE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?nE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hf,iE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hf=hf||document.createElement("div"),hf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Nc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var cc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dC=["Webkit","ms","Moz","O"];Object.keys(cc).forEach(function(t){dC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),cc[e]=cc[t]})});function sE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||cc.hasOwnProperty(t)&&cc[t]?(""+e).trim():e+"px"}function aE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=sE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var pC=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wp(t,e){if(e){if(pC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(me(62))}}function Ep(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tp=null;function Ym(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var kp=null,Bo=null,Uo=null;function c_(t){if(t=xu(t)){if(typeof kp!="function")throw Error(me(280));var e=t.stateNode;e&&(e=_0(e),kp(t.stateNode,t.type,e))}}function oE(t){Bo?Uo?Uo.push(t):Uo=[t]:Bo=t}function lE(){if(Bo){var t=Bo,e=Uo;if(Uo=Bo=null,c_(t),e)for(t=0;t<e.length;t++)c_(e[t])}}function cE(t,e){return t(e)}function uE(){}var vd=!1;function fE(t,e,r){if(vd)return t(e,r);vd=!0;try{return cE(t,e,r)}finally{vd=!1,(Bo!==null||Uo!==null)&&(uE(),lE())}}function Dc(t,e){var r=t.stateNode;if(r===null)return null;var n=_0(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(me(231,e,typeof r));return r}var Sp=!1;if(Qi)try{var Ul={};Object.defineProperty(Ul,"passive",{get:function(){Sp=!0}}),window.addEventListener("test",Ul,Ul),window.removeEventListener("test",Ul,Ul)}catch{Sp=!1}function mC(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var uc=!1,fh=null,hh=!1,Ap=null,gC={onError:function(t){uc=!0,fh=t}};function vC(t,e,r,n,i,s,a,o,l){uc=!1,fh=null,mC.apply(gC,arguments)}function _C(t,e,r,n,i,s,a,o,l){if(vC.apply(this,arguments),uc){if(uc){var c=fh;uc=!1,fh=null}else throw Error(me(198));hh||(hh=!0,Ap=c)}}function Ya(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function hE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function u_(t){if(Ya(t)!==t)throw Error(me(188))}function xC(t){var e=t.alternate;if(!e){if(e=Ya(t),e===null)throw Error(me(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return u_(i),t;if(s===n)return u_(i),e;s=s.sibling}throw Error(me(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(me(189))}}if(r.alternate!==n)throw Error(me(190))}if(r.tag!==3)throw Error(me(188));return r.stateNode.current===r?t:e}function dE(t){return t=xC(t),t!==null?pE(t):null}function pE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pE(t);if(e!==null)return e;t=t.sibling}return null}var mE=Sn.unstable_scheduleCallback,f_=Sn.unstable_cancelCallback,yC=Sn.unstable_shouldYield,wC=Sn.unstable_requestPaint,Gt=Sn.unstable_now,EC=Sn.unstable_getCurrentPriorityLevel,Qm=Sn.unstable_ImmediatePriority,gE=Sn.unstable_UserBlockingPriority,dh=Sn.unstable_NormalPriority,TC=Sn.unstable_LowPriority,vE=Sn.unstable_IdlePriority,p0=null,yi=null;function kC(t){if(yi&&typeof yi.onCommitFiberRoot=="function")try{yi.onCommitFiberRoot(p0,t,void 0,(t.current.flags&128)===128)}catch{}}var ri=Math.clz32?Math.clz32:IC,SC=Math.log,AC=Math.LN2;function IC(t){return t>>>=0,t===0?32:31-(SC(t)/AC|0)|0}var df=64,pf=4194304;function Ql(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ph(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Ql(o):(s&=a,s!==0&&(n=Ql(s)))}else a=r&~i,a!==0?n=Ql(a):s!==0&&(n=Ql(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ri(e),i=1<<r,n|=t[r],e&=~i;return n}function CC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ri(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=CC(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Ip(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _E(){var t=df;return df<<=1,!(df&4194240)&&(df=64),t}function _d(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function vu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ri(e),t[e]=r}function PC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ri(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Jm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ri(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ft=0;function xE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var yE,Zm,wE,EE,TE,Cp=!1,mf=[],Ns=null,Ds=null,Os=null,Oc=new Map,bc=new Map,ws=[],FC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function h_(t,e){switch(t){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":Ds=null;break;case"mouseover":case"mouseout":Os=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(e.pointerId)}}function jl(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=xu(e),e!==null&&Zm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function NC(t,e,r,n,i){switch(e){case"focusin":return Ns=jl(Ns,t,e,r,n,i),!0;case"dragenter":return Ds=jl(Ds,t,e,r,n,i),!0;case"mouseover":return Os=jl(Os,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Oc.set(s,jl(Oc.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,bc.set(s,jl(bc.get(s)||null,t,e,r,n,i)),!0}return!1}function kE(t){var e=xa(t.target);if(e!==null){var r=Ya(e);if(r!==null){if(e=r.tag,e===13){if(e=hE(r),e!==null){t.blockedOn=e,TE(t.priority,function(){wE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $f(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Rp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Tp=n,r.target.dispatchEvent(n),Tp=null}else return e=xu(r),e!==null&&Zm(e),t.blockedOn=r,!1;e.shift()}return!0}function d_(t,e,r){$f(t)&&r.delete(e)}function DC(){Cp=!1,Ns!==null&&$f(Ns)&&(Ns=null),Ds!==null&&$f(Ds)&&(Ds=null),Os!==null&&$f(Os)&&(Os=null),Oc.forEach(d_),bc.forEach(d_)}function Wl(t,e){t.blockedOn===e&&(t.blockedOn=null,Cp||(Cp=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,DC)))}function Lc(t){function e(i){return Wl(i,t)}if(0<mf.length){Wl(mf[0],t);for(var r=1;r<mf.length;r++){var n=mf[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ns!==null&&Wl(Ns,t),Ds!==null&&Wl(Ds,t),Os!==null&&Wl(Os,t),Oc.forEach(e),bc.forEach(e),r=0;r<ws.length;r++)n=ws[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ws.length&&(r=ws[0],r.blockedOn===null);)kE(r),r.blockedOn===null&&ws.shift()}var jo=as.ReactCurrentBatchConfig,mh=!0;function OC(t,e,r,n){var i=ft,s=jo.transition;jo.transition=null;try{ft=1,eg(t,e,r,n)}finally{ft=i,jo.transition=s}}function bC(t,e,r,n){var i=ft,s=jo.transition;jo.transition=null;try{ft=4,eg(t,e,r,n)}finally{ft=i,jo.transition=s}}function eg(t,e,r,n){if(mh){var i=Rp(t,e,r,n);if(i===null)Cd(t,e,n,gh,r),h_(t,n);else if(NC(i,t,e,r,n))n.stopPropagation();else if(h_(t,n),e&4&&-1<FC.indexOf(t)){for(;i!==null;){var s=xu(i);if(s!==null&&yE(s),s=Rp(t,e,r,n),s===null&&Cd(t,e,n,gh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Cd(t,e,n,null,r)}}var gh=null;function Rp(t,e,r,n){if(gh=null,t=Ym(n),t=xa(t),t!==null)if(e=Ya(t),e===null)t=null;else if(r=e.tag,r===13){if(t=hE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gh=t,null}function SE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(EC()){case Qm:return 1;case gE:return 4;case dh:case TC:return 16;case vE:return 536870912;default:return 16}default:return 16}}var Is=null,tg=null,Gf=null;function AE(){if(Gf)return Gf;var t,e=tg,r=e.length,n,i="value"in Is?Is.value:Is.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Gf=i.slice(t,1<n?1-n:void 0)}function Kf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gf(){return!0}function p_(){return!1}function Cn(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gf:p_,this.isPropagationStopped=p_,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=gf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=gf)},persist:function(){},isPersistent:gf}),e}var xl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rg=Cn(xl),_u=Ot({},xl,{view:0,detail:0}),LC=Cn(_u),xd,yd,Hl,m0=Ot({},_u,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ng,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hl&&(Hl&&t.type==="mousemove"?(xd=t.screenX-Hl.screenX,yd=t.screenY-Hl.screenY):yd=xd=0,Hl=t),xd)},movementY:function(t){return"movementY"in t?t.movementY:yd}}),m_=Cn(m0),MC=Ot({},m0,{dataTransfer:0}),VC=Cn(MC),BC=Ot({},_u,{relatedTarget:0}),wd=Cn(BC),UC=Ot({},xl,{animationName:0,elapsedTime:0,pseudoElement:0}),jC=Cn(UC),WC=Ot({},xl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),HC=Cn(WC),zC=Ot({},xl,{data:0}),g_=Cn(zC),$C={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KC[t])?!!e[t]:!1}function ng(){return XC}var qC=Ot({},_u,{key:function(t){if(t.key){var e=$C[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Kf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?GC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ng,charCode:function(t){return t.type==="keypress"?Kf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Kf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),YC=Cn(qC),QC=Ot({},m0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),v_=Cn(QC),JC=Ot({},_u,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ng}),ZC=Cn(JC),e4=Ot({},xl,{propertyName:0,elapsedTime:0,pseudoElement:0}),t4=Cn(e4),r4=Ot({},m0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),n4=Cn(r4),i4=[9,13,27,32],ig=Qi&&"CompositionEvent"in window,fc=null;Qi&&"documentMode"in document&&(fc=document.documentMode);var s4=Qi&&"TextEvent"in window&&!fc,IE=Qi&&(!ig||fc&&8<fc&&11>=fc),__=" ",x_=!1;function CE(t,e){switch(t){case"keyup":return i4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var So=!1;function a4(t,e){switch(t){case"compositionend":return RE(e);case"keypress":return e.which!==32?null:(x_=!0,__);case"textInput":return t=e.data,t===__&&x_?null:t;default:return null}}function o4(t,e){if(So)return t==="compositionend"||!ig&&CE(t,e)?(t=AE(),Gf=tg=Is=null,So=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return IE&&e.locale!=="ko"?null:e.data;default:return null}}var l4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!l4[t.type]:e==="textarea"}function PE(t,e,r,n){oE(n),e=vh(e,"onChange"),0<e.length&&(r=new rg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var hc=null,Mc=null;function c4(t){jE(t,0)}function g0(t){var e=Co(t);if(eE(e))return t}function u4(t,e){if(t==="change")return e}var FE=!1;if(Qi){var Ed;if(Qi){var Td="oninput"in document;if(!Td){var w_=document.createElement("div");w_.setAttribute("oninput","return;"),Td=typeof w_.oninput=="function"}Ed=Td}else Ed=!1;FE=Ed&&(!document.documentMode||9<document.documentMode)}function E_(){hc&&(hc.detachEvent("onpropertychange",NE),Mc=hc=null)}function NE(t){if(t.propertyName==="value"&&g0(Mc)){var e=[];PE(e,Mc,t,Ym(t)),fE(c4,e)}}function f4(t,e,r){t==="focusin"?(E_(),hc=e,Mc=r,hc.attachEvent("onpropertychange",NE)):t==="focusout"&&E_()}function h4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return g0(Mc)}function d4(t,e){if(t==="click")return g0(e)}function p4(t,e){if(t==="input"||t==="change")return g0(e)}function m4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ai=typeof Object.is=="function"?Object.is:m4;function Vc(t,e){if(ai(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!fp.call(e,i)||!ai(t[i],e[i]))return!1}return!0}function T_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function k_(t,e){var r=T_(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=T_(r)}}function DE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?DE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function OE(){for(var t=window,e=uh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=uh(t.document)}return e}function sg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function g4(t){var e=OE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&DE(r.ownerDocument.documentElement,r)){if(n!==null&&sg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=k_(r,s);var a=k_(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var v4=Qi&&"documentMode"in document&&11>=document.documentMode,Ao=null,Pp=null,dc=null,Fp=!1;function S_(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Fp||Ao==null||Ao!==uh(n)||(n=Ao,"selectionStart"in n&&sg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),dc&&Vc(dc,n)||(dc=n,n=vh(Pp,"onSelect"),0<n.length&&(e=new rg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ao)))}function vf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Io={animationend:vf("Animation","AnimationEnd"),animationiteration:vf("Animation","AnimationIteration"),animationstart:vf("Animation","AnimationStart"),transitionend:vf("Transition","TransitionEnd")},kd={},bE={};Qi&&(bE=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function v0(t){if(kd[t])return kd[t];if(!Io[t])return t;var e=Io[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in bE)return kd[t]=e[r];return t}var LE=v0("animationend"),ME=v0("animationiteration"),VE=v0("animationstart"),BE=v0("transitionend"),UE=new Map,A_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zs(t,e){UE.set(t,e),qa(e,[t])}for(var Sd=0;Sd<A_.length;Sd++){var Ad=A_[Sd],_4=Ad.toLowerCase(),x4=Ad[0].toUpperCase()+Ad.slice(1);Zs(_4,"on"+x4)}Zs(LE,"onAnimationEnd");Zs(ME,"onAnimationIteration");Zs(VE,"onAnimationStart");Zs("dblclick","onDoubleClick");Zs("focusin","onFocus");Zs("focusout","onBlur");Zs(BE,"onTransitionEnd");Jo("onMouseEnter",["mouseout","mouseover"]);Jo("onMouseLeave",["mouseout","mouseover"]);Jo("onPointerEnter",["pointerout","pointerover"]);Jo("onPointerLeave",["pointerout","pointerover"]);qa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qa("onBeforeInput",["compositionend","keypress","textInput","paste"]);qa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),y4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jl));function I_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,_C(n,e,void 0,t),t.currentTarget=null}function jE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;I_(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;I_(i,o,c),s=l}}}if(hh)throw t=Ap,hh=!1,Ap=null,t}function yt(t,e){var r=e[Lp];r===void 0&&(r=e[Lp]=new Set);var n=t+"__bubble";r.has(n)||(WE(e,t,2,!1),r.add(n))}function Id(t,e,r){var n=0;e&&(n|=4),WE(r,t,n,e)}var _f="_reactListening"+Math.random().toString(36).slice(2);function Bc(t){if(!t[_f]){t[_f]=!0,qw.forEach(function(r){r!=="selectionchange"&&(y4.has(r)||Id(r,!1,t),Id(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_f]||(e[_f]=!0,Id("selectionchange",!1,e))}}function WE(t,e,r,n){switch(SE(e)){case 1:var i=OC;break;case 4:i=bC;break;default:i=eg}r=i.bind(null,e,r,t),i=void 0,!Sp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Cd(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=xa(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}fE(function(){var c=s,f=Ym(r),h=[];e:{var d=UE.get(t);if(d!==void 0){var p=rg,g=t;switch(t){case"keypress":if(Kf(r)===0)break e;case"keydown":case"keyup":p=YC;break;case"focusin":g="focus",p=wd;break;case"focusout":g="blur",p=wd;break;case"beforeblur":case"afterblur":p=wd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=m_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=VC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ZC;break;case LE:case ME:case VE:p=jC;break;case BE:p=t4;break;case"scroll":p=LC;break;case"wheel":p=n4;break;case"copy":case"cut":case"paste":p=HC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=v_}var m=(e&4)!==0,_=!m&&t==="scroll",w=m?d!==null?d+"Capture":null:d;m=[];for(var E=c,x;E!==null;){x=E;var P=x.stateNode;if(x.tag===5&&P!==null&&(x=P,w!==null&&(P=Dc(E,w),P!=null&&m.push(Uc(E,P,x)))),_)break;E=E.return}0<m.length&&(d=new p(d,g,null,r,f),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==Tp&&(g=r.relatedTarget||r.fromElement)&&(xa(g)||g[Ji]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?xa(g):null,g!==null&&(_=Ya(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(m=m_,P="onMouseLeave",w="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(m=v_,P="onPointerLeave",w="onPointerEnter",E="pointer"),_=p==null?d:Co(p),x=g==null?d:Co(g),d=new m(P,E+"leave",p,r,f),d.target=_,d.relatedTarget=x,P=null,xa(f)===c&&(m=new m(w,E+"enter",g,r,f),m.target=x,m.relatedTarget=_,P=m),_=P,p&&g)t:{for(m=p,w=g,E=0,x=m;x;x=mo(x))E++;for(x=0,P=w;P;P=mo(P))x++;for(;0<E-x;)m=mo(m),E--;for(;0<x-E;)w=mo(w),x--;for(;E--;){if(m===w||w!==null&&m===w.alternate)break t;m=mo(m),w=mo(w)}m=null}else m=null;p!==null&&C_(h,d,p,m,!1),g!==null&&_!==null&&C_(h,_,g,m,!0)}}e:{if(d=c?Co(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var W=u4;else if(y_(d))if(FE)W=p4;else{W=h4;var M=f4}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(W=d4);if(W&&(W=W(t,c))){PE(h,W,r,f);break e}M&&M(t,d,c),t==="focusout"&&(M=d._wrapperState)&&M.controlled&&d.type==="number"&&_p(d,"number",d.value)}switch(M=c?Co(c):window,t){case"focusin":(y_(M)||M.contentEditable==="true")&&(Ao=M,Pp=c,dc=null);break;case"focusout":dc=Pp=Ao=null;break;case"mousedown":Fp=!0;break;case"contextmenu":case"mouseup":case"dragend":Fp=!1,S_(h,r,f);break;case"selectionchange":if(v4)break;case"keydown":case"keyup":S_(h,r,f)}var y;if(ig)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else So?CE(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(IE&&r.locale!=="ko"&&(So||k!=="onCompositionStart"?k==="onCompositionEnd"&&So&&(y=AE()):(Is=f,tg="value"in Is?Is.value:Is.textContent,So=!0)),M=vh(c,k),0<M.length&&(k=new g_(k,t,null,r,f),h.push({event:k,listeners:M}),y?k.data=y:(y=RE(r),y!==null&&(k.data=y)))),(y=s4?a4(t,r):o4(t,r))&&(c=vh(c,"onBeforeInput"),0<c.length&&(f=new g_("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=y))}jE(h,e)})}function Uc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function vh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Dc(t,r),s!=null&&n.unshift(Uc(t,s,i)),s=Dc(t,e),s!=null&&n.push(Uc(t,s,i))),t=t.return}return n}function mo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function C_(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Dc(r,s),l!=null&&a.unshift(Uc(r,l,o))):i||(l=Dc(r,s),l!=null&&a.push(Uc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var w4=/\r\n?/g,E4=/\u0000|\uFFFD/g;function R_(t){return(typeof t=="string"?t:""+t).replace(w4,`
`).replace(E4,"")}function xf(t,e,r){if(e=R_(e),R_(t)!==e&&r)throw Error(me(425))}function _h(){}var Np=null,Dp=null;function Op(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bp=typeof setTimeout=="function"?setTimeout:void 0,T4=typeof clearTimeout=="function"?clearTimeout:void 0,P_=typeof Promise=="function"?Promise:void 0,k4=typeof queueMicrotask=="function"?queueMicrotask:typeof P_<"u"?function(t){return P_.resolve(null).then(t).catch(S4)}:bp;function S4(t){setTimeout(function(){throw t})}function Rd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Lc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Lc(e)}function bs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function F_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var yl=Math.random().toString(36).slice(2),gi="__reactFiber$"+yl,jc="__reactProps$"+yl,Ji="__reactContainer$"+yl,Lp="__reactEvents$"+yl,A4="__reactListeners$"+yl,I4="__reactHandles$"+yl;function xa(t){var e=t[gi];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ji]||r[gi]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=F_(t);t!==null;){if(r=t[gi])return r;t=F_(t)}return e}t=r,r=t.parentNode}return null}function xu(t){return t=t[gi]||t[Ji],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(me(33))}function _0(t){return t[jc]||null}var Mp=[],Ro=-1;function ea(t){return{current:t}}function Tt(t){0>Ro||(t.current=Mp[Ro],Mp[Ro]=null,Ro--)}function vt(t,e){Ro++,Mp[Ro]=t.current,t.current=e}var $s={},Hr=ea($s),cn=ea(!1),Na=$s;function Zo(t,e){var r=t.type.contextTypes;if(!r)return $s;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function un(t){return t=t.childContextTypes,t!=null}function xh(){Tt(cn),Tt(Hr)}function N_(t,e,r){if(Hr.current!==$s)throw Error(me(168));vt(Hr,e),vt(cn,r)}function HE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(me(108,fC(t)||"Unknown",i));return Ot({},r,n)}function yh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$s,Na=Hr.current,vt(Hr,t),vt(cn,cn.current),!0}function D_(t,e,r){var n=t.stateNode;if(!n)throw Error(me(169));r?(t=HE(t,e,Na),n.__reactInternalMemoizedMergedChildContext=t,Tt(cn),Tt(Hr),vt(Hr,t)):Tt(cn),vt(cn,r)}var Mi=null,x0=!1,Pd=!1;function zE(t){Mi===null?Mi=[t]:Mi.push(t)}function C4(t){x0=!0,zE(t)}function ta(){if(!Pd&&Mi!==null){Pd=!0;var t=0,e=ft;try{var r=Mi;for(ft=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Mi=null,x0=!1}catch(i){throw Mi!==null&&(Mi=Mi.slice(t+1)),mE(Qm,ta),i}finally{ft=e,Pd=!1}}return null}var Po=[],Fo=0,wh=null,Eh=0,Vn=[],Bn=0,Da=null,Vi=1,Bi="";function pa(t,e){Po[Fo++]=Eh,Po[Fo++]=wh,wh=t,Eh=e}function $E(t,e,r){Vn[Bn++]=Vi,Vn[Bn++]=Bi,Vn[Bn++]=Da,Da=t;var n=Vi;t=Bi;var i=32-ri(n)-1;n&=~(1<<i),r+=1;var s=32-ri(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Vi=1<<32-ri(e)+i|r<<i|n,Bi=s+t}else Vi=1<<s|r<<i|n,Bi=t}function ag(t){t.return!==null&&(pa(t,1),$E(t,1,0))}function og(t){for(;t===wh;)wh=Po[--Fo],Po[Fo]=null,Eh=Po[--Fo],Po[Fo]=null;for(;t===Da;)Da=Vn[--Bn],Vn[Bn]=null,Bi=Vn[--Bn],Vn[Bn]=null,Vi=Vn[--Bn],Vn[Bn]=null}var kn=null,En=null,It=!1,Zn=null;function GE(t,e){var r=jn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function O_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kn=t,En=bs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kn=t,En=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Da!==null?{id:Vi,overflow:Bi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=jn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,kn=t,En=null,!0):!1;default:return!1}}function Vp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bp(t){if(It){var e=En;if(e){var r=e;if(!O_(t,e)){if(Vp(t))throw Error(me(418));e=bs(r.nextSibling);var n=kn;e&&O_(t,e)?GE(n,r):(t.flags=t.flags&-4097|2,It=!1,kn=t)}}else{if(Vp(t))throw Error(me(418));t.flags=t.flags&-4097|2,It=!1,kn=t}}}function b_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kn=t}function yf(t){if(t!==kn)return!1;if(!It)return b_(t),It=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Op(t.type,t.memoizedProps)),e&&(e=En)){if(Vp(t))throw KE(),Error(me(418));for(;e;)GE(t,e),e=bs(e.nextSibling)}if(b_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){En=bs(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}En=null}}else En=kn?bs(t.stateNode.nextSibling):null;return!0}function KE(){for(var t=En;t;)t=bs(t.nextSibling)}function el(){En=kn=null,It=!1}function lg(t){Zn===null?Zn=[t]:Zn.push(t)}var R4=as.ReactCurrentBatchConfig;function zl(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(me(309));var n=r.stateNode}if(!n)throw Error(me(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(me(284));if(!r._owner)throw Error(me(290,t))}return t}function wf(t,e){throw t=Object.prototype.toString.call(e),Error(me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function L_(t){var e=t._init;return e(t._payload)}function XE(t){function e(w,E){if(t){var x=w.deletions;x===null?(w.deletions=[E],w.flags|=16):x.push(E)}}function r(w,E){if(!t)return null;for(;E!==null;)e(w,E),E=E.sibling;return null}function n(w,E){for(w=new Map;E!==null;)E.key!==null?w.set(E.key,E):w.set(E.index,E),E=E.sibling;return w}function i(w,E){return w=Bs(w,E),w.index=0,w.sibling=null,w}function s(w,E,x){return w.index=x,t?(x=w.alternate,x!==null?(x=x.index,x<E?(w.flags|=2,E):x):(w.flags|=2,E)):(w.flags|=1048576,E)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function o(w,E,x,P){return E===null||E.tag!==6?(E=Md(x,w.mode,P),E.return=w,E):(E=i(E,x),E.return=w,E)}function l(w,E,x,P){var W=x.type;return W===ko?f(w,E,x.props.children,P,x.key):E!==null&&(E.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===xs&&L_(W)===E.type)?(P=i(E,x.props),P.ref=zl(w,E,x),P.return=w,P):(P=eh(x.type,x.key,x.props,null,w.mode,P),P.ref=zl(w,E,x),P.return=w,P)}function c(w,E,x,P){return E===null||E.tag!==4||E.stateNode.containerInfo!==x.containerInfo||E.stateNode.implementation!==x.implementation?(E=Vd(x,w.mode,P),E.return=w,E):(E=i(E,x.children||[]),E.return=w,E)}function f(w,E,x,P,W){return E===null||E.tag!==7?(E=Sa(x,w.mode,P,W),E.return=w,E):(E=i(E,x),E.return=w,E)}function h(w,E,x){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Md(""+E,w.mode,x),E.return=w,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case uf:return x=eh(E.type,E.key,E.props,null,w.mode,x),x.ref=zl(w,null,E),x.return=w,x;case To:return E=Vd(E,w.mode,x),E.return=w,E;case xs:var P=E._init;return h(w,P(E._payload),x)}if(Yl(E)||Bl(E))return E=Sa(E,w.mode,x,null),E.return=w,E;wf(w,E)}return null}function d(w,E,x,P){var W=E!==null?E.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return W!==null?null:o(w,E,""+x,P);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case uf:return x.key===W?l(w,E,x,P):null;case To:return x.key===W?c(w,E,x,P):null;case xs:return W=x._init,d(w,E,W(x._payload),P)}if(Yl(x)||Bl(x))return W!==null?null:f(w,E,x,P,null);wf(w,x)}return null}function p(w,E,x,P,W){if(typeof P=="string"&&P!==""||typeof P=="number")return w=w.get(x)||null,o(E,w,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case uf:return w=w.get(P.key===null?x:P.key)||null,l(E,w,P,W);case To:return w=w.get(P.key===null?x:P.key)||null,c(E,w,P,W);case xs:var M=P._init;return p(w,E,x,M(P._payload),W)}if(Yl(P)||Bl(P))return w=w.get(x)||null,f(E,w,P,W,null);wf(E,P)}return null}function g(w,E,x,P){for(var W=null,M=null,y=E,k=E=0,S=null;y!==null&&k<x.length;k++){y.index>k?(S=y,y=null):S=y.sibling;var I=d(w,y,x[k],P);if(I===null){y===null&&(y=S);break}t&&y&&I.alternate===null&&e(w,y),E=s(I,E,k),M===null?W=I:M.sibling=I,M=I,y=S}if(k===x.length)return r(w,y),It&&pa(w,k),W;if(y===null){for(;k<x.length;k++)y=h(w,x[k],P),y!==null&&(E=s(y,E,k),M===null?W=y:M.sibling=y,M=y);return It&&pa(w,k),W}for(y=n(w,y);k<x.length;k++)S=p(y,w,k,x[k],P),S!==null&&(t&&S.alternate!==null&&y.delete(S.key===null?k:S.key),E=s(S,E,k),M===null?W=S:M.sibling=S,M=S);return t&&y.forEach(function(R){return e(w,R)}),It&&pa(w,k),W}function m(w,E,x,P){var W=Bl(x);if(typeof W!="function")throw Error(me(150));if(x=W.call(x),x==null)throw Error(me(151));for(var M=W=null,y=E,k=E=0,S=null,I=x.next();y!==null&&!I.done;k++,I=x.next()){y.index>k?(S=y,y=null):S=y.sibling;var R=d(w,y,I.value,P);if(R===null){y===null&&(y=S);break}t&&y&&R.alternate===null&&e(w,y),E=s(R,E,k),M===null?W=R:M.sibling=R,M=R,y=S}if(I.done)return r(w,y),It&&pa(w,k),W;if(y===null){for(;!I.done;k++,I=x.next())I=h(w,I.value,P),I!==null&&(E=s(I,E,k),M===null?W=I:M.sibling=I,M=I);return It&&pa(w,k),W}for(y=n(w,y);!I.done;k++,I=x.next())I=p(y,w,k,I.value,P),I!==null&&(t&&I.alternate!==null&&y.delete(I.key===null?k:I.key),E=s(I,E,k),M===null?W=I:M.sibling=I,M=I);return t&&y.forEach(function(C){return e(w,C)}),It&&pa(w,k),W}function _(w,E,x,P){if(typeof x=="object"&&x!==null&&x.type===ko&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case uf:e:{for(var W=x.key,M=E;M!==null;){if(M.key===W){if(W=x.type,W===ko){if(M.tag===7){r(w,M.sibling),E=i(M,x.props.children),E.return=w,w=E;break e}}else if(M.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===xs&&L_(W)===M.type){r(w,M.sibling),E=i(M,x.props),E.ref=zl(w,M,x),E.return=w,w=E;break e}r(w,M);break}else e(w,M);M=M.sibling}x.type===ko?(E=Sa(x.props.children,w.mode,P,x.key),E.return=w,w=E):(P=eh(x.type,x.key,x.props,null,w.mode,P),P.ref=zl(w,E,x),P.return=w,w=P)}return a(w);case To:e:{for(M=x.key;E!==null;){if(E.key===M)if(E.tag===4&&E.stateNode.containerInfo===x.containerInfo&&E.stateNode.implementation===x.implementation){r(w,E.sibling),E=i(E,x.children||[]),E.return=w,w=E;break e}else{r(w,E);break}else e(w,E);E=E.sibling}E=Vd(x,w.mode,P),E.return=w,w=E}return a(w);case xs:return M=x._init,_(w,E,M(x._payload),P)}if(Yl(x))return g(w,E,x,P);if(Bl(x))return m(w,E,x,P);wf(w,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,E!==null&&E.tag===6?(r(w,E.sibling),E=i(E,x),E.return=w,w=E):(r(w,E),E=Md(x,w.mode,P),E.return=w,w=E),a(w)):r(w,E)}return _}var tl=XE(!0),qE=XE(!1),Th=ea(null),kh=null,No=null,cg=null;function ug(){cg=No=kh=null}function fg(t){var e=Th.current;Tt(Th),t._currentValue=e}function Up(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Wo(t,e){kh=t,cg=No=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ln=!0),t.firstContext=null)}function zn(t){var e=t._currentValue;if(cg!==t)if(t={context:t,memoizedValue:e,next:null},No===null){if(kh===null)throw Error(me(308));No=t,kh.dependencies={lanes:0,firstContext:t}}else No=No.next=t;return e}var ya=null;function hg(t){ya===null?ya=[t]:ya.push(t)}function YE(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,hg(e)):(r.next=i.next,i.next=r),e.interleaved=r,Zi(t,n)}function Zi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ys=!1;function dg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $i(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ls(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,et&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Zi(t,r)}return i=n.interleaved,i===null?(e.next=e,hg(n)):(e.next=i.next,i.next=e),n.interleaved=e,Zi(t,r)}function Xf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Jm(t,r)}}function M_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Sh(t,e,r,n){var i=t.updateQueue;ys=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,f=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,m=o;switch(d=e,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(p,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,d=typeof g=="function"?g.call(p,h,d):g,d==null)break e;h=Ot({},h,d);break e;case 2:ys=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=h):f=f.next=p,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ba|=a,t.lanes=a,t.memoizedState=h}}function V_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(me(191,i));i.call(n)}}}var yu={},wi=ea(yu),Wc=ea(yu),Hc=ea(yu);function wa(t){if(t===yu)throw Error(me(174));return t}function pg(t,e){switch(vt(Hc,e),vt(Wc,t),vt(wi,yu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:yp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=yp(e,t)}Tt(wi),vt(wi,e)}function rl(){Tt(wi),Tt(Wc),Tt(Hc)}function JE(t){wa(Hc.current);var e=wa(wi.current),r=yp(e,t.type);e!==r&&(vt(Wc,t),vt(wi,r))}function mg(t){Wc.current===t&&(Tt(wi),Tt(Wc))}var Pt=ea(0);function Ah(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fd=[];function gg(){for(var t=0;t<Fd.length;t++)Fd[t]._workInProgressVersionPrimary=null;Fd.length=0}var qf=as.ReactCurrentDispatcher,Nd=as.ReactCurrentBatchConfig,Oa=0,Dt=null,rr=null,ur=null,Ih=!1,pc=!1,zc=0,P4=0;function Pr(){throw Error(me(321))}function vg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ai(t[r],e[r]))return!1;return!0}function _g(t,e,r,n,i,s){if(Oa=s,Dt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qf.current=t===null||t.memoizedState===null?O4:b4,t=r(n,i),pc){s=0;do{if(pc=!1,zc=0,25<=s)throw Error(me(301));s+=1,ur=rr=null,e.updateQueue=null,qf.current=L4,t=r(n,i)}while(pc)}if(qf.current=Ch,e=rr!==null&&rr.next!==null,Oa=0,ur=rr=Dt=null,Ih=!1,e)throw Error(me(300));return t}function xg(){var t=zc!==0;return zc=0,t}function mi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?Dt.memoizedState=ur=t:ur=ur.next=t,ur}function $n(){if(rr===null){var t=Dt.alternate;t=t!==null?t.memoizedState:null}else t=rr.next;var e=ur===null?Dt.memoizedState:ur.next;if(e!==null)ur=e,rr=t;else{if(t===null)throw Error(me(310));rr=t,t={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},ur===null?Dt.memoizedState=ur=t:ur=ur.next=t}return ur}function $c(t,e){return typeof e=="function"?e(t):e}function Dd(t){var e=$n(),r=e.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=t;var n=rr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var f=c.lane;if((Oa&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Dt.lanes|=f,ba|=f}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,ai(n,e.memoizedState)||(ln=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Dt.lanes|=s,ba|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Od(t){var e=$n(),r=e.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);ai(s,e.memoizedState)||(ln=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function ZE(){}function e2(t,e){var r=Dt,n=$n(),i=e(),s=!ai(n.memoizedState,i);if(s&&(n.memoizedState=i,ln=!0),n=n.queue,yg(n2.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ur!==null&&ur.memoizedState.tag&1){if(r.flags|=2048,Gc(9,r2.bind(null,r,n,i,e),void 0,null),pr===null)throw Error(me(349));Oa&30||t2(r,e,i)}return i}function t2(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Dt.updateQueue,e===null?(e={lastEffect:null,stores:null},Dt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function r2(t,e,r,n){e.value=r,e.getSnapshot=n,i2(e)&&s2(t)}function n2(t,e,r){return r(function(){i2(e)&&s2(t)})}function i2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ai(t,r)}catch{return!0}}function s2(t){var e=Zi(t,1);e!==null&&ni(e,t,1,-1)}function B_(t){var e=mi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$c,lastRenderedState:t},e.queue=t,t=t.dispatch=D4.bind(null,Dt,t),[e.memoizedState,t]}function Gc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Dt.updateQueue,e===null?(e={lastEffect:null,stores:null},Dt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function a2(){return $n().memoizedState}function Yf(t,e,r,n){var i=mi();Dt.flags|=t,i.memoizedState=Gc(1|e,r,void 0,n===void 0?null:n)}function y0(t,e,r,n){var i=$n();n=n===void 0?null:n;var s=void 0;if(rr!==null){var a=rr.memoizedState;if(s=a.destroy,n!==null&&vg(n,a.deps)){i.memoizedState=Gc(e,r,s,n);return}}Dt.flags|=t,i.memoizedState=Gc(1|e,r,s,n)}function U_(t,e){return Yf(8390656,8,t,e)}function yg(t,e){return y0(2048,8,t,e)}function o2(t,e){return y0(4,2,t,e)}function l2(t,e){return y0(4,4,t,e)}function c2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function u2(t,e,r){return r=r!=null?r.concat([t]):null,y0(4,4,c2.bind(null,e,t),r)}function wg(){}function f2(t,e){var r=$n();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&vg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function h2(t,e){var r=$n();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&vg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function d2(t,e,r){return Oa&21?(ai(r,e)||(r=_E(),Dt.lanes|=r,ba|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ln=!0),t.memoizedState=r)}function F4(t,e){var r=ft;ft=r!==0&&4>r?r:4,t(!0);var n=Nd.transition;Nd.transition={};try{t(!1),e()}finally{ft=r,Nd.transition=n}}function p2(){return $n().memoizedState}function N4(t,e,r){var n=Vs(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},m2(t))g2(e,r);else if(r=YE(t,e,r,n),r!==null){var i=Qr();ni(r,t,n,i),v2(r,e,n)}}function D4(t,e,r){var n=Vs(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(m2(t))g2(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,ai(o,a)){var l=e.interleaved;l===null?(i.next=i,hg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=YE(t,e,i,n),r!==null&&(i=Qr(),ni(r,t,n,i),v2(r,e,n))}}function m2(t){var e=t.alternate;return t===Dt||e!==null&&e===Dt}function g2(t,e){pc=Ih=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function v2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Jm(t,r)}}var Ch={readContext:zn,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},O4={readContext:zn,useCallback:function(t,e){return mi().memoizedState=[t,e===void 0?null:e],t},useContext:zn,useEffect:U_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Yf(4194308,4,c2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Yf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Yf(4,2,t,e)},useMemo:function(t,e){var r=mi();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=mi();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=N4.bind(null,Dt,t),[n.memoizedState,t]},useRef:function(t){var e=mi();return t={current:t},e.memoizedState=t},useState:B_,useDebugValue:wg,useDeferredValue:function(t){return mi().memoizedState=t},useTransition:function(){var t=B_(!1),e=t[0];return t=F4.bind(null,t[1]),mi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Dt,i=mi();if(It){if(r===void 0)throw Error(me(407));r=r()}else{if(r=e(),pr===null)throw Error(me(349));Oa&30||t2(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,U_(n2.bind(null,n,s,t),[t]),n.flags|=2048,Gc(9,r2.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=mi(),e=pr.identifierPrefix;if(It){var r=Bi,n=Vi;r=(n&~(1<<32-ri(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=zc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=P4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},b4={readContext:zn,useCallback:f2,useContext:zn,useEffect:yg,useImperativeHandle:u2,useInsertionEffect:o2,useLayoutEffect:l2,useMemo:h2,useReducer:Dd,useRef:a2,useState:function(){return Dd($c)},useDebugValue:wg,useDeferredValue:function(t){var e=$n();return d2(e,rr.memoizedState,t)},useTransition:function(){var t=Dd($c)[0],e=$n().memoizedState;return[t,e]},useMutableSource:ZE,useSyncExternalStore:e2,useId:p2,unstable_isNewReconciler:!1},L4={readContext:zn,useCallback:f2,useContext:zn,useEffect:yg,useImperativeHandle:u2,useInsertionEffect:o2,useLayoutEffect:l2,useMemo:h2,useReducer:Od,useRef:a2,useState:function(){return Od($c)},useDebugValue:wg,useDeferredValue:function(t){var e=$n();return rr===null?e.memoizedState=t:d2(e,rr.memoizedState,t)},useTransition:function(){var t=Od($c)[0],e=$n().memoizedState;return[t,e]},useMutableSource:ZE,useSyncExternalStore:e2,useId:p2,unstable_isNewReconciler:!1};function Qn(t,e){if(t&&t.defaultProps){e=Ot({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function jp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ot({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var w0={isMounted:function(t){return(t=t._reactInternals)?Ya(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Qr(),i=Vs(t),s=$i(n,i);s.payload=e,r!=null&&(s.callback=r),e=Ls(t,s,i),e!==null&&(ni(e,t,i,n),Xf(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Qr(),i=Vs(t),s=$i(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Ls(t,s,i),e!==null&&(ni(e,t,i,n),Xf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Qr(),n=Vs(t),i=$i(r,n);i.tag=2,e!=null&&(i.callback=e),e=Ls(t,i,n),e!==null&&(ni(e,t,n,r),Xf(e,t,n))}};function j_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Vc(r,n)||!Vc(i,s):!0}function _2(t,e,r){var n=!1,i=$s,s=e.contextType;return typeof s=="object"&&s!==null?s=zn(s):(i=un(e)?Na:Hr.current,n=e.contextTypes,s=(n=n!=null)?Zo(t,i):$s),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=w0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function W_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&w0.enqueueReplaceState(e,e.state,null)}function Wp(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},dg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zn(s):(s=un(e)?Na:Hr.current,i.context=Zo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(jp(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&w0.enqueueReplaceState(i,i.state,null),Sh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function nl(t,e){try{var r="",n=e;do r+=uC(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function bd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Hp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var M4=typeof WeakMap=="function"?WeakMap:Map;function x2(t,e,r){r=$i(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ph||(Ph=!0,Zp=n),Hp(t,e)},r}function y2(t,e,r){r=$i(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Hp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Hp(t,e),typeof n!="function"&&(Ms===null?Ms=new Set([this]):Ms.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function H_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new M4;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Q4.bind(null,t,e,r),e.then(t,t))}function z_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function $_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=$i(-1,1),e.tag=2,Ls(r,e,1))),r.lanes|=1),t)}var V4=as.ReactCurrentOwner,ln=!1;function Xr(t,e,r,n){e.child=t===null?qE(e,null,r,n):tl(e,t.child,r,n)}function G_(t,e,r,n,i){r=r.render;var s=e.ref;return Wo(e,i),n=_g(t,e,r,n,s,i),r=xg(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,es(t,e,i)):(It&&r&&ag(e),e.flags|=1,Xr(t,e,n,i),e.child)}function K_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!Rg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,w2(t,e,s,n,i)):(t=eh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Vc,r(a,n)&&t.ref===e.ref)return es(t,e,i)}return e.flags|=1,t=Bs(s,n),t.ref=e.ref,t.return=e,e.child=t}function w2(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Vc(s,n)&&t.ref===e.ref)if(ln=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(ln=!0);else return e.lanes=t.lanes,es(t,e,i)}return zp(t,e,r,n,i)}function E2(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(Oo,vn),vn|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vt(Oo,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,vt(Oo,vn),vn|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,vt(Oo,vn),vn|=n;return Xr(t,e,i,r),e.child}function T2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function zp(t,e,r,n,i){var s=un(r)?Na:Hr.current;return s=Zo(e,s),Wo(e,i),r=_g(t,e,r,n,s,i),n=xg(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,es(t,e,i)):(It&&n&&ag(e),e.flags|=1,Xr(t,e,r,i),e.child)}function X_(t,e,r,n,i){if(un(r)){var s=!0;yh(e)}else s=!1;if(Wo(e,i),e.stateNode===null)Qf(t,e),_2(e,r,n),Wp(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=zn(c):(c=un(r)?Na:Hr.current,c=Zo(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&W_(e,a,n,c),ys=!1;var d=e.memoizedState;a.state=d,Sh(e,n,a,i),l=e.memoizedState,o!==n||d!==l||cn.current||ys?(typeof f=="function"&&(jp(e,r,f,n),l=e.memoizedState),(o=ys||j_(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,QE(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Qn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=zn(l):(l=un(r)?Na:Hr.current,l=Zo(e,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&W_(e,a,n,l),ys=!1,d=e.memoizedState,a.state=d,Sh(e,n,a,i);var g=e.memoizedState;o!==h||d!==g||cn.current||ys?(typeof p=="function"&&(jp(e,r,p,n),g=e.memoizedState),(c=ys||j_(e,r,c,n,d,g,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return $p(t,e,r,n,s,i)}function $p(t,e,r,n,i,s){T2(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&D_(e,r,!1),es(t,e,s);n=e.stateNode,V4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=tl(e,t.child,null,s),e.child=tl(e,null,o,s)):Xr(t,e,o,s),e.memoizedState=n.state,i&&D_(e,r,!0),e.child}function k2(t){var e=t.stateNode;e.pendingContext?N_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&N_(t,e.context,!1),pg(t,e.containerInfo)}function q_(t,e,r,n,i){return el(),lg(i),e.flags|=256,Xr(t,e,r,n),e.child}var Gp={dehydrated:null,treeContext:null,retryLane:0};function Kp(t){return{baseLanes:t,cachePool:null,transitions:null}}function S2(t,e,r){var n=e.pendingProps,i=Pt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vt(Pt,i&1),t===null)return Bp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=k0(a,n,0,null),t=Sa(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Kp(r),e.memoizedState=Gp,t):Eg(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return B4(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Bs(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Bs(o,s):(s=Sa(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Kp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Gp,n}return s=t.child,t=s.sibling,n=Bs(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Eg(t,e){return e=k0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ef(t,e,r,n){return n!==null&&lg(n),tl(e,t.child,null,r),t=Eg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function B4(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=bd(Error(me(422))),Ef(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=k0({mode:"visible",children:n.children},i,0,null),s=Sa(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&tl(e,t.child,null,a),e.child.memoizedState=Kp(a),e.memoizedState=Gp,s);if(!(e.mode&1))return Ef(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(me(419)),n=bd(s,n,void 0),Ef(t,e,a,n)}if(o=(a&t.childLanes)!==0,ln||o){if(n=pr,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Zi(t,i),ni(n,t,i,-1))}return Cg(),n=bd(Error(me(421))),Ef(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=J4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,En=bs(i.nextSibling),kn=e,It=!0,Zn=null,t!==null&&(Vn[Bn++]=Vi,Vn[Bn++]=Bi,Vn[Bn++]=Da,Vi=t.id,Bi=t.overflow,Da=e),e=Eg(e,n.children),e.flags|=4096,e)}function Y_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Up(t.return,e,r)}function Ld(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function A2(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Xr(t,e,n.children,r),n=Pt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Y_(t,r,e);else if(t.tag===19)Y_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(vt(Pt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Ah(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Ld(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ah(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Ld(e,!0,r,null,s);break;case"together":Ld(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function es(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ba|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(me(153));if(e.child!==null){for(t=e.child,r=Bs(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Bs(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function U4(t,e,r){switch(e.tag){case 3:k2(e),el();break;case 5:JE(e);break;case 1:un(e.type)&&yh(e);break;case 4:pg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;vt(Th,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(vt(Pt,Pt.current&1),e.flags|=128,null):r&e.child.childLanes?S2(t,e,r):(vt(Pt,Pt.current&1),t=es(t,e,r),t!==null?t.sibling:null);vt(Pt,Pt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return A2(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vt(Pt,Pt.current),n)break;return null;case 22:case 23:return e.lanes=0,E2(t,e,r)}return es(t,e,r)}var I2,Xp,C2,R2;I2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Xp=function(){};C2=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,wa(wi.current);var s=null;switch(r){case"input":i=gp(t,i),n=gp(t,n),s=[];break;case"select":i=Ot({},i,{value:void 0}),n=Ot({},n,{value:void 0}),s=[];break;case"textarea":i=xp(t,i),n=xp(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=_h)}wp(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&yt("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};R2=function(t,e,r,n){r!==n&&(e.flags|=4)};function $l(t,e){if(!It)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Fr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function j4(t,e,r){var n=e.pendingProps;switch(og(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(e),null;case 1:return un(e.type)&&xh(),Fr(e),null;case 3:return n=e.stateNode,rl(),Tt(cn),Tt(Hr),gg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(yf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(rm(Zn),Zn=null))),Xp(t,e),Fr(e),null;case 5:mg(e);var i=wa(Hc.current);if(r=e.type,t!==null&&e.stateNode!=null)C2(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(me(166));return Fr(e),null}if(t=wa(wi.current),yf(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[gi]=e,n[jc]=s,t=(e.mode&1)!==0,r){case"dialog":yt("cancel",n),yt("close",n);break;case"iframe":case"object":case"embed":yt("load",n);break;case"video":case"audio":for(i=0;i<Jl.length;i++)yt(Jl[i],n);break;case"source":yt("error",n);break;case"img":case"image":case"link":yt("error",n),yt("load",n);break;case"details":yt("toggle",n);break;case"input":s_(n,s),yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},yt("invalid",n);break;case"textarea":o_(n,s),yt("invalid",n)}wp(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&xf(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&xf(n.textContent,o,t),i=["children",""+o]):Fc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&yt("scroll",n)}switch(r){case"input":ff(n),a_(n,s,!0);break;case"textarea":ff(n),l_(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=_h)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=nE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[gi]=e,t[jc]=n,I2(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ep(r,n),r){case"dialog":yt("cancel",t),yt("close",t),i=n;break;case"iframe":case"object":case"embed":yt("load",t),i=n;break;case"video":case"audio":for(i=0;i<Jl.length;i++)yt(Jl[i],t);i=n;break;case"source":yt("error",t),i=n;break;case"img":case"image":case"link":yt("error",t),yt("load",t),i=n;break;case"details":yt("toggle",t),i=n;break;case"input":s_(t,n),i=gp(t,n),yt("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ot({},n,{value:void 0}),yt("invalid",t);break;case"textarea":o_(t,n),i=xp(t,n),yt("invalid",t);break;default:i=n}wp(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?aE(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&iE(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Nc(t,l):typeof l=="number"&&Nc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Fc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&yt("scroll",t):l!=null&&Gm(t,s,l,a))}switch(r){case"input":ff(t),a_(t,n,!1);break;case"textarea":ff(t),l_(t);break;case"option":n.value!=null&&t.setAttribute("value",""+zs(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Vo(t,!!n.multiple,s,!1):n.defaultValue!=null&&Vo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=_h)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fr(e),null;case 6:if(t&&e.stateNode!=null)R2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(me(166));if(r=wa(Hc.current),wa(wi.current),yf(e)){if(n=e.stateNode,r=e.memoizedProps,n[gi]=e,(s=n.nodeValue!==r)&&(t=kn,t!==null))switch(t.tag){case 3:xf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xf(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gi]=e,e.stateNode=n}return Fr(e),null;case 13:if(Tt(Pt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(It&&En!==null&&e.mode&1&&!(e.flags&128))KE(),el(),e.flags|=98560,s=!1;else if(s=yf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(me(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(me(317));s[gi]=e}else el(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fr(e),s=!1}else Zn!==null&&(rm(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Pt.current&1?ir===0&&(ir=3):Cg())),e.updateQueue!==null&&(e.flags|=4),Fr(e),null);case 4:return rl(),Xp(t,e),t===null&&Bc(e.stateNode.containerInfo),Fr(e),null;case 10:return fg(e.type._context),Fr(e),null;case 17:return un(e.type)&&xh(),Fr(e),null;case 19:if(Tt(Pt),s=e.memoizedState,s===null)return Fr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)$l(s,!1);else{if(ir!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ah(t),a!==null){for(e.flags|=128,$l(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return vt(Pt,Pt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Gt()>il&&(e.flags|=128,n=!0,$l(s,!1),e.lanes=4194304)}else{if(!n)if(t=Ah(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),$l(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!It)return Fr(e),null}else 2*Gt()-s.renderingStartTime>il&&r!==1073741824&&(e.flags|=128,n=!0,$l(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Gt(),e.sibling=null,r=Pt.current,vt(Pt,n?r&1|2:r&1),e):(Fr(e),null);case 22:case 23:return Ig(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?vn&1073741824&&(Fr(e),e.subtreeFlags&6&&(e.flags|=8192)):Fr(e),null;case 24:return null;case 25:return null}throw Error(me(156,e.tag))}function W4(t,e){switch(og(e),e.tag){case 1:return un(e.type)&&xh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return rl(),Tt(cn),Tt(Hr),gg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return mg(e),null;case 13:if(Tt(Pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(me(340));el()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Tt(Pt),null;case 4:return rl(),null;case 10:return fg(e.type._context),null;case 22:case 23:return Ig(),null;case 24:return null;default:return null}}var Tf=!1,Mr=!1,H4=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Do(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(t,e,n)}else r.current=null}function qp(t,e,r){try{r()}catch(n){Bt(t,e,n)}}var Q_=!1;function z4(t,e){if(Np=mh,t=OE(),sg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=a),d===s&&++f===n&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Dp={focusedElem:t,selectionRange:r},mh=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,_=g.memoizedState,w=e.stateNode,E=w.getSnapshotBeforeUpdate(e.elementType===e.type?m:Qn(e.type,m),_);w.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(P){Bt(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return g=Q_,Q_=!1,g}function mc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&qp(e,r,s)}i=i.next}while(i!==n)}}function E0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Yp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function P2(t){var e=t.alternate;e!==null&&(t.alternate=null,P2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gi],delete e[jc],delete e[Lp],delete e[A4],delete e[I4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function F2(t){return t.tag===5||t.tag===3||t.tag===4}function J_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||F2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=_h));else if(n!==4&&(t=t.child,t!==null))for(Qp(t,e,r),t=t.sibling;t!==null;)Qp(t,e,r),t=t.sibling}function Jp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Jp(t,e,r),t=t.sibling;t!==null;)Jp(t,e,r),t=t.sibling}var xr=null,Jn=!1;function gs(t,e,r){for(r=r.child;r!==null;)N2(t,e,r),r=r.sibling}function N2(t,e,r){if(yi&&typeof yi.onCommitFiberUnmount=="function")try{yi.onCommitFiberUnmount(p0,r)}catch{}switch(r.tag){case 5:Mr||Do(r,e);case 6:var n=xr,i=Jn;xr=null,gs(t,e,r),xr=n,Jn=i,xr!==null&&(Jn?(t=xr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):xr.removeChild(r.stateNode));break;case 18:xr!==null&&(Jn?(t=xr,r=r.stateNode,t.nodeType===8?Rd(t.parentNode,r):t.nodeType===1&&Rd(t,r),Lc(t)):Rd(xr,r.stateNode));break;case 4:n=xr,i=Jn,xr=r.stateNode.containerInfo,Jn=!0,gs(t,e,r),xr=n,Jn=i;break;case 0:case 11:case 14:case 15:if(!Mr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&qp(r,e,a),i=i.next}while(i!==n)}gs(t,e,r);break;case 1:if(!Mr&&(Do(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Bt(r,e,o)}gs(t,e,r);break;case 21:gs(t,e,r);break;case 22:r.mode&1?(Mr=(n=Mr)||r.memoizedState!==null,gs(t,e,r),Mr=n):gs(t,e,r);break;default:gs(t,e,r)}}function Z_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new H4),e.forEach(function(n){var i=Z4.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function qn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:xr=o.stateNode,Jn=!1;break e;case 3:xr=o.stateNode.containerInfo,Jn=!0;break e;case 4:xr=o.stateNode.containerInfo,Jn=!0;break e}o=o.return}if(xr===null)throw Error(me(160));N2(s,a,i),xr=null,Jn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Bt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)D2(e,t),e=e.sibling}function D2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qn(e,t),fi(t),n&4){try{mc(3,t,t.return),E0(3,t)}catch(m){Bt(t,t.return,m)}try{mc(5,t,t.return)}catch(m){Bt(t,t.return,m)}}break;case 1:qn(e,t),fi(t),n&512&&r!==null&&Do(r,r.return);break;case 5:if(qn(e,t),fi(t),n&512&&r!==null&&Do(r,r.return),t.flags&32){var i=t.stateNode;try{Nc(i,"")}catch(m){Bt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&tE(i,s),Ep(o,a);var c=Ep(o,s);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?aE(i,h):f==="dangerouslySetInnerHTML"?iE(i,h):f==="children"?Nc(i,h):Gm(i,f,h,c)}switch(o){case"input":vp(i,s);break;case"textarea":rE(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Vo(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?Vo(i,!!s.multiple,s.defaultValue,!0):Vo(i,!!s.multiple,s.multiple?[]:"",!1))}i[jc]=s}catch(m){Bt(t,t.return,m)}}break;case 6:if(qn(e,t),fi(t),n&4){if(t.stateNode===null)throw Error(me(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Bt(t,t.return,m)}}break;case 3:if(qn(e,t),fi(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Lc(e.containerInfo)}catch(m){Bt(t,t.return,m)}break;case 4:qn(e,t),fi(t);break;case 13:qn(e,t),fi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Sg=Gt())),n&4&&Z_(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Mr=(c=Mr)||f,qn(e,t),Mr=c):qn(e,t),fi(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(Ce=t,f=t.child;f!==null;){for(h=Ce=f;Ce!==null;){switch(d=Ce,p=d.child,d.tag){case 0:case 11:case 14:case 15:mc(4,d,d.return);break;case 1:Do(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){Bt(n,r,m)}}break;case 5:Do(d,d.return);break;case 22:if(d.memoizedState!==null){tx(h);continue}}p!==null?(p.return=d,Ce=p):tx(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=sE("display",a))}catch(m){Bt(t,t.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Bt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:qn(e,t),fi(t),n&4&&Z_(t);break;case 21:break;default:qn(e,t),fi(t)}}function fi(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(F2(r)){var n=r;break e}r=r.return}throw Error(me(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Nc(i,""),n.flags&=-33);var s=J_(t);Jp(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=J_(t);Qp(t,o,a);break;default:throw Error(me(161))}}catch(l){Bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function $4(t,e,r){Ce=t,O2(t)}function O2(t,e,r){for(var n=(t.mode&1)!==0;Ce!==null;){var i=Ce,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Tf;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Mr;o=Tf;var c=Mr;if(Tf=a,(Mr=l)&&!c)for(Ce=i;Ce!==null;)a=Ce,l=a.child,a.tag===22&&a.memoizedState!==null?rx(i):l!==null?(l.return=a,Ce=l):rx(i);for(;s!==null;)Ce=s,O2(s),s=s.sibling;Ce=i,Tf=o,Mr=c}ex(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ce=s):ex(t)}}function ex(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mr||E0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Mr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Qn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&V_(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}V_(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Lc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Mr||e.flags&512&&Yp(e)}catch(d){Bt(e,e.return,d)}}if(e===t){Ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function tx(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function rx(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{E0(4,e)}catch(l){Bt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Bt(e,i,l)}}var s=e.return;try{Yp(e)}catch(l){Bt(e,s,l)}break;case 5:var a=e.return;try{Yp(e)}catch(l){Bt(e,a,l)}}}catch(l){Bt(e,e.return,l)}if(e===t){Ce=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ce=o;break}Ce=e.return}}var G4=Math.ceil,Rh=as.ReactCurrentDispatcher,Tg=as.ReactCurrentOwner,Wn=as.ReactCurrentBatchConfig,et=0,pr=null,er=null,kr=0,vn=0,Oo=ea(0),ir=0,Kc=null,ba=0,T0=0,kg=0,gc=null,an=null,Sg=0,il=1/0,Li=null,Ph=!1,Zp=null,Ms=null,kf=!1,Cs=null,Fh=0,vc=0,em=null,Jf=-1,Zf=0;function Qr(){return et&6?Gt():Jf!==-1?Jf:Jf=Gt()}function Vs(t){return t.mode&1?et&2&&kr!==0?kr&-kr:R4.transition!==null?(Zf===0&&(Zf=_E()),Zf):(t=ft,t!==0||(t=window.event,t=t===void 0?16:SE(t.type)),t):1}function ni(t,e,r,n){if(50<vc)throw vc=0,em=null,Error(me(185));vu(t,r,n),(!(et&2)||t!==pr)&&(t===pr&&(!(et&2)&&(T0|=r),ir===4&&Es(t,kr)),fn(t,n),r===1&&et===0&&!(e.mode&1)&&(il=Gt()+500,x0&&ta()))}function fn(t,e){var r=t.callbackNode;RC(t,e);var n=ph(t,t===pr?kr:0);if(n===0)r!==null&&f_(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&f_(r),e===1)t.tag===0?C4(nx.bind(null,t)):zE(nx.bind(null,t)),k4(function(){!(et&6)&&ta()}),r=null;else{switch(xE(n)){case 1:r=Qm;break;case 4:r=gE;break;case 16:r=dh;break;case 536870912:r=vE;break;default:r=dh}r=W2(r,b2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function b2(t,e){if(Jf=-1,Zf=0,et&6)throw Error(me(327));var r=t.callbackNode;if(Ho()&&t.callbackNode!==r)return null;var n=ph(t,t===pr?kr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Nh(t,n);else{e=n;var i=et;et|=2;var s=M2();(pr!==t||kr!==e)&&(Li=null,il=Gt()+500,ka(t,e));do try{q4();break}catch(o){L2(t,o)}while(!0);ug(),Rh.current=s,et=i,er!==null?e=0:(pr=null,kr=0,e=ir)}if(e!==0){if(e===2&&(i=Ip(t),i!==0&&(n=i,e=tm(t,i))),e===1)throw r=Kc,ka(t,0),Es(t,n),fn(t,Gt()),r;if(e===6)Es(t,n);else{if(i=t.current.alternate,!(n&30)&&!K4(i)&&(e=Nh(t,n),e===2&&(s=Ip(t),s!==0&&(n=s,e=tm(t,s))),e===1))throw r=Kc,ka(t,0),Es(t,n),fn(t,Gt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(me(345));case 2:ma(t,an,Li);break;case 3:if(Es(t,n),(n&130023424)===n&&(e=Sg+500-Gt(),10<e)){if(ph(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Qr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bp(ma.bind(null,t,an,Li),e);break}ma(t,an,Li);break;case 4:if(Es(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ri(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Gt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*G4(n/1960))-n,10<n){t.timeoutHandle=bp(ma.bind(null,t,an,Li),n);break}ma(t,an,Li);break;case 5:ma(t,an,Li);break;default:throw Error(me(329))}}}return fn(t,Gt()),t.callbackNode===r?b2.bind(null,t):null}function tm(t,e){var r=gc;return t.current.memoizedState.isDehydrated&&(ka(t,e).flags|=256),t=Nh(t,e),t!==2&&(e=an,an=r,e!==null&&rm(e)),t}function rm(t){an===null?an=t:an.push.apply(an,t)}function K4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ai(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Es(t,e){for(e&=~kg,e&=~T0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ri(e),n=1<<r;t[r]=-1,e&=~n}}function nx(t){if(et&6)throw Error(me(327));Ho();var e=ph(t,0);if(!(e&1))return fn(t,Gt()),null;var r=Nh(t,e);if(t.tag!==0&&r===2){var n=Ip(t);n!==0&&(e=n,r=tm(t,n))}if(r===1)throw r=Kc,ka(t,0),Es(t,e),fn(t,Gt()),r;if(r===6)throw Error(me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ma(t,an,Li),fn(t,Gt()),null}function Ag(t,e){var r=et;et|=1;try{return t(e)}finally{et=r,et===0&&(il=Gt()+500,x0&&ta())}}function La(t){Cs!==null&&Cs.tag===0&&!(et&6)&&Ho();var e=et;et|=1;var r=Wn.transition,n=ft;try{if(Wn.transition=null,ft=1,t)return t()}finally{ft=n,Wn.transition=r,et=e,!(et&6)&&ta()}}function Ig(){vn=Oo.current,Tt(Oo)}function ka(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,T4(r)),er!==null)for(r=er.return;r!==null;){var n=r;switch(og(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&xh();break;case 3:rl(),Tt(cn),Tt(Hr),gg();break;case 5:mg(n);break;case 4:rl();break;case 13:Tt(Pt);break;case 19:Tt(Pt);break;case 10:fg(n.type._context);break;case 22:case 23:Ig()}r=r.return}if(pr=t,er=t=Bs(t.current,null),kr=vn=e,ir=0,Kc=null,kg=T0=ba=0,an=gc=null,ya!==null){for(e=0;e<ya.length;e++)if(r=ya[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ya=null}return t}function L2(t,e){do{var r=er;try{if(ug(),qf.current=Ch,Ih){for(var n=Dt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ih=!1}if(Oa=0,ur=rr=Dt=null,pc=!1,zc=0,Tg.current=null,r===null||r.return===null){ir=1,Kc=e,er=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=kr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=z_(a);if(p!==null){p.flags&=-257,$_(p,a,o,s,e),p.mode&1&&H_(s,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){H_(s,c,e),Cg();break e}l=Error(me(426))}}else if(It&&o.mode&1){var _=z_(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),$_(_,a,o,s,e),lg(nl(l,o));break e}}s=l=nl(l,o),ir!==4&&(ir=2),gc===null?gc=[s]:gc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=x2(s,l,e);M_(s,w);break e;case 1:o=l;var E=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ms===null||!Ms.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=y2(s,o,e);M_(s,P);break e}}s=s.return}while(s!==null)}B2(r)}catch(W){e=W,er===r&&r!==null&&(er=r=r.return);continue}break}while(!0)}function M2(){var t=Rh.current;return Rh.current=Ch,t===null?Ch:t}function Cg(){(ir===0||ir===3||ir===2)&&(ir=4),pr===null||!(ba&268435455)&&!(T0&268435455)||Es(pr,kr)}function Nh(t,e){var r=et;et|=2;var n=M2();(pr!==t||kr!==e)&&(Li=null,ka(t,e));do try{X4();break}catch(i){L2(t,i)}while(!0);if(ug(),et=r,Rh.current=n,er!==null)throw Error(me(261));return pr=null,kr=0,ir}function X4(){for(;er!==null;)V2(er)}function q4(){for(;er!==null&&!yC();)V2(er)}function V2(t){var e=j2(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?B2(t):er=e,Tg.current=null}function B2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=W4(r,e),r!==null){r.flags&=32767,er=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ir=6,er=null;return}}else if(r=j4(r,e,vn),r!==null){er=r;return}if(e=e.sibling,e!==null){er=e;return}er=e=t}while(e!==null);ir===0&&(ir=5)}function ma(t,e,r){var n=ft,i=Wn.transition;try{Wn.transition=null,ft=1,Y4(t,e,r,n)}finally{Wn.transition=i,ft=n}return null}function Y4(t,e,r,n){do Ho();while(Cs!==null);if(et&6)throw Error(me(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(me(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(PC(t,s),t===pr&&(er=pr=null,kr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||kf||(kf=!0,W2(dh,function(){return Ho(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Wn.transition,Wn.transition=null;var a=ft;ft=1;var o=et;et|=4,Tg.current=null,z4(t,r),D2(r,t),g4(Dp),mh=!!Np,Dp=Np=null,t.current=r,$4(r),wC(),et=o,ft=a,Wn.transition=s}else t.current=r;if(kf&&(kf=!1,Cs=t,Fh=i),s=t.pendingLanes,s===0&&(Ms=null),kC(r.stateNode),fn(t,Gt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ph)throw Ph=!1,t=Zp,Zp=null,t;return Fh&1&&t.tag!==0&&Ho(),s=t.pendingLanes,s&1?t===em?vc++:(vc=0,em=t):vc=0,ta(),null}function Ho(){if(Cs!==null){var t=xE(Fh),e=Wn.transition,r=ft;try{if(Wn.transition=null,ft=16>t?16:t,Cs===null)var n=!1;else{if(t=Cs,Cs=null,Fh=0,et&6)throw Error(me(331));var i=et;for(et|=4,Ce=t.current;Ce!==null;){var s=Ce,a=s.child;if(Ce.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var f=Ce;switch(f.tag){case 0:case 11:case 15:mc(8,f,s)}var h=f.child;if(h!==null)h.return=f,Ce=h;else for(;Ce!==null;){f=Ce;var d=f.sibling,p=f.return;if(P2(f),f===c){Ce=null;break}if(d!==null){d.return=p,Ce=d;break}Ce=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}Ce=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ce=a;else e:for(;Ce!==null;){if(s=Ce,s.flags&2048)switch(s.tag){case 0:case 11:case 15:mc(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Ce=w;break e}Ce=s.return}}var E=t.current;for(Ce=E;Ce!==null;){a=Ce;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,Ce=x;else e:for(a=E;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:E0(9,o)}}catch(W){Bt(o,o.return,W)}if(o===a){Ce=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,Ce=P;break e}Ce=o.return}}if(et=i,ta(),yi&&typeof yi.onPostCommitFiberRoot=="function")try{yi.onPostCommitFiberRoot(p0,t)}catch{}n=!0}return n}finally{ft=r,Wn.transition=e}}return!1}function ix(t,e,r){e=nl(r,e),e=x2(t,e,1),t=Ls(t,e,1),e=Qr(),t!==null&&(vu(t,1,e),fn(t,e))}function Bt(t,e,r){if(t.tag===3)ix(t,t,r);else for(;e!==null;){if(e.tag===3){ix(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ms===null||!Ms.has(n))){t=nl(r,t),t=y2(e,t,1),e=Ls(e,t,1),t=Qr(),e!==null&&(vu(e,1,t),fn(e,t));break}}e=e.return}}function Q4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Qr(),t.pingedLanes|=t.suspendedLanes&r,pr===t&&(kr&r)===r&&(ir===4||ir===3&&(kr&130023424)===kr&&500>Gt()-Sg?ka(t,0):kg|=r),fn(t,e)}function U2(t,e){e===0&&(t.mode&1?(e=pf,pf<<=1,!(pf&130023424)&&(pf=4194304)):e=1);var r=Qr();t=Zi(t,e),t!==null&&(vu(t,e,r),fn(t,r))}function J4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),U2(t,r)}function Z4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(me(314))}n!==null&&n.delete(e),U2(t,r)}var j2;j2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)ln=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ln=!1,U4(t,e,r);ln=!!(t.flags&131072)}else ln=!1,It&&e.flags&1048576&&$E(e,Eh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Qf(t,e),t=e.pendingProps;var i=Zo(e,Hr.current);Wo(e,r),i=_g(null,e,n,t,i,r);var s=xg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(n)?(s=!0,yh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,dg(e),i.updater=w0,e.stateNode=i,i._reactInternals=e,Wp(e,n,t,r),e=$p(null,e,n,!0,s,r)):(e.tag=0,It&&s&&ag(e),Xr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Qf(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=tR(n),t=Qn(n,t),i){case 0:e=zp(null,e,n,t,r);break e;case 1:e=X_(null,e,n,t,r);break e;case 11:e=G_(null,e,n,t,r);break e;case 14:e=K_(null,e,n,Qn(n.type,t),r);break e}throw Error(me(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),zp(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),X_(t,e,n,i,r);case 3:e:{if(k2(e),t===null)throw Error(me(387));n=e.pendingProps,s=e.memoizedState,i=s.element,QE(t,e),Sh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=nl(Error(me(423)),e),e=q_(t,e,n,r,i);break e}else if(n!==i){i=nl(Error(me(424)),e),e=q_(t,e,n,r,i);break e}else for(En=bs(e.stateNode.containerInfo.firstChild),kn=e,It=!0,Zn=null,r=qE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(el(),n===i){e=es(t,e,r);break e}Xr(t,e,n,r)}e=e.child}return e;case 5:return JE(e),t===null&&Bp(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Op(n,i)?a=null:s!==null&&Op(n,s)&&(e.flags|=32),T2(t,e),Xr(t,e,a,r),e.child;case 6:return t===null&&Bp(e),null;case 13:return S2(t,e,r);case 4:return pg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=tl(e,null,n,r):Xr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),G_(t,e,n,i,r);case 7:return Xr(t,e,e.pendingProps,r),e.child;case 8:return Xr(t,e,e.pendingProps.children,r),e.child;case 12:return Xr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,vt(Th,n._currentValue),n._currentValue=a,s!==null)if(ai(s.value,a)){if(s.children===i.children&&!cn.current){e=es(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=$i(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Up(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(me(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Up(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Xr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Wo(e,r),i=zn(i),n=n(i),e.flags|=1,Xr(t,e,n,r),e.child;case 14:return n=e.type,i=Qn(n,e.pendingProps),i=Qn(n.type,i),K_(t,e,n,i,r);case 15:return w2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),Qf(t,e),e.tag=1,un(n)?(t=!0,yh(e)):t=!1,Wo(e,r),_2(e,n,i),Wp(e,n,i,r),$p(null,e,n,!0,t,r);case 19:return A2(t,e,r);case 22:return E2(t,e,r)}throw Error(me(156,e.tag))};function W2(t,e){return mE(t,e)}function eR(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(t,e,r,n){return new eR(t,e,r,n)}function Rg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tR(t){if(typeof t=="function")return Rg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xm)return 11;if(t===qm)return 14}return 2}function Bs(t,e){var r=t.alternate;return r===null?(r=jn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function eh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")Rg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ko:return Sa(r.children,i,s,e);case Km:a=8,i|=8;break;case hp:return t=jn(12,r,e,i|2),t.elementType=hp,t.lanes=s,t;case dp:return t=jn(13,r,e,i),t.elementType=dp,t.lanes=s,t;case pp:return t=jn(19,r,e,i),t.elementType=pp,t.lanes=s,t;case Jw:return k0(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Yw:a=10;break e;case Qw:a=9;break e;case Xm:a=11;break e;case qm:a=14;break e;case xs:a=16,n=null;break e}throw Error(me(130,t==null?t:typeof t,""))}return e=jn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Sa(t,e,r,n){return t=jn(7,t,n,e),t.lanes=r,t}function k0(t,e,r,n){return t=jn(22,t,n,e),t.elementType=Jw,t.lanes=r,t.stateNode={isHidden:!1},t}function Md(t,e,r){return t=jn(6,t,null,e),t.lanes=r,t}function Vd(t,e,r){return e=jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function rR(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_d(0),this.expirationTimes=_d(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_d(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pg(t,e,r,n,i,s,a,o,l){return t=new rR(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=jn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dg(s),t}function nR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function H2(t){if(!t)return $s;t=t._reactInternals;e:{if(Ya(t)!==t||t.tag!==1)throw Error(me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(me(171))}if(t.tag===1){var r=t.type;if(un(r))return HE(t,r,e)}return e}function z2(t,e,r,n,i,s,a,o,l){return t=Pg(r,n,!0,t,i,s,a,o,l),t.context=H2(null),r=t.current,n=Qr(),i=Vs(r),s=$i(n,i),s.callback=e??null,Ls(r,s,i),t.current.lanes=i,vu(t,i,n),fn(t,n),t}function S0(t,e,r,n){var i=e.current,s=Qr(),a=Vs(i);return r=H2(r),e.context===null?e.context=r:e.pendingContext=r,e=$i(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ls(i,e,a),t!==null&&(ni(t,i,a,s),Xf(t,i,a)),a}function Dh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Fg(t,e){sx(t,e),(t=t.alternate)&&sx(t,e)}function iR(){return null}var $2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ng(t){this._internalRoot=t}A0.prototype.render=Ng.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(me(409));S0(t,e,null,null)};A0.prototype.unmount=Ng.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;La(function(){S0(null,t,null,null)}),e[Ji]=null}};function A0(t){this._internalRoot=t}A0.prototype.unstable_scheduleHydration=function(t){if(t){var e=EE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ws.length&&e!==0&&e<ws[r].priority;r++);ws.splice(r,0,t),r===0&&kE(t)}};function Dg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function I0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ax(){}function sR(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Dh(a);s.call(c)}}var a=z2(e,n,t,0,null,!1,!1,"",ax);return t._reactRootContainer=a,t[Ji]=a.current,Bc(t.nodeType===8?t.parentNode:t),La(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Dh(l);o.call(c)}}var l=Pg(t,0,!1,null,null,!1,!1,"",ax);return t._reactRootContainer=l,t[Ji]=l.current,Bc(t.nodeType===8?t.parentNode:t),La(function(){S0(e,l,r,n)}),l}function C0(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Dh(a);o.call(l)}}S0(e,a,t,i)}else a=sR(r,e,t,i,n);return Dh(a)}yE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ql(e.pendingLanes);r!==0&&(Jm(e,r|1),fn(e,Gt()),!(et&6)&&(il=Gt()+500,ta()))}break;case 13:La(function(){var n=Zi(t,1);if(n!==null){var i=Qr();ni(n,t,1,i)}}),Fg(t,1)}};Zm=function(t){if(t.tag===13){var e=Zi(t,134217728);if(e!==null){var r=Qr();ni(e,t,134217728,r)}Fg(t,134217728)}};wE=function(t){if(t.tag===13){var e=Vs(t),r=Zi(t,e);if(r!==null){var n=Qr();ni(r,t,e,n)}Fg(t,e)}};EE=function(){return ft};TE=function(t,e){var r=ft;try{return ft=t,e()}finally{ft=r}};kp=function(t,e,r){switch(e){case"input":if(vp(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=_0(n);if(!i)throw Error(me(90));eE(n),vp(n,i)}}}break;case"textarea":rE(t,r);break;case"select":e=r.value,e!=null&&Vo(t,!!r.multiple,e,!1)}};cE=Ag;uE=La;var aR={usingClientEntryPoint:!1,Events:[xu,Co,_0,oE,lE,Ag]},Gl={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oR={bundleType:Gl.bundleType,version:Gl.version,rendererPackageName:Gl.rendererPackageName,rendererConfig:Gl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:as.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=dE(t),t===null?null:t.stateNode},findFiberByHostInstance:Gl.findFiberByHostInstance||iR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sf.isDisabled&&Sf.supportsFiber)try{p0=Sf.inject(oR),yi=Sf}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aR;In.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dg(e))throw Error(me(200));return nR(t,e,null,r)};In.createRoot=function(t,e){if(!Dg(t))throw Error(me(299));var r=!1,n="",i=$2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pg(t,1,!1,null,null,r,!1,n,i),t[Ji]=e.current,Bc(t.nodeType===8?t.parentNode:t),new Ng(e)};In.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(me(188)):(t=Object.keys(t).join(","),Error(me(268,t)));return t=dE(e),t=t===null?null:t.stateNode,t};In.flushSync=function(t){return La(t)};In.hydrate=function(t,e,r){if(!I0(e))throw Error(me(200));return C0(null,t,e,!0,r)};In.hydrateRoot=function(t,e,r){if(!Dg(t))throw Error(me(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=$2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=z2(e,null,t,1,r??null,i,!1,s,a),t[Ji]=e.current,Bc(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new A0(e)};In.render=function(t,e,r){if(!I0(e))throw Error(me(200));return C0(null,t,e,!1,r)};In.unmountComponentAtNode=function(t){if(!I0(t))throw Error(me(40));return t._reactRootContainer?(La(function(){C0(null,null,t,!1,function(){t._reactRootContainer=null,t[Ji]=null})}),!0):!1};In.unstable_batchedUpdates=Ag;In.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!I0(r))throw Error(me(200));if(t==null||t._reactInternals===void 0)throw Error(me(38));return C0(t,e,r,!1,n)};In.version="18.3.1-next-f1338f8080-20240426";function G2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(G2)}catch(t){console.error(t)}}G2(),Gw.exports=In;var lR=Gw.exports,K2,ox=lR;K2=ox.createRoot,ox.hydrateRoot;var lx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},cR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},q2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),n.push(r[f],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(X2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):cR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new uR;const d=s<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const g=c<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fR=function(t){const e=X2(t);return q2.encodeByteArray(e,!0)},Oh=function(t){return fR(t).replace(/\./g,"")},Y2=function(t){try{return q2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR=()=>hR().__FIREBASE_DEFAULTS__,pR=()=>{if(typeof process>"u"||typeof lx>"u")return;const t=lx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Y2(t[1]);return e&&JSON.parse(e)},R0=()=>{try{return dR()||pR()||mR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Q2=t=>{var e,r;return(r=(e=R0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},gR=t=>{const e=Q2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},J2=()=>{var t;return(t=R0())===null||t===void 0?void 0:t.config},Z2=t=>{var e;return(e=R0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Oh(JSON.stringify(r)),Oh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zr())}function yR(){var t;const e=(t=R0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ER(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function TR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kR(){const t=zr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function SR(){return!yR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AR(){try{return typeof indexedDB=="object"}catch{return!1}}function IR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR="FirebaseError";class os extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=CR,Object.setPrototypeOf(this,os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wu.prototype.create)}}class wu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?RR(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new os(i,o,n)}}function RR(t,e){return t.replace(PR,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const PR=/\{\$([^}]+)}/g;function FR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(cx(s)&&cx(a)){if(!bh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function cx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Zl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ec(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function NR(t,e){const r=new DR(t,e);return r.subscribe.bind(r)}class DR{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");OR(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Bd),i.error===void 0&&(i.error=Bd),i.complete===void 0&&(i.complete=Bd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function OR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Bd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t){return t&&t._delegate?t._delegate:t}class Ma{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new vR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(MR(e))try{this.getOrInitializeService({instanceIdentifier:ga})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=ga){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ga){return this.instances.has(e)}getOptions(e=ga){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:LR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ga){return this.component?this.component.multipleInstances?e:ga:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LR(t){return t===ga?void 0:t}function MR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new bR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const BR={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},UR=Je.INFO,jR={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},WR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=jR[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Og{constructor(e){this.name=e,this._logLevel=UR,this._logHandler=WR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?BR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const HR=(t,e)=>e.some(r=>t instanceof r);let ux,fx;function zR(){return ux||(ux=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $R(){return fx||(fx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eT=new WeakMap,nm=new WeakMap,tT=new WeakMap,Ud=new WeakMap,bg=new WeakMap;function GR(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Us(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&eT.set(r,t)}).catch(()=>{}),bg.set(e,t),e}function KR(t){if(nm.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});nm.set(t,e)}let im={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return nm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||tT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Us(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function XR(t){im=t(im)}function qR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(jd(this),e,...r);return tT.set(n,e.sort?e.sort():[e]),Us(n)}:$R().includes(t)?function(...e){return t.apply(jd(this),e),Us(eT.get(this))}:function(...e){return Us(t.apply(jd(this),e))}}function YR(t){return typeof t=="function"?qR(t):(t instanceof IDBTransaction&&KR(t),HR(t,zR())?new Proxy(t,im):t)}function Us(t){if(t instanceof IDBRequest)return GR(t);if(Ud.has(t))return Ud.get(t);const e=YR(t);return e!==t&&(Ud.set(t,e),bg.set(e,t)),e}const jd=t=>bg.get(t);function QR(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Us(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Us(a.result),l.oldVersion,l.newVersion,Us(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const JR=["get","getKey","getAll","getAllKeys","count"],ZR=["put","add","delete","clear"],Wd=new Map;function hx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wd.get(e))return Wd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=ZR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||JR.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Wd.set(e,s),s}XR(t=>({...t,get:(e,r,n)=>hx(e,r)||t.get(e,r,n),has:(e,r)=>!!hx(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(tP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function tP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sm="@firebase/app",dx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=new Og("@firebase/app"),rP="@firebase/app-compat",nP="@firebase/analytics-compat",iP="@firebase/analytics",sP="@firebase/app-check-compat",aP="@firebase/app-check",oP="@firebase/auth",lP="@firebase/auth-compat",cP="@firebase/database",uP="@firebase/data-connect",fP="@firebase/database-compat",hP="@firebase/functions",dP="@firebase/functions-compat",pP="@firebase/installations",mP="@firebase/installations-compat",gP="@firebase/messaging",vP="@firebase/messaging-compat",_P="@firebase/performance",xP="@firebase/performance-compat",yP="@firebase/remote-config",wP="@firebase/remote-config-compat",EP="@firebase/storage",TP="@firebase/storage-compat",kP="@firebase/firestore",SP="@firebase/vertexai-preview",AP="@firebase/firestore-compat",IP="firebase",CP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am="[DEFAULT]",RP={[sm]:"fire-core",[rP]:"fire-core-compat",[iP]:"fire-analytics",[nP]:"fire-analytics-compat",[aP]:"fire-app-check",[sP]:"fire-app-check-compat",[oP]:"fire-auth",[lP]:"fire-auth-compat",[cP]:"fire-rtdb",[uP]:"fire-data-connect",[fP]:"fire-rtdb-compat",[hP]:"fire-fn",[dP]:"fire-fn-compat",[pP]:"fire-iid",[mP]:"fire-iid-compat",[gP]:"fire-fcm",[vP]:"fire-fcm-compat",[_P]:"fire-perf",[xP]:"fire-perf-compat",[yP]:"fire-rc",[wP]:"fire-rc-compat",[EP]:"fire-gcs",[TP]:"fire-gcs-compat",[kP]:"fire-fst",[AP]:"fire-fst-compat",[SP]:"fire-vertex","fire-js":"fire-js",[IP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=new Map,om=new Map,lm=new Map;function px(t,e){try{t.container.addComponent(e)}catch(r){ts.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function al(t){const e=t.name;if(lm.has(e))return ts.debug(`There were multiple attempts to register component ${e}.`),!1;lm.set(e,t);for(const r of sl.values())px(r,t);for(const r of om.values())px(r,t);return!0}function Lg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _i(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},js=new wu("app","Firebase",PP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ma("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw js.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=CP;function Mg(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:am,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw js.create("bad-app-name",{appName:String(i)});if(r||(r=J2()),!r)throw js.create("no-options");const s=sl.get(i);if(s){if(bh(r,s.options)&&bh(n,s.config))return s;throw js.create("duplicate-app",{appName:i})}const a=new VR(i);for(const l of lm.values())a.addComponent(l);const o=new FP(r,n,a);return sl.set(i,o),o}function Vg(t=am){const e=sl.get(t);if(!e&&t===am&&J2())return Mg();if(!e)throw js.create("no-app",{appName:t});return e}async function NP(t){let e=!1;const r=t.name;sl.has(r)?(e=!0,sl.delete(r)):om.has(r)&&t.decRefCount()<=0&&(om.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Ws(t,e,r){var n;let i=(n=RP[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ts.warn(o.join(" "));return}al(new Ma(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP="firebase-heartbeat-database",OP=1,Xc="firebase-heartbeat-store";let Hd=null;function rT(){return Hd||(Hd=QR(DP,OP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xc)}catch(r){console.warn(r)}}}}).catch(t=>{throw js.create("idb-open",{originalErrorMessage:t.message})})),Hd}async function bP(t){try{const r=(await rT()).transaction(Xc),n=await r.objectStore(Xc).get(nT(t));return await r.done,n}catch(e){if(e instanceof os)ts.warn(e.message);else{const r=js.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ts.warn(r.message)}}}async function mx(t,e){try{const n=(await rT()).transaction(Xc,"readwrite");await n.objectStore(Xc).put(e,nT(t)),await n.done}catch(r){if(r instanceof os)ts.warn(r.message);else{const n=js.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ts.warn(n.message)}}}function nT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP=1024,MP=30*24*60*60*1e3;class VP{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new UP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=MP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ts.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=gx(),{heartbeatsToSend:n,unsentEntries:i}=BP(this._heartbeatsCache.heartbeats),s=Oh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ts.warn(r),""}}}function gx(){return new Date().toISOString().substring(0,10)}function BP(t,e=LP){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),vx(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),vx(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class UP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AR()?IR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await bP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return mx(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return mx(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function vx(t){return Oh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jP(t){al(new Ma("platform-logger",e=>new eP(e),"PRIVATE")),al(new Ma("heartbeat",e=>new VP(e),"PRIVATE")),Ws(sm,dx,t),Ws(sm,dx,"esm2017"),Ws("fire-js","")}jP("");var WP="firebase",HP="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ws(WP,HP,"app");function Bg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function iT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zP=iT,sT=new wu("auth","Firebase",iT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh=new Og("@firebase/auth");function $P(t,...e){Lh.logLevel<=Je.WARN&&Lh.warn(`Auth (${wl}): ${t}`,...e)}function th(t,...e){Lh.logLevel<=Je.ERROR&&Lh.error(`Auth (${wl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t,...e){throw Ug(t,...e)}function Ei(t,...e){return Ug(t,...e)}function aT(t,e,r){const n=Object.assign(Object.assign({},zP()),{[e]:r});return new wu("auth","Firebase",n).create(e,{appName:t.name})}function Gi(t){return aT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ug(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return sT.create(t,...e)}function Me(t,e,...r){if(!t)throw Ug(e,...r)}function Ui(t){const e="INTERNAL ASSERTION FAILED: "+t;throw th(e),new Error(e)}function rs(t,e){t||Ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function GP(){return _x()==="http:"||_x()==="https:"}function _x(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GP()||ER()||"connection"in navigator)?navigator.onLine:!0}function XP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,r){this.shortDelay=e,this.longDelay=r,rs(r>e,"Short delay should be less than long delay!"),this.isMobile=xR()||TR()}get(){return KP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(t,e){rs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP=new Tu(3e4,6e4);function ls(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ci(t,e,r,n,i={}){return lT(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Eu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return wR()||(c.referrerPolicy="no-referrer"),oT.fetch()(cT(t,t.config.apiHost,r,o),c)})}async function lT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},qP),e);try{const i=new JP(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Af(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Af(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Af(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Af(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw aT(t,f,c);oi(t,f)}}catch(i){if(i instanceof os)throw i;oi(t,"network-request-failed",{message:String(i)})}}async function ku(t,e,r,n,i={}){const s=await Ci(t,e,r,n,i);return"mfaPendingCredential"in s&&oi(t,"multi-factor-auth-required",{_serverResponse:s}),s}function cT(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?jg(t.config,i):`${t.config.apiScheme}://${i}`}function QP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class JP{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ei(this.auth,"network-request-failed")),YP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Af(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Ei(t,e,n);return i.customData._tokenResponse=r,i}function xx(t){return t!==void 0&&t.enterprise!==void 0}class ZP{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return QP(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function eF(t,e){return Ci(t,"GET","/v2/recaptchaConfig",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tF(t,e){return Ci(t,"POST","/v1/accounts:delete",e)}async function uT(t,e){return Ci(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rF(t,e=!1){const r=bt(t),n=await r.getIdToken(e),i=Wg(n);Me(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:_c(zd(i.auth_time)),issuedAtTime:_c(zd(i.iat)),expirationTime:_c(zd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function zd(t){return Number(t)*1e3}function Wg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return th("JWT malformed, contained fewer than 3 sections"),null;try{const i=Y2(r);return i?JSON.parse(i):(th("Failed to decode base64 JWT payload"),null)}catch(i){return th("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function yx(t){const e=Wg(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ol(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof os&&nF(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function nF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=_c(this.lastLoginAt),this.creationTime=_c(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mh(t){var e;const r=t.auth,n=await t.getIdToken(),i=await ol(t,uT(r,{idToken:n}));Me(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?fT(s.providerUserInfo):[],o=aF(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new um(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,h)}async function sF(t){const e=bt(t);await Mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aF(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function fT(t){return t.map(e=>{var{providerId:r}=e,n=Bg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oF(t,e){const r=await lT(t,{},async()=>{const n=Eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=cT(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",oT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function lF(t,e){return Ci(t,"POST","/v2/accounts:revokeToken",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const r=yx(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await oF(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new zo;return n&&(Me(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(Me(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Me(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zo,this.toJSON())}_performRefresh(){return Ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ji{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Bg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new iF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new um(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await ol(this,this.stsTokenManager.getToken(this.auth,e));return Me(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return rF(this,e)}reload(){return sF(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ji(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Mh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_i(this.auth.app))return Promise.reject(Gi(this.auth));const e=await this.getIdToken();return await ol(this,tF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,f;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,g=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,w=(c=r.createdAt)!==null&&c!==void 0?c:void 0,E=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:x,emailVerified:P,isAnonymous:W,providerData:M,stsTokenManager:y}=r;Me(x&&y,e,"internal-error");const k=zo.fromJSON(this.name,y);Me(typeof x=="string",e,"internal-error"),vs(h,e.name),vs(d,e.name),Me(typeof P=="boolean",e,"internal-error"),Me(typeof W=="boolean",e,"internal-error"),vs(p,e.name),vs(g,e.name),vs(m,e.name),vs(_,e.name),vs(w,e.name),vs(E,e.name);const S=new ji({uid:x,auth:e,email:d,emailVerified:P,displayName:h,isAnonymous:W,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:k,createdAt:w,lastLoginAt:E});return M&&Array.isArray(M)&&(S.providerData=M.map(I=>Object.assign({},I))),_&&(S._redirectEventId=_),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new zo;i.updateFromServerResponse(r);const s=new ji({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Mh(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Me(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?fT(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new zo;o.updateFromIdToken(n);const l=new ji({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new um(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx=new Map;function Wi(t){rs(t instanceof Function,"Expected a class definition");let e=wx.get(t);return e?(rs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,wx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}hT.type="NONE";const Ex=hT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(t,e,r){return`firebase:${t}:${e}:${r}`}class $o{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=rh(this.userKey,i.apiKey,s),this.fullPersistenceKey=rh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ji._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new $o(Wi(Ex),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Wi(Ex);const a=rh(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(a);if(f){const h=ji._fromJSON(e,f);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new $o(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new $o(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_T(e))return"Blackberry";if(xT(e))return"Webos";if(pT(e))return"Safari";if((e.includes("chrome/")||mT(e))&&!e.includes("edge/"))return"Chrome";if(vT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function dT(t=zr()){return/firefox\//i.test(t)}function pT(t=zr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mT(t=zr()){return/crios\//i.test(t)}function gT(t=zr()){return/iemobile/i.test(t)}function vT(t=zr()){return/android/i.test(t)}function _T(t=zr()){return/blackberry/i.test(t)}function xT(t=zr()){return/webos/i.test(t)}function Hg(t=zr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function cF(t=zr()){var e;return Hg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uF(){return kR()&&document.documentMode===10}function yT(t=zr()){return Hg(t)||vT(t)||xT(t)||_T(t)||/windows phone/i.test(t)||gT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(t,e=[]){let r;switch(t){case"Browser":r=Tx(zr());break;case"Worker":r=`${Tx(zr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${wl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hF(t,e={}){return Ci(t,"GET","/v2/passwordPolicy",ls(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF=6;class pF{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:dF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kx(this),this.idTokenSubscription=new kx(this),this.beforeStateQueue=new fF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Wi(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await $o.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await uT(this,{idToken:e}),n=await ji._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(_i(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Mh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=XP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_i(this.app))return Promise.reject(Gi(this));const r=e?bt(e):null;return r&&Me(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _i(this.app)?Promise.reject(Gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _i(this.app)?Promise.reject(Gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hF(this),r=new pF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new wu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await lF(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Wi(e)||this._popupRedirectResolver;Me(r,this,"argument-error"),this.redirectPersistenceManager=await $o.create(this,[Wi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&$P(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ra(t){return bt(t)}class kx{constructor(e){this.auth=e,this.observer=null,this.addObserver=NR(r=>this.observer=r)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gF(t){P0=t}function ET(t){return P0.loadJS(t)}function vF(){return P0.recaptchaEnterpriseScript}function _F(){return P0.gapiScript}function xF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const yF="recaptcha-enterprise",wF="NO_RECAPTCHA";class EF{constructor(e){this.type=yF,this.auth=ra(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{eF(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new ZP(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;xx(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{a(c)}).catch(()=>{a(wF)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&xx(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=vF();l.length!==0&&(l+=o),ET(l).then(()=>{i(o,s,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function Sx(t,e,r,n=!1){const i=new EF(t);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},e);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Vh(t,e,r,n){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Sx(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Sx(t,e,r,r==="getOobCode");return n(t,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(t,e){const r=Lg(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(bh(s,e??{}))return i;oi(i,"already-initialized")}return r.initialize({options:e})}function kF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Wi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function SF(t,e,r){const n=ra(t);Me(n._canInitEmulator,n,"emulator-config-failed"),Me(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=TT(e),{host:a,port:o}=AF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),IF()}function TT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function AF(t){const e=TT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:Ax(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Ax(a)}}}function Ax(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function IF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ui("not implemented")}_getIdTokenResponse(e){return Ui("not implemented")}_linkToIdToken(e,r){return Ui("not implemented")}_getReauthenticationResolver(e){return Ui("not implemented")}}async function CF(t,e){return Ci(t,"POST","/v1/accounts:update",e)}async function RF(t,e){return Ci(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PF(t,e){return ku(t,"POST","/v1/accounts:signInWithPassword",ls(t,e))}async function FF(t,e){return Ci(t,"POST","/v1/accounts:sendOobCode",ls(t,e))}async function NF(t,e){return FF(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DF(t,e){return ku(t,"POST","/v1/accounts:signInWithEmailLink",ls(t,e))}async function OF(t,e){return ku(t,"POST","/v1/accounts:signInWithEmailLink",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends zg{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new qc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new qc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,r,"signInWithPassword",PF);case"emailLink":return DF(e,{email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,n,"signUpPassword",RF);case"emailLink":return OF(e,{idToken:r,email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t,e){return ku(t,"POST","/v1/accounts:signInWithIdp",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF="http://localhost";class Va extends zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Va(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):oi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Bg(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Va(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Go(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Go(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Go(e,r)}buildRequest(){const e={requestUri:bF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Eu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function MF(t){const e=Zl(ec(t)).link,r=e?Zl(ec(e)).deep_link_id:null,n=Zl(ec(t)).deep_link_id;return(n?Zl(ec(n)).link:null)||n||r||e||t}class $g{constructor(e){var r,n,i,s,a,o;const l=Zl(ec(e)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,f=(n=l.oobCode)!==null&&n!==void 0?n:null,h=LF((i=l.mode)!==null&&i!==void 0?i:null);Me(c&&f&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=f,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const r=MF(e);try{return new $g(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(){this.providerId=Qa.PROVIDER_ID}static credential(e,r){return qc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=$g.parseLink(r);return Me(n,"argument-error"),qc._fromEmailAndCode(e,n.code,n.tenantId)}}Qa.PROVIDER_ID="password";Qa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Qa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su extends kT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Su{constructor(){super("facebook.com")}static credential(e){return Va._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ts.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends Su{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Va._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ks.credential(r,n)}catch{return null}}}ks.GOOGLE_SIGN_IN_METHOD="google.com";ks.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends Su{constructor(){super("github.com")}static credential(e){return Va._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.GITHUB_SIGN_IN_METHOD="github.com";Ss.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Su{constructor(){super("twitter.com")}static credential(e,r){return Va._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return As.credential(r,n)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VF(t,e){return ku(t,"POST","/v1/accounts:signUp",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await ji._fromIdTokenResponse(e,n,i),a=Ix(n);return new Ba({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Ix(n);return new Ba({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Ix(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh extends os{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Bh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Bh(e,r,n,i)}}function ST(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Bh._fromErrorAndOperation(t,s,e,n):s})}async function BF(t,e,r=!1){const n=await ol(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ba._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AT(t,e,r=!1){const{auth:n}=t;if(_i(n.app))return Promise.reject(Gi(n));const i="reauthenticate";try{const s=await ol(t,ST(n,i,e,t),r);Me(s.idToken,n,"internal-error");const a=Wg(s.idToken);Me(a,n,"internal-error");const{sub:o}=a;return Me(t.uid===o,n,"user-mismatch"),Ba._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&oi(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IT(t,e,r=!1){if(_i(t.app))return Promise.reject(Gi(t));const n="signIn",i=await ST(t,n,e),s=await Ba._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}async function UF(t,e){return IT(ra(t),e)}async function jF(t,e){return AT(bt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CT(t){const e=ra(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function WF(t,e,r){const n=ra(t);await Vh(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",NF)}async function HF(t,e,r){if(_i(t.app))return Promise.reject(Gi(t));const n=ra(t),a=await Vh(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",VF).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&CT(t),l}),o=await Ba._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function zF(t,e,r){return _i(t.app)?Promise.reject(Gi(t)):UF(bt(t),Qa.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&CT(t),n})}function $F(t,e){return GF(bt(t),null,e)}async function GF(t,e,r){const{auth:n}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};r&&(s.password=r);const a=await ol(t,CF(n,s));await t._updateTokensIfNecessary(a,!0)}function KF(t,e,r,n){return bt(t).onIdTokenChanged(e,r,n)}function XF(t,e,r){return bt(t).beforeAuthStateChanged(e,r)}function qF(t,e,r,n){return bt(t).onAuthStateChanged(e,r,n)}function fm(t){return bt(t).signOut()}const Uh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF=1e3,QF=10;class PT extends RT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);uF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,QF):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},YF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}PT.type="LOCAL";const JF=PT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT extends RT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}FT.type="SESSION";const NT=FT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new F0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await ZF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}F0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Gg("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(){return window}function tN(t){Ti().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(){return typeof Ti().WorkerGlobalScope<"u"&&typeof Ti().importScripts=="function"}async function rN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function iN(){return DT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="firebaseLocalStorageDb",sN=1,jh="firebaseLocalStorage",bT="fbase_key";class Au{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function N0(t,e){return t.transaction([jh],e?"readwrite":"readonly").objectStore(jh)}function aN(){const t=indexedDB.deleteDatabase(OT);return new Au(t).toPromise()}function hm(){const t=indexedDB.open(OT,sN);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(jh,{keyPath:bT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(jh)?e(n):(n.close(),await aN(),e(await hm()))})})}async function Cx(t,e,r){const n=N0(t,!0).put({[bT]:e,value:r});return new Au(n).toPromise()}async function oN(t,e){const r=N0(t,!1).get(e),n=await new Au(r).toPromise();return n===void 0?null:n.value}function Rx(t,e){const r=N0(t,!0).delete(e);return new Au(r).toPromise()}const lN=800,cN=3;class LT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>cN)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=F0._getInstance(iN()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await rN(),!this.activeServiceWorker)return;this.sender=new eN(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hm();return await Cx(e,Uh,"1"),await Rx(e,Uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Cx(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>oN(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Rx(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=N0(i,!1).getAll();return new Au(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LT.type="LOCAL";const uN=LT;new Tu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fN(t,e){return e?Wi(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg extends zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Go(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Go(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Go(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function hN(t){return IT(t.auth,new Kg(t),t.bypassAuthState)}function dN(t){const{auth:e,user:r}=t;return Me(r,e,"internal-error"),AT(r,new Kg(t),t.bypassAuthState)}async function pN(t){const{auth:e,user:r}=t;return Me(r,e,"internal-error"),BF(r,new Kg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hN;case"linkViaPopup":case"linkViaRedirect":return pN;case"reauthViaPopup":case"reauthViaRedirect":return dN;default:oi(this.auth,"internal-error")}}resolve(e){rs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=new Tu(2e3,1e4);class bo extends MT{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,bo.currentPopupAction&&bo.currentPopupAction.cancel(),bo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){rs(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ei(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ei(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ei(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,mN.get())};e()}}bo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="pendingRedirect",nh=new Map;class vN extends MT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=nh.get(this.auth._key());if(!e){try{const n=await _N(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}nh.set(this.auth._key(),e)}return this.bypassAuthState||nh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _N(t,e){const r=wN(e),n=yN(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function xN(t,e){nh.set(t._key(),e)}function yN(t){return Wi(t._redirectPersistence)}function wN(t){return rh(gN,t.config.apiKey,t.name)}async function EN(t,e,r=!1){if(_i(t.app))return Promise.reject(Gi(t));const n=ra(t),i=fN(n,e),a=await new vN(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=10*60*1e3;class kN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!SN(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!VT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Ei(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=TN&&this.cachedEventUids.clear(),this.cachedEventUids.has(Px(e))}saveEventToCache(e){this.cachedEventUids.add(Px(e)),this.lastProcessedEventTime=Date.now()}}function Px(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function VT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function SN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AN(t,e={}){return Ci(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,CN=/^https?/;async function RN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await AN(t);for(const r of e)try{if(PN(r))return}catch{}oi(t,"unauthorized-domain")}function PN(t){const e=cm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!CN.test(r))return!1;if(IN.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=new Tu(3e4,6e4);function Fx(){const t=Ti().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function NN(t){return new Promise((e,r)=>{var n,i,s;function a(){Fx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fx(),r(Ei(t,"network-request-failed"))},timeout:FN.get()})}if(!((i=(n=Ti().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ti().gapi)===null||s===void 0)&&s.load)a();else{const o=xF("iframefcb");return Ti()[o]=()=>{gapi.load?a():r(Ei(t,"network-request-failed"))},ET(`${_F()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw ih=null,e})}let ih=null;function DN(t){return ih=ih||NN(t),ih}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=new Tu(5e3,15e3),bN="__/auth/iframe",LN="emulator/auth/iframe",MN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},VN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BN(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?jg(e,LN):`https://${t.config.authDomain}/${bN}`,n={apiKey:e.apiKey,appName:t.name,v:wl},i=VN.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Eu(n).slice(1)}`}async function UN(t){const e=await DN(t),r=Ti().gapi;return Me(r,t,"internal-error"),e.open({where:document.body,url:BN(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:MN,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Ei(t,"network-request-failed"),o=Ti().setTimeout(()=>{s(a)},ON.get());function l(){Ti().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WN=500,HN=600,zN="_blank",$N="http://localhost";class Nx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function GN(t,e,r,n=WN,i=HN){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},jN),{width:n.toString(),height:i.toString(),top:s,left:a}),c=zr().toLowerCase();r&&(o=mT(c)?zN:r),dT(c)&&(e=e||$N,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[p,g])=>`${d}${p}=${g},`,"");if(cF(c)&&o!=="_self")return KN(e||"",o),new Nx(null);const h=window.open(e||"",o,f);Me(h,t,"popup-blocked");try{h.focus()}catch{}return new Nx(h)}function KN(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN="__/auth/handler",qN="emulator/auth/handler",YN=encodeURIComponent("fac");async function Dx(t,e,r,n,i,s){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:wl,eventId:i};if(e instanceof kT){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",FR(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof Su){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${YN}=${encodeURIComponent(l)}`:"";return`${QN(t)}?${Eu(o).slice(1)}${c}`}function QN({config:t}){return t.emulator?jg(t,qN):`https://${t.authDomain}/${XN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d="webStorageSupport";class JN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=NT,this._completeRedirectFn=EN,this._overrideRedirectResult=xN}async _openPopup(e,r,n,i){var s;rs((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Dx(e,r,n,cm(),i);return GN(e,a,Gg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await Dx(e,r,n,cm(),i);return tN(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(rs(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await UN(e),n=new kN(e);return r.register("authEvent",i=>(Me(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send($d,{type:$d},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[$d];a!==void 0&&r(!!a),oi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=RN(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return yT()||pT()||Hg()}}const ZN=JN;var Ox="@firebase/auth",bx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function r3(t){al(new Ma("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Me(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wT(t)},c=new mF(n,i,s,l);return kF(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),al(new Ma("auth-internal",e=>{const r=ra(e.getProvider("auth").getImmediate());return(n=>new e3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ws(Ox,bx,t3(t)),Ws(Ox,bx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=5*60,i3=Z2("authIdTokenMaxAge")||n3;let Lx=null;const s3=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>i3)return;const i=r==null?void 0:r.token;Lx!==i&&(Lx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function BT(t=Vg()){const e=Lg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=TF(t,{popupRedirectResolver:ZN,persistence:[uN,JF,NT]}),n=Z2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=s3(s.toString());XF(r,a,()=>a(r.currentUser)),KF(r,o=>a(o))}}const i=Q2("auth");return i&&SF(r,`http://${i}`),r}function a3(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}gF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Ei("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",a3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});r3("Browser");var Mx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Aa,UT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,k){function S(){}S.prototype=k.prototype,y.D=k.prototype,y.prototype=new S,y.prototype.constructor=y,y.C=function(I,R,C){for(var N=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)N[_e-2]=arguments[_e];return k.prototype[R].apply(I,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(y,k,S){S||(S=0);var I=Array(16);if(typeof k=="string")for(var R=0;16>R;++R)I[R]=k.charCodeAt(S++)|k.charCodeAt(S++)<<8|k.charCodeAt(S++)<<16|k.charCodeAt(S++)<<24;else for(R=0;16>R;++R)I[R]=k[S++]|k[S++]<<8|k[S++]<<16|k[S++]<<24;k=y.g[0],S=y.g[1],R=y.g[2];var C=y.g[3],N=k+(C^S&(R^C))+I[0]+3614090360&4294967295;k=S+(N<<7&4294967295|N>>>25),N=C+(R^k&(S^R))+I[1]+3905402710&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(S^C&(k^S))+I[2]+606105819&4294967295,R=C+(N<<17&4294967295|N>>>15),N=S+(k^R&(C^k))+I[3]+3250441966&4294967295,S=R+(N<<22&4294967295|N>>>10),N=k+(C^S&(R^C))+I[4]+4118548399&4294967295,k=S+(N<<7&4294967295|N>>>25),N=C+(R^k&(S^R))+I[5]+1200080426&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(S^C&(k^S))+I[6]+2821735955&4294967295,R=C+(N<<17&4294967295|N>>>15),N=S+(k^R&(C^k))+I[7]+4249261313&4294967295,S=R+(N<<22&4294967295|N>>>10),N=k+(C^S&(R^C))+I[8]+1770035416&4294967295,k=S+(N<<7&4294967295|N>>>25),N=C+(R^k&(S^R))+I[9]+2336552879&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(S^C&(k^S))+I[10]+4294925233&4294967295,R=C+(N<<17&4294967295|N>>>15),N=S+(k^R&(C^k))+I[11]+2304563134&4294967295,S=R+(N<<22&4294967295|N>>>10),N=k+(C^S&(R^C))+I[12]+1804603682&4294967295,k=S+(N<<7&4294967295|N>>>25),N=C+(R^k&(S^R))+I[13]+4254626195&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(S^C&(k^S))+I[14]+2792965006&4294967295,R=C+(N<<17&4294967295|N>>>15),N=S+(k^R&(C^k))+I[15]+1236535329&4294967295,S=R+(N<<22&4294967295|N>>>10),N=k+(R^C&(S^R))+I[1]+4129170786&4294967295,k=S+(N<<5&4294967295|N>>>27),N=C+(S^R&(k^S))+I[6]+3225465664&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^S&(C^k))+I[11]+643717713&4294967295,R=C+(N<<14&4294967295|N>>>18),N=S+(C^k&(R^C))+I[0]+3921069994&4294967295,S=R+(N<<20&4294967295|N>>>12),N=k+(R^C&(S^R))+I[5]+3593408605&4294967295,k=S+(N<<5&4294967295|N>>>27),N=C+(S^R&(k^S))+I[10]+38016083&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^S&(C^k))+I[15]+3634488961&4294967295,R=C+(N<<14&4294967295|N>>>18),N=S+(C^k&(R^C))+I[4]+3889429448&4294967295,S=R+(N<<20&4294967295|N>>>12),N=k+(R^C&(S^R))+I[9]+568446438&4294967295,k=S+(N<<5&4294967295|N>>>27),N=C+(S^R&(k^S))+I[14]+3275163606&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^S&(C^k))+I[3]+4107603335&4294967295,R=C+(N<<14&4294967295|N>>>18),N=S+(C^k&(R^C))+I[8]+1163531501&4294967295,S=R+(N<<20&4294967295|N>>>12),N=k+(R^C&(S^R))+I[13]+2850285829&4294967295,k=S+(N<<5&4294967295|N>>>27),N=C+(S^R&(k^S))+I[2]+4243563512&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^S&(C^k))+I[7]+1735328473&4294967295,R=C+(N<<14&4294967295|N>>>18),N=S+(C^k&(R^C))+I[12]+2368359562&4294967295,S=R+(N<<20&4294967295|N>>>12),N=k+(S^R^C)+I[5]+4294588738&4294967295,k=S+(N<<4&4294967295|N>>>28),N=C+(k^S^R)+I[8]+2272392833&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^S)+I[11]+1839030562&4294967295,R=C+(N<<16&4294967295|N>>>16),N=S+(R^C^k)+I[14]+4259657740&4294967295,S=R+(N<<23&4294967295|N>>>9),N=k+(S^R^C)+I[1]+2763975236&4294967295,k=S+(N<<4&4294967295|N>>>28),N=C+(k^S^R)+I[4]+1272893353&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^S)+I[7]+4139469664&4294967295,R=C+(N<<16&4294967295|N>>>16),N=S+(R^C^k)+I[10]+3200236656&4294967295,S=R+(N<<23&4294967295|N>>>9),N=k+(S^R^C)+I[13]+681279174&4294967295,k=S+(N<<4&4294967295|N>>>28),N=C+(k^S^R)+I[0]+3936430074&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^S)+I[3]+3572445317&4294967295,R=C+(N<<16&4294967295|N>>>16),N=S+(R^C^k)+I[6]+76029189&4294967295,S=R+(N<<23&4294967295|N>>>9),N=k+(S^R^C)+I[9]+3654602809&4294967295,k=S+(N<<4&4294967295|N>>>28),N=C+(k^S^R)+I[12]+3873151461&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^S)+I[15]+530742520&4294967295,R=C+(N<<16&4294967295|N>>>16),N=S+(R^C^k)+I[2]+3299628645&4294967295,S=R+(N<<23&4294967295|N>>>9),N=k+(R^(S|~C))+I[0]+4096336452&4294967295,k=S+(N<<6&4294967295|N>>>26),N=C+(S^(k|~R))+I[7]+1126891415&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~S))+I[14]+2878612391&4294967295,R=C+(N<<15&4294967295|N>>>17),N=S+(C^(R|~k))+I[5]+4237533241&4294967295,S=R+(N<<21&4294967295|N>>>11),N=k+(R^(S|~C))+I[12]+1700485571&4294967295,k=S+(N<<6&4294967295|N>>>26),N=C+(S^(k|~R))+I[3]+2399980690&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~S))+I[10]+4293915773&4294967295,R=C+(N<<15&4294967295|N>>>17),N=S+(C^(R|~k))+I[1]+2240044497&4294967295,S=R+(N<<21&4294967295|N>>>11),N=k+(R^(S|~C))+I[8]+1873313359&4294967295,k=S+(N<<6&4294967295|N>>>26),N=C+(S^(k|~R))+I[15]+4264355552&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~S))+I[6]+2734768916&4294967295,R=C+(N<<15&4294967295|N>>>17),N=S+(C^(R|~k))+I[13]+1309151649&4294967295,S=R+(N<<21&4294967295|N>>>11),N=k+(R^(S|~C))+I[4]+4149444226&4294967295,k=S+(N<<6&4294967295|N>>>26),N=C+(S^(k|~R))+I[11]+3174756917&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~S))+I[2]+718787259&4294967295,R=C+(N<<15&4294967295|N>>>17),N=S+(C^(R|~k))+I[9]+3951481745&4294967295,y.g[0]=y.g[0]+k&4294967295,y.g[1]=y.g[1]+(R+(N<<21&4294967295|N>>>11))&4294967295,y.g[2]=y.g[2]+R&4294967295,y.g[3]=y.g[3]+C&4294967295}n.prototype.u=function(y,k){k===void 0&&(k=y.length);for(var S=k-this.blockSize,I=this.B,R=this.h,C=0;C<k;){if(R==0)for(;C<=S;)i(this,y,C),C+=this.blockSize;if(typeof y=="string"){for(;C<k;)if(I[R++]=y.charCodeAt(C++),R==this.blockSize){i(this,I),R=0;break}}else for(;C<k;)if(I[R++]=y[C++],R==this.blockSize){i(this,I),R=0;break}}this.h=R,this.o+=k},n.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var k=1;k<y.length-8;++k)y[k]=0;var S=8*this.o;for(k=y.length-8;k<y.length;++k)y[k]=S&255,S/=256;for(this.u(y),y=Array(16),k=S=0;4>k;++k)for(var I=0;32>I;I+=8)y[S++]=this.g[k]>>>I&255;return y};function s(y,k){var S=o;return Object.prototype.hasOwnProperty.call(S,y)?S[y]:S[y]=k(y)}function a(y,k){this.h=k;for(var S=[],I=!0,R=y.length-1;0<=R;R--){var C=y[R]|0;I&&C==k||(S[R]=C,I=!1)}this.g=S}var o={};function l(y){return-128<=y&&128>y?s(y,function(k){return new a([k|0],0>k?-1:0)}):new a([y|0],0>y?-1:0)}function c(y){if(isNaN(y)||!isFinite(y))return h;if(0>y)return _(c(-y));for(var k=[],S=1,I=0;y>=S;I++)k[I]=y/S|0,S*=4294967296;return new a(k,0)}function f(y,k){if(y.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(y.charAt(0)=="-")return _(f(y.substring(1),k));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(k,8)),I=h,R=0;R<y.length;R+=8){var C=Math.min(8,y.length-R),N=parseInt(y.substring(R,R+C),k);8>C?(C=c(Math.pow(k,C)),I=I.j(C).add(c(N))):(I=I.j(S),I=I.add(c(N)))}return I}var h=l(0),d=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(m(this))return-_(this).m();for(var y=0,k=1,S=0;S<this.g.length;S++){var I=this.i(S);y+=(0<=I?I:4294967296+I)*k,k*=4294967296}return y},t.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(g(this))return"0";if(m(this))return"-"+_(this).toString(y);for(var k=c(Math.pow(y,6)),S=this,I="";;){var R=P(S,k).g;S=w(S,R.j(k));var C=((0<S.g.length?S.g[0]:S.h)>>>0).toString(y);if(S=R,g(S))return C+I;for(;6>C.length;)C="0"+C;I=C+I}},t.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function g(y){if(y.h!=0)return!1;for(var k=0;k<y.g.length;k++)if(y.g[k]!=0)return!1;return!0}function m(y){return y.h==-1}t.l=function(y){return y=w(this,y),m(y)?-1:g(y)?0:1};function _(y){for(var k=y.g.length,S=[],I=0;I<k;I++)S[I]=~y.g[I];return new a(S,~y.h).add(d)}t.abs=function(){return m(this)?_(this):this},t.add=function(y){for(var k=Math.max(this.g.length,y.g.length),S=[],I=0,R=0;R<=k;R++){var C=I+(this.i(R)&65535)+(y.i(R)&65535),N=(C>>>16)+(this.i(R)>>>16)+(y.i(R)>>>16);I=N>>>16,C&=65535,N&=65535,S[R]=N<<16|C}return new a(S,S[S.length-1]&-2147483648?-1:0)};function w(y,k){return y.add(_(k))}t.j=function(y){if(g(this)||g(y))return h;if(m(this))return m(y)?_(this).j(_(y)):_(_(this).j(y));if(m(y))return _(this.j(_(y)));if(0>this.l(p)&&0>y.l(p))return c(this.m()*y.m());for(var k=this.g.length+y.g.length,S=[],I=0;I<2*k;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<y.g.length;R++){var C=this.i(I)>>>16,N=this.i(I)&65535,_e=y.i(R)>>>16,pe=y.i(R)&65535;S[2*I+2*R]+=N*pe,E(S,2*I+2*R),S[2*I+2*R+1]+=C*pe,E(S,2*I+2*R+1),S[2*I+2*R+1]+=N*_e,E(S,2*I+2*R+1),S[2*I+2*R+2]+=C*_e,E(S,2*I+2*R+2)}for(I=0;I<k;I++)S[I]=S[2*I+1]<<16|S[2*I];for(I=k;I<2*k;I++)S[I]=0;return new a(S,0)};function E(y,k){for(;(y[k]&65535)!=y[k];)y[k+1]+=y[k]>>>16,y[k]&=65535,k++}function x(y,k){this.g=y,this.h=k}function P(y,k){if(g(k))throw Error("division by zero");if(g(y))return new x(h,h);if(m(y))return k=P(_(y),k),new x(_(k.g),_(k.h));if(m(k))return k=P(y,_(k)),new x(_(k.g),k.h);if(30<y.g.length){if(m(y)||m(k))throw Error("slowDivide_ only works with positive integers.");for(var S=d,I=k;0>=I.l(y);)S=W(S),I=W(I);var R=M(S,1),C=M(I,1);for(I=M(I,2),S=M(S,2);!g(I);){var N=C.add(I);0>=N.l(y)&&(R=R.add(S),C=N),I=M(I,1),S=M(S,1)}return k=w(y,R.j(k)),new x(R,k)}for(R=h;0<=y.l(k);){for(S=Math.max(1,Math.floor(y.m()/k.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),C=c(S),N=C.j(k);m(N)||0<N.l(y);)S-=I,C=c(S),N=C.j(k);g(C)&&(C=d),R=R.add(C),y=w(y,N)}return new x(R,y)}t.A=function(y){return P(this,y).h},t.and=function(y){for(var k=Math.max(this.g.length,y.g.length),S=[],I=0;I<k;I++)S[I]=this.i(I)&y.i(I);return new a(S,this.h&y.h)},t.or=function(y){for(var k=Math.max(this.g.length,y.g.length),S=[],I=0;I<k;I++)S[I]=this.i(I)|y.i(I);return new a(S,this.h|y.h)},t.xor=function(y){for(var k=Math.max(this.g.length,y.g.length),S=[],I=0;I<k;I++)S[I]=this.i(I)^y.i(I);return new a(S,this.h^y.h)};function W(y){for(var k=y.g.length+1,S=[],I=0;I<k;I++)S[I]=y.i(I)<<1|y.i(I-1)>>>31;return new a(S,y.h)}function M(y,k){var S=k>>5;k%=32;for(var I=y.g.length-S,R=[],C=0;C<I;C++)R[C]=0<k?y.i(C+S)>>>k|y.i(C+S+1)<<32-k:y.i(C+S);return new a(R,y.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,UT=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=f,Aa=a}).apply(typeof Mx<"u"?Mx:typeof self<"u"?self:typeof window<"u"?window:{});var If=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jT,tc,WT,sh,dm,HT,zT,$T;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,v,T){return u==Array.prototype||u==Object.prototype||(u[v]=T.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof If=="object"&&If];for(var v=0;v<u.length;++v){var T=u[v];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var n=r(this);function i(u,v){if(v)e:{var T=n;u=u.split(".");for(var D=0;D<u.length-1;D++){var Y=u[D];if(!(Y in T))break e;T=T[Y]}u=u[u.length-1],D=T[u],v=v(D),v!=D&&v!=null&&e(T,u,{configurable:!0,writable:!0,value:v})}}function s(u,v){u instanceof String&&(u+="");var T=0,D=!1,Y={next:function(){if(!D&&T<u.length){var te=T++;return{value:v(te,u[te]),done:!1}}return D=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}i("Array.prototype.values",function(u){return u||function(){return s(this,function(v,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var v=typeof u;return v=v!="object"?v:u?Array.isArray(u)?"array":v:"null",v=="array"||v=="object"&&typeof u.length=="number"}function c(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function f(u,v,T){return u.call.apply(u.bind,arguments)}function h(u,v,T){if(!u)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,D),u.apply(v,Y)}}return function(){return u.apply(v,arguments)}}function d(u,v,T){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function p(u,v){var T=Array.prototype.slice.call(arguments,1);return function(){var D=T.slice();return D.push.apply(D,arguments),u.apply(this,D)}}function g(u,v){function T(){}T.prototype=v.prototype,u.aa=v.prototype,u.prototype=new T,u.prototype.constructor=u,u.Qb=function(D,Y,te){for(var Ee=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)Ee[gt-2]=arguments[gt];return v.prototype[Y].apply(D,Ee)}}function m(u){const v=u.length;if(0<v){const T=Array(v);for(let D=0;D<v;D++)T[D]=u[D];return T}return[]}function _(u,v){for(let T=1;T<arguments.length;T++){const D=arguments[T];if(l(D)){const Y=u.length||0,te=D.length||0;u.length=Y+te;for(let Ee=0;Ee<te;Ee++)u[Y+Ee]=D[Ee]}else u.push(D)}}class w{constructor(v,T){this.i=v,this.j=T,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function E(u){return/^[\s\xa0]*$/.test(u)}function x(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function P(u){return P[" "](u),u}P[" "]=function(){};var W=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function M(u,v,T){for(const D in u)v.call(T,u[D],D,u)}function y(u,v){for(const T in u)v.call(void 0,u[T],T,u)}function k(u){const v={};for(const T in u)v[T]=u[T];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,v){let T,D;for(let Y=1;Y<arguments.length;Y++){D=arguments[Y];for(T in D)u[T]=D[T];for(let te=0;te<S.length;te++)T=S[te],Object.prototype.hasOwnProperty.call(D,T)&&(u[T]=D[T])}}function R(u){var v=1;u=u.split(":");const T=[];for(;0<v&&u.length;)T.push(u.shift()),v--;return u.length&&T.push(u.join(":")),T}function C(u){o.setTimeout(()=>{throw u},0)}function N(){var u=V;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class _e{constructor(){this.h=this.g=null}add(v,T){const D=pe.get();D.set(v,T),this.h?this.h.next=D:this.g=D,this.h=D}}var pe=new w(()=>new Te,u=>u.reset());class Te{constructor(){this.next=this.g=this.h=null}set(v,T){this.h=v,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,ce=!1,V=new _e,X=()=>{const u=o.Promise.resolve(void 0);ge=()=>{u.then(oe)}};var oe=()=>{for(var u;u=N();){try{u.h.call(u.g)}catch(T){C(T)}var v=pe;v.j(u),100>v.h&&(v.h++,u.next=v.g,v.g=u)}ce=!1};function b(){this.s=this.s,this.C=this.C}b.prototype.s=!1,b.prototype.ma=function(){this.s||(this.s=!0,this.N())},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const T=()=>{};o.addEventListener("test",T,v),o.removeEventListener("test",T,v)}catch{}return u}();function K(u,v){if(j.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var T=this.type=u.type,D=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget){if(W){e:{try{P(v.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(v=null)}}else T=="mouseover"?v=u.fromElement:T=="mouseout"&&(v=u.toElement);this.relatedTarget=v,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:q[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&K.aa.h.call(this)}}g(K,j);var q={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var se="closure_listenable_"+(1e6*Math.random()|0),le=0;function ae(u,v,T,D,Y){this.listener=u,this.proxy=null,this.src=v,this.type=T,this.capture=!!D,this.ha=Y,this.key=++le,this.da=this.fa=!1}function ie(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Fe(u){this.src=u,this.g={},this.h=0}Fe.prototype.add=function(u,v,T,D,Y){var te=u.toString();u=this.g[te],u||(u=this.g[te]=[],this.h++);var Ee=qe(u,v,D,Y);return-1<Ee?(v=u[Ee],T||(v.fa=!1)):(v=new ae(v,this.src,te,!!D,Y),v.fa=T,u.push(v)),v};function G(u,v){var T=v.type;if(T in u.g){var D=u.g[T],Y=Array.prototype.indexOf.call(D,v,void 0),te;(te=0<=Y)&&Array.prototype.splice.call(D,Y,1),te&&(ie(v),u.g[T].length==0&&(delete u.g[T],u.h--))}}function qe(u,v,T,D){for(var Y=0;Y<u.length;++Y){var te=u[Y];if(!te.da&&te.listener==v&&te.capture==!!T&&te.ha==D)return Y}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),at={};function Ge(u,v,T,D,Y){if(Array.isArray(v)){for(var te=0;te<v.length;te++)Ge(u,v[te],T,D,Y);return null}return T=Fn(T),u&&u[se]?u.K(v,T,c(D)?!!D.capture:!1,Y):ke(u,v,T,!1,D,Y)}function ke(u,v,T,D,Y,te){if(!v)throw Error("Invalid event type");var Ee=c(Y)?!!Y.capture:!!Y,gt=Pn(u);if(gt||(u[$e]=gt=new Fe(u)),T=gt.add(v,T,D,Ee,te),T.proxy)return T;if(D=Ct(),T.proxy=D,D.src=u,D.listener=T,u.addEventListener)z||(Y=Ee),Y===void 0&&(Y=!1),u.addEventListener(v.toString(),D,Y);else if(u.attachEvent)u.attachEvent(Rn(v.toString()),D);else if(u.addListener&&u.removeListener)u.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Ct(){function u(T){return v.call(u.src,u.listener,T)}const v=oa;return u}function Kr(u,v,T,D,Y){if(Array.isArray(v))for(var te=0;te<v.length;te++)Kr(u,v[te],T,D,Y);else D=c(D)?!!D.capture:!!D,T=Fn(T),u&&u[se]?(u=u.i,v=String(v).toString(),v in u.g&&(te=u.g[v],T=qe(te,T,D,Y),-1<T&&(ie(te[T]),Array.prototype.splice.call(te,T,1),te.length==0&&(delete u.g[v],u.h--)))):u&&(u=Pn(u))&&(v=u.g[v.toString()],u=-1,v&&(u=qe(v,T,D,Y)),(T=-1<u?v[u]:null)&&nn(T))}function nn(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[se])G(v.i,u);else{var T=u.type,D=u.proxy;v.removeEventListener?v.removeEventListener(T,D,u.capture):v.detachEvent?v.detachEvent(Rn(T),D):v.addListener&&v.removeListener&&v.removeListener(D),(T=Pn(v))?(G(T,u),T.h==0&&(T.src=null,v[$e]=null)):ie(u)}}}function Rn(u){return u in at?at[u]:at[u]="on"+u}function oa(u,v){if(u.da)u=!0;else{v=new K(v,this);var T=u.listener,D=u.ha||u.src;u.fa&&nn(u),u=T.call(D,v)}return u}function Pn(u){return u=u[$e],u instanceof Fe?u:null}var mr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fn(u){return typeof u=="function"?u:(u[mr]||(u[mr]=function(v){return u.handleEvent(v)}),u[mr])}function _t(){b.call(this),this.i=new Fe(this),this.M=this,this.F=null}g(_t,b),_t.prototype[se]=!0,_t.prototype.removeEventListener=function(u,v,T,D){Kr(this,u,v,T,D)};function Ht(u,v){var T,D=u.F;if(D)for(T=[];D;D=D.F)T.push(D);if(u=u.M,D=v.type||v,typeof v=="string")v=new j(v,u);else if(v instanceof j)v.target=v.target||u;else{var Y=v;v=new j(D,u),I(v,Y)}if(Y=!0,T)for(var te=T.length-1;0<=te;te--){var Ee=v.g=T[te];Y=qt(Ee,D,!0,v)&&Y}if(Ee=v.g=u,Y=qt(Ee,D,!0,v)&&Y,Y=qt(Ee,D,!1,v)&&Y,T)for(te=0;te<T.length;te++)Ee=v.g=T[te],Y=qt(Ee,D,!1,v)&&Y}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var u=this.i,v;for(v in u.g){for(var T=u.g[v],D=0;D<T.length;D++)ie(T[D]);delete u.g[v],u.h--}}this.F=null},_t.prototype.K=function(u,v,T,D){return this.i.add(String(u),v,!1,T,D)},_t.prototype.L=function(u,v,T,D){return this.i.add(String(u),v,!0,T,D)};function qt(u,v,T,D){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();for(var Y=!0,te=0;te<v.length;++te){var Ee=v[te];if(Ee&&!Ee.da&&Ee.capture==T){var gt=Ee.listener,vr=Ee.ha||Ee.src;Ee.fa&&G(u.i,Ee),Y=gt.call(vr,D)!==!1&&Y}}return Y&&!D.defaultPrevented}function pn(u,v,T){if(typeof u=="function")T&&(u=d(u,T));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(u,v||0)}function He(u){u.g=pn(()=>{u.g=null,u.i&&(u.i=!1,He(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class Rt extends b{constructor(v,T){super(),this.m=v,this.l=T,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function or(u){b.call(this),this.h=u,this.g={}}g(or,b);var Mt=[];function ci(u){M(u.g,function(v,T){this.g.hasOwnProperty(T)&&nn(v)},u),u.g={}}or.prototype.N=function(){or.aa.N.call(this),ci(this)},or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var oo=o.JSON.stringify,nd=o.JSON.parse,id=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function lo(){}lo.prototype.h=null;function Rl(u){return u.h||(u.h=u.i())}function Pl(){}var la={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Fl(){j.call(this,"d")}g(Fl,j);function hs(){j.call(this,"c")}g(hs,j);var Fi={},Ku=null;function co(){return Ku=Ku||new _t}Fi.La="serverreachability";function Xu(u){j.call(this,Fi.La,u)}g(Xu,j);function ca(u){const v=co();Ht(v,new Xu(v))}Fi.STAT_EVENT="statevent";function qu(u,v){j.call(this,Fi.STAT_EVENT,u),this.stat=v}g(qu,j);function gr(u){const v=co();Ht(v,new qu(v,u))}Fi.Ma="timingevent";function Yu(u,v){j.call(this,Fi.Ma,u),this.size=v}g(Yu,j);function Ni(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},v)}function ua(){this.g=!0}ua.prototype.xa=function(){this.g=!1};function sd(u,v,T,D,Y,te){u.info(function(){if(u.g)if(te)for(var Ee="",gt=te.split("&"),vr=0;vr<gt.length;vr++){var nt=gt[vr].split("=");if(1<nt.length){var Cr=nt[0];nt=nt[1];var Rr=Cr.split("_");Ee=2<=Rr.length&&Rr[1]=="type"?Ee+(Cr+"="+nt+"&"):Ee+(Cr+"=redacted&")}}else Ee=null;else Ee=te;return"XMLHTTP REQ ("+D+") [attempt "+Y+"]: "+v+`
`+T+`
`+Ee})}function ad(u,v,T,D,Y,te,Ee){u.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+Y+"]: "+v+`
`+T+`
`+te+" "+Ee})}function A(u,v,T,D){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+O(u,T)+(D?" "+D:"")})}function B(u,v){u.info(function(){return"TIMEOUT: "+v})}ua.prototype.info=function(){};function O(u,v){if(!u.g)return v;if(!v)return null;try{var T=JSON.parse(v);if(T){for(u=0;u<T.length;u++)if(Array.isArray(T[u])){var D=T[u];if(!(2>D.length)){var Y=D[1];if(Array.isArray(Y)&&!(1>Y.length)){var te=Y[0];if(te!="noop"&&te!="stop"&&te!="close")for(var Ee=1;Ee<Y.length;Ee++)Y[Ee]=""}}}}return oo(T)}catch{return v}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},U={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},H;function Q(){}g(Q,lo),Q.prototype.g=function(){return new XMLHttpRequest},Q.prototype.i=function(){return{}},H=new Q;function re(u,v,T,D){this.j=u,this.i=v,this.l=T,this.R=D||1,this.U=new or(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new J}function J(){this.i=null,this.g="",this.h=!1}var Z={},ee={};function de(u,v,T){u.L=1,u.v=Zu(Oi(v)),u.m=T,u.P=!0,we(u,null)}function we(u,v){u.F=Date.now(),Se(u),u.A=Oi(u.v);var T=u.A,D=u.R;Array.isArray(D)||(D=[String(D)]),Fv(T.i,"t",D),u.C=0,T=u.j.J,u.h=new J,u.g=qv(u.j,T?v:null,!u.m),0<u.O&&(u.M=new Rt(d(u.Y,u,u.g),u.O)),v=u.U,T=u.g,D=u.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(Mt[0]=Y.toString()),Y=Mt);for(var te=0;te<Y.length;te++){var Ee=Ge(T,Y[te],D||v.handleEvent,!1,v.h||v);if(!Ee)break;v.g[Ee.key]=Ee}v=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,v)):(u.u="GET",u.g.ea(u.A,u.u,null,v)),ca(),sd(u.i,u.u,u.A,u.l,u.R,u.m)}re.prototype.ca=function(u){u=u.target;const v=this.M;v&&bi(u)==3?v.j():this.Y(u)},re.prototype.Y=function(u){try{if(u==this.g)e:{const Rr=bi(this.g);var v=this.g.Ba();const po=this.g.Z();if(!(3>Rr)&&(Rr!=3||this.g&&(this.h.h||this.g.oa()||Vv(this.g)))){this.J||Rr!=4||v==7||(v==8||0>=po?ca(3):ca(2)),mt(this);var T=this.g.Z();this.X=T;t:if(Ae(this)){var D=Vv(this.g);u="";var Y=D.length,te=bi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){At(this),ot(this);var Ee="";break t}this.h.i=new o.TextDecoder}for(v=0;v<Y;v++)this.h.h=!0,u+=this.h.i.decode(D[v],{stream:!(te&&v==Y-1)});D.length=0,this.h.g+=u,this.C=0,Ee=this.h.g}else Ee=this.g.oa();if(this.o=T==200,ad(this.i,this.u,this.A,this.l,this.R,Rr,T),this.o){if(this.T&&!this.K){t:{if(this.g){var gt,vr=this.g;if((gt=vr.g?vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(gt)){var nt=gt;break t}}nt=null}if(T=nt)A(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Di(this,T);else{this.o=!1,this.s=3,gr(12),At(this),ot(this);break e}}if(this.P){T=!0;let Xn;for(;!this.J&&this.C<Ee.length;)if(Xn=ve(this,Ee),Xn==ee){Rr==4&&(this.s=4,gr(14),T=!1),A(this.i,this.l,null,"[Incomplete Response]");break}else if(Xn==Z){this.s=4,gr(15),A(this.i,this.l,Ee,"[Invalid Chunk]"),T=!1;break}else A(this.i,this.l,Xn,null),Di(this,Xn);if(Ae(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rr!=4||Ee.length!=0||this.h.h||(this.s=1,gr(16),T=!1),this.o=this.o&&T,!T)A(this.i,this.l,Ee,"[Invalid Chunked Response]"),At(this),ot(this);else if(0<Ee.length&&!this.W){this.W=!0;var Cr=this.j;Cr.g==this&&Cr.ba&&!Cr.M&&(Cr.j.info("Great, no buffering proxy detected. Bytes received: "+Ee.length),fd(Cr),Cr.M=!0,gr(11))}}else A(this.i,this.l,Ee,null),Di(this,Ee);Rr==4&&At(this),this.o&&!this.J&&(Rr==4?$v(this.j,this):(this.o=!1,Se(this)))}else bI(this.g),T==400&&0<Ee.indexOf("Unknown SID")?(this.s=3,gr(12)):(this.s=0,gr(13)),At(this),ot(this)}}}catch{}finally{}};function Ae(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ve(u,v){var T=u.C,D=v.indexOf(`
`,T);return D==-1?ee:(T=Number(v.substring(T,D)),isNaN(T)?Z:(D+=1,D+T>v.length?ee:(v=v.slice(D,D+T),u.C=D+T,v)))}re.prototype.cancel=function(){this.J=!0,At(this)};function Se(u){u.S=Date.now()+u.I,Ve(u,u.I)}function Ve(u,v){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ni(d(u.ba,u),v)}function mt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}re.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(B(this.i,this.A),this.L!=2&&(ca(),gr(17)),At(this),this.s=2,ot(this)):Ve(this,this.S-u)};function ot(u){u.j.G==0||u.J||$v(u.j,u)}function At(u){mt(u);var v=u.M;v&&typeof v.ma=="function"&&v.ma(),u.M=null,ci(u.U),u.g&&(v=u.g,u.g=null,v.abort(),v.ma())}function Di(u,v){try{var T=u.j;if(T.G!=0&&(T.g==u||mn(T.h,u))){if(!u.K&&mn(T.h,u)&&T.G==3){try{var D=T.Da.g.parse(v)}catch{D=null}if(Array.isArray(D)&&D.length==3){var Y=D;if(Y[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<u.F)af(T),nf(T);else break e;ud(T),gr(18)}}else T.za=Y[1],0<T.za-T.T&&37500>Y[2]&&T.F&&T.v==0&&!T.C&&(T.C=Ni(d(T.Za,T),6e3));if(1>=uo(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else da(T,11)}else if((u.K||T.g==u)&&af(T),!E(v))for(Y=T.Da.g.parse(v),v=0;v<Y.length;v++){let nt=Y[v];if(T.T=nt[0],nt=nt[1],T.G==2)if(nt[0]=="c"){T.K=nt[1],T.ia=nt[2];const Cr=nt[3];Cr!=null&&(T.la=Cr,T.j.info("VER="+T.la));const Rr=nt[4];Rr!=null&&(T.Aa=Rr,T.j.info("SVER="+T.Aa));const po=nt[5];po!=null&&typeof po=="number"&&0<po&&(D=1.5*po,T.L=D,T.j.info("backChannelRequestTimeoutMs_="+D)),D=T;const Xn=u.g;if(Xn){const lf=Xn.g?Xn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(lf){var te=D.h;te.g||lf.indexOf("spdy")==-1&&lf.indexOf("quic")==-1&&lf.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(od(te,te.h),te.h=null))}if(D.D){const hd=Xn.g?Xn.g.getResponseHeader("X-HTTP-Session-Id"):null;hd&&(D.ya=hd,xt(D.I,D.D,hd))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-u.F,T.j.info("Handshake RTT: "+T.R+"ms")),D=T;var Ee=u;if(D.qa=Xv(D,D.J?D.ia:null,D.W),Ee.K){Tv(D.h,Ee);var gt=Ee,vr=D.L;vr&&(gt.I=vr),gt.B&&(mt(gt),Se(gt)),D.g=Ee}else Hv(D);0<T.i.length&&sf(T)}else nt[0]!="stop"&&nt[0]!="close"||da(T,7);else T.G==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?da(T,7):cd(T):nt[0]!="noop"&&T.l&&T.l.ta(nt),T.v=0)}}ca(4)}catch{}}var fa=class{constructor(u,v){this.g=u,this.map=v}};function ds(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ui(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function uo(u){return u.h?1:u.g?u.g.size:0}function mn(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function od(u,v){u.g?u.g.add(v):u.h=v}function Tv(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}ds.prototype.cancel=function(){if(this.i=kv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function kv(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const T of u.g.values())v=v.concat(T.D);return v}return m(u.i)}function yI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var v=[],T=u.length,D=0;D<T;D++)v.push(u[D]);return v}v=[],T=0;for(D in u)v[T++]=u[D];return v}function wI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var v=[];u=u.length;for(var T=0;T<u;T++)v.push(T);return v}v=[],T=0;for(const D in u)v[T++]=D;return v}}}function Sv(u,v){if(u.forEach&&typeof u.forEach=="function")u.forEach(v,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,v,void 0);else for(var T=wI(u),D=yI(u),Y=D.length,te=0;te<Y;te++)v.call(void 0,D[te],T&&T[te],u)}var Av=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function EI(u,v){if(u){u=u.split("&");for(var T=0;T<u.length;T++){var D=u[T].indexOf("="),Y=null;if(0<=D){var te=u[T].substring(0,D);Y=u[T].substring(D+1)}else te=u[T];v(te,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function ha(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ha){this.h=u.h,Qu(this,u.j),this.o=u.o,this.g=u.g,Ju(this,u.s),this.l=u.l;var v=u.i,T=new Ol;T.i=v.i,v.g&&(T.g=new Map(v.g),T.h=v.h),Iv(this,T),this.m=u.m}else u&&(v=String(u).match(Av))?(this.h=!1,Qu(this,v[1]||"",!0),this.o=Nl(v[2]||""),this.g=Nl(v[3]||"",!0),Ju(this,v[4]),this.l=Nl(v[5]||"",!0),Iv(this,v[6]||"",!0),this.m=Nl(v[7]||"")):(this.h=!1,this.i=new Ol(null,this.h))}ha.prototype.toString=function(){var u=[],v=this.j;v&&u.push(Dl(v,Cv,!0),":");var T=this.g;return(T||v=="file")&&(u.push("//"),(v=this.o)&&u.push(Dl(v,Cv,!0),"@"),u.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&u.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&u.push("/"),u.push(Dl(T,T.charAt(0)=="/"?SI:kI,!0))),(T=this.i.toString())&&u.push("?",T),(T=this.m)&&u.push("#",Dl(T,II)),u.join("")};function Oi(u){return new ha(u)}function Qu(u,v,T){u.j=T?Nl(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function Ju(u,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);u.s=v}else u.s=null}function Iv(u,v,T){v instanceof Ol?(u.i=v,CI(u.i,u.h)):(T||(v=Dl(v,AI)),u.i=new Ol(v,u.h))}function xt(u,v,T){u.i.set(v,T)}function Zu(u){return xt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Nl(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Dl(u,v,T){return typeof u=="string"?(u=encodeURI(u).replace(v,TI),T&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function TI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Cv=/[#\/\?@]/g,kI=/[#\?:]/g,SI=/[#\?]/g,AI=/[#\?@]/g,II=/#/g;function Ol(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function ps(u){u.g||(u.g=new Map,u.h=0,u.i&&EI(u.i,function(v,T){u.add(decodeURIComponent(v.replace(/\+/g," ")),T)}))}t=Ol.prototype,t.add=function(u,v){ps(this),this.i=null,u=fo(this,u);var T=this.g.get(u);return T||this.g.set(u,T=[]),T.push(v),this.h+=1,this};function Rv(u,v){ps(u),v=fo(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function Pv(u,v){return ps(u),v=fo(u,v),u.g.has(v)}t.forEach=function(u,v){ps(this),this.g.forEach(function(T,D){T.forEach(function(Y){u.call(v,Y,D,this)},this)},this)},t.na=function(){ps(this);const u=Array.from(this.g.values()),v=Array.from(this.g.keys()),T=[];for(let D=0;D<v.length;D++){const Y=u[D];for(let te=0;te<Y.length;te++)T.push(v[D])}return T},t.V=function(u){ps(this);let v=[];if(typeof u=="string")Pv(this,u)&&(v=v.concat(this.g.get(fo(this,u))));else{u=Array.from(this.g.values());for(let T=0;T<u.length;T++)v=v.concat(u[T])}return v},t.set=function(u,v){return ps(this),this.i=null,u=fo(this,u),Pv(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},t.get=function(u,v){return u?(u=this.V(u),0<u.length?String(u[0]):v):v};function Fv(u,v,T){Rv(u,v),0<T.length&&(u.i=null,u.g.set(fo(u,v),m(T)),u.h+=T.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(var T=0;T<v.length;T++){var D=v[T];const te=encodeURIComponent(String(D)),Ee=this.V(D);for(D=0;D<Ee.length;D++){var Y=te;Ee[D]!==""&&(Y+="="+encodeURIComponent(String(Ee[D]))),u.push(Y)}}return this.i=u.join("&")};function fo(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function CI(u,v){v&&!u.j&&(ps(u),u.i=null,u.g.forEach(function(T,D){var Y=D.toLowerCase();D!=Y&&(Rv(this,D),Fv(this,Y,T))},u)),u.j=v}function RI(u,v){const T=new ua;if(o.Image){const D=new Image;D.onload=p(ms,T,"TestLoadImage: loaded",!0,v,D),D.onerror=p(ms,T,"TestLoadImage: error",!1,v,D),D.onabort=p(ms,T,"TestLoadImage: abort",!1,v,D),D.ontimeout=p(ms,T,"TestLoadImage: timeout",!1,v,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=u}else v(!1)}function PI(u,v){const T=new ua,D=new AbortController,Y=setTimeout(()=>{D.abort(),ms(T,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:D.signal}).then(te=>{clearTimeout(Y),te.ok?ms(T,"TestPingServer: ok",!0,v):ms(T,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Y),ms(T,"TestPingServer: error",!1,v)})}function ms(u,v,T,D,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),D(T)}catch{}}function FI(){this.g=new id}function NI(u,v,T){const D=T||"";try{Sv(u,function(Y,te){let Ee=Y;c(Y)&&(Ee=oo(Y)),v.push(D+te+"="+encodeURIComponent(Ee))})}catch(Y){throw v.push(D+"type="+encodeURIComponent("_badmap")),Y}}function ef(u){this.l=u.Ub||null,this.j=u.eb||!1}g(ef,lo),ef.prototype.g=function(){return new tf(this.l,this.j)},ef.prototype.i=function(u){return function(){return u}}({});function tf(u,v){_t.call(this),this.D=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(tf,_t),t=tf.prototype,t.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=v,this.readyState=1,Ll(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(v.body=u),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ll(this)),this.g&&(this.readyState=3,Ll(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nv(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nv(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?bl(this):Ll(this),this.readyState==3&&Nv(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,bl(this))},t.Qa=function(u){this.g&&(this.response=u,bl(this))},t.ga=function(){this.g&&bl(this)};function bl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ll(u)}t.setRequestHeader=function(u,v){this.u.append(u,v)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var T=v.next();!T.done;)T=T.value,u.push(T[0]+": "+T[1]),T=v.next();return u.join(`\r
`)};function Ll(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(tf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Dv(u){let v="";return M(u,function(T,D){v+=D,v+=":",v+=T,v+=`\r
`}),v}function ld(u,v,T){e:{for(D in T){var D=!1;break e}D=!0}D||(T=Dv(T),typeof u=="string"?T!=null&&encodeURIComponent(String(T)):xt(u,v,T))}function Vt(u){_t.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Vt,_t);var DI=/^https?$/i,OI=["POST","PUT"];t=Vt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,v,T,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():H.g(),this.v=this.o?Rl(this.o):Rl(H),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(te){Ov(this,te);return}if(u=T||"",T=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var Y in D)T.set(Y,D[Y]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const te of D.keys())T.set(te,D.get(te));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(T.keys()).find(te=>te.toLowerCase()=="content-type"),Y=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(OI,v,void 0))||D||Y||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,Ee]of T)this.g.setRequestHeader(te,Ee);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Mv(this),this.u=!0,this.g.send(u),this.u=!1}catch(te){Ov(this,te)}};function Ov(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.m=5,bv(u),rf(u)}function bv(u){u.A||(u.A=!0,Ht(u,"complete"),Ht(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ht(this,"complete"),Ht(this,"abort"),rf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rf(this,!0)),Vt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Lv(this):this.bb())},t.bb=function(){Lv(this)};function Lv(u){if(u.h&&typeof a<"u"&&(!u.v[1]||bi(u)!=4||u.Z()!=2)){if(u.u&&bi(u)==4)pn(u.Ea,0,u);else if(Ht(u,"readystatechange"),bi(u)==4){u.h=!1;try{const Ee=u.Z();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var T;if(!(T=v)){var D;if(D=Ee===0){var Y=String(u.D).match(Av)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),D=!DI.test(Y?Y.toLowerCase():"")}T=D}if(T)Ht(u,"complete"),Ht(u,"success");else{u.m=6;try{var te=2<bi(u)?u.g.statusText:""}catch{te=""}u.l=te+" ["+u.Z()+"]",bv(u)}}finally{rf(u)}}}}function rf(u,v){if(u.g){Mv(u);const T=u.g,D=u.v[0]?()=>{}:null;u.g=null,u.v=null,v||Ht(u,"ready");try{T.onreadystatechange=D}catch{}}}function Mv(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function bi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<bi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),nd(v)}};function Vv(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function bI(u){const v={};u=(u.g&&2<=bi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<u.length;D++){if(E(u[D]))continue;var T=R(u[D]);const Y=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const te=v[Y]||[];v[Y]=te,te.push(T)}y(v,function(D){return D.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ml(u,v,T){return T&&T.internalChannelParams&&T.internalChannelParams[u]||v}function Bv(u){this.Aa=0,this.i=[],this.j=new ua,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ml("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ml("baseRetryDelayMs",5e3,u),this.cb=Ml("retryDelaySeedMs",1e4,u),this.Wa=Ml("forwardChannelMaxRetries",2,u),this.wa=Ml("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ds(u&&u.concurrentRequestLimit),this.Da=new FI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Bv.prototype,t.la=8,t.G=1,t.connect=function(u,v,T,D){gr(0),this.W=u,this.H=v||{},T&&D!==void 0&&(this.H.OSID=T,this.H.OAID=D),this.F=this.X,this.I=Xv(this,null,this.W),sf(this)};function cd(u){if(Uv(u),u.G==3){var v=u.U++,T=Oi(u.I);if(xt(T,"SID",u.K),xt(T,"RID",v),xt(T,"TYPE","terminate"),Vl(u,T),v=new re(u,u.j,v),v.L=2,v.v=Zu(Oi(T)),T=!1,o.navigator&&o.navigator.sendBeacon)try{T=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!T&&o.Image&&(new Image().src=v.v,T=!0),T||(v.g=qv(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Se(v)}Kv(u)}function nf(u){u.g&&(fd(u),u.g.cancel(),u.g=null)}function Uv(u){nf(u),u.u&&(o.clearTimeout(u.u),u.u=null),af(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function sf(u){if(!ui(u.h)&&!u.s){u.s=!0;var v=u.Ga;ge||X(),ce||(ge(),ce=!0),V.add(v,u),u.B=0}}function LI(u,v){return uo(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=v.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ni(d(u.Ga,u,v),Gv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Y=new re(this,this.j,u);let te=this.o;if(this.S&&(te?(te=k(te),I(te,this.S)):te=this.S),this.m!==null||this.O||(Y.H=te,te=null),this.P)e:{for(var v=0,T=0;T<this.i.length;T++){t:{var D=this.i[T];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(v+=D,4096<v){v=T;break e}if(v===4096||T===this.i.length-1){v=T+1;break e}}v=1e3}else v=1e3;v=Wv(this,Y,v),T=Oi(this.I),xt(T,"RID",u),xt(T,"CVER",22),this.D&&xt(T,"X-HTTP-Session-Id",this.D),Vl(this,T),te&&(this.O?v="headers="+encodeURIComponent(String(Dv(te)))+"&"+v:this.m&&ld(T,this.m,te)),od(this.h,Y),this.Ua&&xt(T,"TYPE","init"),this.P?(xt(T,"$req",v),xt(T,"SID","null"),Y.T=!0,de(Y,T,null)):de(Y,T,v),this.G=2}}else this.G==3&&(u?jv(this,u):this.i.length==0||ui(this.h)||jv(this))};function jv(u,v){var T;v?T=v.l:T=u.U++;const D=Oi(u.I);xt(D,"SID",u.K),xt(D,"RID",T),xt(D,"AID",u.T),Vl(u,D),u.m&&u.o&&ld(D,u.m,u.o),T=new re(u,u.j,T,u.B+1),u.m===null&&(T.H=u.o),v&&(u.i=v.D.concat(u.i)),v=Wv(u,T,1e3),T.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),od(u.h,T),de(T,D,v)}function Vl(u,v){u.H&&M(u.H,function(T,D){xt(v,D,T)}),u.l&&Sv({},function(T,D){xt(v,D,T)})}function Wv(u,v,T){T=Math.min(u.i.length,T);var D=u.l?d(u.l.Na,u.l,u):null;e:{var Y=u.i;let te=-1;for(;;){const Ee=["count="+T];te==-1?0<T?(te=Y[0].g,Ee.push("ofs="+te)):te=0:Ee.push("ofs="+te);let gt=!0;for(let vr=0;vr<T;vr++){let nt=Y[vr].g;const Cr=Y[vr].map;if(nt-=te,0>nt)te=Math.max(0,Y[vr].g-100),gt=!1;else try{NI(Cr,Ee,"req"+nt+"_")}catch{D&&D(Cr)}}if(gt){D=Ee.join("&");break e}}}return u=u.i.splice(0,T),v.D=u,D}function Hv(u){if(!u.g&&!u.u){u.Y=1;var v=u.Fa;ge||X(),ce||(ge(),ce=!0),V.add(v,u),u.v=0}}function ud(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ni(d(u.Fa,u),Gv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,zv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ni(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gr(10),nf(this),zv(this))};function fd(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function zv(u){u.g=new re(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var v=Oi(u.qa);xt(v,"RID","rpc"),xt(v,"SID",u.K),xt(v,"AID",u.T),xt(v,"CI",u.F?"0":"1"),!u.F&&u.ja&&xt(v,"TO",u.ja),xt(v,"TYPE","xmlhttp"),Vl(u,v),u.m&&u.o&&ld(v,u.m,u.o),u.L&&(u.g.I=u.L);var T=u.g;u=u.ia,T.L=1,T.v=Zu(Oi(v)),T.m=null,T.P=!0,we(T,u)}t.Za=function(){this.C!=null&&(this.C=null,nf(this),ud(this),gr(19))};function af(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function $v(u,v){var T=null;if(u.g==v){af(u),fd(u),u.g=null;var D=2}else if(mn(u.h,v))T=v.D,Tv(u.h,v),D=1;else return;if(u.G!=0){if(v.o)if(D==1){T=v.m?v.m.length:0,v=Date.now()-v.F;var Y=u.B;D=co(),Ht(D,new Yu(D,T)),sf(u)}else Hv(u);else if(Y=v.s,Y==3||Y==0&&0<v.X||!(D==1&&LI(u,v)||D==2&&ud(u)))switch(T&&0<T.length&&(v=u.h,v.i=v.i.concat(T)),Y){case 1:da(u,5);break;case 4:da(u,10);break;case 3:da(u,6);break;default:da(u,2)}}}function Gv(u,v){let T=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(T*=2),T*v}function da(u,v){if(u.j.info("Error code "+v),v==2){var T=d(u.fb,u),D=u.Xa;const Y=!D;D=new ha(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Qu(D,"https"),Zu(D),Y?RI(D.toString(),T):PI(D.toString(),T)}else gr(2);u.G=0,u.l&&u.l.sa(v),Kv(u),Uv(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),gr(2)):(this.j.info("Failed to ping google.com"),gr(1))};function Kv(u){if(u.G=0,u.ka=[],u.l){const v=kv(u.h);(v.length!=0||u.i.length!=0)&&(_(u.ka,v),_(u.ka,u.i),u.h.i.length=0,m(u.i),u.i.length=0),u.l.ra()}}function Xv(u,v,T){var D=T instanceof ha?Oi(T):new ha(T);if(D.g!="")v&&(D.g=v+"."+D.g),Ju(D,D.s);else{var Y=o.location;D=Y.protocol,v=v?v+"."+Y.hostname:Y.hostname,Y=+Y.port;var te=new ha(null);D&&Qu(te,D),v&&(te.g=v),Y&&Ju(te,Y),T&&(te.l=T),D=te}return T=u.D,v=u.ya,T&&v&&xt(D,T,v),xt(D,"VER",u.la),Vl(u,D),D}function qv(u,v,T){if(v&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Ca&&!u.pa?new Vt(new ef({eb:T})):new Vt(u.pa),v.Ha(u.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yv(){}t=Yv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function of(){}of.prototype.g=function(u,v){return new gn(u,v)};function gn(u,v){_t.call(this),this.g=new Bv(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(u?u["X-WebChannel-Client-Profile"]=v.va:u={"X-WebChannel-Client-Profile":v.va}),this.g.S=u,(u=v&&v.Sb)&&!E(u)&&(this.g.m=u),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!E(v)&&(this.g.D=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new ho(this)}g(gn,_t),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){cd(this.g)},gn.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var T={};T.__data__=u,u=T}else this.u&&(T={},T.__data__=oo(u),u=T);v.i.push(new fa(v.Ya++,u)),v.G==3&&sf(v)},gn.prototype.N=function(){this.g.l=null,delete this.j,cd(this.g),delete this.g,gn.aa.N.call(this)};function Qv(u){Fl.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const T in v){u=T;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}g(Qv,Fl);function Jv(){hs.call(this),this.status=1}g(Jv,hs);function ho(u){this.g=u}g(ho,Yv),ho.prototype.ua=function(){Ht(this.g,"a")},ho.prototype.ta=function(u){Ht(this.g,new Qv(u))},ho.prototype.sa=function(u){Ht(this.g,new Jv)},ho.prototype.ra=function(){Ht(this.g,"b")},of.prototype.createWebChannel=of.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,$T=function(){return new of},zT=function(){return co()},HT=Fi,dm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,sh=L,U.COMPLETE="complete",WT=U,Pl.EventType=la,la.OPEN="a",la.CLOSE="b",la.ERROR="c",la.MESSAGE="d",_t.prototype.listen=_t.prototype.K,tc=Pl,Vt.prototype.listenOnce=Vt.prototype.L,Vt.prototype.getLastError=Vt.prototype.Ka,Vt.prototype.getLastErrorCode=Vt.prototype.Ba,Vt.prototype.getStatus=Vt.prototype.Z,Vt.prototype.getResponseJson=Vt.prototype.Oa,Vt.prototype.getResponseText=Vt.prototype.oa,Vt.prototype.send=Vt.prototype.ea,Vt.prototype.setWithCredentials=Vt.prototype.Ha,jT=Vt}).apply(typeof If<"u"?If:typeof self<"u"?self:typeof window<"u"?window:{});const Vx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Or.UNAUTHENTICATED=new Or(null),Or.GOOGLE_CREDENTIALS=new Or("google-credentials-uid"),Or.FIRST_PARTY=new Or("first-party-uid"),Or.MOCK_USER=new Or("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=new Og("@firebase/firestore");function Kl(){return Ua.logLevel}function Re(t,...e){if(Ua.logLevel<=Je.DEBUG){const r=e.map(Xg);Ua.debug(`Firestore (${El}): ${t}`,...r)}}function ns(t,...e){if(Ua.logLevel<=Je.ERROR){const r=e.map(Xg);Ua.error(`Firestore (${El}): ${t}`,...r)}}function ll(t,...e){if(Ua.logLevel<=Je.WARN){const r=e.map(Xg);Ua.warn(`Firestore (${El}): ${t}`,...r)}}function Xg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(t="Unexpected state"){const e=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: `+t;throw ns(e),new Error(e)}function ht(t,e){t||Be()}function je(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends os{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class o3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Or.UNAUTHENTICATED))}shutdown(){}}class l3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class c3{constructor(e){this.t=e,this.currentUser=Or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ht(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Ki;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ki,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ki)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ht(typeof n.accessToken=="string"),new GT(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ht(e===null||typeof e=="string"),new Or(e)}}class u3{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Or.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class f3{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new u3(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Or.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class h3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class d3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){ht(this.o===void 0);const n=s=>{s.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ht(typeof r.token=="string"),this.R=r.token,new h3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=p3(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function st(t,e){return t<e?-1:t>e?1:0}function cl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ie(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ie(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ie(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return sr.fromMillis(Date.now())}static fromDate(e){return sr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new sr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new sr(0,0))}static max(){return new Ue(new sr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Be(),n===void 0?n=e.length-r:n>e.length-r&&Be(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Yc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Yc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Et extends Yc{construct(e,r,n){return new Et(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ie(ue.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Et(r)}static emptyPath(){return new Et([])}}const m3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Er extends Yc{construct(e,r,n){return new Er(e,r,n)}static isValidIdentifier(e){return m3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Er.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Er(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Ie(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Ie(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ie(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Ie(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Er(r)}static emptyPath(){return new Er([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.path=e}static fromPath(e){return new De(Et.fromString(e))}static fromName(e){return new De(Et.fromString(e).popFirst(5))}static empty(){return new De(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Et.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new Et(e.slice()))}}function g3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(n===1e9?new sr(r+1,0):new sr(r,n));return new Gs(i,De.empty(),e)}function v3(t){return new Gs(t.readTime,t.key,-1)}class Gs{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Gs(Ue.min(),De.empty(),-1)}static max(){return new Gs(Ue.max(),De.empty(),-1)}}function _3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=De.comparator(t.documentKey,e.documentKey),r!==0?r:st(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class y3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iu(t){if(t.code!==ue.FAILED_PRECONDITION||t.message!==x3)throw t;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Be(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new he((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof he?r:he.resolve(r)}catch(r){return he.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):he.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):he.reject(r)}static resolve(e){return new he((r,n)=>{r(e)})}static reject(e){return new he((r,n)=>{n(e)})}static waitFor(e){return new he((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=he.resolve(!1);for(const n of e)r=r.next(i=>i?he.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new he((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(f=>{a[c]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new he((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function w3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Cu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}qg.oe=-1;function D0(t){return t==null}function Wh(t){return t===0&&1/t==-1/0}function E3(t){return typeof t=="number"&&Number.isInteger(t)&&!Wh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ja(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function XT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,r){this.comparator=e,this.root=r||yr.EMPTY}insert(e,r){return new Lt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,yr.BLACK,null,null))}remove(e){return new Lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cf(this.root,e,this.comparator,!0)}}class Cf{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??yr.RED,this.left=i??yr.EMPTY,this.right=s??yr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new yr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return yr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return yr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Be();const e=this.left.check();if(e!==this.right.check())throw Be();return e+(this.isRed()?0:1)}}yr.EMPTY=null,yr.RED=!0,yr.BLACK=!1;yr.EMPTY=new class{constructor(){this.size=0}get key(){throw Be()}get value(){throw Be()}get color(){throw Be()}get left(){throw Be()}get right(){throw Be()}copy(e,r,n,i,s){return this}insert(e,r,n){return new yr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.comparator=e,this.data=new Lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Ux(this.data.getIterator())}getIteratorFrom(e){return new Ux(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Sr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Sr(this.comparator);return r.data=e,r}}class Ux{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.fields=e,e.sort(Er.comparator)}static empty(){return new Tn([])}unionWith(e){let r=new Sr(Er.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Tn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return cl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new qT("Invalid base64 string: "+s):s}}(e);return new Ir(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ir(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ir.EMPTY_BYTE_STRING=new Ir("");const T3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ks(t){if(ht(!!t),typeof t=="string"){let e=0;const r=T3.exec(t);if(ht(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:$t(t.seconds),nanos:$t(t.nanos)}}function $t(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ja(t){return typeof t=="string"?Ir.fromBase64String(t):Ir.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Qg(t){const e=t.mapValue.fields.__previous_value__;return Yg(e)?Qg(e):e}function Qc(t){const e=Ks(t.mapValue.fields.__local_write_time__.timestampValue);return new sr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Jc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Jc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Jc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf={mapValue:{}};function Wa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Yg(t)?4:A3(t)?9007199254740991:S3(t)?10:11:Be()}function Ai(t,e){if(t===e)return!0;const r=Wa(t);if(r!==Wa(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qc(t).isEqual(Qc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ks(i.timestampValue),o=Ks(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ja(i.bytesValue).isEqual(ja(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return $t(i.geoPointValue.latitude)===$t(s.geoPointValue.latitude)&&$t(i.geoPointValue.longitude)===$t(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return $t(i.integerValue)===$t(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=$t(i.doubleValue),o=$t(s.doubleValue);return a===o?Wh(a)===Wh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return cl(t.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Bx(a)!==Bx(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ai(a[l],o[l])))return!1;return!0}(t,e);default:return Be()}}function Zc(t,e){return(t.values||[]).find(r=>Ai(r,e))!==void 0}function ul(t,e){if(t===e)return 0;const r=Wa(t),n=Wa(e);if(r!==n)return st(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return st(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=$t(s.integerValue||s.doubleValue),l=$t(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return jx(t.timestampValue,e.timestampValue);case 4:return jx(Qc(t),Qc(e));case 5:return st(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ja(s),l=ja(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=st(o[c],l[c]);if(f!==0)return f}return st(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=st($t(s.latitude),$t(a.latitude));return o!==0?o:st($t(s.longitude),$t(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Wx(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,f;const h=s.fields||{},d=a.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,g=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=st(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((f=g==null?void 0:g.values)===null||f===void 0?void 0:f.length)||0);return m!==0?m:Wx(p,g)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Rf.mapValue&&a===Rf.mapValue)return 0;if(s===Rf.mapValue)return 1;if(a===Rf.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=st(l[h],f[h]);if(d!==0)return d;const p=ul(o[l[h]],c[f[h]]);if(p!==0)return p}return st(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Be()}}function jx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return st(t,e);const r=Ks(t),n=Ks(e),i=st(r.seconds,n.seconds);return i!==0?i:st(r.nanos,n.nanos)}function Wx(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=ul(r[i],n[i]);if(s)return s}return st(r.length,n.length)}function fl(t){return pm(t)}function pm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ks(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ja(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return De.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=pm(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${pm(r.fields[a])}`;return i+"}"}(t.mapValue):Be()}function Hx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mm(t){return!!t&&"integerValue"in t}function Jg(t){return!!t&&"arrayValue"in t}function zx(t){return!!t&&"nullValue"in t}function $x(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ah(t){return!!t&&"mapValue"in t}function S3(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function xc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ja(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=xc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=xc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function A3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ah(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=xc(r)}setAll(e){let r=Er.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=xc(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());ah(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];ah(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ja(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new on(xc(this.value))}}function YT(t){const e=[];return Ja(t.fields,(r,n)=>{const i=new Er([r]);if(ah(n)){const s=YT(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vr(e,0,Ue.min(),Ue.min(),Ue.min(),on.empty(),0)}static newFoundDocument(e,r,n,i){return new Vr(e,1,r,Ue.min(),n,i,0)}static newNoDocument(e,r){return new Vr(e,2,r,Ue.min(),Ue.min(),on.empty(),0)}static newUnknownDocument(e,r){return new Vr(e,3,r,Ue.min(),Ue.min(),on.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,r){this.position=e,this.inclusive=r}}function Gx(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=De.comparator(De.fromName(a.referenceValue),r.key):n=ul(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Kx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ai(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,r="asc"){this.field=e,this.dir=r}}function I3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{}class tr extends QT{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new R3(e,r,n):r==="array-contains"?new N3(e,n):r==="in"?new D3(e,n):r==="not-in"?new O3(e,n):r==="array-contains-any"?new b3(e,n):new tr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new P3(e,n):new F3(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ul(r,this.value)):r!==null&&Wa(this.value)===Wa(r)&&this.matchesComparison(ul(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class li extends QT{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new li(e,r)}matches(e){return JT(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function JT(t){return t.op==="and"}function ZT(t){return C3(t)&&JT(t)}function C3(t){for(const e of t.filters)if(e instanceof li)return!1;return!0}function gm(t){if(t instanceof tr)return t.field.canonicalString()+t.op.toString()+fl(t.value);if(ZT(t))return t.filters.map(e=>gm(e)).join(",");{const e=t.filters.map(r=>gm(r)).join(",");return`${t.op}(${e})`}}function ek(t,e){return t instanceof tr?function(n,i){return i instanceof tr&&n.op===i.op&&n.field.isEqual(i.field)&&Ai(n.value,i.value)}(t,e):t instanceof li?function(n,i){return i instanceof li&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&ek(a,i.filters[o]),!0):!1}(t,e):void Be()}function tk(t){return t instanceof tr?function(r){return`${r.field.canonicalString()} ${r.op} ${fl(r.value)}`}(t):t instanceof li?function(r){return r.op.toString()+" {"+r.getFilters().map(tk).join(" ,")+"}"}(t):"Filter"}class R3 extends tr{constructor(e,r,n){super(e,r,n),this.key=De.fromName(n.referenceValue)}matches(e){const r=De.comparator(e.key,this.key);return this.matchesComparison(r)}}class P3 extends tr{constructor(e,r){super(e,"in",r),this.keys=rk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class F3 extends tr{constructor(e,r){super(e,"not-in",r),this.keys=rk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function rk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>De.fromName(n.referenceValue))}class N3 extends tr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Jg(r)&&Zc(r.arrayValue,this.value)}}class D3 extends tr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Zc(this.value.arrayValue,r)}}class O3 extends tr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Zc(this.value.arrayValue,r)}}class b3 extends tr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Jg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Zc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function Xx(t,e=null,r=[],n=[],i=null,s=null,a=null){return new L3(t,e,r,n,i,s,a)}function Zg(t){const e=je(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>gm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),D0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>fl(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>fl(n)).join(",")),e.ue=r}return e.ue}function e1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!I3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!ek(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Kx(t.startAt,e.startAt)&&Kx(t.endAt,e.endAt)}function vm(t){return De.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function M3(t,e,r,n,i,s,a,o){return new Ru(t,e,r,n,i,s,a,o)}function O0(t){return new Ru(t)}function qx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nk(t){return t.collectionGroup!==null}function yc(t){const e=je(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Sr(Er.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new zh(s,n))}),r.has(Er.keyField().canonicalString())||e.ce.push(new zh(Er.keyField(),n))}return e.ce}function ki(t){const e=je(t);return e.le||(e.le=V3(e,yc(t))),e.le}function V3(t,e){if(t.limitType==="F")return Xx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new zh(i.field,s)});const r=t.endAt?new Hh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Hh(t.startAt.position,t.startAt.inclusive):null;return Xx(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function _m(t,e){const r=t.filters.concat([e]);return new Ru(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function xm(t,e,r){return new Ru(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function b0(t,e){return e1(ki(t),ki(e))&&t.limitType===e.limitType}function ik(t){return`${Zg(ki(t))}|lt:${t.limitType}`}function xo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>tk(i)).join(", ")}]`),D0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>fl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>fl(i)).join(",")),`Target(${n})`}(ki(t))}; limitType=${t.limitType})`}function L0(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):De.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of yc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=Gx(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,yc(n),i)||n.endAt&&!function(a,o,l){const c=Gx(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,yc(n),i))}(t,e)}function B3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function sk(t){return(e,r)=>{let n=!1;for(const i of yc(t)){const s=U3(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function U3(t,e,r){const n=t.field.isKeyField()?De.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?ul(l,c):Be()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Be()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ja(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return XT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3=new Lt(De.comparator);function is(){return j3}const ak=new Lt(De.comparator);function rc(...t){let e=ak;for(const r of t)e=e.insert(r.key,r);return e}function ok(t){let e=ak;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ea(){return wc()}function lk(){return wc()}function wc(){return new Tl(t=>t.toString(),(t,e)=>t.isEqual(e))}const W3=new Lt(De.comparator),H3=new Sr(De.comparator);function Qe(...t){let e=H3;for(const r of t)e=e.add(r);return e}const z3=new Sr(st);function $3(){return z3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wh(e)?"-0":e}}function ck(t){return{integerValue:""+t}}function G3(t,e){return E3(e)?ck(e):t1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(){this._=void 0}}function K3(t,e,r){return t instanceof $h?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Yg(s)&&(s=Qg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof eu?fk(t,e):t instanceof tu?hk(t,e):function(i,s){const a=uk(i,s),o=Yx(a)+Yx(i.Pe);return mm(a)&&mm(i.Pe)?ck(o):t1(i.serializer,o)}(t,e)}function X3(t,e,r){return t instanceof eu?fk(t,e):t instanceof tu?hk(t,e):r}function uk(t,e){return t instanceof Gh?function(n){return mm(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class $h extends M0{}class eu extends M0{constructor(e){super(),this.elements=e}}function fk(t,e){const r=dk(e);for(const n of t.elements)r.some(i=>Ai(i,n))||r.push(n);return{arrayValue:{values:r}}}class tu extends M0{constructor(e){super(),this.elements=e}}function hk(t,e){let r=dk(e);for(const n of t.elements)r=r.filter(i=>!Ai(i,n));return{arrayValue:{values:r}}}class Gh extends M0{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Yx(t){return $t(t.integerValue||t.doubleValue)}function dk(t){return Jg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function q3(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof eu&&i instanceof eu||n instanceof tu&&i instanceof tu?cl(n.elements,i.elements,Ai):n instanceof Gh&&i instanceof Gh?Ai(n.Pe,i.Pe):n instanceof $h&&i instanceof $h}(t.transform,e.transform)}class Y3{constructor(e,r){this.version=e,this.transformResults=r}}class Jr{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Jr}static exists(e){return new Jr(void 0,e)}static updateTime(e){return new Jr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class V0{}function pk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new B0(t.key,Jr.none()):new Pu(t.key,t.data,Jr.none());{const r=t.data,n=on.empty();let i=new Sr(Er.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new na(t.key,n,new Tn(i.toArray()),Jr.none())}}function Q3(t,e,r){t instanceof Pu?function(i,s,a){const o=i.value.clone(),l=Jx(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof na?function(i,s,a){if(!oh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=Jx(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(mk(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Ec(t,e,r,n){return t instanceof Pu?function(s,a,o,l){if(!oh(s.precondition,a))return o;const c=s.value.clone(),f=Zx(s.fieldTransforms,l,a);return c.setAll(f),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof na?function(s,a,o,l){if(!oh(s.precondition,a))return o;const c=Zx(s.fieldTransforms,l,a),f=a.data;return f.setAll(mk(s)),f.setAll(c),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return oh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function J3(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=uk(n.transform,i||null);s!=null&&(r===null&&(r=on.empty()),r.set(n.field,s))}return r||null}function Qx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&cl(n,i,(s,a)=>q3(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Pu extends V0{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class na extends V0{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function mk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Jx(t,e,r){const n=new Map;ht(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,X3(a,o,r[i]))}return n}function Zx(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,K3(s,a,e))}return n}class B0 extends V0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Z3 extends V0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Q3(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ec(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ec(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=lk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=pk(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Qe())}isEqual(e){return this.batchId===e.batchId&&cl(this.mutations,e.mutations,(r,n)=>Qx(r,n))&&cl(this.baseMutations,e.baseMutations,(r,n)=>Qx(r,n))}}class r1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){ht(e.mutations.length===n.length);let i=function(){return W3}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new r1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt,Ze;function nD(t){switch(t){default:return Be();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function gk(t){if(t===void 0)return ns("GRPC error has no .code"),ue.UNKNOWN;switch(t){case Qt.OK:return ue.OK;case Qt.CANCELLED:return ue.CANCELLED;case Qt.UNKNOWN:return ue.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return ue.INTERNAL;case Qt.UNAVAILABLE:return ue.UNAVAILABLE;case Qt.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Qt.NOT_FOUND:return ue.NOT_FOUND;case Qt.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Qt.ABORTED:return ue.ABORTED;case Qt.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Qt.DATA_LOSS:return ue.DATA_LOSS;default:return Be()}}(Ze=Qt||(Qt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new Aa([4294967295,4294967295],0);function ey(t){const e=iD().encode(t),r=new UT;return r.update(e),new Uint8Array(r.digest())}function ty(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Aa([r,n],0),new Aa([i,s],0)]}class n1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new nc(`Invalid padding: ${r}`);if(n<0)throw new nc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new nc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new nc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Aa.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Aa.fromNumber(n)));return i.compare(sD)===1&&(i=new Aa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=ey(e),[n,i]=ty(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n1(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=ey(e),[n,i]=ty(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Fu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new U0(Ue.min(),i,new Lt(st),is(),Qe())}}class Fu{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Fu(n,r,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class vk{constructor(e,r){this.targetId=e,this.me=r}}class _k{constructor(e,r,n=Ir.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ry{constructor(){this.fe=0,this.ge=iy(),this.pe=Ir.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Qe(),r=Qe(),n=Qe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Be()}}),new Fu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=iy()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ht(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class aD{constructor(e){this.Le=e,this.Be=new Map,this.ke=is(),this.qe=ny(),this.Qe=new Lt(st)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Be()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(vm(s))if(n===0){const a=new De(s.path);this.Ue(r,a,Vr.newNoDocument(a,Ue.min()))}else ht(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ja(n).toUint8Array()}catch(l){if(l instanceof qT)return ll("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new n1(a,i,s)}catch(l){return ll(l instanceof nc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&vm(o.target)){const l=new De(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Vr.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Qe();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new U0(e,r,this.Qe,this.ke,n);return this.ke=is(),this.qe=ny(),this.Qe=new Lt(st),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new ry,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Sr(st),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Re("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ry),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function ny(){return new Lt(De.comparator)}function iy(){return new Lt(De.comparator)}const oD={asc:"ASCENDING",desc:"DESCENDING"},lD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cD={and:"AND",or:"OR"};class uD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function ym(t,e){return t.useProto3Json||D0(e)?e:{value:e}}function Kh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fD(t,e){return Kh(t,e.toTimestamp())}function Si(t){return ht(!!t),Ue.fromTimestamp(function(r){const n=Ks(r);return new sr(n.seconds,n.nanos)}(t))}function i1(t,e){return wm(t,e).canonicalString()}function wm(t,e){const r=function(i){return new Et(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function yk(t){const e=Et.fromString(t);return ht(Sk(e)),e}function Em(t,e){return i1(t.databaseId,e.path)}function Gd(t,e){const r=yk(e);if(r.get(1)!==t.databaseId.projectId)throw new Ie(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ie(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new De(Ek(r))}function wk(t,e){return i1(t.databaseId,e)}function hD(t){const e=yk(t);return e.length===4?Et.emptyPath():Ek(e)}function Tm(t){return new Et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ek(t){return ht(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function sy(t,e,r){return{name:Em(t,e),fields:r.value.mapValue.fields}}function dD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Be()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,f){return c.useProto3Json?(ht(f===void 0||typeof f=="string"),Ir.fromBase64String(f||"")):(ht(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ir.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const f=c.code===void 0?ue.UNKNOWN:gk(c.code);return new Ie(f,c.message||"")}(a);r=new _k(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gd(t,n.document.name),s=Si(n.document.updateTime),a=n.document.createTime?Si(n.document.createTime):Ue.min(),o=new on({mapValue:{fields:n.document.fields}}),l=Vr.newFoundDocument(i,s,a,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new lh(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Gd(t,n.document),s=n.readTime?Si(n.readTime):Ue.min(),a=Vr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new lh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Gd(t,n.document),s=n.removedTargetIds||[];r=new lh([],s,i,null)}else{if(!("filter"in e))return Be();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new rD(i,s),o=n.targetId;r=new vk(o,a)}}return r}function pD(t,e){let r;if(e instanceof Pu)r={update:sy(t,e.key,e.value)};else if(e instanceof B0)r={delete:Em(t,e.key)};else if(e instanceof na)r={update:sy(t,e.key,e.data),updateMask:TD(e.fieldMask)};else{if(!(e instanceof Z3))return Be();r={verify:Em(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof $h)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof eu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof tu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Gh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Be()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:fD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Be()}(t,e.precondition)),r}function mD(t,e){return t&&t.length>0?(ht(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Si(i.updateTime):Si(s);return a.isEqual(Ue.min())&&(a=Si(s)),new Y3(a,i.transformResults||[])}(r,e))):[]}function gD(t,e){return{documents:[wk(t,e.path)]}}function vD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=wk(t,i);const s=function(c){if(c.length!==0)return kk(li.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:yo(d.field),direction:yD(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=ym(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function _D(t){let e=hD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){ht(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=Tk(h);return d instanceof li&&ZT(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(g){return new zh(wo(g.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,D0(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new Hh(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new Hh(p,d)}(r.endAt)),M3(e,i,a,s,o,"F",l,c)}function xD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Tk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=wo(r.unaryFilter.field);return tr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=wo(r.unaryFilter.field);return tr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=wo(r.unaryFilter.field);return tr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=wo(r.unaryFilter.field);return tr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Be()}}(t):t.fieldFilter!==void 0?function(r){return tr.create(wo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Be()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return li.create(r.compositeFilter.filters.map(n=>Tk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Be()}}(r.compositeFilter.op))}(t):Be()}function yD(t){return oD[t]}function wD(t){return lD[t]}function ED(t){return cD[t]}function yo(t){return{fieldPath:t.canonicalString()}}function wo(t){return Er.fromServerFormat(t.fieldPath)}function kk(t){return t instanceof tr?function(r){if(r.op==="=="){if($x(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NAN"}};if(zx(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if($x(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NOT_NAN"}};if(zx(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(r.field),op:wD(r.op),value:r.value}}}(t):t instanceof li?function(r){const n=r.getFilters().map(i=>kk(i));return n.length===1?n[0]:{compositeFilter:{op:ED(r.op),filters:n}}}(t):Be()}function TD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Sk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,r,n,i,s=Ue.min(),a=Ue.min(),o=Ir.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Rs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Rs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e){this.ct=e}}function SD(t){const e=_D({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(){this.un=new ID}addToCollectionParentIndex(e,r){return this.un.add(r),he.resolve()}getCollectionParents(e,r){return he.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return he.resolve()}deleteFieldIndex(e,r){return he.resolve()}deleteAllFieldIndexes(e){return he.resolve()}createTargetIndexes(e,r){return he.resolve()}getDocumentsMatchingTarget(e,r){return he.resolve(null)}getIndexType(e,r){return he.resolve(0)}getFieldIndexes(e,r){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,r){return he.resolve(Gs.min())}getMinOffsetFromCollectionGroup(e,r){return he.resolve(Gs.min())}updateCollectionGroup(e,r,n){return he.resolve()}updateIndexEntries(e,r){return he.resolve()}}class ID{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Sr(Et.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Sr(Et.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new hl(0)}static kn(){return new hl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.changes=new Tl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Vr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?he.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Ec(n.mutation,i,Tn.empty(),sr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Qe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Qe()){const i=Ea();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=rc();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ea();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Qe()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=is();const a=wc(),o=function(){return wc()}();return r.forEach((l,c)=>{const f=n.get(c.key);i.has(c.key)&&(f===void 0||f.mutation instanceof na)?s=s.insert(c.key,c):f!==void 0?(a.set(c.key,f.mutation.getFieldMask()),Ec(f.mutation,c,f.mutation.getFieldMask(),sr.now())):a.set(c.key,Tn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,f)=>a.set(c,f)),r.forEach((c,f)=>{var h;return o.set(c,new RD(f,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=wc();let i=new Lt((a,o)=>a-o),s=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||Tn.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(i.get(o.batchId)||Qe()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=lk();f.forEach(d=>{if(!s.has(d)){const p=pk(r.get(d),n.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return he.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return De.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):nk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):he.resolve(Ea());let o=-1,l=s;return a.next(c=>he.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?he.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Qe())).next(f=>({batchId:o,changes:ok(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new De(r)).next(n=>{let i=rc();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=rc();return this.indexManager.getCollectionParents(e,s).next(o=>he.forEach(o,l=>{const c=function(h,d){return new Ru(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const f=c.getKey();a.get(f)===null&&(a=a.insert(f,Vr.newInvalidDocument(f)))});let o=rc();return a.forEach((l,c)=>{const f=s.get(l);f!==void 0&&Ec(f.mutation,c,Tn.empty(),sr.now()),L0(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return he.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Si(i.createTime)}}(r)),he.resolve()}getNamedQuery(e,r){return he.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:SD(i.bundledQuery),readTime:Si(i.readTime)}}(r)),he.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(){this.overlays=new Lt(De.comparator),this.Ir=new Map}getOverlay(e,r){return he.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ea();return he.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),he.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),he.resolve()}getOverlaysForCollection(e,r,n){const i=Ea(),s=r.length+1,a=new De(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return he.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Lt((c,f)=>c-f);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=s.get(c.largestBatchId);f===null&&(f=Ea(),s=s.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=Ea(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=i)););return he.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new tD(r,n));let s=this.Ir.get(r);s===void 0&&(s=Qe(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(){this.sessionToken=Ir.EMPTY_BYTE_STRING}getSessionToken(e){return he.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,he.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(){this.Tr=new Sr(lr.Er),this.dr=new Sr(lr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new lr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new lr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new De(new Et([])),n=new lr(r,e),i=new lr(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new De(new Et([])),n=new lr(r,e),i=new lr(r,e+1);let s=Qe();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new lr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class lr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return De.comparator(e.key,r.key)||st(e.wr,r.wr)}static Ar(e,r){return st(e.wr,r.wr)||De.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Sr(lr.Er)}checkEmpty(e){return he.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new eD(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new lr(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return he.resolve(a)}lookupMutationBatch(e,r){return he.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return he.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),he.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Sr(st);return r.forEach(i=>{const s=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),he.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;De.isDocumentKey(s)||(s=s.child(""));const a=new lr(new De(s),0);let o=new Sr(st);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),he.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){ht(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return he.forEach(r.mutations,i=>{const s=new lr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new lr(r,0),i=this.br.firstAfterOrEqual(n);return he.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,he.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e){this.Mr=e,this.docs=function(){return new Lt(De.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return he.resolve(n?n.document.mutableCopy():Vr.newInvalidDocument(r))}getEntries(e,r){let n=is();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Vr.newInvalidDocument(i))}),he.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=is();const a=r.path,o=new De(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||_3(v3(f),n)<=0||(i.has(f.key)||L0(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return he.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Be()}Or(e,r){return he.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new LD(this)}getSize(e){return he.resolve(this.size)}}class LD extends CD{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),he.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.persistence=e,this.Nr=new Tl(r=>Zg(r),e1),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new s1,this.targetCount=0,this.kr=hl.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),he.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new hl(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,he.resolve()}updateTargetData(e,r){return this.Kn(r),he.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),he.waitFor(s).next(()=>i)}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return he.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),he.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),he.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),he.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return he.resolve(n)}containsKey(e,r){return he.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,r){this.qr={},this.overlays={},this.Qr=new qg(0),this.Kr=!1,this.Kr=!0,this.$r=new DD,this.referenceDelegate=e(this),this.Ur=new MD(this),this.indexManager=new AD,this.remoteDocumentCache=function(i){return new bD(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new kD(r),this.Gr=new FD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new ND,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new OD(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Re("MemoryPersistence","Starting transaction:",e);const i=new BD(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return he.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class BD extends y3{constructor(e){super(),this.currentSequenceNumber=e}}class a1{constructor(e){this.persistence=e,this.Jr=new s1,this.Yr=null}static Zr(e){return new a1(e)}get Xr(){if(this.Yr)return this.Yr;throw Be()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),he.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),he.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),he.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.Xr,n=>{const i=De.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Ue.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return he.or([()=>he.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Qe(),i=Qe();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new o1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return SR()?8:w3(zr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new UD;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Kl()<=Je.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",xo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),he.resolve()):(Kl()<=Je.DEBUG&&Re("QueryEngine","Query:",xo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Kl()<=Je.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",xo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ki(r))):he.resolve())}Yi(e,r){if(qx(r))return he.resolve(null);let n=ki(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=xm(r,null,"F"),n=ki(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Qe(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,xm(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return qx(r)||i.isEqual(Ue.min())?he.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?he.resolve(null):(Kl()<=Je.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xo(r)),this.rs(e,a,r,g3(i,-1)).next(o=>o))})}ts(e,r){let n=new Sr(sk(e));return r.forEach((i,s)=>{L0(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Kl()<=Je.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",xo(r)),this.Ji.getDocumentsMatchingQuery(e,r,Gs.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Lt(st),this._s=new Tl(s=>Zg(s),e1),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PD(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function HD(t,e,r,n){return new WD(t,e,r,n)}async function Ak(t,e){const r=je(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Qe();for(const c of i){a.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of s){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function zD(t,e){const r=je(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let p=he.resolve();return d.forEach(g=>{p=p.next(()=>f.getEntry(l,g)).next(m=>{const _=c.docVersions.get(g);ht(_!==null),m.version.compareTo(_)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),f.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Qe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Ik(t){const e=je(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function $D(t,e){const r=je(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Ir.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),i=i.insert(h,p),function(m,_,w){return m.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(d,p,f)&&o.push(r.Ur.updateTargetData(s,p))});let l=is(),c=Qe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(GD(s,a,e.documentUpdates).next(f=>{l=f.Ps,c=f.Is})),!n.isEqual(Ue.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return he.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function GD(t,e,r){let n=Qe(),i=Qe();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=is();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ue.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Re("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function KD(t,e){const r=je(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function XD(t,e){const r=je(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,he.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Rs(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function km(t,e,r){const n=je(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Cu(a))throw a;Re("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function ay(t,e,r){const n=je(t);let i=Ue.min(),s=Qe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,f){const h=je(l),d=h._s.get(f);return d!==void 0?he.resolve(h.os.get(d)):h.Ur.getTargetData(c,f)}(n,a,ki(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Ue.min(),r?s:Qe())).next(o=>(qD(n,B3(e),o),{documents:o,Ts:s})))}function qD(t,e,r){let n=t.us.get(e)||Ue.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class oy{constructor(){this.activeTargetIds=$3()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YD{constructor(){this.so=new oy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new oy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pf=null;function Kd(){return Pf===null?Pf=function(){return 268435456+Math.round(2147483648*Math.random())}():Pf++,"0x"+Pf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="WebChannelConnection";class eO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Kd(),l=this.xo(r,n.toUriEncodedString());Re("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(f=>(Re("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw ll("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+El}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=JD[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Kd();return new Promise((a,o)=>{const l=new jT;l.setWithCredentials(!0),l.listenOnce(WT.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case sh.NO_ERROR:const f=l.getResponseJson();Re(Nr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case sh.TIMEOUT:Re(Nr,`RPC '${e}' ${s} timed out`),o(new Ie(ue.DEADLINE_EXCEEDED,"Request time out"));break;case sh.HTTP_ERROR:const h=l.getStatus();if(Re(Nr,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const g=function(_){const w=_.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(w)>=0?w:ue.UNKNOWN}(p.status);o(new Ie(g,p.message))}else o(new Ie(ue.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ie(ue.UNAVAILABLE,"Connection failed."));break;default:Be()}}finally{Re(Nr,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Re(Nr,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Kd(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=$T(),o=zT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Re(Nr,`Creating RPC '${e}' stream ${i}: ${f}`,l);const h=a.createWebChannel(f,l);let d=!1,p=!1;const g=new ZD({Io:_=>{p?Re(Nr,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(d||(Re(Nr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Re(Nr,`RPC '${e}' stream ${i} sending:`,_),h.send(_))},To:()=>h.close()}),m=(_,w,E)=>{_.listen(w,x=>{try{E(x)}catch(P){setTimeout(()=>{throw P},0)}})};return m(h,tc.EventType.OPEN,()=>{p||(Re(Nr,`RPC '${e}' stream ${i} transport opened.`),g.yo())}),m(h,tc.EventType.CLOSE,()=>{p||(p=!0,Re(Nr,`RPC '${e}' stream ${i} transport closed`),g.So())}),m(h,tc.EventType.ERROR,_=>{p||(p=!0,ll(Nr,`RPC '${e}' stream ${i} transport errored:`,_),g.So(new Ie(ue.UNAVAILABLE,"The operation could not be completed")))}),m(h,tc.EventType.MESSAGE,_=>{var w;if(!p){const E=_.data[0];ht(!!E);const x=E,P=x.error||((w=x[0])===null||w===void 0?void 0:w.error);if(P){Re(Nr,`RPC '${e}' stream ${i} received error:`,P);const W=P.status;let M=function(S){const I=Qt[S];if(I!==void 0)return gk(I)}(W),y=P.message;M===void 0&&(M=ue.INTERNAL,y="Unknown error status: "+W+" with message "+P.message),p=!0,g.So(new Ie(M,y)),h.close()}else Re(Nr,`RPC '${e}' stream ${i} received:`,E),g.bo(E)}}),m(o,HT.STAT_EVENT,_=>{_.stat===dm.PROXY?Re(Nr,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===dm.NOPROXY&&Re(Nr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function Xd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(t){return new uD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ck(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===ue.RESOURCE_EXHAUSTED?(ns(r.toString()),ns("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new Ie(ue.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tO extends Rk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=dD(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?Si(a.readTime):Ue.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Tm(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=vm(l)?{documents:gD(s,l)}:{query:vD(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=xk(s,a.resumeToken);const c=ym(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ue.min())>0){o.readTime=Kh(s,a.snapshotVersion.toTimestamp());const c=ym(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=xD(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Tm(this.serializer),r.removeTarget=e,this.a_(r)}}class rO extends Rk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return ht(!!e.streamToken),this.lastStreamToken=e.streamToken,ht(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ht(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=mD(e.writeResults,e.commitTime),n=Si(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Tm(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>pD(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Ie(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,wm(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ie(ue.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,wm(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(ue.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class iO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ns(r),this.D_=!1):Re("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Za(this)&&(Re("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=je(l);c.L_.add(4),await Nu(c),c.q_.set("Unknown"),c.L_.delete(4),await W0(c)}(this))})}),this.q_=new iO(n,i)}}async function W0(t){if(Za(t))for(const e of t.B_)await e(!0)}async function Nu(t){for(const e of t.B_)await e(!1)}function Pk(t,e){const r=je(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),f1(r)?u1(r):kl(r).r_()&&c1(r,e))}function l1(t,e){const r=je(t),n=kl(r);r.N_.delete(e),n.r_()&&Fk(r,e),r.N_.size===0&&(n.r_()?n.o_():Za(r)&&r.q_.set("Unknown"))}function c1(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}kl(t).A_(e)}function Fk(t,e){t.Q_.xe(e),kl(t).R_(e)}function u1(t){t.Q_=new aD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),kl(t).start(),t.q_.v_()}function f1(t){return Za(t)&&!kl(t).n_()&&t.N_.size>0}function Za(t){return je(t).L_.size===0}function Nk(t){t.Q_=void 0}async function aO(t){t.q_.set("Online")}async function oO(t){t.N_.forEach((e,r)=>{c1(t,e)})}async function lO(t,e){Nk(t),f1(t)?(t.q_.M_(e),u1(t)):t.q_.set("Unknown")}async function cO(t,e,r){if(t.q_.set("Online"),e instanceof _k&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Xh(t,n)}else if(e instanceof lh?t.Q_.Ke(e):e instanceof vk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ue.min()))try{const n=await Ik(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(c);f&&s.N_.set(c,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(Ir.EMPTY_BYTE_STRING,f.snapshotVersion)),Fk(s,l);const h=new Rs(f.target,l,c,f.sequenceNumber);c1(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Re("RemoteStore","Failed to raise snapshot:",n),await Xh(t,n)}}async function Xh(t,e,r){if(!Cu(e))throw e;t.L_.add(1),await Nu(t),t.q_.set("Offline"),r||(r=()=>Ik(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Re("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await W0(t)})}function Dk(t,e){return e().catch(r=>Xh(t,r,e))}async function H0(t){const e=je(t),r=Xs(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uO(e);)try{const i=await KD(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,fO(e,i)}catch(i){await Xh(e,i)}Ok(e)&&bk(e)}function uO(t){return Za(t)&&t.O_.length<10}function fO(t,e){t.O_.push(e);const r=Xs(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Ok(t){return Za(t)&&!Xs(t).n_()&&t.O_.length>0}function bk(t){Xs(t).start()}async function hO(t){Xs(t).p_()}async function dO(t){const e=Xs(t);for(const r of t.O_)e.m_(r.mutations)}async function pO(t,e,r){const n=t.O_.shift(),i=r1.from(n,e,r);await Dk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await H0(t)}async function mO(t,e){e&&Xs(t).V_&&await async function(n,i){if(function(a){return nD(a)&&a!==ue.ABORTED}(i.code)){const s=n.O_.shift();Xs(n).s_(),await Dk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await H0(n)}}(t,e),Ok(t)&&bk(t)}async function cy(t,e){const r=je(t);r.asyncQueue.verifyOperationInProgress(),Re("RemoteStore","RemoteStore received new credentials");const n=Za(r);r.L_.add(3),await Nu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await W0(r)}async function gO(t,e){const r=je(t);e?(r.L_.delete(2),await W0(r)):e||(r.L_.add(2),await Nu(r),r.q_.set("Unknown"))}function kl(t){return t.K_||(t.K_=function(r,n,i){const s=je(r);return s.w_(),new tO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:aO.bind(null,t),Ro:oO.bind(null,t),mo:lO.bind(null,t),d_:cO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),f1(t)?u1(t):t.q_.set("Unknown")):(await t.K_.stop(),Nk(t))})),t.K_}function Xs(t){return t.U_||(t.U_=function(r,n,i){const s=je(r);return s.w_(),new rO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:hO.bind(null,t),mo:mO.bind(null,t),f_:dO.bind(null,t),g_:pO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await H0(t)):(await t.U_.stop(),t.O_.length>0&&(Re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new h1(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function d1(t,e){if(ns("AsyncQueue",`${e}: ${t}`),Cu(t))return new Ie(ue.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e){this.comparator=e?(r,n)=>e(r,n)||De.comparator(r.key,n.key):(r,n)=>De.comparator(r.key,n.key),this.keyedMap=rc(),this.sortedSet=new Lt(this.comparator)}static emptySet(e){return new Ko(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ko;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(){this.W_=new Lt(De.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Be():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class dl{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new dl(e,r,Ko.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&b0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _O{constructor(){this.queries=fy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=je(r),s=i.queries;i.queries=fy(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ie(ue.ABORTED,"Firestore shutting down"))}}function fy(){return new Tl(t=>ik(t),b0)}async function p1(t,e){const r=je(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new vO,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=d1(a,`Initialization of query '${xo(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&g1(r)}async function m1(t,e){const r=je(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function xO(t,e){const r=je(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&g1(r)}function yO(t,e,r){const n=je(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function g1(t){t.Y_.forEach(e=>{e.next()})}var Sm,hy;(hy=Sm||(Sm={})).ea="default",hy.Cache="cache";class v1{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new dl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=dl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Sm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.key=e}}class Mk{constructor(e){this.key=e}}class wO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Qe(),this.mutatedKeys=Qe(),this.Aa=sk(e),this.Ra=new Ko(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new uy,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),p=L0(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;d&&p?d.data.isEqual(p.data)?g!==m&&(n.track({type:3,doc:p}),_=!0):this.ga(d,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),_=!0):d&&!p&&(n.track({type:1,doc:d}),_=!0,(l||c)&&(o=!0)),_&&(p?(a=a.add(p),s=m?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,h)=>function(p,g){const m=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be()}};return m(p)-m(g)}(f.type,h.type)||this.Aa(f.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new dl(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new uy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Qe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new Mk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new Lk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Qe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return dl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class EO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class TO{constructor(e){this.key=e,this.va=!1}}class kO{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Tl(o=>ik(o),b0),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(De.comparator),this.Na=new Map,this.La=new s1,this.Ba={},this.ka=new Map,this.qa=hl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function SO(t,e,r=!0){const n=Hk(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Vk(n,e,r,!0),i}async function AO(t,e){const r=Hk(t);await Vk(r,e,!0,!1)}async function Vk(t,e,r,n){const i=await XD(t.localStore,ki(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await IO(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Pk(t.remoteStore,i),o}async function IO(t,e,r,n,i){t.Ka=(h,d,p)=>async function(m,_,w,E){let x=_.view.ma(w);x.ns&&(x=await ay(m.localStore,_.query,!1).then(({documents:y})=>_.view.ma(y,x)));const P=E&&E.targetChanges.get(_.targetId),W=E&&E.targetMismatches.get(_.targetId)!=null,M=_.view.applyChanges(x,m.isPrimaryClient,P,W);return py(m,_.targetId,M.wa),M.snapshot}(t,h,d,p);const s=await ay(t.localStore,e,!0),a=new wO(e,s.Ts),o=a.ma(s.documents),l=Fu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);py(t,r,c.wa);const f=new EO(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function CO(t,e,r){const n=je(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!b0(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await km(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&l1(n.remoteStore,i.targetId),Am(n,i.targetId)}).catch(Iu)):(Am(n,i.targetId),await km(n.localStore,i.targetId,!0))}async function RO(t,e){const r=je(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),l1(r.remoteStore,n.targetId))}async function PO(t,e,r){const n=MO(t);try{const i=await function(a,o){const l=je(a),c=sr.now(),f=o.reduce((p,g)=>p.add(g.key),Qe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=is(),m=Qe();return l.cs.getEntries(p,f).next(_=>{g=_,g.forEach((w,E)=>{E.isValidDocument()||(m=m.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(_=>{h=_;const w=[];for(const E of o){const x=J3(E,h.get(E.key).overlayedDocument);x!=null&&w.push(new na(E.key,x,YT(x.value.mapValue),Jr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,w,o)}).next(_=>{d=_;const w=_.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,_.batchId,w)})}).then(()=>({batchId:d.batchId,changes:ok(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Lt(st)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await Du(n,i.changes),await H0(n.remoteStore)}catch(i){const s=d1(i,"Failed to persist write");r.reject(s)}}async function Bk(t,e){const r=je(t);try{const n=await $D(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(ht(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ht(a.va):i.removedDocuments.size>0&&(ht(a.va),a.va=!1))}),await Du(r,n,e)}catch(n){await Iu(n)}}function dy(t,e,r){const n=je(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=je(a);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&g1(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function FO(t,e,r){const n=je(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Lt(De.comparator);a=a.insert(s,Vr.newNoDocument(s,Ue.min()));const o=Qe().add(s),l=new U0(Ue.min(),new Map,new Lt(st),a,o);await Bk(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),_1(n)}else await km(n.localStore,e,!1).then(()=>Am(n,e,r)).catch(Iu)}async function NO(t,e){const r=je(t),n=e.batch.batchId;try{const i=await zD(r.localStore,e);jk(r,n,null),Uk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Du(r,i)}catch(i){await Iu(i)}}async function DO(t,e,r){const n=je(t);try{const i=await function(a,o){const l=je(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(ht(h!==null),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);jk(n,e,r),Uk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Du(n,i)}catch(i){await Iu(i)}}function Uk(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function jk(t,e,r){const n=je(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Am(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||Wk(t,n)})}function Wk(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(l1(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),_1(t))}function py(t,e,r){for(const n of r)n instanceof Lk?(t.La.addReference(n.key,e),OO(t,n)):n instanceof Mk?(Re("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||Wk(t,n.key)):Be()}function OO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Re("SyncEngine","New document in limbo: "+r),t.xa.add(n),_1(t))}function _1(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new De(Et.fromString(e)),n=t.qa.next();t.Na.set(n,new TO(r)),t.Oa=t.Oa.insert(r,n),Pk(t.remoteStore,new Rs(ki(O0(r.path)),n,"TargetPurposeLimboResolution",qg.oe))}}async function Du(t,e,r){const n=je(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=o1.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const f=je(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>he.forEach(c,d=>he.forEach(d.$i,p=>f.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>he.forEach(d.Ui,p=>f.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!Cu(h))throw h;Re("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=f.os.get(d),g=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(g);f.os=f.os.insert(d,m)}}}(n.localStore,s))}async function bO(t,e){const r=je(t);if(!r.currentUser.isEqual(e)){Re("SyncEngine","User change. New user:",e.toKey());const n=await Ak(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ie(ue.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Du(r,n.hs)}}function LO(t,e){const r=je(t),n=r.Na.get(e);if(n&&n.va)return Qe().add(n.key);{let i=Qe();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function Hk(t){const e=je(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FO.bind(null,e),e.Ca.d_=xO.bind(null,e.eventManager),e.Ca.$a=yO.bind(null,e.eventManager),e}function MO(t){const e=je(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DO.bind(null,e),e}class qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=j0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return HD(this.persistence,new jD,e.initialUser,this.serializer)}Ga(e){return new VD(a1.Zr,this.serializer)}Wa(e){return new YD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qh.provider={build:()=>new qh};class Im{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>dy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=bO.bind(null,this.syncEngine),await gO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _O}()}createDatastore(e){const r=j0(e.databaseInfo.databaseId),n=function(s){return new eO(s)}(e.databaseInfo);return function(s,a,o,l){return new nO(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new sO(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>dy(this.syncEngine,r,0),function(){return ly.D()?new ly:new QD}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,f){const h=new kO(i,s,a,o,l,c);return f&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=je(i);Re("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Nu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Im.provider={build:()=>new Im};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ns("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Or.UNAUTHENTICATED,this.clientId=KT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Re("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Re("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=d1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qd(t,e){t.asyncQueue.verifyOperationInProgress(),Re("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Ak(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function my(t,e){t.asyncQueue.verifyOperationInProgress();const r=await BO(t);Re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>cy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>cy(e.remoteStore,i)),t._onlineComponents=e}async function BO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Re("FirestoreClient","Using user provided OfflineComponentProvider");try{await qd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ue.FAILED_PRECONDITION||i.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;ll("Error using user provided cache. Falling back to memory cache: "+r),await qd(t,new qh)}}else Re("FirestoreClient","Using default OfflineComponentProvider"),await qd(t,new qh);return t._offlineComponents}async function zk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Re("FirestoreClient","Using user provided OnlineComponentProvider"),await my(t,t._uninitializedComponentsProvider._online)):(Re("FirestoreClient","Using default OnlineComponentProvider"),await my(t,new Im))),t._onlineComponents}function UO(t){return zk(t).then(e=>e.syncEngine)}async function Yh(t){const e=await zk(t),r=e.eventManager;return r.onListen=SO.bind(null,e.syncEngine),r.onUnlisten=CO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=AO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=RO.bind(null,e.syncEngine),r}function jO(t,e,r={}){const n=new Ki;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new x1({next:d=>{f.Za(),a.enqueueAndForget(()=>m1(s,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new Ie(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new Ie(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new v1(O0(o.path),f,{includeMetadataChanges:!0,_a:!0});return p1(s,h)}(await Yh(t),t.asyncQueue,e,r,n)),n.promise}function WO(t,e,r={}){const n=new Ki;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new x1({next:d=>{f.Za(),a.enqueueAndForget(()=>m1(s,h)),d.fromCache&&l.source==="server"?c.reject(new Ie(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new v1(o,f,{includeMetadataChanges:!0,_a:!0});return p1(s,h)}(await Yh(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t,e,r){if(!r)throw new Ie(ue.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function HO(t,e,r,n){if(e===!0&&n===!0)throw new Ie(ue.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function vy(t){if(!De.isDocumentKey(t))throw new Ie(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _y(t){if(De.isDocumentKey(t))throw new Ie(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function z0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Be()}function Zr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ie(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=z0(t);throw new Ie(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ie(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$k((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ie(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ie(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ie(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $0{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new o3;switch(n.type){case"firstParty":return new f3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ie(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=gy.get(r);n&&(Re("ComponentProvider","Removing Datastore"),gy.delete(r),n.terminate())}(this),Promise.resolve()}}function zO(t,e,r,n={}){var i;const s=(t=Zr(t,$0))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&ll("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Or.MOCK_USER;else{o=_R(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Ie(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Or(c)}t._authCredentials=new l3(new GT(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new eo(this.firestore,e,this._query)}}class jr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jr(this.firestore,e,this._key)}}class Hs extends eo{constructor(e,r,n){super(e,r,O0(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jr(this.firestore,null,new De(e))}withConverter(e){return new Hs(this.firestore,e,this._path)}}function vi(t,e,...r){if(t=bt(t),Gk("collection","path",e),t instanceof $0){const n=Et.fromString(e,...r);return _y(n),new Hs(t,null,n)}{if(!(t instanceof jr||t instanceof Hs))throw new Ie(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Et.fromString(e,...r));return _y(n),new Hs(t.firestore,null,n)}}function fr(t,e,...r){if(t=bt(t),arguments.length===1&&(e=KT.newId()),Gk("doc","path",e),t instanceof $0){const n=Et.fromString(e,...r);return vy(n),new jr(t,null,new De(n))}{if(!(t instanceof jr||t instanceof Hs))throw new Ie(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Et.fromString(e,...r));return vy(n),new jr(t.firestore,t instanceof Hs?t.converter:null,new De(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ck(this,"async_queue_retry"),this.Vu=()=>{const n=Xd();n&&Re("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Xd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Xd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ki;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Cu(e))throw e;Re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw ns("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=h1.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Be()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function wy(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Ii extends $0{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new yy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yy(e),this._firestoreClient=void 0,await e}}}function $O(t,e){const r=typeof t=="object"?t:Vg(),n=typeof t=="string"?t:"(default)",i=Lg(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=gR("firestore");s&&zO(i,...s)}return i}function Ou(t){if(t._terminated)throw new Ie(ue.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GO(t),t._firestoreClient}function GO(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,f){return new k3(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,$k(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new VO(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pl(Ir.fromBase64String(e))}catch(r){throw new Ie(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new pl(Ir.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ie(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ie(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ie(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=/^__.*__$/;class XO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new na(e,this.data,this.fieldMask,r,this.fieldTransforms):new Pu(e,this.data,r,this.fieldTransforms)}}class Kk{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new na(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Xk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be()}}class T1{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new T1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Qh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Xk(this.Cu)&&KO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class qO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||j0(e)}Qu(e,r,n,i=!1){return new T1({Cu:e,methodName:r,qu:n,path:Er.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lu(t){const e=t._freezeSettings(),r=j0(t._databaseId);return new qO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function k1(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);S1("Data must be an object, but it was:",a,n);const o=Qk(n,a);let l,c;if(s.merge)l=new Tn(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=Cm(e,h,r);if(!a.contains(d))throw new Ie(ue.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);Zk(f,d)||f.push(d)}l=new Tn(f),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new XO(new on(o),l,c)}class G0 extends y1{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof G0}}function qk(t,e,r,n){const i=t.Qu(1,e,r);S1("Data must be an object, but it was:",i,n);const s=[],a=on.empty();Ja(n,(l,c)=>{const f=A1(e,l,r);c=bt(c);const h=i.Nu(f);if(c instanceof G0)s.push(f);else{const d=Mu(c,h);d!=null&&(s.push(f),a.set(f,d))}});const o=new Tn(s);return new Kk(a,o,i.fieldTransforms)}function Yk(t,e,r,n,i,s){const a=t.Qu(1,e,r),o=[Cm(e,n,r)],l=[i];if(s.length%2!=0)throw new Ie(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(Cm(e,s[d])),l.push(s[d+1]);const c=[],f=on.empty();for(let d=o.length-1;d>=0;--d)if(!Zk(c,o[d])){const p=o[d];let g=l[d];g=bt(g);const m=a.Nu(p);if(g instanceof G0)c.push(p);else{const _=Mu(g,m);_!=null&&(c.push(p),f.set(p,_))}}const h=new Tn(c);return new Kk(f,h,a.fieldTransforms)}function YO(t,e,r,n=!1){return Mu(r,t.Qu(n?4:3,e))}function Mu(t,e){if(Jk(t=bt(t)))return S1("Unsupported field value:",e,t),Qk(t,e);if(t instanceof y1)return function(n,i){if(!Xk(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Mu(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=bt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return G3(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=sr.fromDate(n);return{timestampValue:Kh(i.serializer,s)}}if(n instanceof sr){const s=new sr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Kh(i.serializer,s)}}if(n instanceof w1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pl)return{bytesValue:xk(i.serializer,n._byteString)};if(n instanceof jr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:i1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof E1)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return t1(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${z0(n)}`)}(t,e)}function Qk(t,e){const r={};return XT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ja(t,(n,i)=>{const s=Mu(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Jk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof sr||t instanceof w1||t instanceof pl||t instanceof jr||t instanceof y1||t instanceof E1)}function S1(t,e,r){if(!Jk(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=z0(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Cm(t,e,r){if((e=bt(e))instanceof bu)return e._internalPath;if(typeof e=="string")return A1(t,e);throw Qh("Field path arguments must be of type string or ",t,!1,void 0,r)}const QO=new RegExp("[~\\*/\\[\\]]");function A1(t,e,r){if(e.search(QO)>=0)throw Qh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new bu(...e.split("."))._internalPath}catch{throw Qh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Qh(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new Ie(ue.INVALID_ARGUMENT,o+t+l)}function Zk(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(I1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class JO extends eS{data(){return super.data()}}function I1(t,e){return typeof e=="string"?A1(t,e):e instanceof bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ie(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class C1{}class ZO extends C1{}function ic(t,e,...r){let n=[];e instanceof C1&&n.push(e),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof R1).length,o=s.filter(l=>l instanceof K0).length;if(a>1||a>0&&o>0)throw new Ie(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class K0 extends ZO{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new K0(e,r,n)}_apply(e){const r=this._parse(e);return rS(e._query,r),new eo(e.firestore,e.converter,_m(e._query,r))}_parse(e){const r=Lu(e.firestore);return function(s,a,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Ie(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Ty(h,f);const p=[];for(const g of h)p.push(Ey(l,s,g));d={arrayValue:{values:p}}}else d=Ey(l,s,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Ty(h,f),d=YO(o,a,h,f==="in"||f==="not-in");return tr.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function va(t,e,r){const n=e,i=I1("where",t);return K0._create(i,n,r)}class R1 extends C1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new R1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:li.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)rS(a,l),a=_m(a,l)}(e._query,r),new eo(e.firestore,e.converter,_m(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Ey(t,e,r){if(typeof(r=bt(r))=="string"){if(r==="")throw new Ie(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nk(e)&&r.indexOf("/")!==-1)throw new Ie(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Et.fromString(r));if(!De.isDocumentKey(n))throw new Ie(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Hx(t,new De(n))}if(r instanceof jr)return Hx(t,r._key);throw new Ie(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${z0(r)}.`)}function Ty(t,e){if(!Array.isArray(t)||t.length===0)throw new Ie(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rS(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ie(ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class e6{convertValue(e,r="none"){switch(Wa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ja(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Be()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ja(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>$t(a.doubleValue));return new E1(s)}convertGeoPoint(e){return new w1($t(e.latitude),$t(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Qg(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Qc(e));default:return null}}convertTimestamp(e){const r=Ks(e);return new sr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Et.fromString(e);ht(Sk(n));const i=new Jc(n.get(1),n.get(3)),s=new De(n.popFirst(5));return i.isEqual(r)||ns(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nS extends eS{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ch(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(I1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ch extends nS{data(e={}){return super.data(e)}}class iS{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new sc(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ch(this._firestore,this._userDataWriter,n.key,n,new sc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ie(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new ch(i._firestore,i._userDataWriter,o.doc.key,o.doc,new sc(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new ch(i._firestore,i._userDataWriter,o.doc.key,o.doc,new sc(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,f=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:t6(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function t6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r6(t){t=Zr(t,jr);const e=Zr(t.firestore,Ii);return jO(Ou(e),t._key).then(r=>aS(e,t,r))}class F1 extends e6{constructor(e){super(),this.firestore=e}convertBytes(e){return new pl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new jr(this.firestore,null,r)}}function sS(t){t=Zr(t,eo);const e=Zr(t.firestore,Ii),r=Ou(e),n=new F1(e);return tS(t._query),WO(r,t._query).then(i=>new iS(e,n,t,i))}function Lo(t,e,r){t=Zr(t,jr);const n=Zr(t.firestore,Ii),i=P1(t.converter,e,r);return Vu(n,[k1(Lu(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Jr.none())])}function ky(t,e,r,...n){t=Zr(t,jr);const i=Zr(t.firestore,Ii),s=Lu(i);let a;return a=typeof(e=bt(e))=="string"||e instanceof bu?Yk(s,"updateDoc",t._key,e,r,n):qk(s,"updateDoc",t._key,e),Vu(i,[a.toMutation(t._key,Jr.exists(!0))])}function Sy(t){return Vu(Zr(t.firestore,Ii),[new B0(t._key,Jr.none())])}function n6(t,e){const r=Zr(t.firestore,Ii),n=fr(t),i=P1(t.converter,e);return Vu(r,[k1(Lu(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Jr.exists(!1))]).then(()=>n)}function Un(t,...e){var r,n,i;t=bt(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||wy(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(wy(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,f;if(t instanceof jr)c=Zr(t.firestore,Ii),f=O0(t._key.path),l={next:h=>{e[a]&&e[a](aS(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Zr(t,eo);c=Zr(h.firestore,Ii),f=h._query;const d=new F1(c);l={next:p=>{e[a]&&e[a](new iS(c,d,h,p))},error:e[a+1],complete:e[a+2]},tS(t._query)}return function(d,p,g,m){const _=new x1(m),w=new v1(p,_,g);return d.asyncQueue.enqueueAndForget(async()=>p1(await Yh(d),w)),()=>{_.Za(),d.asyncQueue.enqueueAndForget(async()=>m1(await Yh(d),w))}}(Ou(c),f,o,l)}function Vu(t,e){return function(n,i){const s=new Ki;return n.asyncQueue.enqueueAndForget(async()=>PO(await UO(n),i,s)),s.promise}(Ou(t),e)}function aS(t,e,r){const n=r.docs.get(e._key),i=new F1(t);return new nS(t,i,e._key,n,new sc(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Lu(e)}set(e,r,n){this._verifyNotCommitted();const i=Yd(e,this._firestore),s=P1(i.converter,r,n),a=k1(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,Jr.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const s=Yd(e,this._firestore);let a;return a=typeof(r=bt(r))=="string"||r instanceof bu?Yk(this._dataReader,"WriteBatch.update",s._key,r,n,i):qk(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(a.toMutation(s._key,Jr.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Yd(e,this._firestore);return this._mutations=this._mutations.concat(new B0(r._key,Jr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(ue.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Yd(t,e){if((t=bt(t)).firestore!==e)throw new Ie(ue.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s6(t){return Ou(t=Zr(t,Ii)),new i6(t,e=>Vu(t,e))}(function(e,r=!0){(function(i){El=i})(wl),al(new Ma("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Ii(new c3(n.getProvider("auth-internal")),new d3(n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ie(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jc(c.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Ws(Vx,"4.7.3",e),Ws(Vx,"4.7.3","esm2017")})();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Jh={};Jh.version="0.18.5";var oS=1252,a6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},D1=function(t){a6.indexOf(t)!=-1&&(oS=N1[0]=t)};function o6(){D1(1252)}var ei=function(t){D1(t)};function O1(){ei(1200),o6()}function Ay(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function l6(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function lS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var ac=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?l6(t.slice(2)):e==254&&r==255?lS(t.slice(2)):e==65279?t.slice(1):t},Ff=function(e){return String.fromCharCode(e)},Iy=function(e){return String.fromCharCode(e)},ru,Ps="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function nu(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ps.charAt(s)+Ps.charAt(a)+Ps.charAt(o)+Ps.charAt(l);return e}function An(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Ps.indexOf(t.charAt(c++)),a=Ps.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ps.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ps.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cs=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function qs(t){return Ke?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Cy(t){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var yn=function(e){return Ke?cs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function X0(t){if(typeof ArrayBuffer>"u")return yn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ia(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function c6(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function b1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return b1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var hr=Ke?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:cs(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function u6(t){for(var e=[],r=0,n=t.length+250,i=qs(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=qs(65535),n=65530)}return e.push(i.slice(0,r)),hr(e)}var en=/\u0000/g,oc=/[\u0001-\u0006]/g;function Xo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ti(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}function L1(t,e){var r=""+t;return r.length>=e?r:Ut(" ",e-r.length)+r}function Zh(t,e){var r=""+t;return r.length>=e?r:r+Ut(" ",e-r.length)}function f6(t,e){var r=""+Math.round(t);return r.length>=e?r:Ut("0",e-r.length)+r}function h6(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}var Ry=Math.pow(2,32);function go(t,e){if(t>Ry||t<-Ry)return f6(t,e);var r=Math.round(t);return h6(r,e)}function e0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Py=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Qd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d6(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Oe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Fy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},p6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function t0(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,f=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,f=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=s):(f=c,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function Ta(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=y6(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var cS=new Date(1899,11,31,0,0,0),m6=cS.getTime(),g6=new Date(1900,2,1,0,0,0);function uS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=g6&&(r+=24*60*60*1e3),(r-(m6+(t.getTimezoneOffset()-cS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function M1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function v6(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function _6(t){var e=t<0?12:11,r=M1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function x6(t){var e=M1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function iu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=_6(t):e===10?r=t.toFixed(10).substr(0,12):r=x6(t),M1(v6(r.toUpperCase()))}function Ha(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):iu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Gn(14,uS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function y6(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function w6(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Qd[r.m-1][1];case 5:return Qd[r.m-1][0];default:return Qd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Py[r.q][0];default:return Py[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ti(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ti(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?ti(l,c):"";return f}function Fs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var fS=/%/g;function E6(t,e,r){var n=e.replace(fS,""),i=e.length-n.length;return Xi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function T6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Xi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+hS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dS=/# (\?+)( ?)\/( ?)(\d+)/;function k6(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ut(" ",t[1].length+1+t[4].length):L1(a,t[1].length)+t[2]+"/"+t[3]+ti(o,t[4].length))}function S6(t,e,r){return r+(e===0?"":""+e)+Ut(" ",t[1].length+2+t[4].length)}var pS=/^#*0*\.([0#]+)/,mS=/\).*[0#]/,gS=/\(###\) ###\\?-####/;function qr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Ny(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Dy(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function A6(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function I6(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Dn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dn("n",n,r):"("+Dn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return T6(t,e,r);if(e.indexOf("%")!==-1)return E6(t,e,r);if(e.indexOf("E")!==-1)return hS(e,r);if(e.charCodeAt(0)===36)return"$"+Dn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+go(l,e.length);if(e.match(/^[#?]+$/))return i=go(r,0),i==="0"&&(i=""),i.length>e.length?i:qr(e.substr(0,e.length-i.length))+i;if(s=e.match(dS))return k6(s,l,c);if(e.match(/^#+0+$/))return c+go(l,e.length-e.indexOf("0"));if(s=e.match(pS))return i=Ny(r,s[1].length).replace(/^([^\.]+)$/,"$1."+qr(s[1])).replace(/\.$/,"."+qr(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Ut("0",qr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Ny(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Fs(go(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dn(t,e,-r):Fs(""+(Math.floor(r)+A6(r,s[1].length)))+"."+ti(Dy(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Dn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Xo(Dn(t,e.replace(/[\\-]/g,""),r)),a=0,Xo(Xo(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(gS))return i=Dn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=t0(l,Math.pow(10,a)-1,!1),i=""+c,f=Xi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Zh(o[2],a),f.length<s[4].length&&(f=qr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=t0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?L1(o[1],a)+s[2]+"/"+s[3]+Zh(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=go(r,0),e.length<=i.length?i:qr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return qr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Dy(r,s[1].length),r<0?"-"+Dn(t,e,-r):Fs(I6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ti(0,3-g.length):"")+g})+"."+ti(a,s[1].length);switch(e){case"###,##0.00":return Dn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Fs(go(l,0));return p!=="0"?c+p:"";case"###,###.00":return Dn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function C6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Xi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function R6(t,e,r){var n=e.replace(fS,""),i=e.length-n.length;return Xi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function vS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function di(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?di("n",n,r):"("+di("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return C6(t,e,r);if(e.indexOf("%")!==-1)return R6(t,e,r);if(e.indexOf("E")!==-1)return vS(e,r);if(e.charCodeAt(0)===36)return"$"+di(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ti(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:qr(e.substr(0,e.length-i.length))+i;if(s=e.match(dS))return S6(s,l,c);if(e.match(/^#+0+$/))return c+ti(l,e.length-e.indexOf("0"));if(s=e.match(pS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+qr(s[1])).replace(/\.$/,"."+qr(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+Ut("0",qr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Fs(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):Fs(""+r)+"."+Ut("0",s[1].length);if(s=e.match(/^#,#*,#0/))return di(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Xo(di(t,e.replace(/[\\-]/g,""),r)),a=0,Xo(Xo(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(gS))return i=di(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=t0(l,Math.pow(10,a)-1,!1),i=""+c,f=Xi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Zh(o[2],a),f.length<s[4].length&&(f=qr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=t0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?L1(o[1],a)+s[2]+"/"+s[3]+Zh(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:qr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return qr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):Fs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ti(0,3-g.length):"")+g})+"."+ti(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Fs(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return di(t,e.slice(0,e.lastIndexOf(".")),r)+qr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Xi(t,e,r){return(r|0)===r?di(t,e,r):Dn(t,e,r)}function P6(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var _S=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Sl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":e0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(_S))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function F6(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!e0(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Ta(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Ta(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=Ta(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",a+=5,d="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(_S)){if(c==null&&(c=Ta(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Sl(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,w=0,E;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",_<1&&(_=1);break;case"s":(E=i[a].v.match(/\.0+$/))&&(w=Math.max(w,E[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=w6(i[a].t.charCodeAt(0),i[a].v,c,w),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;x+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=Ha(e,r);break}var W="",M,y;if(x.length>0){x.charCodeAt(0)==40?(M=e<0&&x.charCodeAt(0)===45?-e:e,y=Xi("n",x,M)):(M=e<0&&n>1?-e:e,y=Xi("n",x,M),M<0&&i[0]&&i[0].t=="t"&&(y=y.substr(1),i[0].v="-"+i[0].v)),P=y.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var S=i.length;if(k===i.length&&y.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=y.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=y.substr(0,P+1),P=-1),i[a].t="t",S=a);P>=0&&S<i.length&&(i[S].v=y.substr(0,P+1)+i[S].v)}else if(k!==i.length&&y.indexOf("E")===-1){for(P=y.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,W=i[a].v.substr(f+1);f>=0;--f)P>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(W=y.charAt(P--)+W);i[a].v=W,i[a].t="t",S=a}for(P>=0&&S<i.length&&(i[S].v=y.substr(0,P+1)+i[S].v),P=y.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,W=i[a].v.substr(0,f);f<i[a].v.length;++f)P<y.length&&(W+=y.charAt(P++));i[a].v=W,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(M=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Xi(i[a].t,i[a].v,M),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var Oy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function by(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function N6(t,e){var r=P6(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Oy),o=r[1].match(Oy);return by(e,a)?[n,r[0]]:by(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Gn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Oe)[t],n==null&&(n=r.table&&r.table[Fy[t]]||Oe[Fy[t]]),n==null&&(n=p6[t]||"General");break}if(e0(n,0))return Ha(e,r);e instanceof Date&&(e=uS(e,r.date1904));var i=N6(n,e);if(e0(i[1]))return Ha(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return F6(i[1],e,r,i[0])}function qi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Oe[r]==null){e<0&&(e=r);continue}if(Oe[r]==t){e=r;break}}e<0&&(e=391)}return Oe[e]=t,e}function q0(t){for(var e=0;e!=392;++e)t[e]!==void 0&&qi(t[e],e)}function Al(){Oe=d6()}var D6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function O6(t){var e=typeof t=="number"?Oe[t]:t;return e=e.replace(xS,"(\\d+)"),new RegExp("^"+e+"$")}function b6(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(xS)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var L6=function(){var t={};t.version="1.2.0";function e(){for(var y=0,k=new Array(256),S=0;S!=256;++S)y=S,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,k[S]=y;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(y){var k=0,S=0,I=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)R[I]=y[I];for(I=0;I!=256;++I)for(S=y[I],k=256+I;k<4096;k+=256)S=R[k]=S>>>8^y[S&255];var C=[];for(I=1;I!=16;++I)C[I-1]=typeof Int32Array<"u"?R.subarray(I*256,I*256+256):R.slice(I*256,I*256+256);return C}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],f=i[5],h=i[6],d=i[7],p=i[8],g=i[9],m=i[10],_=i[11],w=i[12],E=i[13],x=i[14];function P(y,k){for(var S=k^-1,I=0,R=y.length;I<R;)S=S>>>8^r[(S^y.charCodeAt(I++))&255];return~S}function W(y,k){for(var S=k^-1,I=y.length-15,R=0;R<I;)S=x[y[R++]^S&255]^E[y[R++]^S>>8&255]^w[y[R++]^S>>16&255]^_[y[R++]^S>>>24]^m[y[R++]]^g[y[R++]]^p[y[R++]]^d[y[R++]]^h[y[R++]]^f[y[R++]]^c[y[R++]]^l[y[R++]]^o[y[R++]]^a[y[R++]]^s[y[R++]]^r[y[R++]];for(I+=15;R<I;)S=S>>>8^r[(S^y[R++])&255];return~S}function M(y,k){for(var S=k^-1,I=0,R=y.length,C=0,N=0;I<R;)C=y.charCodeAt(I++),C<128?S=S>>>8^r[(S^C)&255]:C<2048?(S=S>>>8^r[(S^(192|C>>6&31))&255],S=S>>>8^r[(S^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,N=y.charCodeAt(I++)&1023,S=S>>>8^r[(S^(240|C>>8&7))&255],S=S>>>8^r[(S^(128|C>>2&63))&255],S=S>>>8^r[(S^(128|N>>6&15|(C&3)<<4))&255],S=S>>>8^r[(S^(128|N&63))&255]):(S=S>>>8^r[(S^(224|C>>12&15))&255],S=S>>>8^r[(S^(128|C>>6&63))&255],S=S>>>8^r[(S^(128|C&63))&255]);return~S}return t.table=r,t.bstr=P,t.buf=W,t.str=M,t}(),Ne=function(){var e={};e.version="1.2.1";function r(A,B){for(var O=A.split("/"),L=B.split("/"),U=0,H=0,Q=Math.min(O.length,L.length);U<Q;++U){if(H=O[U].length-L[U].length)return H;if(O[U]!=L[U])return O[U]<L[U]?-1:1}return O.length-L.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var B=A.lastIndexOf("/");return B===-1?A:A.slice(0,B+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var B=A.lastIndexOf("/");return B===-1?A:A.slice(B+1)}function s(A,B){typeof B=="string"&&(B=new Date(B));var O=B.getHours();O=O<<6|B.getMinutes(),O=O<<5|B.getSeconds()>>>1,A.write_shift(2,O);var L=B.getFullYear()-1980;L=L<<4|B.getMonth()+1,L=L<<5|B.getDate(),A.write_shift(2,L)}function a(A){var B=A.read_shift(2)&65535,O=A.read_shift(2)&65535,L=new Date,U=O&31;O>>>=5;var H=O&15;O>>>=4,L.setMilliseconds(0),L.setFullYear(O+1980),L.setMonth(H-1),L.setDate(U);var Q=B&31;B>>>=5;var re=B&63;return B>>>=6,L.setHours(B),L.setMinutes(re),L.setSeconds(Q<<1),L}function o(A){wr(A,0);for(var B={},O=0;A.l<=A.length-4;){var L=A.read_shift(2),U=A.read_shift(2),H=A.l+U,Q={};switch(L){case 21589:O=A.read_shift(1),O&1&&(Q.mtime=A.read_shift(4)),U>5&&(O&2&&(Q.atime=A.read_shift(4)),O&4&&(Q.ctime=A.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}A.l=H,B[L]=Q}return B}var l;function c(){return l||(l={})}function f(A,B){if(A[0]==80&&A[1]==75)return Pl(A,B);if((A[0]|32)==109&&(A[1]|32)==105)return qu(A,B);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var O=3,L=512,U=0,H=0,Q=0,re=0,J=0,Z=[],ee=A.slice(0,512);wr(ee,0);var de=h(ee);switch(O=de[0],O){case 3:L=512;break;case 4:L=4096;break;case 0:if(de[1]==0)return Pl(A,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}L!==512&&(ee=A.slice(0,L),wr(ee,28));var we=A.slice(0,L);d(ee,O);var Ae=ee.read_shift(4,"i");if(O===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);ee.l+=4,Q=ee.read_shift(4,"i"),ee.l+=4,ee.chk("00100000","Mini Stream Cutoff Size: "),re=ee.read_shift(4,"i"),U=ee.read_shift(4,"i"),J=ee.read_shift(4,"i"),H=ee.read_shift(4,"i");for(var ve=-1,Se=0;Se<109&&(ve=ee.read_shift(4,"i"),!(ve<0));++Se)Z[Se]=ve;var Ve=p(A,L);_(J,H,Ve,L,Z);var mt=E(Ve,Q,Z,L);mt[Q].name="!Directory",U>0&&re!==N&&(mt[re].name="!MiniFAT"),mt[Z[0]].name="!FAT",mt.fat_addrs=Z,mt.ssz=L;var ot={},At=[],Di=[],fa=[];x(Q,mt,Ve,At,U,ot,Di,re),g(Di,fa,At),At.shift();var ds={FileIndex:Di,FullPaths:fa};return B&&B.raw&&(ds.raw={header:we,sectors:Ve}),ds}function h(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(_e,"Header Signature: "),A.l+=16;var B=A.read_shift(2,"u");return[A.read_shift(2,"u"),B]}function d(A,B){var O=9;switch(A.l+=2,O=A.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function p(A,B){for(var O=Math.ceil(A.length/B)-1,L=[],U=1;U<O;++U)L[U-1]=A.slice(U*B,(U+1)*B);return L[O-1]=A.slice(O*B),L}function g(A,B,O){for(var L=0,U=0,H=0,Q=0,re=0,J=O.length,Z=[],ee=[];L<J;++L)Z[L]=ee[L]=L,B[L]=O[L];for(;re<ee.length;++re)L=ee[re],U=A[L].L,H=A[L].R,Q=A[L].C,Z[L]===L&&(U!==-1&&Z[U]!==U&&(Z[L]=Z[U]),H!==-1&&Z[H]!==H&&(Z[L]=Z[H])),Q!==-1&&(Z[Q]=L),U!==-1&&L!=Z[L]&&(Z[U]=Z[L],ee.lastIndexOf(U)<re&&ee.push(U)),H!==-1&&L!=Z[L]&&(Z[H]=Z[L],ee.lastIndexOf(H)<re&&ee.push(H));for(L=1;L<J;++L)Z[L]===L&&(H!==-1&&Z[H]!==H?Z[L]=Z[H]:U!==-1&&Z[U]!==U&&(Z[L]=Z[U]));for(L=1;L<J;++L)if(A[L].type!==0){if(re=L,re!=Z[re])do re=Z[re],B[L]=B[re]+"/"+B[L];while(re!==0&&Z[re]!==-1&&re!=Z[re]);Z[L]=-1}for(B[0]+="/",L=1;L<J;++L)A[L].type!==2&&(B[L]+="/")}function m(A,B,O){for(var L=A.start,U=A.size,H=[],Q=L;O&&U>0&&Q>=0;)H.push(B.slice(Q*C,Q*C+C)),U-=C,Q=_a(O,Q*4);return H.length===0?ne(0):hr(H).slice(0,A.size)}function _(A,B,O,L,U){var H=N;if(A===N){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var Q=O[A],re=(L>>>2)-1;if(!Q)return;for(var J=0;J<re&&(H=_a(Q,J*4))!==N;++J)U.push(H);_(_a(Q,L-4),B-1,O,L,U)}}function w(A,B,O,L,U){var H=[],Q=[];U||(U=[]);var re=L-1,J=0,Z=0;for(J=B;J>=0;){U[J]=!0,H[H.length]=J,Q.push(A[J]);var ee=O[Math.floor(J*4/L)];if(Z=J*4&re,L<4+Z)throw new Error("FAT boundary crossed: "+J+" 4 "+L);if(!A[ee])break;J=_a(A[ee],Z)}return{nodes:H,data:Ky([Q])}}function E(A,B,O,L){var U=A.length,H=[],Q=[],re=[],J=[],Z=L-1,ee=0,de=0,we=0,Ae=0;for(ee=0;ee<U;++ee)if(re=[],we=ee+B,we>=U&&(we-=U),!Q[we]){J=[];var ve=[];for(de=we;de>=0;){ve[de]=!0,Q[de]=!0,re[re.length]=de,J.push(A[de]);var Se=O[Math.floor(de*4/L)];if(Ae=de*4&Z,L<4+Ae)throw new Error("FAT boundary crossed: "+de+" 4 "+L);if(!A[Se]||(de=_a(A[Se],Ae),ve[de]))break}H[we]={nodes:re,data:Ky([J])}}return H}function x(A,B,O,L,U,H,Q,re){for(var J=0,Z=L.length?2:0,ee=B[A].data,de=0,we=0,Ae;de<ee.length;de+=128){var ve=ee.slice(de,de+128);wr(ve,64),we=ve.read_shift(2),Ae=z1(ve,0,we-Z),L.push(Ae);var Se={name:Ae,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},Ve=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);Ve!==0&&(Se.ct=P(ve,ve.l-8));var mt=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);mt!==0&&(Se.mt=P(ve,ve.l-8)),Se.start=ve.read_shift(4,"i"),Se.size=ve.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=N,Se.name=""),Se.type===5?(J=Se.start,U>0&&J!==N&&(B[J].name="!StreamData")):Se.size>=4096?(Se.storage="fat",B[Se.start]===void 0&&(B[Se.start]=w(O,Se.start,B.fat_addrs,B.ssz)),B[Se.start].name=Se.name,Se.content=B[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:J!==N&&Se.start!==N&&B[J]&&(Se.content=m(Se,B[J].data,(B[re]||{}).data))),Se.content&&wr(Se.content,0),H[Ae]=Se,Q.push(Se)}}function P(A,B){return new Date((xn(A,B+4)/1e7*Math.pow(2,32)+xn(A,B)/1e7-11644473600)*1e3)}function W(A,B){return c(),f(l.readFileSync(A),B)}function M(A,B){var O=B&&B.type;switch(O||Ke&&Buffer.isBuffer(A)&&(O="buffer"),O||"base64"){case"file":return W(A,B);case"base64":return f(yn(An(A)),B);case"binary":return f(yn(A),B)}return f(A,B)}function y(A,B){var O=B||{},L=O.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=L+"/",A.FileIndex[0]={name:L,type:5}),O.CLSID&&(A.FileIndex[0].clsid=O.CLSID),k(A)}function k(A){var B="Sh33tJ5";if(!Ne.find(A,"/"+B)){var O=ne(4);O[0]=55,O[1]=O[3]=50,O[2]=54,A.FileIndex.push({name:B,type:2,content:O,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+B),S(A)}}function S(A,B){y(A);for(var O=!1,L=!1,U=A.FullPaths.length-1;U>=0;--U){var H=A.FileIndex[U];switch(H.type){case 0:L?O=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(H.R*H.L*H.C)&&(O=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!B)){var Q=new Date(1987,1,19),re=0,J=Object.create?Object.create(null):{},Z=[];for(U=0;U<A.FullPaths.length;++U)J[A.FullPaths[U]]=!0,A.FileIndex[U].type!==0&&Z.push([A.FullPaths[U],A.FileIndex[U]]);for(U=0;U<Z.length;++U){var ee=n(Z[U][0]);L=J[ee],L||(Z.push([ee,{name:i(ee).replace("/",""),type:1,clsid:Te,ct:Q,mt:Q,content:null}]),J[ee]=!0)}for(Z.sort(function(Ae,ve){return r(Ae[0],ve[0])}),A.FullPaths=[],A.FileIndex=[],U=0;U<Z.length;++U)A.FullPaths[U]=Z[U][0],A.FileIndex[U]=Z[U][1];for(U=0;U<Z.length;++U){var de=A.FileIndex[U],we=A.FullPaths[U];if(de.name=i(we).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||Te,U===0)de.C=Z.length>1?1:-1,de.size=0,de.type=5;else if(we.slice(-1)=="/"){for(re=U+1;re<Z.length&&n(A.FullPaths[re])!=we;++re);for(de.C=re>=Z.length?-1:re,re=U+1;re<Z.length&&n(A.FullPaths[re])!=n(we);++re);de.R=re>=Z.length?-1:re,de.type=1}else n(A.FullPaths[U+1]||"")==n(we)&&(de.R=U+1),de.type=2}}}function I(A,B){var O=B||{};if(O.fileType=="mad")return gr(A,O);switch(S(A),O.fileType){case"zip":return Fl(A,O)}var L=function(Ae){for(var ve=0,Se=0,Ve=0;Ve<Ae.FileIndex.length;++Ve){var mt=Ae.FileIndex[Ve];if(mt.content){var ot=mt.content.length;ot>0&&(ot<4096?ve+=ot+63>>6:Se+=ot+511>>9)}}for(var At=Ae.FullPaths.length+3>>2,Di=ve+7>>3,fa=ve+127>>7,ds=Di+Se+At+fa,ui=ds+127>>7,uo=ui<=109?0:Math.ceil((ui-109)/127);ds+ui+uo+127>>7>ui;)uo=++ui<=109?0:Math.ceil((ui-109)/127);var mn=[1,uo,ui,fa,At,Se,ve,0];return Ae.FileIndex[0].size=ve<<6,mn[7]=(Ae.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(A),U=ne(L[7]<<9),H=0,Q=0;{for(H=0;H<8;++H)U.write_shift(1,pe[H]);for(H=0;H<8;++H)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),H=0;H<3;++H)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,L[2]),U.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:N),U.write_shift(4,L[3]),U.write_shift(-4,L[1]?L[0]-1:N),U.write_shift(4,L[1]),H=0;H<109;++H)U.write_shift(-4,H<L[2]?L[1]+H:-1)}if(L[1])for(Q=0;Q<L[1];++Q){for(;H<236+Q*127;++H)U.write_shift(-4,H<L[2]?L[1]+H:-1);U.write_shift(-4,Q===L[1]-1?N:Q+1)}var re=function(Ae){for(Q+=Ae;H<Q-1;++H)U.write_shift(-4,H+1);Ae&&(++H,U.write_shift(-4,N))};for(Q=H=0,Q+=L[1];H<Q;++H)U.write_shift(-4,ge.DIFSECT);for(Q+=L[2];H<Q;++H)U.write_shift(-4,ge.FATSECT);re(L[3]),re(L[4]);for(var J=0,Z=0,ee=A.FileIndex[0];J<A.FileIndex.length;++J)ee=A.FileIndex[J],ee.content&&(Z=ee.content.length,!(Z<4096)&&(ee.start=Q,re(Z+511>>9)));for(re(L[6]+7>>3);U.l&511;)U.write_shift(-4,ge.ENDOFCHAIN);for(Q=H=0,J=0;J<A.FileIndex.length;++J)ee=A.FileIndex[J],ee.content&&(Z=ee.content.length,!(!Z||Z>=4096)&&(ee.start=Q,re(Z+63>>6)));for(;U.l&511;)U.write_shift(-4,ge.ENDOFCHAIN);for(H=0;H<L[4]<<2;++H){var de=A.FullPaths[H];if(!de||de.length===0){for(J=0;J<17;++J)U.write_shift(4,0);for(J=0;J<3;++J)U.write_shift(4,-1);for(J=0;J<12;++J)U.write_shift(4,0);continue}ee=A.FileIndex[H],H===0&&(ee.start=ee.size?ee.start-1:N);var we=H===0&&O.root||ee.name;if(Z=2*(we.length+1),U.write_shift(64,we,"utf16le"),U.write_shift(2,Z),U.write_shift(1,ee.type),U.write_shift(1,ee.color),U.write_shift(-4,ee.L),U.write_shift(-4,ee.R),U.write_shift(-4,ee.C),ee.clsid)U.write_shift(16,ee.clsid,"hex");else for(J=0;J<4;++J)U.write_shift(4,0);U.write_shift(4,ee.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ee.start),U.write_shift(4,ee.size),U.write_shift(4,0)}for(H=1;H<A.FileIndex.length;++H)if(ee=A.FileIndex[H],ee.size>=4096)if(U.l=ee.start+1<<9,Ke&&Buffer.isBuffer(ee.content))ee.content.copy(U,U.l,0,ee.size),U.l+=ee.size+511&-512;else{for(J=0;J<ee.size;++J)U.write_shift(1,ee.content[J]);for(;J&511;++J)U.write_shift(1,0)}for(H=1;H<A.FileIndex.length;++H)if(ee=A.FileIndex[H],ee.size>0&&ee.size<4096)if(Ke&&Buffer.isBuffer(ee.content))ee.content.copy(U,U.l,0,ee.size),U.l+=ee.size+63&-64;else{for(J=0;J<ee.size;++J)U.write_shift(1,ee.content[J]);for(;J&63;++J)U.write_shift(1,0)}if(Ke)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function R(A,B){var O=A.FullPaths.map(function(J){return J.toUpperCase()}),L=O.map(function(J){var Z=J.split("/");return Z[Z.length-(J.slice(-1)=="/"?2:1)]}),U=!1;B.charCodeAt(0)===47?(U=!0,B=O[0].slice(0,-1)+B):U=B.indexOf("/")!==-1;var H=B.toUpperCase(),Q=U===!0?O.indexOf(H):L.indexOf(H);if(Q!==-1)return A.FileIndex[Q];var re=!H.match(oc);for(H=H.replace(en,""),re&&(H=H.replace(oc,"!")),Q=0;Q<O.length;++Q)if((re?O[Q].replace(oc,"!"):O[Q]).replace(en,"")==H||(re?L[Q].replace(oc,"!"):L[Q]).replace(en,"")==H)return A.FileIndex[Q];return null}var C=64,N=-2,_e="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],Te="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ce(A,B,O){c();var L=I(A,O);l.writeFileSync(B,L)}function V(A){for(var B=new Array(A.length),O=0;O<A.length;++O)B[O]=String.fromCharCode(A[O]);return B.join("")}function X(A,B){var O=I(A,B);switch(B&&B.type||"buffer"){case"file":return c(),l.writeFileSync(B.filename,O),O;case"binary":return typeof O=="string"?O:V(O);case"base64":return nu(typeof O=="string"?O:V(O));case"buffer":if(Ke)return Buffer.isBuffer(O)?O:cs(O);case"array":return typeof O=="string"?yn(O):O}return O}var oe;function b(A){try{var B=A.InflateRaw,O=new B;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)oe=A;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function j(A,B){if(!oe)return lo(A,B);var O=oe.InflateRaw,L=new O,U=L._processChunk(A.slice(A.l),L._finishFlushFlag);return A.l+=L.bytesRead,U}function z(A){return oe?oe.deflateRawSync(A):He(A)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(A){var B=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(B>>16|B>>8|B)&255}for(var ae=typeof Uint8Array<"u",ie=ae?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)ie[Fe]=le(Fe);function G(A,B){var O=ie[A&255];return B<=8?O>>>8-B:(O=O<<8|ie[A>>8&255],B<=16?O>>>16-B:(O=O<<8|ie[A>>16&255],O>>>24-B))}function qe(A,B){var O=B&7,L=B>>>3;return(A[L]|(O<=6?0:A[L+1]<<8))>>>O&3}function $e(A,B){var O=B&7,L=B>>>3;return(A[L]|(O<=5?0:A[L+1]<<8))>>>O&7}function at(A,B){var O=B&7,L=B>>>3;return(A[L]|(O<=4?0:A[L+1]<<8))>>>O&15}function Ge(A,B){var O=B&7,L=B>>>3;return(A[L]|(O<=3?0:A[L+1]<<8))>>>O&31}function ke(A,B){var O=B&7,L=B>>>3;return(A[L]|(O<=1?0:A[L+1]<<8))>>>O&127}function Ct(A,B,O){var L=B&7,U=B>>>3,H=(1<<O)-1,Q=A[U]>>>L;return O<8-L||(Q|=A[U+1]<<8-L,O<16-L)||(Q|=A[U+2]<<16-L,O<24-L)||(Q|=A[U+3]<<24-L),Q&H}function Kr(A,B,O){var L=B&7,U=B>>>3;return L<=5?A[U]|=(O&7)<<L:(A[U]|=O<<L&255,A[U+1]=(O&7)>>8-L),B+3}function nn(A,B,O){var L=B&7,U=B>>>3;return O=(O&1)<<L,A[U]|=O,B+1}function Rn(A,B,O){var L=B&7,U=B>>>3;return O<<=L,A[U]|=O&255,O>>>=8,A[U+1]=O,B+8}function oa(A,B,O){var L=B&7,U=B>>>3;return O<<=L,A[U]|=O&255,O>>>=8,A[U+1]=O&255,A[U+2]=O>>>8,B+16}function Pn(A,B){var O=A.length,L=2*O>B?2*O:B+5,U=0;if(O>=B)return A;if(Ke){var H=Cy(L);if(A.copy)A.copy(H);else for(;U<A.length;++U)H[U]=A[U];return H}else if(ae){var Q=new Uint8Array(L);if(Q.set)Q.set(A);else for(;U<O;++U)Q[U]=A[U];return Q}return A.length=L,A}function mr(A){for(var B=new Array(A),O=0;O<A;++O)B[O]=0;return B}function Fn(A,B,O){var L=1,U=0,H=0,Q=0,re=0,J=A.length,Z=ae?new Uint16Array(32):mr(32);for(H=0;H<32;++H)Z[H]=0;for(H=J;H<O;++H)A[H]=0;J=A.length;var ee=ae?new Uint16Array(J):mr(J);for(H=0;H<J;++H)Z[U=A[H]]++,L<U&&(L=U),ee[H]=0;for(Z[0]=0,H=1;H<=L;++H)Z[H+16]=re=re+Z[H-1]<<1;for(H=0;H<J;++H)re=A[H],re!=0&&(ee[H]=Z[re+16]++);var de=0;for(H=0;H<J;++H)if(de=A[H],de!=0)for(re=G(ee[H],L)>>L-de,Q=(1<<L+4-de)-1;Q>=0;--Q)B[re|Q<<de]=de&15|H<<4;return L}var _t=ae?new Uint16Array(512):mr(512),Ht=ae?new Uint16Array(32):mr(32);if(!ae){for(var qt=0;qt<512;++qt)_t[qt]=0;for(qt=0;qt<32;++qt)Ht[qt]=0}(function(){for(var A=[],B=0;B<32;B++)A.push(5);Fn(A,Ht,32);var O=[];for(B=0;B<=143;B++)O.push(8);for(;B<=255;B++)O.push(9);for(;B<=279;B++)O.push(7);for(;B<=287;B++)O.push(8);Fn(O,_t,288)})();var pn=function(){for(var B=ae?new Uint8Array(32768):[],O=0,L=0;O<se.length-1;++O)for(;L<se[O+1];++L)B[L]=O;for(;L<32768;++L)B[L]=29;var U=ae?new Uint8Array(259):[];for(O=0,L=0;O<q.length-1;++O)for(;L<q[O+1];++L)U[L]=O;function H(re,J){for(var Z=0;Z<re.length;){var ee=Math.min(65535,re.length-Z),de=Z+ee==re.length;for(J.write_shift(1,+de),J.write_shift(2,ee),J.write_shift(2,~ee&65535);ee-- >0;)J[J.l++]=re[Z++]}return J.l}function Q(re,J){for(var Z=0,ee=0,de=ae?new Uint16Array(32768):[];ee<re.length;){var we=Math.min(65535,re.length-ee);if(we<10){for(Z=Kr(J,Z,+(ee+we==re.length)),Z&7&&(Z+=8-(Z&7)),J.l=Z/8|0,J.write_shift(2,we),J.write_shift(2,~we&65535);we-- >0;)J[J.l++]=re[ee++];Z=J.l*8;continue}Z=Kr(J,Z,+(ee+we==re.length)+2);for(var Ae=0;we-- >0;){var ve=re[ee];Ae=(Ae<<5^ve)&32767;var Se=-1,Ve=0;if((Se=de[Ae])&&(Se|=ee&-32768,Se>ee&&(Se-=32768),Se<ee))for(;re[Se+Ve]==re[ee+Ve]&&Ve<250;)++Ve;if(Ve>2){ve=U[Ve],ve<=22?Z=Rn(J,Z,ie[ve+1]>>1)-1:(Rn(J,Z,3),Z+=5,Rn(J,Z,ie[ve-23]>>5),Z+=3);var mt=ve<8?0:ve-4>>2;mt>0&&(oa(J,Z,Ve-q[ve]),Z+=mt),ve=B[ee-Se],Z=Rn(J,Z,ie[ve]>>3),Z-=3;var ot=ve<4?0:ve-2>>1;ot>0&&(oa(J,Z,ee-Se-se[ve]),Z+=ot);for(var At=0;At<Ve;++At)de[Ae]=ee&32767,Ae=(Ae<<5^re[ee])&32767,++ee;we-=Ve-1}else ve<=143?ve=ve+48:Z=nn(J,Z,1),Z=Rn(J,Z,ie[ve]),de[Ae]=ee&32767,++ee}Z=Rn(J,Z,0)-1}return J.l=(Z+7)/8|0,J.l}return function(J,Z){return J.length<8?H(J,Z):Q(J,Z)}}();function He(A){var B=ne(50+Math.floor(A.length*1.1)),O=pn(A,B);return B.slice(0,O)}var Rt=ae?new Uint16Array(32768):mr(32768),or=ae?new Uint16Array(32768):mr(32768),Mt=ae?new Uint16Array(128):mr(128),ci=1,oo=1;function nd(A,B){var O=Ge(A,B)+257;B+=5;var L=Ge(A,B)+1;B+=5;var U=at(A,B)+4;B+=4;for(var H=0,Q=ae?new Uint8Array(19):mr(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,Z=ae?new Uint8Array(8):mr(8),ee=ae?new Uint8Array(8):mr(8),de=Q.length,we=0;we<U;++we)Q[K[we]]=H=$e(A,B),J<H&&(J=H),Z[H]++,B+=3;var Ae=0;for(Z[0]=0,we=1;we<=J;++we)ee[we]=Ae=Ae+Z[we-1]<<1;for(we=0;we<de;++we)(Ae=Q[we])!=0&&(re[we]=ee[Ae]++);var ve=0;for(we=0;we<de;++we)if(ve=Q[we],ve!=0){Ae=ie[re[we]]>>8-ve;for(var Se=(1<<7-ve)-1;Se>=0;--Se)Mt[Ae|Se<<ve]=ve&7|we<<3}var Ve=[];for(J=1;Ve.length<O+L;)switch(Ae=Mt[ke(A,B)],B+=Ae&7,Ae>>>=3){case 16:for(H=3+qe(A,B),B+=2,Ae=Ve[Ve.length-1];H-- >0;)Ve.push(Ae);break;case 17:for(H=3+$e(A,B),B+=3;H-- >0;)Ve.push(0);break;case 18:for(H=11+ke(A,B),B+=7;H-- >0;)Ve.push(0);break;default:Ve.push(Ae),J<Ae&&(J=Ae);break}var mt=Ve.slice(0,O),ot=Ve.slice(O);for(we=O;we<286;++we)mt[we]=0;for(we=L;we<30;++we)ot[we]=0;return ci=Fn(mt,Rt,286),oo=Fn(ot,or,30),B}function id(A,B){if(A[0]==3&&!(A[1]&3))return[qs(B),2];for(var O=0,L=0,U=Cy(B||1<<18),H=0,Q=U.length>>>0,re=0,J=0;!(L&1);){if(L=$e(A,O),O+=3,L>>>1)L>>1==1?(re=9,J=5):(O=nd(A,O),re=ci,J=oo);else{O&7&&(O+=8-(O&7));var Z=A[O>>>3]|A[(O>>>3)+1]<<8;if(O+=32,Z>0)for(!B&&Q<H+Z&&(U=Pn(U,H+Z),Q=U.length);Z-- >0;)U[H++]=A[O>>>3],O+=8;continue}for(;;){!B&&Q<H+32767&&(U=Pn(U,H+32767),Q=U.length);var ee=Ct(A,O,re),de=L>>>1==1?_t[ee]:Rt[ee];if(O+=de&15,de>>>=4,!(de>>>8&255))U[H++]=de;else{if(de==256)break;de-=257;var we=de<8?0:de-4>>2;we>5&&(we=0);var Ae=H+q[de];we>0&&(Ae+=Ct(A,O,we),O+=we),ee=Ct(A,O,J),de=L>>>1==1?Ht[ee]:or[ee],O+=de&15,de>>>=4;var ve=de<4?0:de-2>>1,Se=se[de];for(ve>0&&(Se+=Ct(A,O,ve),O+=ve),!B&&Q<Ae&&(U=Pn(U,Ae+100),Q=U.length);H<Ae;)U[H]=U[H-Se],++H}}}return B?[U,O+7>>>3]:[U.slice(0,H),O+7>>>3]}function lo(A,B){var O=A.slice(A.l||0),L=id(O,B);return A.l+=L[1],L[0]}function Rl(A,B){if(A)typeof console<"u"&&console.error(B);else throw new Error(B)}function Pl(A,B){var O=A;wr(O,0);var L=[],U=[],H={FileIndex:L,FullPaths:U};y(H,{root:B.root});for(var Q=O.length-4;(O[Q]!=80||O[Q+1]!=75||O[Q+2]!=5||O[Q+3]!=6)&&Q>=0;)--Q;O.l=Q+4,O.l+=4;var re=O.read_shift(2);O.l+=6;var J=O.read_shift(4);for(O.l=J,Q=0;Q<re;++Q){O.l+=20;var Z=O.read_shift(4),ee=O.read_shift(4),de=O.read_shift(2),we=O.read_shift(2),Ae=O.read_shift(2);O.l+=8;var ve=O.read_shift(4),Se=o(O.slice(O.l+de,O.l+de+we));O.l+=de+we+Ae;var Ve=O.l;O.l=ve+4,la(O,Z,ee,H,Se),O.l=Ve}return H}function la(A,B,O,L,U){A.l+=2;var H=A.read_shift(2),Q=A.read_shift(2),re=a(A);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var J=A.read_shift(4),Z=A.read_shift(4),ee=A.read_shift(4),de=A.read_shift(2),we=A.read_shift(2),Ae="",ve=0;ve<de;++ve)Ae+=String.fromCharCode(A[A.l++]);if(we){var Se=o(A.slice(A.l,A.l+we));(Se[21589]||{}).mt&&(re=Se[21589].mt),((U||{})[21589]||{}).mt&&(re=U[21589].mt)}A.l+=we;var Ve=A.slice(A.l,A.l+Z);switch(Q){case 8:Ve=j(A,ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var mt=!1;H&8&&(J=A.read_shift(4),J==134695760&&(J=A.read_shift(4),mt=!0),Z=A.read_shift(4),ee=A.read_shift(4)),Z!=B&&Rl(mt,"Bad compressed size: "+B+" != "+Z),ee!=O&&Rl(mt,"Bad uncompressed size: "+O+" != "+ee),Ni(L,Ae,Ve,{unsafe:!0,mt:re})}function Fl(A,B){var O=B||{},L=[],U=[],H=ne(1),Q=O.compression?8:0,re=0,J=0,Z=0,ee=0,de=0,we=A.FullPaths[0],Ae=we,ve=A.FileIndex[0],Se=[],Ve=0;for(J=1;J<A.FullPaths.length;++J)if(Ae=A.FullPaths[J].slice(we.length),ve=A.FileIndex[J],!(!ve.size||!ve.content||Ae=="Sh33tJ5")){var mt=ee,ot=ne(Ae.length);for(Z=0;Z<Ae.length;++Z)ot.write_shift(1,Ae.charCodeAt(Z)&127);ot=ot.slice(0,ot.l),Se[de]=L6.buf(ve.content,0);var At=ve.content;Q==8&&(At=z(At)),H=ne(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,re),H.write_shift(2,Q),ve.mt?s(H,ve.mt):H.write_shift(4,0),H.write_shift(-4,Se[de]),H.write_shift(4,At.length),H.write_shift(4,ve.content.length),H.write_shift(2,ot.length),H.write_shift(2,0),ee+=H.length,L.push(H),ee+=ot.length,L.push(ot),ee+=At.length,L.push(At),H=ne(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,re),H.write_shift(2,Q),H.write_shift(4,0),H.write_shift(-4,Se[de]),H.write_shift(4,At.length),H.write_shift(4,ve.content.length),H.write_shift(2,ot.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,mt),Ve+=H.l,U.push(H),Ve+=ot.length,U.push(ot),++de}return H=ne(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,de),H.write_shift(2,de),H.write_shift(4,Ve),H.write_shift(4,ee),H.write_shift(2,0),hr([hr(L),hr(U),H])}var hs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Fi(A,B){if(A.ctype)return A.ctype;var O=A.name||"",L=O.match(/\.([^\.]+)$/);return L&&hs[L[1]]||B&&(L=(O=B).match(/[\.\\]([^\.\\])+$/),L&&hs[L[1]])?hs[L[1]]:"application/octet-stream"}function Ku(A){for(var B=nu(A),O=[],L=0;L<B.length;L+=76)O.push(B.slice(L,L+76));return O.join(`\r
`)+`\r
`}function co(A){var B=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var ee=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(ee.length==1?"0"+ee:ee)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],L=B.split(`\r
`),U=0;U<L.length;++U){var H=L[U];if(H.length==0){O.push("");continue}for(var Q=0;Q<H.length;){var re=76,J=H.slice(Q,Q+re);J.charAt(re-1)=="="?re--:J.charAt(re-2)=="="?re-=2:J.charAt(re-3)=="="&&(re-=3),J=H.slice(Q,Q+re),Q+=re,Q<H.length&&(J+="="),O.push(J)}}return O.join(`\r
`)}function Xu(A){for(var B=[],O=0;O<A.length;++O){for(var L=A[O];O<=A.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+A[++O];B.push(L)}for(var U=0;U<B.length;++U)B[U]=B[U].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return yn(B.join(`\r
`))}function ca(A,B,O){for(var L="",U="",H="",Q,re=0;re<10;++re){var J=B[re];if(!J||J.match(/^\s*$/))break;var Z=J.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":L=Z[2].trim();break;case"content-type":H=Z[2].trim();break;case"content-transfer-encoding":U=Z[2].trim();break}}switch(++re,U.toLowerCase()){case"base64":Q=yn(An(B.slice(re).join("")));break;case"quoted-printable":Q=Xu(B.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ee=Ni(A,L.slice(O.length),Q,{unsafe:!0});H&&(ee.ctype=H)}function qu(A,B){if(V(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=B&&B.root||"",L=(Ke&&Buffer.isBuffer(A)?A.toString("binary"):V(A)).split(`\r
`),U=0,H="";for(U=0;U<L.length;++U)if(H=L[U],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),O||(O=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),H.slice(0,O.length)!=O););var Q=(L[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var re="--"+(Q[1]||""),J=[],Z=[],ee={FileIndex:J,FullPaths:Z};y(ee);var de,we=0;for(U=0;U<L.length;++U){var Ae=L[U];Ae!==re&&Ae!==re+"--"||(we++&&ca(ee,L.slice(de,U),O),de=U)}return ee}function gr(A,B){var O=B||{},L=O.boundary||"SheetJS";L="------="+L;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],H=A.FullPaths[0],Q=H,re=A.FileIndex[0],J=1;J<A.FullPaths.length;++J)if(Q=A.FullPaths[J].slice(H.length),re=A.FileIndex[J],!(!re.size||!re.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var Z=re.content,ee=Ke&&Buffer.isBuffer(Z)?Z.toString("binary"):V(Z),de=0,we=Math.min(1024,ee.length),Ae=0,ve=0;ve<=we;++ve)(Ae=ee.charCodeAt(ve))>=32&&Ae<128&&++de;var Se=de>=we*4/5;U.push(L),U.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+Q),U.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),U.push("Content-Type: "+Fi(re,Q)),U.push(""),U.push(Se?co(ee):Ku(ee))}return U.push(L+`--\r
`),U.join(`\r
`)}function Yu(A){var B={};return y(B,A),B}function Ni(A,B,O,L){var U=L&&L.unsafe;U||y(A);var H=!U&&Ne.find(A,B);if(!H){var Q=A.FullPaths[0];B.slice(0,Q.length)==Q?Q=B:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+B).replace("//","/")),H={name:i(B),type:2},A.FileIndex.push(H),A.FullPaths.push(Q),U||Ne.utils.cfb_gc(A)}return H.content=O,H.size=O?O.length:0,L&&(L.CLSID&&(H.clsid=L.CLSID),L.mt&&(H.mt=L.mt),L.ct&&(H.ct=L.ct)),H}function ua(A,B){y(A);var O=Ne.find(A,B);if(O){for(var L=0;L<A.FileIndex.length;++L)if(A.FileIndex[L]==O)return A.FileIndex.splice(L,1),A.FullPaths.splice(L,1),!0}return!1}function sd(A,B,O){y(A);var L=Ne.find(A,B);if(L){for(var U=0;U<A.FileIndex.length;++U)if(A.FileIndex[U]==L)return A.FileIndex[U].name=i(O),A.FullPaths[U]=O,!0}return!1}function ad(A){S(A,!0)}return e.find=R,e.read=M,e.parse=f,e.write=X,e.writeFile=ce,e.utils={cfb_new:Yu,cfb_add:Ni,cfb_del:ua,cfb_mov:sd,cfb_gc:ad,ReadShift:Tc,CheckField:jS,prep_blob:wr,bconcat:hr,use_zlib:b,_deflateRaw:He,_inflateRaw:lo,consts:ge},e}();function M6(t){return typeof t=="string"?X0(t):Array.isArray(t)?c6(t):t}function Bu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=X0(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?xi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([M6(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ia(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function V6(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Wt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ly(t,e){for(var r=[],n=Wt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Y0(t){for(var e=[],r=Wt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Q0(t){for(var e=[],r=Wt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function B6(t){for(var e=[],r=Wt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var r0=new Date(1899,11,30,0,0,0);function ar(t,e){var r=t.getTime(),n=r0.getTime()+(t.getTimezoneOffset()-r0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var yS=new Date,U6=r0.getTime()+(yS.getTimezoneOffset()-r0.getTimezoneOffset())*6e4,My=yS.getTimezoneOffset();function J0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+U6),e.getTimezoneOffset()!==My&&e.setTime(e.getTime()+(e.getTimezoneOffset()-My)*6e4),e}function j6(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Vy=new Date("2017-02-19T19:06:09.000Z"),wS=isNaN(Vy.getFullYear())?new Date("2/19/17"):Vy,W6=wS.getFullYear()==2017;function kt(t,e){var r=new Date(t);if(W6)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(wS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function za(t,e){if(Ke&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return xi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return xi(lS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return xi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return xi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function St(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=St(t[r]));return e}function Ut(t,e){for(var r="";r.length<e;)r+=t;return r}function ii(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var H6=["january","february","march","april","may","june","july","august","september","october","november","december"];function ml(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&H6.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var z6=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function ES(t){return t?t.content&&t.type?za(t.content,!0):t.data?ac(t.data):t.asNodeBuffer&&Ke?ac(t.asNodeBuffer().toString("binary")):t.asBinary?ac(t.asBinary()):t._data&&t._data.getContent?ac(za(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function TS(t){if(!t)return null;if(t.data)return Ay(t.data);if(t.asNodeBuffer&&Ke)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Ay(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function $6(t){return t&&t.name.slice(-4)===".bin"?TS(t):ES(t)}function Ln(t,e){for(var r=t.FullPaths||Wt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function V1(t,e){var r=Ln(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Jt(t,e,r){if(!r)return $6(V1(t,e));if(!e)return null;try{return Jt(t,e)}catch{return null}}function wn(t,e,r){if(!r)return ES(V1(t,e));if(!e)return null;try{return wn(t,e)}catch{return null}}function G6(t,e,r){return TS(V1(t,e))}function By(t){for(var e=t.FullPaths||Wt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ze(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ke?n=cs(r):n=u6(r),Ne.utils.cfb_add(t,e,n)}Ne.utils.cfb_add(t,e,r)}else t.file(e,r)}function B1(){return Ne.utils.cfb_new()}function kS(t,e){switch(e.type){case"base64":return Ne.read(t,{type:"base64"});case"binary":return Ne.read(t,{type:"binary"});case"buffer":case"array":return Ne.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function lc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Xt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,K6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Uy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,X6=/<[^>]*>/g,Gr=Xt.match(Uy)?Uy:X6,q6=/<\w*:/,Y6=/<(\/?)\w+:/;function Le(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(K6),o=0,l="",c=0,f="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ri(t){return t.replace(Y6,"<$1")}var SS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},U1=Y0(SS),tt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return SS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),j1=/[&<>'"]/g,Q6=/[\u0000-\u0008\u000b-\u001f]/g;function ut(t){var e=t+"";return e.replace(j1,function(r){return U1[r]}).replace(Q6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jy(t){return ut(t).replace(/ /g,"_x0020_")}var AS=/[\u0000-\u001f]/g;function W1(t){var e=t+"";return e.replace(j1,function(r){return U1[r]}).replace(/\n/g,"<br/>").replace(AS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function J6(t){var e=t+"";return e.replace(j1,function(r){return U1[r]}).replace(AS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Wy=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Z6(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function wt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jd(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Hy(t){var e=qs(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function zy(t){return cs(t,"binary").toString("utf8")}var Nf="foo bar baz",pt=Ke&&(zy(Nf)==Jd(Nf)&&zy||Hy(Nf)==Jd(Nf)&&Hy)||Jd,xi=Ke?function(t){return cs(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},su=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),IS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),eb=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tb=/<\/?(?:vt:)?variant>/g,rb=/<(?:vt:)([^>]*)>([\s\S]*)</;function $y(t,e){var r=Le(t),n=t.match(eb(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(tb,"").match(rb);a&&i.push({v:pt(a[2]),t:a[1]})}),i}var CS=/(^\s|\s$|\n)/;function Tr(t,e){return"<"+t+(e.match(CS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function au(t){return Wt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function xe(t,e,r){return"<"+t+(r!=null?au(r):"")+(e!=null?(e.match(CS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Rm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function nb(t,e){switch(typeof t){case"string":var r=xe("vt:lpwstr",ut(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xe((t|0)==t?"vt:i4":"vt:r8",ut(String(t)));case"boolean":return xe("vt:bool",t?"true":"false")}if(t instanceof Date)return xe("vt:filetime",Rm(t));throw new Error("Unable to serialize "+t)}function H1(t){if(Ke&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return pt(ia(b1(t)));throw new Error("Bad input format: expected Buffer or string")}var ou=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},to=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ib(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function sb(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Gy=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Ky=Ke?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:cs(e)})):Gy(t)}:Gy,Xy=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Hi(t,i)));return n.join("").replace(en,"")},z1=Ke?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(en,""):Xy(t,e,r)}:Xy,qy=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},RS=Ke?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):qy(t,e,r)}:qy,Yy=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Eo(t,i)));return n.join("")},Uu=Ke?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Yy(e,r,n)}:Yy,PS=function(t,e){var r=xn(t,e);return r>0?Uu(t,e+4,e+4+r-1):""},FS=PS,NS=function(t,e){var r=xn(t,e);return r>0?Uu(t,e+4,e+4+r-1):""},DS=NS,OS=function(t,e){var r=2*xn(t,e);return r>0?Uu(t,e+4,e+4+r-1):""},bS=OS,LS=function(e,r){var n=xn(e,r);return n>0?z1(e,r+4,r+4+n):""},MS=LS,VS=function(t,e){var r=xn(t,e);return r>0?Uu(t,e+4,e+4+r):""},BS=VS,US=function(t,e){return ib(t,e)},n0=US,$1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ke&&(FS=function(e,r){if(!Buffer.isBuffer(e))return PS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},DS=function(e,r){if(!Buffer.isBuffer(e))return NS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},bS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},MS=function(e,r){if(!Buffer.isBuffer(e))return LS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},BS=function(e,r){if(!Buffer.isBuffer(e))return VS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},n0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):US(e,r)},$1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Eo=function(t,e){return t[e]},Hi=function(t,e){return t[e+1]*256+t[e]},ab=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},xn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_a=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},ob=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Tc(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Hi(this,c)),c+=2;t*=2;break;case"utf8":r=Uu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=z1(this,this.l,this.l+t);break;case"wstr":return Tc.call(this,t,"dbcs");case"lpstr-ansi":r=FS(this,this.l),t=4+xn(this,this.l);break;case"lpstr-cp":r=DS(this,this.l),t=4+xn(this,this.l);break;case"lpwstr":r=bS(this,this.l),t=4+2*xn(this,this.l);break;case"lpp4":t=4+xn(this,this.l),r=MS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+xn(this,this.l),r=BS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Eo(this,this.l+t++))!==0;)s.push(Ff(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Hi(this,this.l+t))!==0;)s.push(Ff(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Eo(this,c),this.l=c+1,o=Tc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ff(Hi(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Eo(this,c),this.l=c+1,o=Tc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ff(Eo(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=Eo(this,this.l),this.l++,n;case 2:return n=(e==="i"?ab:Hi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?_a:ob)(this,this.l),this.l+=4,n):(i=xn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=n0(this,this.l):i=n0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=RS(this,this.l,t);break}}return this.l+=t,r}var lb=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},cb=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},ub=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function fb(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)ub(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,lb(this,e,this.l);break;case 8:if(n=8,r==="f"){sb(this,e,this.l);break}case 16:break;case-4:n=4,cb(this,e,this.l);break}return this.l+=n,this}function jS(t,e){var r=RS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function wr(t,e){t.l=e,t.read_shift=Tc,t.chk=jS,t.write_shift=fb}function $r(t,e){t.l+=e}function ne(t){var e=qs(t);return wr(e,0),e}function us(t,e,r){if(t){var n,i,s;wr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=du[o]||du[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=c.f&&c.f(t,s,r);if(t.l=l,e(f,c,o))return}}}function hn(){var t=[],e=Ke?256:2048,r=function(c){var f=ne(c);return wr(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),hr(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function fe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=du[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&$1(r)&&t.push(r)}}function kc(t,e,r){var n=St(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Qy(t,e,r){var n=St(t);return n.s=kc(n.s,e.s,r),n.e=kc(n.e,e.s,r),n}function Sc(t,e){if(t.cRel&&t.c<0)for(t=St(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=St(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=be(t);return!t.cRel&&t.cRel!=null&&(r=pb(r)),!t.rRel&&t.rRel!=null&&(r=hb(r)),r}function Zd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ft(t.s.c)+":"+(t.e.cRel?"":"$")+Ft(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Kt(t.s.r)+":"+(t.e.rRel?"":"$")+Kt(t.e.r):Sc(t.s,e.biff)+":"+Sc(t.e,e.biff)}function G1(t){return parseInt(db(t),10)-1}function Kt(t){return""+(t+1)}function hb(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function db(t){return t.replace(/\$(\d+)$/,"$1")}function K1(t){for(var e=mb(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ft(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function pb(t){return t.replace(/^([A-Z])/,"$$$1")}function mb(t){return t.replace(/^\$([A-Z])/,"$1")}function gb(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function be(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function dn(t){var e=t.indexOf(":");return e==-1?{s:Nt(t),e:Nt(t)}:{s:Nt(t.slice(0,e)),e:Nt(t.slice(e+1))}}function We(t,e){return typeof e>"u"||typeof e=="number"?We(t.s,t.e):(typeof t!="string"&&(t=be(t)),typeof e!="string"&&(e=be(e)),t==e?t:t+":"+e)}function rt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Jy(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Gn(t.z,r?ar(e):e)}catch{}try{return t.w=Gn((t.XF||{}).numFmtId||(r?14:0),r?ar(e):e)}catch{return""+e}}function ss(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?fs[t.v]||t.v:e==null?Jy(t,t.v):Jy(t,e))}function sa(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function WS(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Nt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=rt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},g=a+h,m=o+d;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Oe[14],n.cellDates?(p.t="d",p.w=Gn(p.z,ar(p.v))):(p.t="n",p.v=ar(p.v),p.w=Gn(p.z,p.v))):p.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(p.z=s[g][m].z),s[g][m]=p;else{var _=be({c:m,r:g});s[_]&&s[_].z&&(p.z=s[_].z),s[_]=p}}}return c.s.c<1e7&&(s["!ref"]=We(c)),s}function Il(t,e){return WS(null,t,e)}function vb(t){return t.read_shift(4,"i")}function si(t,e){return e||(e=ne(4)),e.write_shift(4,t),e}function Wr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function dr(t,e){var r=!1;return e==null&&(r=!0,e=ne(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function _b(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function xb(t,e){return e||(e=ne(4)),e.write_shift(2,0),e.write_shift(2,0),e}function X1(t,e){var r=t.l,n=t.read_shift(1),i=Wr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(_b(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function yb(t,e){var r=!1;return e==null&&(r=!0,e=ne(15+4*t.t.length)),e.write_shift(1,0),dr(t.t,e),r?e.slice(0,e.l):e}var wb=X1;function Eb(t,e){var r=!1;return e==null&&(r=!0,e=ne(23+4*t.t.length)),e.write_shift(1,1),dr(t.t,e),e.write_shift(4,1),xb({},e),r?e.slice(0,e.l):e}function Kn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ro(t,e){return e==null&&(e=ne(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function no(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function io(t,e){return e==null&&(e=ne(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Tb=Wr,HS=dr;function q1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function i0(t,e){var r=!1;return e==null&&(r=!0,e=ne(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var kb=Wr,Pm=q1,Y1=i0;function Q1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?n0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_a(e,0)>>2;return r?i/100:i}function zS(t,e){e==null&&(e=ne(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function $S(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Sb(t,e){return e||(e=ne(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var so=$S,Cl=Sb;function Ur(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function $a(t,e){return(e||ne(8)).write_shift(8,t,"f")}function Ab(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Ia[i];c&&(e.rgb=cu(c));break;case 2:e.rgb=cu([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function s0(t,e){if(e||(e=ne(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Ib(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Cb(t,e){e||(e=ne(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function GS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Rb(t){return GS(t,1)}function Pb(t){return GS(t,2)}var J1=2,sn=3,Df=11,Zy=12,a0=19,Of=64,Fb=65,Nb=71,Db=4108,Ob=4126,cr=80,KS=81,bb=[cr,KS],Fm={1:{n:"CodePage",t:J1},2:{n:"Category",t:cr},3:{n:"PresentationFormat",t:cr},4:{n:"ByteCount",t:sn},5:{n:"LineCount",t:sn},6:{n:"ParagraphCount",t:sn},7:{n:"SlideCount",t:sn},8:{n:"NoteCount",t:sn},9:{n:"HiddenCount",t:sn},10:{n:"MultimediaClipCount",t:sn},11:{n:"ScaleCrop",t:Df},12:{n:"HeadingPairs",t:Db},13:{n:"TitlesOfParts",t:Ob},14:{n:"Manager",t:cr},15:{n:"Company",t:cr},16:{n:"LinksUpToDate",t:Df},17:{n:"CharacterCount",t:sn},19:{n:"SharedDoc",t:Df},22:{n:"HyperlinksChanged",t:Df},23:{n:"AppVersion",t:sn,p:"version"},24:{n:"DigSig",t:Fb},26:{n:"ContentType",t:cr},27:{n:"ContentStatus",t:cr},28:{n:"Language",t:cr},29:{n:"Version",t:cr},255:{},2147483648:{n:"Locale",t:a0},2147483651:{n:"Behavior",t:a0},1919054434:{}},Nm={1:{n:"CodePage",t:J1},2:{n:"Title",t:cr},3:{n:"Subject",t:cr},4:{n:"Author",t:cr},5:{n:"Keywords",t:cr},6:{n:"Comments",t:cr},7:{n:"Template",t:cr},8:{n:"LastAuthor",t:cr},9:{n:"RevNumber",t:cr},10:{n:"EditTime",t:Of},11:{n:"LastPrinted",t:Of},12:{n:"CreatedDate",t:Of},13:{n:"ModifiedDate",t:Of},14:{n:"PageCount",t:sn},15:{n:"WordCount",t:sn},16:{n:"CharCount",t:sn},17:{n:"Thumbnail",t:Nb},18:{n:"Application",t:cr},19:{n:"DocSecurity",t:sn},255:{},2147483648:{n:"Locale",t:a0},2147483651:{n:"Behavior",t:a0},1919054434:{}},ew={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Lb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Mb(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Vb=Mb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ia=St(Vb),fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},XS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Dm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Z1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bb(t){var e=Z1();if(!t||!t.match)return e;var r={};if((t.match(Gr)||[]).forEach(function(n){var i=Le(n);switch(i[0].replace(q6,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Dm[i.ContentType]]!==void 0&&e[Dm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==nr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function qS(t,e){var r=B6(Dm),n=[],i;n[n.length]=Xt,n[n.length]=xe("Types",null,{xmlns:nr.CT,"xmlns:xsd":nr.xsd,"xmlns:xsi":nr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return xe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=xe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:bf[l][e.bookType]||bf[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=xe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:bf[l][e.bookType]||bf[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=xe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Xe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lu(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ac(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Gr)||[]).forEach(function(i){var s=Le(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:lc(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function qo(t){var e=[Xt,xe("Relationships",null,{xmlns:nr.RELS})];return Wt(t["!id"]).forEach(function(r){e[e.length]=xe("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ct(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Xe.HLINK,Xe.XPATH,Xe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var Ub="application/vnd.oasis.opendocument.spreadsheet";function jb(t,e){for(var r=H1(t),n,i;n=ou.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Le(n[0],!1),i.path=="/"&&i.type!==Ub)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function Wb(t){var e=[Xt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function tw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Hb(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function zb(t){var e=[Xt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(tw(t[r][0],t[r][1])),e.push(Hb("",t[r][0]));return e.push(tw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function YS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Jh.version+"</meta:generator></office:meta></office:document-meta>"}var Hn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],$b=function(){for(var t=new Array(Hn.length),e=0;e<Hn.length;++e){var r=Hn[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function QS(t){var e={};t=pt(t);for(var r=0;r<Hn.length;++r){var n=Hn[r],i=t.match($b[r]);i!=null&&i.length>0&&(e[n[1]]=tt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=kt(e[n[1]]))}return e}function ep(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ut(e),n[n.length]=r?xe(t,e,r):Tr(t,e))}function JS(t,e){var r=e||{},n=[Xt,xe("cp:coreProperties",null,{"xmlns:cp":nr.CORE_PROPS,"xmlns:dc":nr.dc,"xmlns:dcterms":nr.dcterms,"xmlns:dcmitype":nr.dcmitype,"xmlns:xsi":nr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&ep("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Rm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&ep("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Rm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Hn.length;++s){var a=Hn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ep(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ca=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ZS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function eA(t,e,r,n){var i=[];if(typeof t=="string")i=$y(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?$y(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function Gb(t,e,r){var n={};return e||(e={}),t=pt(t),Ca.forEach(function(i){var s=(t.match(su(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=tt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&eA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function tA(t){var e=[],r=xe;return t||(t={}),t.Application="SheetJS",e[e.length]=Xt,e[e.length]=xe("Properties",null,{xmlns:nr.EXT_PROPS,"xmlns:vt":nr.vt}),Ca.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ut(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ut(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Kb=/<[^>]+>[^<]*/g;function Xb(t,e){var r={},n="",i=t.match(Kb);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Le(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=tt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=tt(f);break;case"bool":r[n]=wt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=kt(f);break;case"cy":case"error":r[n]=tt(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function rA(t){var e=[Xt,xe("Properties",null,{xmlns:nr.CUST_PROPS,"xmlns:vt":nr.vt})];if(!t)return e.join("");var r=1;return Wt(t).forEach(function(i){++r,e[e.length]=xe("property",nb(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ut(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Om={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tp;function qb(t,e,r){tp||(tp=Y0(Om)),e=tp[e]||e,t[e]=r}function Yb(t,e){var r=[];return Wt(Om).map(function(n){for(var i=0;i<Hn.length;++i)if(Hn[i][1]==n)return Hn[i];for(i=0;i<Ca.length;++i)if(Ca[i][1]==n)return Ca[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Tr(Om[n[1]]||n[1],i))}}),xe("DocumentProperties",r.join(""),{xmlns:_n.o})}function Qb(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Wt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Hn.length;++a)if(s==Hn[a][1])return;for(a=0;a<Ca.length;++a)if(s==Ca[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(xe(jy(s),o,{"dt:dt":l}))}}),e&&Wt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(xe(jy(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+_n.o+'">'+i.join("")+"</"+n+">"}function ev(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Jb(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ne(8);return a.write_shift(4,n),a.write_shift(4,i),a}function nA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function iA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function sA(t,e,r){return e===31?iA(t):nA(t,e,r)}function bm(t,e,r){return sA(t,e,r===!1?0:4)}function Zb(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return sA(t,e,0)}function eL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(en,""),t.l-i&2&&(t.l+=2)}return r}function tL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(en,"");return r}function rL(t){var e=t.l,r=o0(t,KS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=o0(t,sn);return[r,n]}function nL(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(rL(t));return r}function rw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(en,"").replace(oc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function aA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function iL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function o0(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Zy&&n!==e&&bb.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Zy?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return nA(t,n,4).replace(en,"");case 31:return iA(t);case 64:return ev(t);case 65:return aA(t);case 71:return iL(t);case 80:return bm(t,n,!s.raw).replace(en,"");case 81:return Zb(t,n).replace(en,"");case 4108:return nL(t);case 4126:case 4127:return n==4127?eL(t):tL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function nw(t,e){var r=ne(4),n=ne(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ne(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=Jb(e);break;case 31:case 80:for(n=ne(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return hr([r,n])}function iw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var f=t.read_shift(4),h=t.read_shift(4);s[a]=[f,h+r]}s.sort(function(E,x){return E[1]-x[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var g=e[s[a][0]];if(d[g.n]=o0(t,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ei(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(s[a][0]===1){if(o=d.CodePage=o0(t,J1),ei(o),l!==-1){var m=t.l;t.l=s[l][1],c=rw(t,o),t.l=m}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=rw(t,o)}else{var _=c[s[a][0]],w;switch(t[t.l]){case 65:t.l+=4,w=aA(t);break;case 30:t.l+=4,w=bm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,w=bm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,w=t.read_shift(4,"i");break;case 19:t.l+=4,w=t.read_shift(4);break;case 5:t.l+=4,w=t.read_shift(8,"f");break;case 11:t.l+=4,w=zt(t,4);break;case 64:t.l+=4,w=kt(ev(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[_]=w}}return t.l=r+n,d}var oA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function sL(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function sw(t,e,r){var n=ne(8),i=[],s=[],a=8,o=0,l=ne(8),c=ne(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=ne(8),c.write_shift(4,0),i.unshift(c);var f=[ne(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=ne(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=hr(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(oA.indexOf(t[o][0])>-1||ZS.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],p=0;if(e){p=+e[t[o][0]];var g=r[p];if(g.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=nw(g.t,d)}else{var _=sL(d);_==-1&&(_=31,d=String(d)),l=nw(_,d)}s.push(l),c=ne(8),c.write_shift(4,e?p:2+o),i.push(c),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),hr([n].concat(i).concat(s))}function aw(t,e,r){var n=t.content;if(!n)return{};wr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Ne.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=iw(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=s,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=iw(n,null)}catch{}for(p in g)d[p]=g[p];return d.FMTID=[s,a],d}function ow(t,e,r,n,i,s){var a=ne(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ne.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=sw(t,r,n);if(o.push(l),i){var c=sw(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return hr(o)}function _s(t,e){return t.read_shift(e),null}function aL(t,e){e||(e=ne(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function oL(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function zt(t,e){return t.read_shift(e)===1}function Yr(t,e){return e||(e=ne(2)),e.write_shift(2,+!!t),e}function Zt(t){return t.read_shift(2,"u")}function Mn(t,e){return e||(e=ne(2)),e.write_shift(2,t),e}function lA(t,e){return oL(t,e,Zt)}function lL(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function cA(t,e,r){return r||(r=ne(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function ju(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function cL(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function uL(t){var e=t.t||"",r=ne(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ne(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return hr(i)}function Ga(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Wu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ga(t,n,r)}function ao(t,e,r){if(r.biff>5)return Wu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function uA(t,e,r){return r||(r=ne(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function fL(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function hL(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(en,"");return n&&(t.l+=24),i}function dL(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(en,"");return r+a}function pL(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return hL(t);case"0303000000000000c000000000000046":return dL(t);default:throw new Error("Unsupported Moniker "+r)}}function Lf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(en,""):"";return r}function lw(t,e){e||(e=ne(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function mL(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",f,h;i&16&&(s=Lf(t,r-t.l)),i&128&&(a=Lf(t,r-t.l)),(i&257)===257&&(o=Lf(t,r-t.l)),(i&257)===1&&(l=pL(t,r-t.l)),i&8&&(c=Lf(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(h=ev(t)),t.l=r;var d=a||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return f&&(p.guid=f),h&&(p.time=h),s&&(p.Tooltip=s),p}function gL(t){var e=ne(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),lw(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&lw(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function fA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function hA(t,e){var r=fA(t);return r[3]=0,r}function Pi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ka(t,e,r,n){return n||(n=ne(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function vL(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function _L(t,e,r){return e===0?"":ao(t,e,r)}function xL(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function dA(t){var e=t.read_shift(2),r=Q1(t);return[e,r]}function yL(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=ju(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Z0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function pA(t,e){return e||(e=ne(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function mA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var wL=mA;function gA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function EL(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function TL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Dr(t){t.l+=2,t.l+=t.read_shift(2)}var kL={0:Dr,4:Dr,5:Dr,6:Dr,7:TL,8:Dr,9:Dr,10:Dr,11:Dr,12:Dr,13:EL,14:Dr,15:Dr,16:Dr,17:Dr,18:Dr,19:Dr,20:Dr,21:gA};function SL(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(kL[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Mf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function tv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ne(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function AL(t,e){return e===0||t.read_shift(2),1200}function IL(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=ao(t,0,r);return t.read_shift(e+n-t.l),i}function CL(t,e){var r=!e||e.biff==8,n=ne(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function RL(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function PL(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=ju(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function FL(t,e){var r=!e||e.biff>=8?2:1,n=ne(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function NL(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(cL(t));return s.Count=n,s.Unique=i,s}function DL(t,e){var r=ne(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=uL(t[i]);var s=hr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function OL(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function bL(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function LL(t){var e=vL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function ML(t){return t.read_shift(2),t.read_shift(4)}function cw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function VL(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function BL(){var t=ne(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function UL(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function jL(t){var e=ne(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function WL(){}function HL(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=ju(t,0,r),n}function zL(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ne(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function $L(t){var e=Pi(t);return e.isst=t.read_shift(4),e}function GL(t,e,r,n){var i=ne(10);return Ka(t,e,n,i),i.write_shift(4,r),i}function KL(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Pi(t);r.biff==2&&t.l++;var s=Wu(t,n-t.l,r);return i.val=s,i}function XL(t,e,r,n,i){var s=!i||i.biff==8,a=ne(8+ +s+(1+s)*r.length);return Ka(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function qL(t,e,r){var n=t.read_shift(2),i=ao(t,0,r);return[n,i]}function YL(t,e,r,n){var i=r&&r.biff==5;n||(n=ne(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var QL=ao;function uw(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function JL(t,e){var r=e.biff==8||!e.biff?4:2,n=ne(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function ZL(t){var e=t.read_shift(2),r=t.read_shift(2),n=dA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function e8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(dA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function t8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function r8(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=Lb[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function n8(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=r8(t,e,n.fStyle,r),n}function fw(t,e,r,n){var i=r&&r.biff==5;n||(n=ne(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function i8(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function s8(t){var e=ne(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function hw(t,e,r){var n=Pi(t);(r.biff==2||e==9)&&++t.l;var i=lL(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function a8(t,e,r,n,i,s){var a=ne(8);return Ka(t,e,n,a),cA(r,s,a),a}function o8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Pi(t),i=Ur(t);return n.val=i,n}function l8(t,e,r,n){var i=ne(14);return Ka(t,e,n,i),$a(r,i),i}var dw=_L;function c8(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ga(t,s),o=[];n>t.l;)o.push(Wu(t));return[s,i,a,o]}function pw(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=yL(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var u8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mw(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ga(t,a,r);i&32&&(c=u8[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:SV(t,f,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function vA(t,e,r){if(r.biff<8)return f8(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(xL(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function f8(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=ju(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function h8(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ga(t,n,r),a=Ga(t,i,r);return[s,a]}function d8(t,e,r){var n=mA(t);t.l++;var i=t.read_shift(1);return e-=8,[AV(t,e,r),i,n]}function gw(t,e,r){var n=wL(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,TV(t,e,r)]}function p8(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function m8(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=ao(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function g8(t,e,r){return m8(t,e,r)}function v8(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Z0(t));return r}function _8(t){var e=ne(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)pA(t[r],e);return e}function x8(t,e,r){if(r&&r.biff<8)return w8(t,e,r);var n=gA(t),i=SL(t,e-22,n[1]);return{cmo:n,ft:i}}var y8={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function w8(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((y8[n]||$r)(t,e,r)),{cmo:[i,n,s],ft:a}}function E8(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=fL(t,6,r);var o=t.read_shift(2);t.read_shift(2),Zt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Ga(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function T8(t,e){var r=Z0(t);t.l+=16;var n=mL(t,e-24);return[r,n]}function k8(t){var e=ne(24),r=Nt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return hr([e,gL(t[1])])}function S8(t,e){t.read_shift(2);var r=Z0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(en,""),[r,n]}function A8(t){var e=t[1].Tooltip,r=ne(10+2*(e.length+1));r.write_shift(2,2048);var n=Nt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function I8(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ew[r]||r,r=t.read_shift(2),e[1]=ew[r]||r,e}function C8(t){return t||(t=ne(4)),t.write_shift(2,1),t.write_shift(2,1),t}function R8(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(hA(t));return r}function P8(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(hA(t));return r}function F8(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function _A(t,e,r){if(!r.cellStyles)return $r(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function N8(t,e){var r=ne(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function D8(t,e){var r={};return e<32||(t.l+=16,r.header=Ur(t),r.footer=Ur(t),t.l+=2),r}function O8(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function b8(t){for(var e=ne(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var L8=Pi,M8=lA,V8=Wu;function B8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function U8(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Pi(t);++t.l;var i=ao(t,e-7,r);return n.t="str",n.val=i,n}function j8(t){var e=Pi(t);++t.l;var r=Ur(t);return e.t="n",e.val=r,e}function W8(t,e,r){var n=ne(15);return Gu(n,t,e),n.write_shift(8,r,"f"),n}function H8(t){var e=Pi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function z8(t,e,r){var n=ne(9);return Gu(n,t,e),n.write_shift(2,r),n}function $8(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function G8(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function K8(t,e,r){var n=t.l+e,i=Pi(t),s=t.read_shift(2),a=Ga(t,s,r);return t.l=n,i.t="str",i.val=a,i}var X8=[2,3,48,49,131,139,140,245],Lm=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Y0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=qs(1);switch(l.type){case"base64":f=yn(An(o));break;case"binary":f=yn(o);break;case"buffer":case"array":f=o;break}wr(f,0);var h=f.read_shift(1),d=!!(h&136),p=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,_=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(_=f.read_shift(2));var w=f.read_shift(2),E=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=t[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var x=[],P={},W=Math.min(f.length,h==2?521:_-10-(p?264:0)),M=g?32:11;f.l<W&&f[f.l]!=13;)switch(P={},P.name=ru.utils.decode(E,f.slice(f.l,f.l+M)).replace(/[\u0000\r\n].*$/g,""),f.l+=M,P.type=String.fromCharCode(f.read_shift(1)),h!=2&&!g&&(P.offset=f.read_shift(4)),P.len=f.read_shift(1),h==2&&(P.offset=f.read_shift(2)),P.dec=f.read_shift(1),P.name.length&&x.push(P),h!=2&&(f.l+=g?13:14),P.type){case"B":(!p||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var y=0,k=0;for(c[0]=[],k=0;k!=x.length;++k)c[0][k]=x[k].name;for(;m-- >0;){if(f[f.l]===42){f.l+=w;continue}for(++f.l,c[++y]=[],k=0,k=0;k!=x.length;++k){var S=f.slice(f.l,f.l+x[k].len);f.l+=x[k].len,wr(S,0);var I=ru.utils.decode(E,S);switch(x[k].type){case"C":I.trim().length&&(c[y][k]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[y][k]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[y][k]=I;break;case"F":c[y][k]=parseFloat(I.trim());break;case"+":case"I":c[y][k]=g?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[y][k]=!0;break;case"N":case"F":c[y][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[y][k]="##MEMO##"+(g?parseInt(I.trim(),10):S.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[y][k]=+I||0);break;case"@":c[y][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[y][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[y][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[y][k]=-S.read_shift(-8,"f");break;case"B":if(p&&x[k].len==8){c[y][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=x[k].len;break;case"0":if(x[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Il(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function i(o,l){try{return sa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ei(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=hn(),h=f0(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),g=o["!cols"]||[],m=0,_=0,w=0,E=1;for(m=0;m<d.length;++m){if(((g[m]||{}).DBF||{}).name){d[m]=g[m].DBF.name,++w;continue}if(d[m]!=null){if(++w,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(_=0;_<1024;++_)if(d.indexOf(d[m]+"_"+_)==-1){d[m]+="_"+_;break}}}}var x=rt(o["!ref"]),P=[],W=[],M=[];for(m=0;m<=x.e.c-x.s.c;++m){var y="",k="",S=0,I=[];for(_=0;_<p.length;++_)p[_][m]!=null&&I.push(p[_][m]);if(I.length==0||d[m]==null){P[m]="?";continue}for(_=0;_<I.length;++_){switch(typeof I[_]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=I[_]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(I[_]).length),y=y&&y!=k?"C":k}S>250&&(S=250),k=((g[m]||{}).DBF||{}).type,k=="C"&&g[m].DBF.len>S&&(S=g[m].DBF.len),y=="B"&&k=="N"&&(y="N",M[m]=g[m].DBF.dec,S=g[m].DBF.len),W[m]=y=="C"||k=="N"?S:s[y]||0,E+=W[m],P[m]=y}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,p.length),R.write_shift(2,296+32*w),R.write_shift(2,E),m=0;m<4;++m)R.write_shift(4,0);for(R.write_shift(4,0|(+e[oS]||3)<<8),m=0,_=0;m<d.length;++m)if(d[m]!=null){var C=f.next(32),N=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,N,"sbcs"),C.write_shift(1,P[m]=="?"?"C":P[m],"sbcs"),C.write_shift(4,_),C.write_shift(1,W[m]||s[P[m]]||0),C.write_shift(1,M[m]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),_+=W[m]||s[P[m]]||0}var _e=f.next(264);for(_e.write_shift(4,13),m=0;m<65;++m)_e.write_shift(4,0);for(m=0;m<p.length;++m){var pe=f.next(E);for(pe.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(P[_]){case"L":pe.write_shift(1,p[m][_]==null?63:p[m][_]?84:70);break;case"B":pe.write_shift(8,p[m][_]||0,"f");break;case"N":var Te="0";for(typeof p[m][_]=="number"&&(Te=p[m][_].toFixed(M[_]||0)),w=0;w<W[_]-Te.length;++w)pe.write_shift(1,32);pe.write_shift(1,Te,"sbcs");break;case"D":p[m][_]?(pe.write_shift(4,("0000"+p[m][_].getFullYear()).slice(-4),"sbcs"),pe.write_shift(2,("00"+(p[m][_].getMonth()+1)).slice(-2),"sbcs"),pe.write_shift(2,("00"+p[m][_].getDate()).slice(-2),"sbcs")):pe.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(p[m][_]!=null?p[m][_]:"").slice(0,W[_]);for(pe.write_shift(1,ge,"sbcs"),w=0;w<W[_]-ge.length;++w)pe.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),xA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Wt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var g=t[p];return typeof g=="number"?Iy(g):g},n=function(d,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?d:Iy(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return s(An(d),p);case"binary":return s(d,p);case"buffer":return s(Ke&&Buffer.isBuffer(d)?d.toString("binary"):ia(d),p);case"array":return s(za(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var g=d.split(/[\n\r]+/),m=-1,_=-1,w=0,E=0,x=[],P=[],W=null,M={},y=[],k=[],S=[],I=0,R;for(+p.codepage>=0&&ei(+p.codepage);w!==g.length;++w){I=0;var C=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=C.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),_e=N[0],pe;if(C.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&P.push(C.slice(3).replace(/;;/g,";"));break;case"C":var Te=!1,ge=!1,ce=!1,V=!1,X=-1,oe=-1;for(E=1;E<N.length;++E)switch(N[E].charAt(0)){case"A":break;case"X":_=parseInt(N[E].slice(1))-1,ge=!0;break;case"Y":for(m=parseInt(N[E].slice(1))-1,ge||(_=0),R=x.length;R<=m;++R)x[R]=[];break;case"K":pe=N[E].slice(1),pe.charAt(0)==='"'?pe=pe.slice(1,pe.length-1):pe==="TRUE"?pe=!0:pe==="FALSE"?pe=!1:isNaN(ii(pe))?isNaN(ml(pe).getDate())||(pe=kt(pe)):(pe=ii(pe),W!==null&&Sl(W)&&(pe=J0(pe))),Te=!0;break;case"E":V=!0;var b=Yo(N[E].slice(1),{r:m,c:_});x[m][_]=[x[m][_],b];break;case"S":ce=!0,x[m][_]=[x[m][_],"S5S"];break;case"G":break;case"R":X=parseInt(N[E].slice(1))-1;break;case"C":oe=parseInt(N[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(Te&&(x[m][_]&&x[m][_].length==2?x[m][_][0]=pe:x[m][_]=pe,W=null),ce){if(V)throw new Error("SYLK shared formula cannot have own formula");var j=X>-1&&x[X][oe];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");x[m][_][1]=MA(j[1],{r:m-X,c:_-oe})}break;case"F":var z=0;for(E=1;E<N.length;++E)switch(N[E].charAt(0)){case"X":_=parseInt(N[E].slice(1))-1,++z;break;case"Y":for(m=parseInt(N[E].slice(1))-1,R=x.length;R<=m;++R)x[R]=[];break;case"M":I=parseInt(N[E].slice(1))/20;break;case"F":break;case"G":break;case"P":W=P[parseInt(N[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=N[E].slice(1).split(" "),R=parseInt(S[0],10);R<=parseInt(S[1],10);++R)I=parseInt(S[2],10),k[R-1]=I===0?{hidden:!0}:{wch:I},Ys(k[R-1]);break;case"C":_=parseInt(N[E].slice(1))-1,k[_]||(k[_]={});break;case"R":m=parseInt(N[E].slice(1))-1,y[m]||(y[m]={}),I>0?(y[m].hpt=I,y[m].hpx=vl(I)):I===0&&(y[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}z<1&&(W=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return y.length>0&&(M["!rows"]=y),k.length>0&&(M["!cols"]=k),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,M]}function a(d,p){var g=i(d,p),m=g[0],_=g[1],w=Il(m,p);return Wt(_).forEach(function(E){w[E]=_[E]}),w}function o(d,p){return sa(a(d,p),p)}function l(d,p,g,m){var _="C;Y"+(g+1)+";X"+(m+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+ov(d.f,{r:g,c:m}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(d,p){p.forEach(function(g,m){var _="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=uu(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=fu(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function f(d,p){p.forEach(function(g,m){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*hu(g.hpx)+";"),_.length>2&&d.push(_+"R"+(m+1))})}function h(d,p){var g=["ID;PWXL;N;E"],m=[],_=rt(d["!ref"]),w,E=Array.isArray(d),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&c(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var P=_.s.r;P<=_.e.r;++P)for(var W=_.s.c;W<=_.e.c;++W){var M=be({r:P,c:W});w=E?(d[P]||[])[W]:d[M],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,d,P,W))}return g.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),yA=function(){function t(s,a){switch(a.type){case"base64":return e(An(s),a);case"binary":return e(s,a);case"buffer":return e(Ke&&Buffer.isBuffer(s)?s.toString("binary"):ia(s),a);case"array":return e(za(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),p=d[0],g=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(ii(g))?isNaN(ml(g).getDate())?h[l][c]=g:h[l][c]=kt(g):h[l][c]=ii(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Il(t(s,a),a)}function n(s,a){return sa(r(s,a),a)}var i=function(){var s=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=rt(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){a(c,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var m=be({r:p,c:g});if(h=d?(l[p]||[])[g]:l[m],!h){a(c,1,0,"");continue}switch(h.t){case"n":var _=h.w;!_&&h.v!=null&&(_=h.v),_==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,_,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Gn(h.z||Oe[14],ar(kt(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var w=`\r
`,E=c.join(w);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),wA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),g=-1,m=-1,_=0,w=[];_!==p.length;++_){var E=p[_].trim().split(":");if(E[0]==="cell"){var x=Nt(E[1]);if(w.length<=x.r)for(g=w.length;g<=x.r;++g)w[g]||(w[g]=[]);switch(g=x.r,m=x.c,E[2]){case"t":w[g][m]=t(E[3]);break;case"v":w[g][m]=+E[3];break;case"vtf":var P=E[E.length-1];case"vtc":switch(E[3]){case"nl":w[g][m]=!!+E[4];break;default:w[g][m]=+E[4];break}E[2]=="vtf"&&(w[g][m]=[w[g][m],P])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return Il(r(h,d),d)}function i(h,d){return sa(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],g,m="",_=dn(h["!ref"]),w=Array.isArray(h),E=_.s.r;E<=_.e.r;++E)for(var x=_.s.c;x<=_.e.c;++x)if(m=be({r:E,c:x}),g=w?(h[E]||[])[x]:h[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(e(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=e(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var P=ar(kt(g.v));p[2]="vtc",p[3]="nd",p[4]=""+P,p[5]=g.w||Gn(g.z||Oe[14],P);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),gl=function(){function t(f,h,d,p,g){g.raw?h[d][p]=f:f===""||(f==="TRUE"?h[d][p]=!0:f==="FALSE"?h[d][p]=!1:isNaN(ii(f))?isNaN(ml(f).getDate())?h[d][p]=f:h[d][p]=kt(f):h[d][p]=ii(f))}function e(f,h){var d=h||{},p=[];if(!f||f.length===0)return p;for(var g=f.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var _=10,w=0,E=0;E<=m;++E)w=g[E].indexOf(" "),w==-1?w=g[E].length:w++,_=Math.max(_,w);for(E=0;E<=m;++E){p[E]=[];var x=0;for(t(g[E].slice(0,_).trim(),p,E,x,d),x=1;x<=(g[E].length-_)/10+1;++x)t(g[E].slice(_+(x-1)*10,_+x*10).trim(),p,E,x,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,p=0,g=0;p<f.length;++p)(g=f.charCodeAt(p))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p]);if(!g.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p])}return g.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[g.pop()[1]]||44}function s(f,h){var d=h||{},p="",g=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=i(f.slice(0,1024)):d&&d.FS?p=d.FS:p=i(f.slice(0,1024));var _=0,w=0,E=0,x=0,P=0,W=p.charCodeAt(0),M=!1,y=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=d.dateNF!=null?O6(d.dateNF):null;function I(){var R=f.slice(x,P),C={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)C.t="z";else if(d.raw)C.t="s",C.v=R;else if(R.trim().length===0)C.t="s",C.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(C.t="s",C.v=R.slice(2,-1).replace(/""/g,'"')):c9(R)?(C.t="n",C.f=R.slice(1)):(C.t="s",C.v=R);else if(R=="TRUE")C.t="b",C.v=!0;else if(R=="FALSE")C.t="b",C.v=!1;else if(!isNaN(E=ii(R)))C.t="n",d.cellText!==!1&&(C.w=R),C.v=E;else if(!isNaN(ml(R).getDate())||S&&R.match(S)){C.z=d.dateNF||Oe[14];var N=0;S&&R.match(S)&&(R=b6(R,d.dateNF,R.match(S)||[]),N=1),d.cellDates?(C.t="d",C.v=kt(R,N)):(C.t="n",C.v=ar(kt(R,N))),d.cellText!==!1&&(C.w=Gn(C.z,C.v instanceof Date?ar(C.v):C.v)),d.cellNF||delete C.z}else C.t="s",C.v=R;if(C.t=="z"||(d.dense?(g[_]||(g[_]=[]),g[_][w]=C):g[be({c:w,r:_})]=C),x=P+1,k=f.charCodeAt(x),m.e.c<w&&(m.e.c=w),m.e.r<_&&(m.e.r=_),y==W)++w;else if(w=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;P<f.length;++P)switch(y=f.charCodeAt(P)){case 34:k===34&&(M=!M);break;case W:case 10:case 13:if(!M&&I())break e;break}return P-x>0&&I(),g["!ref"]=We(m),g}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):Il(e(f,h),h)}function o(f,h){var d="",p=h.type=="string"?[0,0,0,0]:mv(f,h);switch(h.type){case"base64":d=An(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof ru<"u"||(d=Ke&&Buffer.isBuffer(f)?f.toString("binary"):ia(f));break;case"array":d=za(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=pt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=pt(d):h.type=="binary"&&typeof ru<"u",d.slice(0,19)=="socialcalc:version:"?wA.to_sheet(h.type=="string"?d:pt(d),h):a(d,h)}function l(f,h){return sa(o(f,h),h)}function c(f){for(var h=[],d=rt(f["!ref"]),p,g=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var _=[],w=d.s.c;w<=d.e.c;++w){var E=be({r:m,c:w});if(p=g?(f[m]||[])[w]:f[E],!p||p.v==null){_.push("          ");continue}for(var x=(p.w||(ss(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";_.push(x+(w===0?" ":""))}h.push(_.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function q8(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=xA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return gl.to_workbook(t,e)}}var Ra=function(){function t(b,j,z){if(b){wr(b,b.l||0);for(var K=z.Enum||X;b.l<b.length;){var q=b.read_shift(2),se=K[q]||K[65535],le=b.read_shift(2),ae=b.l+le,ie=se.f&&se.f(b,le,z);if(b.l=ae,j(ie,se,q))return}}}function e(b,j){switch(j.type){case"base64":return r(yn(An(b)),j);case"binary":return r(yn(b),j);case"buffer":case"array":return r(b,j)}throw"Unsupported type "+j.type}function r(b,j){if(!b)return b;var z=j||{},K=z.dense?[]:{},q="Sheet1",se="",le=0,ae={},ie=[],Fe=[],G={s:{r:0,c:0},e:{r:0,c:0}},qe=z.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)z.Enum=X,t(b,function(ke,Ct,Kr){switch(Kr){case 0:z.vers=ke,ke>=4096&&(z.qpro=!0);break;case 6:G=ke;break;case 204:ke&&(se=ke);break;case 222:se=ke;break;case 15:case 51:z.qpro||(ke[1].v=ke[1].v.slice(1));case 13:case 14:case 16:Kr==14&&(ke[2]&112)==112&&(ke[2]&15)>1&&(ke[2]&15)<15&&(ke[1].z=z.dateNF||Oe[14],z.cellDates&&(ke[1].t="d",ke[1].v=J0(ke[1].v))),z.qpro&&ke[3]>le&&(K["!ref"]=We(G),ae[q]=K,ie.push(q),K=z.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},le=ke[3],q=se||"Sheet"+(le+1),se="");var nn=z.dense?(K[ke[0].r]||[])[ke[0].c]:K[be(ke[0])];if(nn){nn.t=ke[1].t,nn.v=ke[1].v,ke[1].z!=null&&(nn.z=ke[1].z),ke[1].f!=null&&(nn.f=ke[1].f);break}z.dense?(K[ke[0].r]||(K[ke[0].r]=[]),K[ke[0].r][ke[0].c]=ke[1]):K[be(ke[0])]=ke[1];break}},z);else if(b[2]==26||b[2]==14)z.Enum=oe,b[2]==14&&(z.qpro=!0,b.l=0),t(b,function(ke,Ct,Kr){switch(Kr){case 204:q=ke;break;case 22:ke[1].v=ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ke[3]>le&&(K["!ref"]=We(G),ae[q]=K,ie.push(q),K=z.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},le=ke[3],q="Sheet"+(le+1)),qe>0&&ke[0].r>=qe)break;z.dense?(K[ke[0].r]||(K[ke[0].r]=[]),K[ke[0].r][ke[0].c]=ke[1]):K[be(ke[0])]=ke[1],G.e.c<ke[0].c&&(G.e.c=ke[0].c),G.e.r<ke[0].r&&(G.e.r=ke[0].r);break;case 27:ke[14e3]&&(Fe[ke[14e3][0]]=ke[14e3][1]);break;case 1537:Fe[ke[0]]=ke[1],ke[0]==le&&(q=ke[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(K["!ref"]=We(G),ae[se||q]=K,ie.push(se||q),!Fe.length)return{SheetNames:ie,Sheets:ae};for(var $e={},at=[],Ge=0;Ge<Fe.length;++Ge)ae[ie[Ge]]?(at.push(Fe[Ge]||ie[Ge]),$e[Fe[Ge]]=ae[Fe[Ge]]||ae[ie[Ge]]):(at.push(Fe[Ge]),$e[Fe[Ge]]={"!ref":"A1"});return{SheetNames:at,Sheets:$e}}function n(b,j){var z=j||{};if(+z.codepage>=0&&ei(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var K=hn(),q=rt(b["!ref"]),se=Array.isArray(b),le=[];ye(K,0,s(1030)),ye(K,6,l(q));for(var ae=Math.min(q.e.r,8191),ie=q.s.r;ie<=ae;++ie)for(var Fe=Kt(ie),G=q.s.c;G<=q.e.c;++G){ie===q.s.r&&(le[G]=Ft(G));var qe=le[G]+Fe,$e=se?(b[ie]||[])[G]:b[qe];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?ye(K,13,p(ie,G,$e.v)):ye(K,14,m(ie,G,$e.v));else{var at=ss($e);ye(K,15,h(ie,G,at.slice(0,239)))}}return ye(K,1),K.end()}function i(b,j){var z=j||{};if(+z.codepage>=0&&ei(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var K=hn();ye(K,0,a(b));for(var q=0,se=0;q<b.SheetNames.length;++q)(b.Sheets[b.SheetNames[q]]||{})["!ref"]&&ye(K,27,V(b.SheetNames[q],se++));var le=0;for(q=0;q<b.SheetNames.length;++q){var ae=b.Sheets[b.SheetNames[q]];if(!(!ae||!ae["!ref"])){for(var ie=rt(ae["!ref"]),Fe=Array.isArray(ae),G=[],qe=Math.min(ie.e.r,8191),$e=ie.s.r;$e<=qe;++$e)for(var at=Kt($e),Ge=ie.s.c;Ge<=ie.e.c;++Ge){$e===ie.s.r&&(G[Ge]=Ft(Ge));var ke=G[Ge]+at,Ct=Fe?(ae[$e]||[])[Ge]:ae[ke];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")ye(K,23,I($e,Ge,le,Ct.v));else{var Kr=ss(Ct);ye(K,22,y($e,Ge,le,Kr.slice(0,239)))}}++le}}return ye(K,1),K.end()}function s(b){var j=ne(2);return j.write_shift(2,b),j}function a(b){var j=ne(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var z=0,K=0,q=0,se=0;se<b.SheetNames.length;++se){var le=b.SheetNames[se],ae=b.Sheets[le];if(!(!ae||!ae["!ref"])){++q;var ie=dn(ae["!ref"]);z<ie.e.r&&(z=ie.e.r),K<ie.e.c&&(K=ie.e.c)}}return z>8191&&(z=8191),j.write_shift(2,z),j.write_shift(1,q),j.write_shift(1,K),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(b,j,z){var K={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&z.qpro?(K.s.c=b.read_shift(1),b.l++,K.s.r=b.read_shift(2),K.e.c=b.read_shift(1),b.l++,K.e.r=b.read_shift(2),K):(K.s.c=b.read_shift(2),K.s.r=b.read_shift(2),j==12&&z.qpro&&(b.l+=2),K.e.c=b.read_shift(2),K.e.r=b.read_shift(2),j==12&&z.qpro&&(b.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function l(b){var j=ne(8);return j.write_shift(2,b.s.c),j.write_shift(2,b.s.r),j.write_shift(2,b.e.c),j.write_shift(2,b.e.r),j}function c(b,j,z){var K=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(K[0].c=b.read_shift(1),K[3]=b.read_shift(1),K[0].r=b.read_shift(2),b.l+=2):(K[2]=b.read_shift(1),K[0].c=b.read_shift(2),K[0].r=b.read_shift(2)),K}function f(b,j,z){var K=b.l+j,q=c(b,j,z);if(q[1].t="s",z.vers==20768){b.l++;var se=b.read_shift(1);return q[1].v=b.read_shift(se,"utf8"),q}return z.qpro&&b.l++,q[1].v=b.read_shift(K-b.l,"cstr"),q}function h(b,j,z){var K=ne(7+z.length);K.write_shift(1,255),K.write_shift(2,j),K.write_shift(2,b),K.write_shift(1,39);for(var q=0;q<K.length;++q){var se=z.charCodeAt(q);K.write_shift(1,se>=128?95:se)}return K.write_shift(1,0),K}function d(b,j,z){var K=c(b,j,z);return K[1].v=b.read_shift(2,"i"),K}function p(b,j,z){var K=ne(7);return K.write_shift(1,255),K.write_shift(2,j),K.write_shift(2,b),K.write_shift(2,z,"i"),K}function g(b,j,z){var K=c(b,j,z);return K[1].v=b.read_shift(8,"f"),K}function m(b,j,z){var K=ne(13);return K.write_shift(1,255),K.write_shift(2,j),K.write_shift(2,b),K.write_shift(8,z,"f"),K}function _(b,j,z){var K=b.l+j,q=c(b,j,z);if(q[1].v=b.read_shift(8,"f"),z.qpro)b.l=K;else{var se=b.read_shift(2);P(b.slice(b.l,b.l+se),q),b.l+=se}return q}function w(b,j,z){var K=j&32768;return j&=-32769,j=(K?b:0)+(j>=8192?j-16384:j),(K?"":"$")+(z?Ft(j):Kt(j))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(b,j){wr(b,0);for(var z=[],K=0,q="",se="",le="",ae="";b.l<b.length;){var ie=b[b.l++];switch(ie){case 0:z.push(b.read_shift(8,"f"));break;case 1:se=w(j[0].c,b.read_shift(2),!0),q=w(j[0].r,b.read_shift(2),!1),z.push(se+q);break;case 2:{var Fe=w(j[0].c,b.read_shift(2),!0),G=w(j[0].r,b.read_shift(2),!1);se=w(j[0].c,b.read_shift(2),!0),q=w(j[0].r,b.read_shift(2),!1),z.push(Fe+G+":"+se+q)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(b.read_shift(2));break;case 6:{for(var qe="";ie=b[b.l++];)qe+=String.fromCharCode(ie);z.push('"'+qe.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ae=z.pop(),le=z.pop(),z.push(["AND","OR"][ie-20]+"("+le+","+ae+")");break;default:if(ie<32&&x[ie])ae=z.pop(),le=z.pop(),z.push(le+x[ie]+ae);else if(E[ie]){if(K=E[ie][1],K==69&&(K=b[b.l++]),K>z.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+z.join("|")+"|");return}var $e=z.slice(-K);z.length-=K,z.push(E[ie][0]+"("+$e.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}z.length==1?j[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function W(b){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=b.read_shift(2),j[3]=b[b.l++],j[0].c=b[b.l++],j}function M(b,j){var z=W(b);return z[1].t="s",z[1].v=b.read_shift(j-4,"cstr"),z}function y(b,j,z,K){var q=ne(6+K.length);q.write_shift(2,b),q.write_shift(1,z),q.write_shift(1,j),q.write_shift(1,39);for(var se=0;se<K.length;++se){var le=K.charCodeAt(se);q.write_shift(1,le>=128?95:le)}return q.write_shift(1,0),q}function k(b,j){var z=W(b);z[1].v=b.read_shift(2);var K=z[1].v>>1;if(z[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return z[1].v=K,z}function S(b,j){var z=W(b),K=b.read_shift(4),q=b.read_shift(4),se=b.read_shift(2);if(se==65535)return K===0&&q===3221225472?(z[1].t="e",z[1].v=15):K===0&&q===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var le=se&32768;return se=(se&32767)-16446,z[1].v=(1-le*2)*(q*Math.pow(2,se+32)+K*Math.pow(2,se)),z}function I(b,j,z,K){var q=ne(14);if(q.write_shift(2,b),q.write_shift(1,z),q.write_shift(1,j),K==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var se=0,le=0,ae=0,ie=0;return K<0&&(se=1,K=-K),le=Math.log2(K)|0,K/=Math.pow(2,le-31),ie=K>>>0,ie&2147483648||(K/=2,++le,ie=K>>>0),K-=ie,ie|=2147483648,ie>>>=0,K*=Math.pow(2,32),ae=K>>>0,q.write_shift(4,ae),q.write_shift(4,ie),le+=16383+(se?32768:0),q.write_shift(2,le),q}function R(b,j){var z=S(b);return b.l+=j-14,z}function C(b,j){var z=W(b),K=b.read_shift(4);return z[1].v=K>>6,z}function N(b,j){var z=W(b),K=b.read_shift(8,"f");return z[1].v=K,z}function _e(b,j){var z=N(b);return b.l+=j-10,z}function pe(b,j){return b[b.l+j-1]==0?b.read_shift(j,"cstr"):""}function Te(b,j){var z=b[b.l++];z>j-1&&(z=j-1);for(var K="";K.length<z;)K+=String.fromCharCode(b[b.l++]);return K}function ge(b,j,z){if(!(!z.qpro||j<21)){var K=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var q=b.read_shift(j-21,"cstr");return[K,q]}}function ce(b,j){for(var z={},K=b.l+j;b.l<K;){var q=b.read_shift(2);if(q==14e3){for(z[q]=[0,""],z[q][0]=b.read_shift(2);b[b.l];)z[q][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return z}function V(b,j){var z=ne(5+b.length);z.write_shift(2,14e3),z.write_shift(2,j);for(var K=0;K<b.length;++K){var q=b.charCodeAt(K);z[z.l++]=q>127?95:q}return z[z.l++]=0,z}var X={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pe},222:{n:"SHEETNAMELP",f:Te},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function Y8(t){var e={},r=t.match(Gr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Le(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=N1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var Q8=function(){var t=su("t"),e=su("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:tt(a[1])},l=s.match(e);return l&&(o.s=Y8(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),J8=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Z8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eM=/<(?:\w+:)?r>/,tM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=tt(pt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pt(t),r&&(n.h=W1(n.t))):t.match(eM)&&(n.r=pt(t),n.t=tt(pt((t.replace(tM,"").match(Z8)||[]).join("").replace(Gr,""))),r&&(n.h=J8(Q8(n.r)))),n):{t:""}}var rM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nM=/<(?:\w+:)?(?:si|sstItem)>/g,iM=/<\/(?:\w+:)?(?:si|sstItem)>/;function sM(t,e){var r=[],n="";if(!t)return r;var i=t.match(rM);if(i){n=i[2].replace(nM,"").split(iM);for(var s=0;s!=n.length;++s){var a=rv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Le(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var aM=/^\s|\s$|[\t\n\r]/;function EA(t,e){if(!e.bookSST)return"";var r=[Xt];r[r.length]=xe("sst",null,{xmlns:to[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(aM)&&(s+=' xml:space="preserve"'),s+=">"+ut(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oM(t){return[t.read_shift(4),t.read_shift(4)]}function lM(t,e){var r=[],n=!1;return us(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function cM(t,e){return e||(e=ne(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var uM=yb;function fM(t){var e=hn();fe(e,159,cM(t));for(var r=0;r<t.length;++r)fe(e,19,uM(t[r]));return fe(e,160),e.end()}function TA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Yi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function hM(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Yi(t,4),e.U=Yi(t,4),e.W=Yi(t,4),e}function dM(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function pM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(dM(t));return e}function mM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function gM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Yi(t,4),e.U=Yi(t,4),e.W=Yi(t,4),e}function vM(t){var e=gM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function kA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function SA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function _M(t){var e=Yi(t);switch(e.Minor){case 2:return[e.Minor,xM(t)];case 3:return[e.Minor,yM()];case 4:return[e.Minor,wM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function xM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=kA(t,r),i=SA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function yM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wM(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Gr,function(s){var a=Le(s);switch(Ri(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function EM(t,e){var r={},n=r.EncryptionVersionInfo=Yi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=kA(t,i),e-=i,r.EncryptionVerifier=SA(t,e),r}function TM(t){var e={},r=e.EncryptionVersionInfo=Yi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function nv(t){var e=0,r,n=TA(t),i=n.length+1,s,a,o,l,c;for(r=qs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var AA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var f=a[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=TA(a),l=s(o),c=o.length,f=qs(16),h=0;h!=16;++h)f[h]=0;var d,p,g;for((c&1)===1&&(d=l>>8,f[c]=i(t[0],d),--c,d=l&255,p=o[o.length-1],f[c]=i(p,d));c>0;)--c,d=l>>8,f[c]=i(o[c],d),--c,d=l&255,f[c]=i(o[c],d);for(c=15,g=15-o.length;g>0;)d=l>>8,f[c]=i(t[g],d),--c,--g,d=l&255,f[c]=i(o[c],d),--c,--g;return f}}(),kM=function(t,e,r,n,i){i||(i=e),n||(n=AA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},SM=function(t){var e=0,r=AA(t);return function(n){var i=kM("",n,e,r);return e=i[1],i[0]}};function AM(t,e,r,n){var i={key:Zt(t),verificationBytes:Zt(t)};return r.password&&(i.verifier=nv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=SM(r.password)),i}function IM(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=TM(t):n.Data=EM(t,e),n}function CM(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?IM(t,e-2,n):AM(t,r.biff>=8?e:e-2,r,n),n}var IA=function(){function t(i,s){switch(s.type){case"base64":return e(An(i),s);case"binary":return e(i,s);case"buffer":return e(Ke&&Buffer.isBuffer(i)?i.toString("binary"):ia(i),s);case"array":return e(za(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,g,m=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var _=f.slice(p,d.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var w={v:_,t:"s"};Array.isArray(o)?o[h][m]=w:o[be({r:h,c:m})]=w}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=We(c),o}function r(i,s){return sa(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=rt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=be({r:c,c:f});o=l?(i[c]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ss(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function RM(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function cu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function PM(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function FM(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function l0(t,e){if(e===0)return t;var r=PM(RM(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),cu(FM(r))}var CA=6,NM=15,DM=1,Br=CA;function uu(t){return Math.floor((t+Math.round(128/Br)/256)*Br)}function fu(t){return Math.floor((t-5)/Br*100+.5)/100}function c0(t){return Math.round((t*Br+5)/Br*256)/256}function rp(t){return c0(fu(uu(t)))}function iv(t){var e=Math.abs(t-rp(t)),r=Br;if(e>.005)for(Br=DM;Br<NM;++Br)Math.abs(t-rp(t))<=e&&(e=Math.abs(t-rp(t)),r=Br);Br=r}function Ys(t){t.width?(t.wpx=uu(t.width),t.wch=fu(t.wpx),t.MDW=Br):t.wpx?(t.wch=fu(t.wpx),t.width=c0(t.wch),t.MDW=Br):typeof t.wch=="number"&&(t.width=c0(t.wch),t.wpx=uu(t.width),t.MDW=Br),t.customWidth&&delete t.customWidth}var OM=96,RA=OM;function hu(t){return t*96/RA}function vl(t){return t*RA/96}var bM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function LM(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Gr)||[]).forEach(function(a){var o=Le(a);switch(Ri(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=wt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=wt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function MM(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Gr)||[]).forEach(function(a){var o=Le(a);switch(Ri(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function VM(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Gr)||[]).forEach(function(a){var o=Le(a);switch(Ri(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=pt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?wt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?wt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?wt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?wt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?wt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?wt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?wt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=N1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=wt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ia[i.color.index];i.color.index==81&&(l=Ia[1]),l||(l=Ia[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=l0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function BM(t,e,r){e.NumberFmt=[];for(var n=Wt(Oe),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Oe[n[i]];var s=t[0].match(Gr);if(s)for(i=0;i<s.length;++i){var a=Le(s[i]);switch(Ri(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=tt(pt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}qi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function UM(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=xe("numFmt",null,{numFmtId:n,formatCode:ut(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=xe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Vf=["numFmtId","fillId","fontId","borderId","xfId"],Bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function jM(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Gr)||[]).forEach(function(s){var a=Le(s),o=0;switch(Ri(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Vf.length;++o)n[Vf[o]]&&(n[Vf[o]]=parseInt(n[Vf[o]],10));for(o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=wt(n[Bf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=wt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function WM(t){var e=[];return e[e.length]=xe("cellXfs",null),t.forEach(function(r){e[e.length]=xe("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=xe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var HM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&BM(h,f,c),(h=o.match(i))&&VM(h,f,l,c),(h=o.match(n))&&MM(h,f,l,c),(h=o.match(s))&&LM(h,f,l,c),(h=o.match(r))&&jM(h,f,c),f}}();function PA(t,e){var r=[Xt,xe("styleSheet",null,{xmlns:to[0],"xmlns:vt":nr.vt})],n;return t.SSF&&(n=UM(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=WM(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function zM(t,e){var r=t.read_shift(2),n=Wr(t);return[r,n]}function $M(t,e,r){r||(r=ne(6+4*e.length)),r.write_shift(2,t),dr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function GM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Ib(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Ab(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wr(t),n}function KM(t,e){e||(e=ne(25+4*32)),e.write_shift(2,t.sz*20),Cb(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),s0(t.color,e);var n=0;return n=2,e.write_shift(1,n),dr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var XM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],np,qM=$r;function vw(t,e){e||(e=ne(4*3+8*7+16*1)),np||(np=Y0(XM));var r=np[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(s0({auto:1},e),s0({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function YM(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function FA(t,e,r){r||(r=ne(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Xl(t,e){return e||(e=ne(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var QM=$r;function JM(t,e){return e||(e=ne(51)),e.write_shift(1,0),Xl(null,e),Xl(null,e),Xl(null,e),Xl(null,e),Xl(null,e),e.length>e.l?e.slice(0,e.l):e}function ZM(t,e){return e||(e=ne(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),i0(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function e5(t,e,r){var n=ne(2052);return n.write_shift(4,t),i0(e,n),i0(r,n),n.length>n.l?n.slice(0,n.l):n}function t5(t,e,r){var n={};n.NumberFmt=[];for(var i in Oe)n.NumberFmt[i]=Oe[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return us(t,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],qi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=l0(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function r5(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(fe(t,615,si(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&fe(t,44,$M(i,e[i]))}),fe(t,616))}}function n5(t){var e=1;fe(t,611,si(e)),fe(t,43,KM({sz:12,color:{theme:1},name:"Calibri",family:2})),fe(t,612)}function i5(t){var e=2;fe(t,603,si(e)),fe(t,45,vw({patternType:"none"})),fe(t,45,vw({patternType:"gray125"})),fe(t,604)}function s5(t){var e=1;fe(t,613,si(e)),fe(t,46,JM()),fe(t,614)}function a5(t){var e=1;fe(t,626,si(e)),fe(t,47,FA({numFmtId:0},65535)),fe(t,627)}function o5(t,e){fe(t,617,si(e.length)),e.forEach(function(r){fe(t,47,FA(r,0))}),fe(t,618)}function l5(t){var e=1;fe(t,619,si(e)),fe(t,48,ZM({xfId:0,name:"Normal"})),fe(t,620)}function c5(t){var e=0;fe(t,505,si(e)),fe(t,506)}function u5(t){var e=0;fe(t,508,e5(e,"TableStyleMedium9","PivotStyleMedium4")),fe(t,509)}function f5(t,e){var r=hn();return fe(r,278),r5(r,t.SSF),n5(r),i5(r),s5(r),a5(r),o5(r,e.cellXfs),l5(r),c5(r),u5(r),fe(r,279),r.end()}var h5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function d5(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Gr)||[]).forEach(function(i){var s=Le(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[h5.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function p5(){}function m5(){}var g5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,v5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function x5(t,e,r){e.themeElements={};var n;[["clrScheme",g5,d5],["fontScheme",v5,p5],["fmtScheme",_5,m5]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var y5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function NA(t,e){(!t||t.length===0)&&(t=sv());var r,n={};if(!(r=t.match(y5)))throw new Error("themeElements not found in theme");return x5(r[0],n,e),n.raw=t,n}function sv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function w5(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=kS(s,{type:"array"})}catch{return}var o=wn(a,"theme/theme/theme1.xml",!0);if(o)return NA(o,r)}}function E5(t){return t.read_shift(4)}function T5(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=k5(t,4);break;case 2:e.xclrValue=fA(t);break;case 3:e.xclrValue=E5(t);break;case 4:t.l+=4;break}return t.l+=8,e}function k5(t,e){return $r(t,e)}function S5(t,e){return $r(t,e)}function A5(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=T5(t);break;case 6:n[1]=S5(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function I5(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(A5(t,r-t.l));return{ixfe:n,ext:s}}function C5(t,e){e.forEach(function(r){switch(r[0]){}})}function R5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Wr(t)}}function P5(t){var e=ne(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),dr(t.name,e),e.slice(0,e.l)}function F5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function N5(t){var e=ne(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function D5(t,e){var r=ne(8+2*e.length);return r.write_shift(4,t),dr(e,r),r.slice(0,r.l)}function O5(t){return t.l+=4,t.read_shift(4)!=0}function b5(t,e){var r=ne(8);return r.write_shift(4,t),r.write_shift(4,1),r}function L5(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return us(t,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function M5(){var t=hn();return fe(t,332),fe(t,334,si(1)),fe(t,335,P5({name:"XLDAPR",version:12e4,flags:3496657072})),fe(t,336),fe(t,339,D5(1,"XLDAPR")),fe(t,52),fe(t,35,si(514)),fe(t,4096,si(0)),fe(t,4097,Mn(1)),fe(t,36),fe(t,53),fe(t,340),fe(t,337,b5(1)),fe(t,51,N5([[1,0]])),fe(t,338),fe(t,333),t.end()}function V5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Gr,function(o){var l=Le(o);switch(Ri(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function DA(){var t=[Xt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function B5(t){var e=[];if(!t)return e;var r=1;return(t.match(Gr)||[]).forEach(function(n){var i=Le(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function U5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=be(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function j5(t,e,r){var n=[];return us(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function W5(t,e,r,n){if(!t)return t;var i=n||{},s=!1;us(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function H5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Mo=1024;function OA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[xe("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),xe("o:shapelayout",xe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),xe("v:shapetype",[xe("v:stroke",null,{joinstyle:"miter"}),xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Mo<t*1e3;)Mo+=1e3;return e.forEach(function(s){var a=Nt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=xe("v:fill",l,o),f={on:"t",obscured:"t"};++Mo,i=i.concat(["<v:shape"+au({id:"_x0000_s"+Mo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,xe("v:shadow",null,f),xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Tr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Tr("x:AutoFill","False"),Tr("x:Row",String(a.r)),Tr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function _w(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Nt(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=rt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=We(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function z5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Le(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Nt(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&rv(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function bA(t){var e=[Xt,xe("comments",null,{xmlns:to[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ut(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(ut(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Tr("t",ut(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Tr("t",ut(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function $5(t,e){var r=[],n=!1,i={},s=0;return t.replace(Gr,function(o,l){var c=Le(o);switch(Ri(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function G5(t,e,r){var n=[Xt,xe("ThreadedComments",null,{xmlns:nr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(xe("threadedComment",Tr("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function K5(t,e){var r=[],n=!1;return t.replace(Gr,function(s){var a=Le(s);switch(Ri(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function X5(t){var e=[Xt,xe("personList",null,{xmlns:nr.TCMNT,"xmlns:x":to[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function q5(t){var e={};e.iauthor=t.read_shift(4);var r=so(t);return e.rfx=r.s,e.ref=be(r.s),t.l+=16,e}function Y5(t,e){return e==null&&(e=ne(36)),e.write_shift(4,t[1].iauthor),Cl(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Q5=Wr;function J5(t){return dr(t.slice(0,54))}function Z5(t,e){var r=[],n=[],i={},s=!1;return us(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function e9(t){var e=hn(),r=[];return fe(e,628),fe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),fe(e,632,J5(i.a)))})}),fe(e,631),fe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Nt(n[0]),e:Nt(n[0])};fe(e,635,Y5([s,i])),i.t&&i.t.length>0&&fe(e,637,Eb(i)),fe(e,636),delete i.iauthor})}),fe(e,634),fe(e,629),e.end()}var t9="application/vnd.ms-office.vbaProject";function r9(t){var e=Ne.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ne.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Ne.write(e)}function n9(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ne.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var LA=["xlsb","xlsm","xlam","biff8","xla"];function i9(){return{"!type":"dialog"}}function s9(){return{"!type":"dialog"}}function a9(){return{"!type":"macro"}}function o9(){return{"!type":"macro"}}var Yo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,i+(o?"":"$")+Ft(f)+(l?"":"$")+Kt(c)}return function(i,s){return e=s,i.replace(t,r)}}(),av=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ov=function(){return function(e,r){return e.replace(av,function(n,i,s,a,o,l){var c=K1(a)-(s?0:r.c),f=G1(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function MA(t,e){return t.replace(av,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ft(K1(s)+e.c))+(a=="$"?a+o:Kt(G1(o)+e.r))})}function l9(t,e,r){var n=dn(e),i=n.s,s=Nt(r),a={r:s.r-i.r,c:s.c-i.c};return MA(t,a)}function c9(t){return t.length!=1}function xw(t){return t.replace(/_xlfn\./g,"")}function Yt(t){t.l+=1}function Qs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function VA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return BA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Qs(t),o=Qs(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function BA(t){var e=Qs(t),r=Qs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function u9(t,e,r){if(r.biff<8)return BA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Qs(t),a=Qs(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function UA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return f9(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Qs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function f9(t){var e=Qs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function h9(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function d9(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return p9(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function p9(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function m9(t,e,r){var n=(t[t.l++]&96)>>5,i=VA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function g9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=VA(t,s,r);return[n,i,a]}function v9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function _9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function x9(t,e,r){var n=(t[t.l++]&96)>>5,i=u9(t,e-1,r);return[n,i]}function y9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function yw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function w9(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function E9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function T9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function k9(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function S9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function jA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function A9(t){return t.read_shift(2),jA(t)}function I9(t){return t.read_shift(2),jA(t)}function C9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=UA(t,0,r);return[n,i]}function R9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=d9(t,0,r);return[n,i]}function P9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=UA(t,0,r);return[n,i,s]}function F9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[OV[i],zA[i],n]}function N9(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:D9(t);return[i,(s[0]===0?zA:DV)[s[1]]]}function D9(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function O9(t,e,r){t.l+=r&&r.biff==2?3:4}function b9(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function L9(t){return t.l++,fs[t.read_shift(1)]}function M9(t){return t.l++,t.read_shift(2)}function V9(t){return t.l++,t.read_shift(1)!==0}function B9(t){return t.l++,Ur(t)}function U9(t,e,r){return t.l++,ju(t,e-1,r)}function j9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=fs[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ur(t);break;case 2:r[1]=ao(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function W9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?so:Z0)(t));return i}function H9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=j9(t,r.biff);return a}function z9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function $9(t,e,r){if(r.biff==5)return G9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function G9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function K9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function X9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function q9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Y9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var Q9=$r,J9=$r,Z9=$r;function Hu(t,e,r){return t.l+=2,[h9(t)]}function lv(t){return t.l+=6,[]}var eV=Hu,tV=lv,rV=lv,nV=Hu;function WA(t){return t.l+=2,[Zt(t),t.read_shift(2)&1]}var iV=Hu,sV=WA,aV=lv,oV=Hu,lV=Hu,cV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=cV[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function fV(t){return t.l+=2,[t.read_shift(4)]}function hV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function dV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function mV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function gV(t){return t.l+=4,[0,0]}var ww={1:{n:"PtgExp",f:b9},2:{n:"PtgTbl",f:Z9},3:{n:"PtgAdd",f:Yt},4:{n:"PtgSub",f:Yt},5:{n:"PtgMul",f:Yt},6:{n:"PtgDiv",f:Yt},7:{n:"PtgPower",f:Yt},8:{n:"PtgConcat",f:Yt},9:{n:"PtgLt",f:Yt},10:{n:"PtgLe",f:Yt},11:{n:"PtgEq",f:Yt},12:{n:"PtgGe",f:Yt},13:{n:"PtgGt",f:Yt},14:{n:"PtgNe",f:Yt},15:{n:"PtgIsect",f:Yt},16:{n:"PtgUnion",f:Yt},17:{n:"PtgRange",f:Yt},18:{n:"PtgUplus",f:Yt},19:{n:"PtgUminus",f:Yt},20:{n:"PtgPercent",f:Yt},21:{n:"PtgParen",f:Yt},22:{n:"PtgMissArg",f:Yt},23:{n:"PtgStr",f:U9},26:{n:"PtgSheet",f:hV},27:{n:"PtgEndSheet",f:dV},28:{n:"PtgErr",f:L9},29:{n:"PtgBool",f:V9},30:{n:"PtgInt",f:M9},31:{n:"PtgNum",f:B9},32:{n:"PtgArray",f:y9},33:{n:"PtgFunc",f:F9},34:{n:"PtgFuncVar",f:N9},35:{n:"PtgName",f:z9},36:{n:"PtgRef",f:C9},37:{n:"PtgArea",f:m9},38:{n:"PtgMemArea",f:K9},39:{n:"PtgMemErr",f:Q9},40:{n:"PtgMemNoMem",f:J9},41:{n:"PtgMemFunc",f:X9},42:{n:"PtgRefErr",f:q9},43:{n:"PtgAreaErr",f:v9},44:{n:"PtgRefN",f:R9},45:{n:"PtgAreaN",f:x9},46:{n:"PtgMemAreaN",f:pV},47:{n:"PtgMemNoMemN",f:mV},57:{n:"PtgNameX",f:$9},58:{n:"PtgRef3d",f:P9},59:{n:"PtgArea3d",f:g9},60:{n:"PtgRefErr3d",f:Y9},61:{n:"PtgAreaErr3d",f:_9},255:{}},vV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_V={1:{n:"PtgElfLel",f:WA},2:{n:"PtgElfRw",f:oV},3:{n:"PtgElfCol",f:eV},6:{n:"PtgElfRwV",f:lV},7:{n:"PtgElfColV",f:nV},10:{n:"PtgElfRadical",f:iV},11:{n:"PtgElfRadicalS",f:aV},13:{n:"PtgElfColS",f:tV},15:{n:"PtgElfColSV",f:rV},16:{n:"PtgElfRadicalLel",f:sV},25:{n:"PtgList",f:uV},29:{n:"PtgSxName",f:fV},255:{}},xV={0:{n:"PtgAttrNoop",f:gV},1:{n:"PtgAttrSemi",f:S9},2:{n:"PtgAttrIf",f:T9},4:{n:"PtgAttrChoose",f:w9},8:{n:"PtgAttrGoto",f:E9},16:{n:"PtgAttrSum",f:O9},32:{n:"PtgAttrBaxcel",f:yw},33:{n:"PtgAttrBaxcel",f:yw},64:{n:"PtgAttrSpace",f:A9},65:{n:"PtgAttrSpaceSemi",f:I9},128:{n:"PtgAttrIfError",f:k9},255:{}};function zu(t,e,r,n){if(n.biff<8)return $r(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=H9(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=W9(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push($r(t,e)),s}function $u(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=ww[s]||ww[vV[s]],(s===24||s===25)&&(i=(s===24?_V:xV)[t[t.l+1]]),!i||!i.f?$r(t,e):a.push([i.n,i.f(t,e,r)]);return a}function yV(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var wV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function HA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ew(t,e,r){var n=HA(t,e,r);return n=="#REF"?n:EV(n,r)}function Lr(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,p,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,_="",w=0,E=t[0].length;w<E;++w){var x=t[0][w];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:_=Ut(" ",t[0][m][1][1]);break;case 1:_=Ut("\r",t[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+_,m=-1}o.push(c+wV[x[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=kc(x[1][1],a,i),o.push(Sc(f,s));break;case"PtgRefN":f=r?kc(x[1][1],r,i):x[1][1],o.push(Sc(f,s));break;case"PtgRef3d":h=x[1][1],f=kc(x[1][2],a,i),g=Ew(n,h,i),o.push(g+"!"+Sc(f,s));break;case"PtgFunc":case"PtgFuncVar":var P=x[1][0],W=x[1][1];P||(P=0),P&=127;var M=P==0?[]:o.slice(-P);o.length-=P,W==="User"&&(W=M.shift()),o.push(W+"("+M.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=Qy(x[1][1],r?{s:r}:a,i),o.push(Zd(p,i));break;case"PtgArea":p=Qy(x[1][1],a,i),o.push(Zd(p,i));break;case"PtgArea3d":h=x[1][1],p=x[1][2],g=Ew(n,h,i),o.push(g+"!"+Zd(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2];var y=(n.names||[])[d-1]||(n[0]||[])[d],k=y?y.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var S=x[1][1];d=x[1][2];var I;if(i.biff<=5)S<0&&(S=-S),n[S]&&(I=n[S][d]);else{var R="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][d]&&n[S][d].itab>0&&(R=n.SheetNames[n[S][d].itab-1]+"!"):R=n.SheetNames[d-1]+"!"),n[S]&&n[S][d])R+=n[S][d].Name;else if(n[0]&&n[0][d])R+=n[0][d].Name;else{var C=(HA(n,S,i)||"").split(";;");C[d-1]?R=C[d-1]:R+="SH33TJSERRX"}o.push(R);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var N="(",_e=")";if(m>=0){switch(_="",t[0][m][1][0]){case 2:N=Ut(" ",t[0][m][1][1])+N;break;case 3:N=Ut("\r",t[0][m][1][1])+N;break;case 4:_e=Ut(" ",t[0][m][1][1])+_e;break;case 5:_e=Ut("\r",t[0][m][1][1])+_e;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(N+o.pop()+_e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var pe={c:r.c,r:r.r};if(n.sharedf[be(f)]){var Te=n.sharedf[be(f)];o.push(Lr(Te,a,pe,n,i))}else{var ge=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Lr(c[1],a,pe,n,i)),ge=!0;break}ge||o.push(x[1])}break;case"PtgArray":o.push("{"+yV(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ce.indexOf(t[0][w][0])==-1){x=t[0][m];var V=!0;switch(x[1][0]){case 4:V=!1;case 0:_=Ut(" ",x[1][1]);break;case 5:V=!1;case 1:_=Ut("\r",x[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((V?_:"")+o.pop()+(V?"":_)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function TV(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],$r(t,e-2)];var o=$u(t,a,r);return e!==a+i&&(s=zu(t,e-a-i,o,r)),t.l=n,[o,s]}function kV(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],$r(t,e-2)];var o=$u(t,a,r);return e!==a+i&&(s=zu(t,e-a-i,o,r)),t.l=n,[o,s]}function SV(t,e,r,n){var i=t.l+e,s=$u(t,n,r),a;return i!==t.l&&(a=zu(t,i-t.l,s,r)),[s,a]}function AV(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=$u(t,s,r);return s==65535?[[],$r(t,e-2)]:(e!==s+2&&(i=zu(t,n-s-2,a,r)),[a,i])}function IV(t){var e;if(Hi(t,t.l+6)!==65535)return[Ur(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function CV(t){if(t==null){var e=ne(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return $a(t);return $a(0)}function ip(t,e,r){var n=t.l+e,i=Pi(t);r.biff==2&&++t.l;var s=IV(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=kV(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function RV(t,e,r,n,i){var s=Ka(e,r,i),a=CV(t.v),o=ne(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ne(t.bf.length),f=0;f<t.bf.length;++f)c[f]=t.bf[f];var h=hr([s,a,o,c]);return h}function ed(t,e,r){var n=t.read_shift(4),i=$u(t,n,r),s=t.read_shift(4),a=s>0?zu(t,s,i,r):null;return[i,a]}var PV=ed,td=ed,FV=ed,NV=ed,DV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},OV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Tw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function bV(t){var e="of:="+t.replace(av,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function sp(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function LV(t){return t.replace(/\./,"!")}var Ic={},Qo={},Cc=typeof Map<"u";function cv(t,e,r){var n=0,i=t.length;if(r){if(Cc?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Cc?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Cc?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function rd(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Br=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=fu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=c0(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Pa(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function aa(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){qi(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function $A(t,e,r,n,i,s){try{n.cellNF&&(t.z=Oe[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=kt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Oe[e]==null&&qi(D6[e]||"General",e),t.t==="e")t.w=t.w||fs[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=iu(t.v);else if(t.t==="d"){var a=ar(t.v);(a|0)===a?t.w=a.toString(10):t.w=iu(a)}else{if(t.v===void 0)return"";t.w=Ha(t.v,Qo)}else t.t==="d"?t.w=Gn(e,ar(t.v),Qo):t.w=Gn(e,t.v,Qo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=l0(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=l0(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function MV(t,e,r){if(t&&t["!ref"]){var n=rt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function VV(t,e){var r=rt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=We(r))}var BV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,jV=/<(?:\w:)?hyperlink [^>]*>/mg,WV=/"(\w*:\w*)"/,HV=/<(?:\w:)?col\b[^>]*[\/]?>/g,zV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,$V=/<(?:\w:)?pageMargins[^>]*\/>/g,GA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,KV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function XV(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(UV);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var d=c.match(GA);d?uv(d[0],o,i,r):(d=c.match(GV))&&YV(d[0],d[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(WV);g&&VV(o,g[1])}var m=c.match(KV);m&&m[1]&&cB(m[1],i);var _=[];if(e.cellStyles){var w=c.match(HV);w&&iB(_,w)}h&&hB(h[1],o,e,l,s,a);var E=f.match(zV);E&&(o["!autofilter"]=aB(E[0]));var x=[],P=f.match(BV);if(P)for(p=0;p!=P.length;++p)x[p]=rt(P[p].slice(P[p].indexOf('"')+1));var W=f.match(jV);W&&tB(o,W,n);var M=f.match($V);if(M&&(o["!margins"]=rB(Le(M[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=We(l)),e.sheetRows>0&&o["!ref"]){var y=rt(o["!ref"]);e.sheetRows<=+y.e.r&&(y.e.r=e.sheetRows-1,y.e.r>l.e.r&&(y.e.r=l.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>l.e.c&&(y.e.c=l.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=We(y))}return _.length>0&&(o["!cols"]=_),x.length>0&&(o["!merges"]=x),o}function qV(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+We(t[r])+'"/>';return e+"</mergeCells>"}function uv(t,e,r,n){var i=Le(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=tt(pt(i.codeName)))}function YV(t,e,r,n,i){uv(t.slice(0,t.indexOf(">")),r,n,i)}function QV(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=xi(ut(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+xe("outlinePr",null,c)}!s&&!o||(i[i.length]=xe("sheetPr",o,a))}var JV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ZV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eB(t){var e={sheet:1};return JV.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),ZV.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=nv(t.password).toString(16).toUpperCase()),xe("sheetProtection",null,e)}function tB(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Le(pt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+tt(s.location))):(s.Target="#"+tt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=rt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=be({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function rB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function nB(t){return Pa(t),xe("pageMargins",null,t)}function iB(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Le(e[n],!0);i.hidden&&(i.hidden=wt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,iv(i.width)),Ys(i);s<=a;)t[s++]=St(i)}}function sB(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=xe("col",null,rd(i,n)));return r[r.length]="</cols>",r.join("")}function aB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function oB(t,e,r,n){var i=typeof t.ref=="string"?t.ref:We(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=dn(i);a.s.r==a.e.r&&(a.e.r=dn(e["!ref"]).e.r,i=We(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),xe("autoFilter",null,{ref:i})}var lB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cB(t,e){e.Views||(e.Views=[{}]),(t.match(lB)||[]).forEach(function(r,n){var i=Le(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),wt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function uB(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),xe("sheetViews",xe("sheetView",null,i),{})}function fB(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=fs[t.v];break;case"d":n&&n.cellDates?i=kt(t.v,-1).toISOString():(t=St(t),t.t="n",i=""+(t.v=ar(kt(t.v)))),typeof t.z>"u"&&(t.z=Oe[14]);break;default:i=t.v;break}var o=Tr("v",ut(i)),l={r:e},c=aa(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Tr("v",""+cv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=xe("f",ut(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),xe("c",o,l)}var hB=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=su("v"),a=su("f");return function(l,c,f,h,d,p){for(var g=0,m="",_=[],w=[],E=0,x=0,P=0,W="",M,y,k=0,S=0,I,R,C=0,N=0,_e=Array.isArray(p.CellXf),pe,Te=[],ge=[],ce=Array.isArray(c),V=[],X={},oe=!1,b=!!f.sheetStubs,j=l.split(e),z=0,K=j.length;z!=K;++z){m=j[z].trim();var q=m.length;if(q!==0){var se=0;e:for(g=0;g<q;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(y=Le(m.slice(se,g),!0),k=y.r!=null?parseInt(y.r,10):k+1,S=-1,f.sheetRows&&f.sheetRows<k)continue;X={},oe=!1,y.ht&&(oe=!0,X.hpt=parseFloat(y.ht),X.hpx=vl(X.hpt)),y.hidden=="1"&&(oe=!0,X.hidden=!0),y.outlineLevel!=null&&(oe=!0,X.level=+y.outlineLevel),oe&&(V[k-1]=X)}break;case"<":se=g;break}if(se>=g)break;if(y=Le(m.slice(se,g),!0),k=y.r!=null?parseInt(y.r,10):k+1,S=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(X={},oe=!1,y.ht&&(oe=!0,X.hpt=parseFloat(y.ht),X.hpx=vl(X.hpt)),y.hidden=="1"&&(oe=!0,X.hidden=!0),y.outlineLevel!=null&&(oe=!0,X.level=+y.outlineLevel),oe&&(V[k-1]=X)),_=m.slice(g).split(t);for(var le=0;le!=_.length&&_[le].trim().charAt(0)=="<";++le);for(_=_.slice(le),g=0;g!=_.length;++g)if(m=_[g].trim(),m.length!==0){if(w=m.match(r),E=g,x=0,P=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,w!=null&&w.length===2){for(E=0,W=w[1],x=0;x!=W.length&&!((P=W.charCodeAt(x)-64)<1||P>26);++x)E=26*E+P;--E,S=E}else++S;for(x=0;x!=m.length&&m.charCodeAt(x)!==62;++x);if(++x,y=Le(m.slice(0,x),!0),y.r||(y.r=be({r:k-1,c:S})),W=m.slice(x),M={t:""},(w=W.match(s))!=null&&w[1]!==""&&(M.v=tt(w[1])),f.cellFormula){if((w=W.match(a))!=null&&w[1]!==""){if(M.f=tt(pt(w[1])).replace(/\r\n/g,`
`),f.xlfn||(M.f=xw(M.f)),w[0].indexOf('t="array"')>-1)M.F=(W.match(i)||[])[1],M.F.indexOf(":")>-1&&Te.push([rt(M.F),M.F]);else if(w[0].indexOf('t="shared"')>-1){R=Le(w[0]);var ae=tt(pt(w[1]));f.xlfn||(ae=xw(ae)),ge[parseInt(R.si,10)]=[R,ae,y.r]}}else(w=W.match(/<f[^>]*\/>/))&&(R=Le(w[0]),ge[R.si]&&(M.f=l9(ge[R.si][1],ge[R.si][2],y.r)));var ie=Nt(y.r);for(x=0;x<Te.length;++x)ie.r>=Te[x][0].s.r&&ie.r<=Te[x][0].e.r&&ie.c>=Te[x][0].s.c&&ie.c<=Te[x][0].e.c&&(M.F=Te[x][1])}if(y.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(b)M.t="z";else continue;else M.t=y.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),M.t){case"n":if(M.v==""||M.v==null){if(!b)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!b)continue;M.t="z"}else I=Ic[parseInt(M.v,10)],M.v=I.t,M.r=I.r,f.cellHTML&&(M.h=I.h);break;case"str":M.t="s",M.v=M.v!=null?pt(M.v):"",f.cellHTML&&(M.h=W1(M.v));break;case"inlineStr":w=W.match(n),M.t="s",w!=null&&(I=rv(w[1]))?(M.v=I.t,f.cellHTML&&(M.h=I.h)):M.v="";break;case"b":M.v=wt(M.v);break;case"d":f.cellDates?M.v=kt(M.v,1):(M.v=ar(kt(M.v,1)),M.t="n");break;case"e":(!f||f.cellText!==!1)&&(M.w=M.v),M.v=XS[M.v];break}if(C=N=0,pe=null,_e&&y.s!==void 0&&(pe=p.CellXf[y.s],pe!=null&&(pe.numFmtId!=null&&(C=pe.numFmtId),f.cellStyles&&pe.fillId!=null&&(N=pe.fillId))),$A(M,C,N,f,d,p),f.cellDates&&_e&&M.t=="n"&&Sl(Oe[C])&&(M.t="d",M.v=J0(M.v)),y.cm&&f.xlmeta){var Fe=(f.xlmeta.Cell||[])[+y.cm-1];Fe&&Fe.type=="XLDAPR"&&(M.D=!0)}if(ce){var G=Nt(y.r);c[G.r]||(c[G.r]=[]),c[G.r][G.c]=M}else c[y.r]=M}}}}V.length>0&&(c["!rows"]=V)}}();function dB(t,e,r,n){var i=[],s=[],a=rt(t["!ref"]),o="",l,c="",f=[],h=0,d=0,p=t["!rows"],g=Array.isArray(t),m={r:c},_,w=-1;for(d=a.s.c;d<=a.e.c;++d)f[d]=Ft(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Kt(h),d=a.s.c;d<=a.e.c;++d){l=f[d]+c;var E=g?(t[h]||[])[d]:t[l];E!==void 0&&(o=fB(E,l,t,e))!=null&&s.push(o)}(s.length>0||p&&p[h])&&(m={r:c},p&&p[h]&&(_=p[h],_.hidden&&(m.hidden=1),w=-1,_.hpx?w=hu(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(m.ht=w,m.customHeight=1),_.level&&(m.outlineLevel=_.level)),i[i.length]=xe("row",s.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},_=p[h],_.hidden&&(m.hidden=1),w=-1,_.hpx?w=hu(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(m.ht=w,m.customHeight=1),_.level&&(m.outlineLevel=_.level),i[i.length]=xe("row","",m));return i.join("")}function KA(t,e,r,n){var i=[Xt,xe("worksheet",null,{xmlns:to[0],"xmlns:r":nr.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=rt(c);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=We(f)}n||(n={}),l["!comments"]=[];var h=[];QV(l,r,t,e,i),i[i.length]=xe("dimension",null,{ref:c}),i[i.length]=uB(l,e,t,r),e.sheetFormat&&(i[i.length]=xe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=sB(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=dB(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=eB(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=oB(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=qV(l["!merges"]));var d=-1,p,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=ct(n,-1,ut(m[1].Target).replace(/#.*$/,""),Xe.HLINK),p["r:id"]="rId"+g),(d=m[1].Target.indexOf("#"))>-1&&(p.location=ut(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=ut(m[1].Tooltip)),i[i.length]=xe("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=nB(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Tr("ignoredErrors",xe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=ct(n,-1,"../drawings/drawing"+(t+1)+".xml",Xe.DRAW),i[i.length]=xe("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=ct(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Xe.VML),i[i.length]=xe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function pB(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function mB(t,e,r){var n=ne(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=hu(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var h=-1,d=-1,p=f<<10;p<f+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[be(c)];g&&(h<0&&(h=p),d=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function gB(t,e,r,n){var i=mB(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&fe(t,0,i)}var vB=so,_B=Cl;function xB(){}function yB(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Tb(t),r}function wB(t,e,r){r==null&&(r=ne(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return s0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),HS(t,r),r.slice(0,r.l)}function EB(t){var e=Kn(t);return[e]}function TB(t,e,r){return r==null&&(r=ne(8)),ro(e,r)}function kB(t){var e=no(t);return[e]}function SB(t,e,r){return r==null&&(r=ne(4)),io(e,r)}function AB(t){var e=Kn(t),r=t.read_shift(1);return[e,r,"b"]}function IB(t,e,r){return r==null&&(r=ne(9)),ro(e,r),r.write_shift(1,t.v?1:0),r}function CB(t){var e=no(t),r=t.read_shift(1);return[e,r,"b"]}function RB(t,e,r){return r==null&&(r=ne(5)),io(e,r),r.write_shift(1,t.v?1:0),r}function PB(t){var e=Kn(t),r=t.read_shift(1);return[e,r,"e"]}function FB(t,e,r){return r==null&&(r=ne(9)),ro(e,r),r.write_shift(1,t.v),r}function NB(t){var e=no(t),r=t.read_shift(1);return[e,r,"e"]}function DB(t,e,r){return r==null&&(r=ne(8)),io(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function OB(t){var e=Kn(t),r=t.read_shift(4);return[e,r,"s"]}function bB(t,e,r){return r==null&&(r=ne(12)),ro(e,r),r.write_shift(4,e.v),r}function LB(t){var e=no(t),r=t.read_shift(4);return[e,r,"s"]}function MB(t,e,r){return r==null&&(r=ne(8)),io(e,r),r.write_shift(4,e.v),r}function VB(t){var e=Kn(t),r=Ur(t);return[e,r,"n"]}function BB(t,e,r){return r==null&&(r=ne(16)),ro(e,r),$a(t.v,r),r}function XA(t){var e=no(t),r=Ur(t);return[e,r,"n"]}function UB(t,e,r){return r==null&&(r=ne(12)),io(e,r),$a(t.v,r),r}function jB(t){var e=Kn(t),r=Q1(t);return[e,r,"n"]}function WB(t,e,r){return r==null&&(r=ne(12)),ro(e,r),zS(t.v,r),r}function HB(t){var e=no(t),r=Q1(t);return[e,r,"n"]}function zB(t,e,r){return r==null&&(r=ne(8)),io(e,r),zS(t.v,r),r}function $B(t){var e=Kn(t),r=X1(t);return[e,r,"is"]}function GB(t){var e=Kn(t),r=Wr(t);return[e,r,"str"]}function KB(t,e,r){return r==null&&(r=ne(12+4*t.v.length)),ro(e,r),dr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function XB(t){var e=no(t),r=Wr(t);return[e,r,"str"]}function qB(t,e,r){return r==null&&(r=ne(8+4*t.v.length)),io(e,r),dr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function YB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}function QB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}function JB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=Ur(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}function ZB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=Wr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}var e7=so,t7=Cl;function r7(t,e){return e==null&&(e=ne(4)),e.write_shift(4,t),e}function n7(t,e){var r=t.l+e,n=so(t),i=q1(t),s=Wr(t),a=Wr(t),o=Wr(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function i7(t,e){var r=ne(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Cl({s:Nt(t[0]),e:Nt(t[0])},r),Y1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return dr(i||"",r),dr(t[1].Tooltip||"",r),dr("",r),r.slice(0,r.l)}function s7(){}function a7(t,e,r){var n=t.l+e,i=$S(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=PV(t,n-t.l,r);a[1]=o}else t.l=n;return a}function o7(t,e,r){var n=t.l+e,i=so(t),s=[i];if(r.cellFormula){var a=NV(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function l7(t,e,r){r==null&&(r=ne(18));var n=rd(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var qA=["left","right","top","bottom","header","footer"];function c7(t){var e={};return qA.forEach(function(r){e[r]=Ur(t)}),e}function u7(t,e){return e==null&&(e=ne(6*8)),Pa(t),qA.forEach(function(r){$a(t[r],e)}),e}function f7(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function h7(t,e,r){r==null&&(r=ne(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function d7(t){var e=ne(24);return e.write_shift(4,4),e.write_shift(4,1),Cl(t,e),e}function p7(t,e){return e==null&&(e=ne(16*4+2)),e.write_shift(2,t.password?nv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function m7(){}function g7(){}function v7(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,g,m,_,w,E,x,P,W,M=[];o.biff=12,o["!row"]=0;var y=0,k=!1,S=[],I={},R=o.supbooks||i.supbooks||[[]];if(R.sharedf=I,R.arrayf=S,R.SheetNames=i.SheetNames||i.Sheets.map(function(ce){return ce.name}),!o.supbooks&&(o.supbooks=R,i.Names))for(var C=0;C<i.Names.length;++C)R[0][C+1]=i.Names[C];var N=[],_e=[],pe=!1;du[16]={n:"BrtShortReal",f:XA};var Te;if(us(t,function(V,X,oe){if(!d)switch(oe){case 148:c=V;break;case 0:p=V,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),P=Kt(_=p.r),o["!row"]=p.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=vl(V.hpt)),_e[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:V[2]},V[2]){case"n":g.v=V[1];break;case"s":x=Ic[V[1]],g.v=x.t,g.r=x.r;break;case"b":g.v=!!V[1];break;case"e":g.v=V[1],o.cellText!==!1&&(g.w=fs[g.v]);break;case"str":g.t="s",g.v=V[1];break;case"is":g.t="s",g.v=V[1].t;break}if((m=a.CellXf[V[0].iStyleRef])&&$A(g,m.numFmtId,null,o,s,a),w=V[0].c==-1?w+1:V[0].c,o.dense?(l[_]||(l[_]=[]),l[_][w]=g):l[Ft(w)+P]=g,o.cellFormula){for(k=!1,y=0;y<S.length;++y){var b=S[y];p.r>=b[0].s.r&&p.r<=b[0].e.r&&w>=b[0].s.c&&w<=b[0].e.c&&(g.F=We(b[0]),k=!0)}!k&&V.length>3&&(g.f=V[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>w&&(f.s.c=w),f.e.r<p.r&&(f.e.r=p.r),f.e.c<w&&(f.e.c=w),o.cellDates&&m&&g.t=="n"&&Sl(Oe[m.numFmtId])){var j=Ta(g.v);j&&(g.t="d",g.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}Te&&(Te.type=="XLDAPR"&&(g.D=!0),Te=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},w=V[0].c==-1?w+1:V[0].c,o.dense?(l[_]||(l[_]=[]),l[_][w]=g):l[Ft(w)+P]=g,f.s.r>p.r&&(f.s.r=p.r),f.s.c>w&&(f.s.c=w),f.e.r<p.r&&(f.e.r=p.r),f.e.c<w&&(f.e.c=w),Te&&(Te.type=="XLDAPR"&&(g.D=!0),Te=void 0);break;case 176:M.push(V);break;case 49:Te=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var z=n["!id"][V.relId];for(z?(V.Target=z.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=z):V.relId==""&&(V.Target="#"+V.loc),_=V.rfx.s.r;_<=V.rfx.e.r;++_)for(w=V.rfx.s.c;w<=V.rfx.e.c;++w)o.dense?(l[_]||(l[_]=[]),l[_][w]||(l[_][w]={t:"z",v:void 0}),l[_][w].l=V):(E=be({c:w,r:_}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=V);break;case 426:if(!o.cellFormula)break;S.push(V),W=o.dense?l[_][w]:l[Ft(w)+P],W.f=Lr(V[1],f,{r:p.r,c:w},R,o),W.F=We(V[0]);break;case 427:if(!o.cellFormula)break;I[be(V[0].s)]=V[1],W=o.dense?l[_][w]:l[Ft(w)+P],W.f=Lr(V[1],f,{r:p.r,c:w},R,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)N[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},pe||(pe=!0,iv(V.w/256)),Ys(N[V.e+1]);break;case 161:l["!autofilter"]={ref:We(V)};break;case 476:l["!margins"]=V;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),V.name&&(i.Sheets[r].CodeName=V.name),(V.above||V.left)&&(l["!outline"]={above:V.above,left:V.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),V.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!X.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=We(c||f)),o.sheetRows&&l["!ref"]){var ge=rt(l["!ref"]);o.sheetRows<=+ge.e.r&&(ge.e.r=o.sheetRows-1,ge.e.r>f.e.r&&(ge.e.r=f.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>f.e.c&&(ge.e.c=f.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),l["!fullref"]=l["!ref"],l["!ref"]=We(ge))}return M.length>0&&(l["!merges"]=M),N.length>0&&(l["!cols"]=N),_e.length>0&&(l["!rows"]=_e),l}function _7(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=St(e),e.z=e.z||Oe[14],e.v=ar(kt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=aa(i.cellXfs,e,i),e.l&&s["!links"].push([be(l),e.l]),e.c&&s["!comments"].push([be(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=cv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?fe(t,18,MB(e,l)):fe(t,7,bB(e,l))):(l.t="str",a?fe(t,17,qB(e,l)):fe(t,6,KB(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?fe(t,13,zB(e,l)):fe(t,2,WB(e,l)):a?fe(t,16,UB(e,l)):fe(t,5,BB(e,l)),!0;case"b":return l.t="b",a?fe(t,15,RB(e,l)):fe(t,4,IB(e,l)),!0;case"e":return l.t="e",a?fe(t,14,DB(e,l)):fe(t,3,FB(e,l)),!0}return a?fe(t,12,SB(e,l)):fe(t,1,TB(e,l)),!0}function x7(t,e,r,n){var i=rt(e["!ref"]||"A1"),s,a="",o=[];fe(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=c;++f){a=Kt(f),gB(t,e,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=Ft(d)),s=o[d]+a;var p=l?(e[f]||[])[d]:e[s];if(!p){h=!1;continue}h=_7(t,p,f,d,n,e,h)}}fe(t,146)}function y7(t,e){!e||!e["!merges"]||(fe(t,177,r7(e["!merges"].length)),e["!merges"].forEach(function(r){fe(t,176,t7(r))}),fe(t,178))}function w7(t,e){!e||!e["!cols"]||(fe(t,390),e["!cols"].forEach(function(r,n){r&&fe(t,60,l7(n,r))}),fe(t,391))}function E7(t,e){!e||!e["!ref"]||(fe(t,648),fe(t,649,d7(rt(e["!ref"]))),fe(t,650))}function T7(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=ct(r,-1,n[1].Target.replace(/#.*$/,""),Xe.HLINK);fe(t,494,i7(n,i))}}),delete e["!links"]}function k7(t,e,r,n){if(e["!comments"].length>0){var i=ct(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Xe.VML);fe(t,551,Y1("rId"+i)),e["!legacy"]=i}}function S7(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:We(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=dn(s);o.s.r==o.e.r&&(o.e.r=dn(e["!ref"]).e.r,s=We(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe(t,161,Cl(rt(s))),fe(t,162)}}function A7(t,e,r){fe(t,133),fe(t,137,h7(e,r)),fe(t,138),fe(t,134)}function I7(t,e){e["!protect"]&&fe(t,535,p7(e["!protect"]))}function C7(t,e,r,n){var i=hn(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=rt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],fe(i,129),(r.vbaraw||a["!outline"])&&fe(i,147,wB(o,a["!outline"])),fe(i,148,_B(l)),A7(i,a,r.Workbook),w7(i,a),x7(i,a,t,e),I7(i,a),S7(i,a,r,t),y7(i,a),T7(i,a,n),a["!margins"]&&fe(i,476,u7(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&E7(i,a),k7(i,a,t,n),fe(i,130),i.end()}function R7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=tt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function P7(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=R7(h);f.s.r=f.s.c=0,f.e.c=o,c=Ft(o),d[0].forEach(function(p,g){a[c+Kt(g)]={t:"n",v:p,z:d[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=We(f)),a}function F7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(GA);return o&&uv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function N7(t,e){t.l+=10;var r=Wr(t);return{name:r}}function D7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return us(t,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var fv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],O7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],b7=[],L7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=wt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Sw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=wt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function YA(t){Sw(t.WBProps,fv),Sw(t.CalcPr,L7),kw(t.WBView,O7),kw(t.Sheets,b7),Qo.date1904=wt(t.WBProps.date1904)}function M7(t){return!t.Workbook||!t.Workbook.WBProps?"false":wt(t.Workbook.WBProps.date1904)?"true":"false"}var V7="][*?/\\".split("");function QA(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return V7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function B7(t,e,r){t.forEach(function(n,i){QA(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function U7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];B7(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)MV(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var j7=/<\w+:workbook/;function W7(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Gr,function(l,c){var f=Le(l);switch(Ri(f[0])){case"<?xml":break;case"<workbook":l.match(j7)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fv.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=wt(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=pt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=tt(pt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=pt(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),wt(f.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=tt(pt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),to.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return YA(r),r}function JA(t){var e=[Xt];e[e.length]=xe("workbook",null,{xmlns:to[0],"xmlns:r":nr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(fv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=xe("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:ut(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=xe("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=xe("definedName",ut(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function H7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Pm(t),r.name=Wr(t),r}function z7(t,e){return e||(e=ne(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Y1(t.strRelID,e),dr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function $7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Wr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function G7(t,e){e||(e=ne(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),HS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function K7(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function X7(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=kb(t),a=FV(t,0,r),o=q1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function q7(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],du[16]={n:"BrtFRTArchID$",f:K7},us(t,function(l,c,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),YA(r),r.Names=s,r.supbooks=a,r}function Y7(t,e){fe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};fe(t,156,z7(i))}fe(t,144)}function Q7(t,e){e||(e=ne(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return dr("SheetJS",e),dr(Jh.version,e),dr(Jh.version,e),dr("7262",e),e.length>e.l?e.slice(0,e.l):e}function J7(t,e){e||(e=ne(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Z7(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(fe(t,135),fe(t,158,J7(i)),fe(t,136))}}function eU(t,e){var r=hn();return fe(r,131),fe(r,128,Q7()),fe(r,153,G7(t.Workbook&&t.Workbook.WBProps||null)),Z7(r,t),Y7(r,t),fe(r,132),r.end()}function tU(t,e,r){return e.slice(-4)===".bin"?q7(t,r):W7(t,r)}function rU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?v7(t,n,r,i,s,a,o):XV(t,n,r,i,s,a,o)}function nU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?D7(t,n,r,i,s):F7(t,n,r,i,s)}function iU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?a9():o9()}function sU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?i9():s9()}function aU(t,e,r,n){return e.slice(-4)===".bin"?t5(t,r,n):HM(t,r,n)}function oU(t,e,r){return NA(t,r)}function lU(t,e,r){return e.slice(-4)===".bin"?lM(t,r):sM(t,r)}function cU(t,e,r){return e.slice(-4)===".bin"?Z5(t,r):z5(t,r)}function uU(t,e,r){return e.slice(-4)===".bin"?j5(t):B5(t)}function fU(t,e,r,n){return r.slice(-4)===".bin"?W5(t,e,r,n):void 0}function hU(t,e,r){return e.slice(-4)===".bin"?L5(t,e,r):V5(t,e,r)}function dU(t,e,r){return(e.slice(-4)===".bin"?eU:JA)(t)}function pU(t,e,r,n,i){return(e.slice(-4)===".bin"?C7:KA)(t,r,n,i)}function mU(t,e,r){return(e.slice(-4)===".bin"?f5:PA)(t,r)}function gU(t,e,r){return(e.slice(-4)===".bin"?fM:EA)(t,r)}function vU(t,e,r){return(e.slice(-4)===".bin"?e9:bA)(t)}function _U(t){return(t.slice(-4)===".bin"?M5:DA)()}var ZA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,eI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(ZA),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(eI),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function xU(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ZA),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(eI),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Rc;function yU(t,e){var r=Rc[t]||tt(t);return r==="General"?Ha(e):Gn(r,e)}function wU(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=wt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=kt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[tt(e)]=i}function EU(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||fs[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=iu(t.v):t.w=Ha(t.v):t.w=yU(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Rc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Sl(n)){var i=Ta(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function TU(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=bM[n.Pattern]||n.Pattern)}t[e.ID]=e}function kU(t,e,r,n,i,s,a,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var p=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&p.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wt(t);break;case"String":n.t="s",n.r=Wy(tt(t)),n.v=t.indexOf("<")>-1?tt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(kt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=tt(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=XS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Wy(e||t));break}if(EU(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=tt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Yo(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Yo("RC:RC",i):n.ArrayRange&&(n.F=Yo(n.ArrayRange,i),l.push([rt(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function SU(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function ap(t,e){var r=e||{};Al();var n=ac(H1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=St(r);return a.type="string",gl.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){i.indexOf("<"+Ct)>=0&&(s=!0)}),s)return uj(n,r);Rc={"General Number":"General","General Date":Oe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oe[15],"Short Date":Oe[14],"Long Time":Oe[19],"Medium Time":Oe[18],"Short Time":Oe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oe[2],Standard:Oe[4],Percent:Oe[10],Scientific:Oe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},p="",g={},m={},_=Yn('<Data ss:Type="String">'),w=0,E=0,x=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},M={},y="",k=0,S=[],I={},R={},C=0,N=[],_e=[],pe={},Te=[],ge,ce=!1,V=[],X=[],oe={},b=0,j=0,z={Sheets:[],WBProps:{date1904:!1}},K={};ou.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";o=ou.exec(n);)switch(o[3]=(q=o[3]).toLowerCase()){case"data":if(q=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?kU(n.slice(w,o.index),y,_,l[l.length-1][0]=="comment"?pe:g,{c:E,r:x},W,Te[E],m,V,r):(y="",_=Yn(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(_e.length>0&&(g.c=_e),(!r.sheetRows||r.sheetRows>x)&&g.v!==void 0&&(r.dense?(d[x]||(d[x]=[]),d[x][E]=g):d[Ft(E)+Kt(x)]=g),g.HRef&&(g.l={Target:tt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(b=E+(parseInt(g.MergeAcross,10)|0),j=x+(parseInt(g.MergeDown,10)|0),S.push({s:{c:E,r:x},e:{c:b,r:j}})),!r.sheetStubs)g.MergeAcross?E=b+1:++E;else if(g.MergeAcross||g.MergeDown){for(var se=E;se<=b;++se)for(var le=x;le<=j;++le)(se>E||le>x)&&(r.dense?(d[le]||(d[le]=[]),d[le][se]={t:"z"}):d[Ft(se)+Kt(le)]={t:"z"});E=b+1}else++E;else g=xU(o[0]),g.Index&&(E=+g.Index-1),E<P.s.c&&(P.s.c=E),E>P.e.c&&(P.e.c=E),o[0].slice(-2)==="/>"&&++E,_e=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<P.s.r&&(P.s.r=x),x>P.e.r&&(P.e.r=x),o[0].slice(-2)==="/>"&&(m=Yn(o[0]),m.Index&&(x=+m.Index-1)),E=0,++x):(m=Yn(o[0]),m.Index&&(x=+m.Index-1),oe={},(m.AutoFitHeight=="0"||m.Height)&&(oe.hpx=parseInt(m.Height,10),oe.hpt=hu(oe.hpx),X[x]=oe),m.Hidden=="1"&&(oe.hidden=!0,X[x]=oe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(d["!ref"]=We(P),r.sheetRows&&r.sheetRows<=P.e.r&&(d["!fullref"]=d["!ref"],P.e.r=r.sheetRows-1,d["!ref"]=We(P))),S.length&&(d["!merges"]=S),Te.length>0&&(d["!cols"]=Te),X.length>0&&(d["!rows"]=X),f[p]=d}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=E=0,l.push([o[3],!1]),c=Yn(o[0]),p=tt(c.Name),d=r.dense?[]:{},S=[],V=[],X=[],K={name:p,Hidden:0},z.Sheets.push(K);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Te=[],ce=!1}break;case"style":o[1]==="/"?TU(W,M,r):M=Yn(o[0]);break;case"numberformat":M.nf=tt(Yn(o[0]).Format||"General"),Rc[M.nf]&&(M.nf=Rc[M.nf]);for(var ae=0;ae!=392&&Oe[ae]!=M.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(Oe[ae]==null){qi(M.nf,ae);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ge=Yn(o[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!ce&&ge.wpx>10){ce=!0,Br=CA;for(var ie=0;ie<Te.length;++ie)Te[ie]&&Ys(Te[ie])}ce&&Ys(ge),Te[ge.Index-1||Te.length]=ge;for(var Fe=0;Fe<+ge.Span;++Fe)Te[Te.length]=St(ge);break;case"namedrange":if(o[1]==="/")break;z.Names||(z.Names=[]);var G=Le(o[0]),qe={Name:G.Name,Ref:Yo(G.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(qe.Sheet=z.Sheets.length-1),z.Names.push(qe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=Yn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?qb(I,q,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));SU(pe),_e.push(pe)}else l.push([o[3],!1]),c=Yn(o[0]),pe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var $e=Yn(o[0]);d["!autofilter"]={ref:Yo($e.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Pw(n,r);var at=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(o[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else C=o.index+o[0].length;break;case"header":d["!margins"]||Pa(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].header=+Le(o[0]).Margin);break;case"footer":d["!margins"]||Pa(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].footer=+Le(o[0]).Margin);break;case"pagemargins":var Ge=Le(o[0]);d["!margins"]||Pa(d["!margins"]={},"xlml"),isNaN(+Ge.Top)||(d["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(d["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(d["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(d["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?wU(R,q,N,n.slice(C,o.index)):(N=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ke={};return!r.bookSheets&&!r.bookProps&&(ke.Sheets=f),ke.SheetNames=h,ke.Workbook=z,ke.SSF=St(Oe),ke.Props=I,ke.Custprops=R,ke}function Mm(t,e){switch(dv(e=e||{}),e.type||"base64"){case"base64":return ap(An(t),e);case"binary":case"buffer":case"file":return ap(t,e);case"array":return ap(ia(t),e)}}function AU(t,e){var r=[];return t.Props&&r.push(Yb(t.Props,e)),t.Custprops&&r.push(Qb(t.Props,t.Custprops)),r.join("")}function IU(){return""}function CU(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(xe("NumberFormat",null,{"ss:Format":ut(Oe[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(xe("Style",s.join(""),a))}),xe("Styles",r.join(""))}function tI(t){return xe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ov(t.Ref,{r:0,c:0})})}function RU(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(tI(i)))}return xe("Names",r.join(""))}function PU(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(tI(o)))}return s.join("")}function FU(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(xe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(xe("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(xe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Tr("ProtectContents","True")),t["!protect"].objects&&i.push(Tr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Tr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Tr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Tr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":xe("WorksheetOptions",i.join(""),{xmlns:_n.x})}function NU(t){return t.map(function(e){var r=Z6(e.t||""),n=xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xe("Comment",n,{"ss:Author":e.a})}).join("")}function DU(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+ut(ov(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Nt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=ut(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=ut(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=fs[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Oe[14]);break;case"s":h="String",d=J6(t.v||"");break}var p=aa(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var g=t.v!=null?d:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(m+=NU(t.c)),xe("Cell",m,o)}function OU(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=vl(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function bU(t,e,r,n){if(!t["!ref"])return"";var i=rt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,w){Ys(_);var E=!!_.width,x=rd(w,_),P={"ss:Index":w+1};E&&(P["ss:Width"]=uu(x.width)),_.hidden&&(P["ss:Hidden"]="1"),o.push(xe("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var f=[OU(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(d=!0);break}if(!d){var p={r:c,c:h},g=be(p),m=l?(t[c]||[])[h]:t[g];f.push(DU(m,g,t,e,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function LU(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?PU(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?bU(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(FU(s,e,t,r)),n.join("")}function MU(t,e){e||(e={}),t.SSF||(t.SSF=St(Oe)),t.SSF&&(Al(),q0(t.SSF),e.revssf=Q0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],aa(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(AU(t,e)),r.push(IU()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(xe("Worksheet",LU(n,e,t),{"ss:Name":ut(t.SheetNames[n])}));return r[2]=CU(t,e),r[3]=RU(t),Xt+xe("Workbook",r.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}function VU(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Rb(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=Pb(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var BU=[60,1084,2066,2165,2175];function UU(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Hi(r,r.l),c=Vm[l],f=0;c!=null&&BU.indexOf(l)>-1;)s=Hi(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,c=Vm[l=Hi(r,r.l)];var h=hr(a);wr(h,0);var d=0;h.lens=[];for(var p=0;p<a.length;++p)h.lens.push(d),d+=a[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function hi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Oe[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||fs[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=iu(t.v):t.w=Ha(t.v):t.w=Gn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Sl(Oe[n]||String(n))){var i=Ta(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Uf(t,e,r){return{v:t,ixfe:e,t:r}}function jU(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",f={},h,d="",p,g,m,_,w={},E=[],x,P,W=[],M=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(He){return He<8?Ia[He]:He<64&&M[He-8]||Ia[He]},I=function(He,Rt,or){var Mt=Rt.XF.data;if(!(!Mt||!Mt.patternType||!or||!or.cellStyles)){Rt.s={},Rt.s.patternType=Mt.patternType;var ci;(ci=cu(S(Mt.icvFore)))&&(Rt.s.fgColor={rgb:ci}),(ci=cu(S(Mt.icvBack)))&&(Rt.s.bgColor={rgb:ci})}},R=function(He,Rt,or){if(!(oe>1)&&!(or.sheetRows&&He.r>=or.sheetRows)){if(or.cellStyles&&Rt.XF&&Rt.XF.data&&I(He,Rt,or),delete Rt.ixfe,delete Rt.XF,h=He,d=be(He),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),He.r<a.s.r&&(a.s.r=He.r),He.c<a.s.c&&(a.s.c=He.c),He.r+1>a.e.r&&(a.e.r=He.r+1),He.c+1>a.e.c&&(a.e.c=He.c+1),or.cellFormula&&Rt.f){for(var Mt=0;Mt<E.length;++Mt)if(!(E[Mt][0].s.c>He.c||E[Mt][0].s.r>He.r)&&!(E[Mt][0].e.c<He.c||E[Mt][0].e.r<He.r)){Rt.F=We(E[Mt][0]),(E[Mt][0].s.c!=He.c||E[Mt][0].s.r!=He.r)&&delete Rt.f,Rt.f&&(Rt.f=""+Lr(E[Mt][1],a,He,V,C));break}}or.dense?(i[He.r]||(i[He.r]=[]),i[He.r][He.c]=Rt):i[d]=Rt}},C={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var N,_e=[],pe=[],Te=[],ge=[],ce=!1,V=[];V.SheetNames=C.snames,V.sharedf=C.sharedf,V.arrayf=C.arrayf,V.names=[],V.XTI=[];var X=0,oe=0,b=0,j=[],z=[],K;C.codepage=1200,ei(1200);for(var q=!1;t.l<t.length-1;){var se=t.l,le=t.read_shift(2);if(le===0&&X===10)break;var ae=t.l===t.length?0:t.read_shift(2),ie=Vm[le];if(ie&&ie.f){if(e.bookSheets&&X===133&&le!==133)break;if(X=le,ie.r===2||ie.r==12){var Fe=t.read_shift(2);if(ae-=2,!C.enc&&Fe!==le&&((Fe&255)<<8|Fe>>8)!==le)throw new Error("rt mismatch: "+Fe+"!="+le);ie.r==12&&(t.l+=10,ae-=10)}var G={};if(le===10?G=ie.f(t,ae,C):G=UU(le,ie,t,ae,C),oe==0&&[9,521,1033,2057].indexOf(X)===-1)continue;switch(le){case 34:r.opts.Date1904=y.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=G;break;case 66:var qe=Number(G);switch(qe){case 21010:qe=1200;break;case 32768:qe=1e4;break;case 32769:qe=1252;break}ei(C.codepage=qe),q=!0;break;case 317:C.rrtabid=G;break;case 25:C.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:C.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:W.push(G);break;case 430:V.push([G]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(G);break;case 24:case 536:K={Name:G.Name,Ref:Lr(G.rgce,a,null,V,C)},G.itab>0&&(K.Sheet=G.itab-1),V.names.push(K),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(z[G.itab-1]={ref:We(G.rgce[0][0][1][2])});break;case 22:C.ExternCount=G;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(G),V.XTI=V.XTI.concat(G);break;case 2196:if(C.biff<8)break;K!=null&&(K.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&C.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,C.snames.push(G.name);break;case 10:{if(--oe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=We(a),e.sheetRows&&e.sheetRows<=a.e.r){var $e=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=We(a),a.e.r=$e}a.e.r++,a.e.c++}_e.length>0&&(i["!merges"]=_e),pe.length>0&&(i["!objects"]=pe),Te.length>0&&(i["!cols"]=Te),ge.length>0&&(i["!rows"]=ge),y.Sheets.push(k)}c===""?f=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),C.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(C.biff=5,q=!0,ei(C.codepage=28591)),C.biff==8&&G.BIFFVer==0&&G.dt==16&&(C.biff=2),oe++)break;if(i=e.dense?[]:{},C.biff<8&&!q&&(q=!0,ei(C.codepage=e.codepage||1252)),C.biff<5||G.BIFFVer==0&&G.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:t.l-ae,name:c};s[at.pos]=at,C.snames.push(c)}else c=(s[se]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),_e=[],pe=[],C.arrayf=E=[],Te=[],ge=[],ce=!1,k={Hidden:(s[se]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[G.r]||[])[G.c]:i[be({c:G.c,r:G.r})])&&++G.c,x={ixfe:G.ixfe,XF:W[G.ixfe]||{},v:G.val,t:"n"},b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:G.c,r:G.r},x,e);break;case 5:case 517:x={ixfe:G.ixfe,XF:W[G.ixfe],v:G.val,t:G.t},b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:G.c,r:G.r},x,e);break;case 638:x={ixfe:G.ixfe,XF:W[G.ixfe],v:G.rknum,t:"n"},b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:G.c,r:G.r},x,e);break;case 189:for(var Ge=G.c;Ge<=G.C;++Ge){var ke=G.rkrec[Ge-G.c][0];x={ixfe:ke,XF:W[ke],v:G.rkrec[Ge-G.c][1],t:"n"},b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:Ge,r:G.r},x,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(x=Uf(G.val,G.cell.ixfe,G.tt),x.XF=W[x.ixfe],e.cellFormula){var Ct=G.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var Kr=Ct[0][0][1][0],nn=Ct[0][0][1][1],Rn=be({r:Kr,c:nn});w[Rn]?x.f=""+Lr(G.formula,a,G.cell,V,C):x.F=((e.dense?(i[Kr]||[])[nn]:i[Rn])||{}).F}else x.f=""+Lr(G.formula,a,G.cell,V,C)}b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R(G.cell,x,e),o=G}break;case 7:case 519:if(o)o.val=G,x=Uf(G,o.cell.ixfe,"s"),x.XF=W[x.ixfe],e.cellFormula&&(x.f=""+Lr(o.formula,a,o.cell,V,C)),b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R(o.cell,x,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(G);var oa=be(G[0].s);if(p=e.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[oa],e.cellFormula&&p){if(!o||!oa||!p)break;p.f=""+Lr(G[1],a,G[0],V,C),p.F=We(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;w[be(o.cell)]=G[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[be(o.cell)],(p||{}).f=""+Lr(G[0],a,h,V,C)}}break;case 253:x=Uf(l[G.isst].t,G.ixfe,"s"),l[G.isst].h&&(x.h=l[G.isst].h),x.XF=W[x.ixfe],b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:G.c,r:G.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:G.ixfe,XF:W[G.ixfe],t:"z"},b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:G.c,r:G.r},x,e));break;case 190:if(e.sheetStubs)for(var Pn=G.c;Pn<=G.C;++Pn){var mr=G.ixfe[Pn-G.c];x={ixfe:mr,XF:W[mr],t:"z"},b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:Pn,r:G.r},x,e)}break;case 214:case 516:case 4:x=Uf(G.val,G.ixfe,"s"),x.XF=W[x.ixfe],b>0&&(x.z=j[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),R({c:G.c,r:G.r},x,e);break;case 0:case 512:oe===1&&(a=G);break;case 252:l=G;break;case 1054:if(C.biff==4){j[b++]=G[1];for(var Fn=0;Fn<b+163&&Oe[Fn]!=G[1];++Fn);Fn>=163&&qi(G[1],b+163)}else qi(G[1],G[0]);break;case 30:{j[b++]=G;for(var _t=0;_t<b+163&&Oe[_t]!=G;++_t);_t>=163&&qi(G,b+163)}break;case 229:_e=_e.concat(G);break;case 93:pe[G.cmo[0]]=C.lastobj=G;break;case 438:C.lastobj.TxO=G;break;case 127:C.lastobj.ImData=G;break;case 440:for(_=G[0].s.r;_<=G[0].e.r;++_)for(m=G[0].s.c;m<=G[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[be({c:m,r:_})],p&&(p.l=G[1]);break;case 2048:for(_=G[0].s.r;_<=G[0].e.r;++_)for(m=G[0].s.c;m<=G[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[be({c:m,r:_})],p&&p.l&&(p.l.Tooltip=G[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;p=e.dense?(i[G[0].r]||[])[G[0].c]:i[be(G[0])];var Ht=pe[G[2]];p||(e.dense?(i[G[0].r]||(i[G[0].r]=[]),p=i[G[0].r][G[0].c]={t:"z"}):p=i[be(G[0])]={t:"z"},a.e.r=Math.max(a.e.r,G[0].r),a.s.r=Math.min(a.s.r,G[0].r),a.e.c=Math.max(a.e.c,G[0].c),a.s.c=Math.min(a.s.c,G[0].c)),p.c||(p.c=[]),g={a:G[1],t:Ht.TxO.t},p.c.push(g)}break;case 2173:C5(W[G.ixfe],G.ext);break;case 125:{if(!C.cellStyles)break;for(;G.e>=G.s;)Te[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},ce||(ce=!0,iv(G.w/256)),Ys(Te[G.e+1])}break;case 520:{var qt={};G.level!=null&&(ge[G.r]=qt,qt.level=G.level),G.hidden&&(ge[G.r]=qt,qt.hidden=!0),G.hpt&&(ge[G.r]=qt,qt.hpt=G.hpt,qt.hpx=vl(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Pa(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=G;break;case 161:i["!margins"]||Pa(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(y.Views[0].RTL=!0);break;case 146:M=G;break;case 2198:N=G;break;case 140:P=G;break;case 442:c?k.CodeName=G||k.name:y.WBProps.CodeName=G||"ThisWorkbook";break}}else ie||console.error("Missing Info for XLS Record 0x"+le.toString(16)),t.l+=ae}return r.SheetNames=Wt(s).sort(function(pn,He){return Number(pn)-Number(He)}).map(function(pn){return s[pn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&z.forEach(function(pn,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=pn}),r.Strings=l,r.SSF=St(Oe),C.enc&&(r.Encryption=C.enc),N&&(r.Themes=N),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),V.names.length>0&&(y.Names=V.names),r.Workbook=y,r}var Pc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function WU(t,e,r){var n=Ne.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=aw(n,Fm,Pc.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Ne.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=aw(a,Nm,Pc.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(eA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function HU(t,e){var r=[],n=[],i=[],s=0,a,o=Ly(Fm,"n"),l=Ly(Nm,"n");if(t.Props)for(a=Wt(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Wt(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)oA.indexOf(i[s][0])>-1||ZS.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ne.utils.cfb_add(e,"/SummaryInformation",ow(n,Pc.SI,l,Nm)),(r.length||c.length)&&Ne.utils.cfb_add(e,"/DocumentSummaryInformation",ow(r,Pc.DSI,o,Fm,c.length?c:null,Pc.UDI))}function rI(t,e){e||(e={}),dv(e),O1(),e.codepage&&D1(e.codepage);var r,n;if(t.FullPaths){if(Ne.find(t,"/encryption"))throw new Error("File is password-protected");r=Ne.find(t,"!CompObj"),n=Ne.find(t,"/Workbook")||Ne.find(t,"/Book")}else{switch(e.type){case"base64":t=yn(An(t));break;case"binary":t=yn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}wr(t,0),n={content:t}}var i,s;if(r&&VU(r),e.bookProps&&!e.bookSheets)i={};else{var a=Ke?"buffer":"array";if(n&&n.content)i=jU(n.content,e);else if((s=Ne.find(t,"PerfectOffice_MAIN"))&&s.content)i=Ra.to_workbook(s.content,(e.type=a,e));else if((s=Ne.find(t,"NativeContent_MAIN"))&&s.content)i=Ra.to_workbook(s.content,(e.type=a,e));else throw(s=Ne.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ne.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=r9(t))}var o={};return t.FullPaths&&WU(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function zU(t,e){var r=e||{},n=Ne.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ne.utils.cfb_add(n,i,nI(t,r)),r.biff==8&&(t.Props||t.Custprops)&&HU(t,n),r.biff==8&&t.vbaraw&&n9(n,Ne.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var du={0:{f:pB},1:{f:EB},2:{f:jB},3:{f:PB},4:{f:AB},5:{f:VB},6:{f:GB},7:{f:OB},8:{f:ZB},9:{f:JB},10:{f:YB},11:{f:QB},12:{f:kB},13:{f:HB},14:{f:NB},15:{f:CB},16:{f:XA},17:{f:XB},18:{f:LB},19:{f:X1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:X7},40:{},42:{},43:{f:GM},44:{f:zM},45:{f:qM},46:{f:QM},47:{f:YM},48:{},49:{f:vb},50:{},51:{f:F5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:_A},62:{f:$B},63:{f:U5},64:{f:m7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:f7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:yB},148:{f:vB,p:16},151:{f:s7},152:{},153:{f:$7},154:{},155:{},156:{f:H7},157:{},158:{},159:{T:1,f:oM},160:{T:-1},161:{T:1,f:so},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:e7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:R5},336:{T:-1},337:{f:O5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:a7},427:{f:o7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:c7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:n7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Q5},633:{T:1},634:{T:-1},635:{T:1,f:q5},636:{T:-1},637:{f:wb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:N7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:g7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vm={6:{f:ip},10:{f:_s},12:{f:Zt},13:{f:Zt},14:{f:zt},15:{f:zt},16:{f:Ur},17:{f:zt},18:{f:zt},19:{f:Zt},20:{f:dw},21:{f:dw},23:{f:vA},24:{f:mw},25:{f:zt},26:{},27:{},28:{f:g8},29:{},34:{f:zt},35:{f:pw},38:{f:Ur},39:{f:Ur},40:{f:Ur},41:{f:Ur},42:{f:zt},43:{f:zt},47:{f:CM},49:{f:HL},51:{f:Zt},60:{},61:{f:VL},64:{f:zt},65:{f:WL},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:IL},93:{f:x8},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:_A},128:{f:i8},129:{f:RL},130:{f:Zt},131:{f:zt},132:{f:zt},133:{f:PL},134:{},140:{f:I8},141:{f:Zt},144:{},146:{f:P8},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:M8},161:{f:D8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:e8},190:{f:t8},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:zt},222:{},224:{f:n8},225:{f:AL},226:{f:_s},227:{},229:{f:v8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:NL},253:{f:$L},255:{f:OL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:lA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:c8},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:E8},439:{f:zt},440:{f:T8},441:{},442:{f:Wu},443:{},444:{f:Zt},445:{},446:{},448:{f:_s},449:{f:ML,r:2},450:{f:_s},512:{f:uw},513:{f:L8},515:{f:o8},516:{f:KL},517:{f:hw},519:{f:V8},520:{f:bL},523:{},545:{f:gw},549:{f:cw},566:{},574:{f:UL},638:{f:ZL},659:{},1048:{},1054:{f:qL},1084:{},1212:{f:d8},2048:{f:S8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Mf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:F8,r:12},2173:{f:I5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:h8,r:12},2197:{},2198:{f:w5,r:12},2199:{},2200:{},2201:{},2202:{f:p8,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:LL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:O8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:R8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uw},1:{},2:{f:H8},3:{f:j8},4:{f:U8},5:{f:hw},7:{f:$8},8:{},9:{f:Mf},11:{},22:{f:Zt},30:{f:QL},31:{},32:{},33:{f:gw},36:{},37:{f:cw},50:{f:G8},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:B8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:K8},223:{},234:{},354:{},421:{},518:{f:ip},521:{f:Mf},536:{f:mw},547:{f:pw},561:{},579:{},1030:{f:ip},1033:{f:Mf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ye(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&$1(r)&&t.push(r)}}function $U(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return ye(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(f=t.next(4),f.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;f.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Gu(t,e,r){return t||(t=ne(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function GU(t,e,r,n){var i=ne(9);return Gu(i,t,e),cA(r,n||"b",i),i}function KU(t,e,r){var n=ne(8+2*r.length);return Gu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function XU(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?ar(kt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ye(t,2,z8(r,n,i)):ye(t,3,W8(r,n,i));return;case"b":case"e":ye(t,5,GU(r,n,e.v,e.t));return;case"s":case"str":ye(t,4,KU(r,n,(e.v||"").slice(0,255)));return}ye(t,1,Gu(null,r,n))}function qU(t,e,r,n){var i=Array.isArray(e),s=rt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=We(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Kt(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=Ft(f)),a=l[f]+o;var h=i?(e[c]||[])[f]:e[a];h&&XU(t,h,c,f)}}}function YU(t,e){for(var r=e||{},n=hn(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ye(n,r.biff==4?1033:r.biff==3?521:9,tv(t,16,r)),qU(n,t.Sheets[t.SheetNames[i]],i,r),ye(n,10),n.end()}function QU(t,e,r){ye(t,49,zL({sz:12,name:"Arial"},r))}function JU(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ye(t,1054,YL(i,e[i],r))})}function ZU(t,e){var r=ne(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ye(t,2151,r),r=ne(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pA(rt(e["!ref"]||"A1"),r),r.write_shift(4,4),ye(t,2152,r)}function ej(t,e){for(var r=0;r<16;++r)ye(t,224,fw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ye(t,224,fw(n,0,e))})}function tj(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ye(t,440,k8(n)),n[1].Tooltip&&ye(t,2048,A8(n))}delete e["!links"]}function rj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&ye(t,125,N8(rd(i,n),i))})}}function nj(t,e,r,n,i){var s=16+aa(i.cellXfs,e,i);if(e.v==null&&!e.bf){ye(t,513,Ka(r,n,s));return}if(e.bf)ye(t,6,RV(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?ar(kt(e.v)):e.v;ye(t,515,l8(r,n,a,s));break;case"b":case"e":ye(t,517,a8(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=cv(i.Strings,e.v,i.revStrings);ye(t,253,GL(r,n,o,s))}else ye(t,516,XL(r,n,(e.v||"").slice(0,255),s,i));break;default:ye(t,513,Ka(r,n,s))}}function ij(t,e,r){var n=hn(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,f,h="",d=[],p=rt(s["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}ye(n,2057,tv(r,16,e)),ye(n,13,Mn(1)),ye(n,12,Mn(100)),ye(n,15,Yr(!0)),ye(n,17,Yr(!1)),ye(n,16,$a(.001)),ye(n,95,Yr(!0)),ye(n,42,Yr(!1)),ye(n,43,Yr(!1)),ye(n,130,Mn(1)),ye(n,128,s8()),ye(n,131,Yr(!1)),ye(n,132,Yr(!1)),c&&rj(n,s["!cols"]),ye(n,512,JL(p,e)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=Kt(m);for(var _=p.s.c;_<=p.e.c;++_){m===p.s.r&&(d[_]=Ft(_)),f=d[_]+h;var w=l?(s[m]||[])[_]:s[f];w&&(nj(n,w,m,_,e),c&&w.l&&s["!links"].push([f,w.l]))}}var E=o.CodeName||o.name||i;return c&&ye(n,574,jL((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ye(n,229,_8(s["!merges"])),c&&tj(n,s),ye(n,442,uA(E)),c&&ZU(n,s),ye(n,10),n.end()}function sj(t,e,r){var n=hn(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ye(n,2057,tv(t,5,r)),r.bookType=="xla"&&ye(n,135),ye(n,225,o?Mn(1200):null),ye(n,193,aL(2)),l&&ye(n,191),l&&ye(n,192),ye(n,226),ye(n,92,CL("SheetJS",r)),ye(n,66,Mn(o?1200:1252)),o&&ye(n,353,Mn(0)),o&&ye(n,448),ye(n,317,b8(t.SheetNames.length)),o&&t.vbaraw&&ye(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";ye(n,442,uA(c))}ye(n,156,Mn(17)),ye(n,25,Yr(!1)),ye(n,18,Yr(!1)),ye(n,19,Mn(0)),o&&ye(n,431,Yr(!1)),o&&ye(n,444,Mn(0)),ye(n,61,BL()),ye(n,64,Yr(!1)),ye(n,141,Mn(0)),ye(n,34,Yr(M7(t)=="true")),ye(n,14,Yr(!0)),o&&ye(n,439,Yr(!1)),ye(n,218,Mn(0)),QU(n,t,r),JU(n,t.SSF,r),ej(n,r),o&&ye(n,352,Yr(!1));var f=n.end(),h=hn();o&&ye(h,140,C8()),o&&r.Strings&&$U(h,252,DL(r.Strings)),ye(h,10);var d=h.end(),p=hn(),g=0,m=0;for(m=0;m<t.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var _=f.length+g+d.length;for(m=0;m<t.SheetNames.length;++m){var w=s[m]||{};ye(p,133,FL({pos:_,hs:w.Hidden||0,dt:0,name:t.SheetNames[m]},r)),_+=e[m].length}var E=p.end();if(g!=E.length)throw new Error("BS8 "+g+" != "+E.length);var x=[];return f.length&&x.push(f),E.length&&x.push(E),d.length&&x.push(d),hr(x)}function aj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=St(Oe)),t&&t.SSF&&(Al(),q0(t.SSF),r.revssf=Q0(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pv(r),r.cellXfs=[],aa(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=ij(i,r,t);return n.unshift(sj(t,n,r)),hr(n)}function nI(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=dn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return aj(t,e);case 4:case 3:case 2:return YU(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Aw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=z6(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<l.length;++a){var m=l[a].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var w=m.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var E=w[o].trim();if(E.match(/<t[dh]/i)){for(var x=E,P=0;x.charAt(0)=="<"&&(P=x.indexOf(">"))>-1;)x=x.slice(P+1);for(var W=0;W<g.length;++W){var M=g[W];M.s.c==f&&M.s.r<c&&c<=M.e.r&&(f=M.e.c+1,W=-1)}var y=Le(E.slice(0,E.indexOf(">")));d=y.colspan?+y.colspan:1,((h=+y.rowspan)>1||d>1)&&g.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var k=y.t||y["data-t"]||"";if(!x.length){f+=d;continue}if(x=IS(x),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!x.length){f+=d;continue}var S={t:"s",v:x};r.raw||!x.trim().length||k=="s"||(x==="TRUE"?S={t:"b",v:!0}:x==="FALSE"?S={t:"b",v:!1}:isNaN(ii(x))?isNaN(ml(x).getDate())||(S={t:"d",v:kt(x)},r.cellDates||(S={t:"n",v:ar(S.v)}),S.z=r.dateNF||Oe[14]):S={t:"n",v:ii(x)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=S):n[be({r:c,c:f})]=S,f+=d}}}}return n["!ref"]=We(p),g.length&&(n["!merges"]=g),n}function oj(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=be({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||W1(h.w||(ss(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+f,s.push(xe("td",d,p))}}var g="<tr>";return g+s.join("")+"</tr>"}var lj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cj="</body></html>";function uj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return sa(Aw(r[0],e),e);var n=vv();return r.forEach(function(i,s){_v(n,Aw(i,e),"Sheet"+(s+1))}),n}function fj(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function iI(t,e){var r=e||{},n=r.header!=null?r.header:lj,i=r.footer!=null?r.footer:cj,s=[n],a=dn(t["!ref"]);r.dense=Array.isArray(t),s.push(fj(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(oj(t,a,o,r));return s.push("</table>"+i),s.join("")}function sI(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Nt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=dn(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),g=0,m=0,_=0,w=0,E=0,x=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&m<l;++g){var P=o[g];if(Iw(P)){if(n.display)continue;p[m]={hidden:!0}}var W=P.children;for(_=w=0;_<W.length;++_){var M=W[_];if(!(n.display&&Iw(M))){var y=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):IS(M.innerHTML),k=M.getAttribute("data-z")||M.getAttribute("z");for(d=0;d<h.length;++d){var S=h[d];S.s.c==w+s&&S.s.r<m+i&&m+i<=S.e.r&&(w=S.e.c+1-s,d=-1)}x=+M.getAttribute("colspan")||1,((E=+M.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:m+i,c:w+s},e:{r:m+i+(E||1)-1,c:w+s+(x||1)-1}});var I={t:"s",v:y},R=M.getAttribute("data-t")||M.getAttribute("t")||"";y!=null&&(y.length==0?I.t=R||"z":n.raw||y.trim().length==0||R=="s"||(y==="TRUE"?I={t:"b",v:!0}:y==="FALSE"?I={t:"b",v:!1}:isNaN(ii(y))?isNaN(ml(y).getDate())||(I={t:"d",v:kt(y)},n.cellDates||(I={t:"n",v:ar(I.v)}),I.z=n.dateNF||Oe[14]):I={t:"n",v:ii(y)})),I.z===void 0&&k!=null&&(I.z=k);var C="",N=M.getElementsByTagName("A");if(N&&N.length)for(var _e=0;_e<N.length&&!(N[_e].hasAttribute("href")&&(C=N[_e].getAttribute("href"),C.charAt(0)!="#"));++_e);C&&C.charAt(0)!="#"&&(I.l={Target:C}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][w+s]=I):t[be({c:w+s,r:m+i})]=I,c.e.c<w+s&&(c.e.c=w+s),w+=x}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=We(c),m>=l&&(t["!fullref"]=We((c.e.r=o.length-g+m-1+i,c))),t}function aI(t,e){var r=e||{},n=r.dense?[]:{};return sI(n,t,e)}function hj(t,e){return sa(aI(t,e),e)}function Iw(t){var e="",r=dj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function dj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function pj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=tt(e.replace(/<[^>]*>/g,""));return[r]}var Cw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function oI(t,e){var r=e||{},n=H1(t),i=[],s,a,o={name:""},l="",c=0,f,h,d={},p=[],g=r.dense?[]:{},m,_,w={value:""},E="",x=0,P=[],W=-1,M=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},I=[],R={},C=0,N=0,_e=[],pe=1,Te=1,ge=[],ce={Names:[]},V={},X=["",""],oe=[],b={},j="",z=0,K=!1,q=!1,se=0;for(ou.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=ou.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?g["!ref"]=We(y):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(g["!fullref"]=g["!ref"],y.e.r=r.sheetRows-1,g["!ref"]=We(y)),I.length&&(g["!merges"]=I),_e.length&&(g["!rows"]=_e),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),d[f.name]=g,q=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Le(m[0],!1),W=M=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,g=r.dense?[]:{},I=[],_e=[],q=!0);break;case"table-row-group":m[1]==="/"?--k:++k;break;case"table-row":case"":if(m[1]==="/"){W+=pe,pe=1;break}if(h=Le(m[0],!1),h.?W=h.-1:W==-1&&(W=0),pe=+h["number-rows-repeated"]||1,pe<10)for(se=0;se<pe;++se)k>0&&(_e[W+se]={level:k});M=-1;break;case"covered-table-cell":m[1]!=="/"&&++M,r.sheetStubs&&(r.dense?(g[W]||(g[W]=[]),g[W][M]={t:"z"}):g[be({r:W,c:M})]={t:"z"}),E="",P=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++M,w=Le(m[0],!1),Te=parseInt(w["number-columns-repeated"]||"1",10),_={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(_.f=Tw(tt(w.formula))),(w.||w["value-type"])=="string"&&(_.t="s",_.v=tt(w["string-value"]||""),r.dense?(g[W]||(g[W]=[]),g[W][M]=_):g[be({r:W,c:M})]=_),M+=Te-1;else if(m[1]!=="/"){++M,E="",x=0,P=[],Te=1;var le=pe?W+pe-1:W;if(M>y.e.c&&(y.e.c=M),M<y.s.c&&(y.s.c=M),W<y.s.r&&(y.s.r=W),le>y.e.r&&(y.e.r=le),w=Le(m[0],!1),oe=[],b={},_={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=tt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(C=parseInt(w["number-matrix-rows-spanned"],10)||0,N=parseInt(w["number-matrix-columns-spanned"],10)||0,R={s:{r:W,c:M},e:{r:W+C-1,c:M+N-1}},_.F=We(R),ge.push([R,_.F])),w.formula)_.f=Tw(w.formula);else for(se=0;se<ge.length;++se)W>=ge[se][0].s.r&&W<=ge[se][0].e.r&&M>=ge[se][0].s.c&&M<=ge[se][0].e.c&&(_.F=ge[se][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(C=parseInt(w["number-rows-spanned"],10)||0,N=parseInt(w["number-columns-spanned"],10)||0,R={s:{r:W,c:M},e:{r:W+C-1,c:M+N-1}},I.push(R)),w["number-columns-repeated"]&&(Te=parseInt(w["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=wt(w["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(w.value);break;case"percentage":_.t="n",_.v=parseFloat(w.value);break;case"currency":_.t="n",_.v=parseFloat(w.value);break;case"date":_.t="d",_.v=kt(w["date-value"]),r.cellDates||(_.t="n",_.v=ar(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=j6(w["time-value"])/86400,r.cellDates&&(_.t="d",_.v=J0(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(w.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",w["string-value"]!=null&&(E=tt(w["string-value"]),P=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(K=!1,_.t==="s"&&(_.v=E||"",P.length&&(_.R=P),K=x==0),V.Target&&(_.l=V),oe.length>0&&(_.c=oe,oe=[]),E&&r.cellText!==!1&&(_.w=E),K&&(_.t="z",delete _.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var ae=0;ae<pe;++ae){if(Te=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(g[W+ae]||(g[W+ae]=[]),g[W+ae][M]=ae==0?_:St(_);--Te>0;)g[W+ae][M+Te]=St(_);else for(g[be({r:W+ae,c:M})]=_;--Te>0;)g[be({r:W+ae,c:M+Te})]=St(_);y.e.c<=M&&(y.e.c=M)}Te=parseInt(w["number-columns-repeated"]||"1",10),M+=Te-1,Te=0,_={},E="",P=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;b.t=E,P.length&&(b.R=P),b.a=j,oe.push(b)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);j="",z=0,E="",x=0,P=[];break;case"creator":m[1]==="/"?j=n.slice(z,m.index):z=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);E="",x=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Le(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Le(m[0],!1),l+=Cw[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Le(m[0],!1),l+=Cw[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":a=Le(m[0],!1),X=sp(a["cell-range-address"]);var ie={Name:a.name,Ref:X[0]+"!"+X[1]};q&&(ie.Sheet=p.length),ce.Names.push(ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!w||!w["string-value"])){var Fe=pj(n.slice(x,m.index));E=(E.length>0?E+`
`:"")+Fe[0]}else Le(m[0],!1),x=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{X=sp(Le(m[0])["target-range-address"]),d[X[0]]["!autofilter"]={ref:X[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(V=Le(m[0],!1),!V.href)break;V.Target=tt(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(X=sp(V.Target.slice(1)),V.Target="#"+X[0]+"!"+X[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var G={Sheets:d,SheetNames:p,Workbook:ce};return r.bookSheets&&delete G.Sheets,G}function Rw(t,e){e=e||{},Ln(t,"META-INF/manifest.xml")&&jb(Jt(t,"META-INF/manifest.xml"),e);var r=wn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=oI(pt(r),e);return Ln(t,"meta.xml")&&(n.Props=QS(Jt(t,"meta.xml"))),n}function Pw(t,e){return oI(t,e)}var mj=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+au({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xt+e}}(),Fw=function(){var t=function(s){return ut(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+ut(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=dn(s["!ref"]||"A1"),d=s["!merges"]||[],p=0,g=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",_=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)l.push(e);for(;f<=h.e.c;++f){var w=!1,E={},x="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>f)&&!(d[p].s.r>c)&&!(d[p].e.c<f)&&!(d[p].e.r<c)){(d[p].s.c!=f||d[p].s.r!=c)&&(w=!0),E["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,E["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(w){l.push(r);continue}var P=be({r:c,c:f}),W=g?(s[c]||[])[f]:s[P];if(W&&W.f&&(E["table:formula"]=ut(bV(W.f)),W.F&&W.F.slice(0,P.length)==P)){var M=dn(W.F);E["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,E["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!W){l.push(e);continue}switch(W.t){case"b":x=W.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=W.v?"true":"false";break;case"n":x=W.w||String(W.v||0),E["office:value-type"]="float",E["office:value"]=W.v||0;break;case"s":case"str":x=W.v==null?"":W.v,E["office:value-type"]="string";break;case"d":x=W.w||kt(W.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=kt(W.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(e);continue}var y=t(x);if(W.l&&W.l.Target){var k=W.l.Target;k=k.charAt(0)=="#"?"#"+LV(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),y=xe("text:a",y,{"xlink:href":k.replace(/&/g,"&amp;")})}l.push("          "+xe("table:table-cell",xe("text:p",y,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ys(h),h.ods=o;var d=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var h=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Xt],c=au({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=au({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(YS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function lI(t,e){if(e.bookType=="fods")return Fw(t,e);var r=B1(),n="",i=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,Fw(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,mj(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,Xt+YS()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,zb(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,Wb(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xa(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Bm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):pt(ia(t))}function gj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):yn(xi(t))}function vj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Js(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Nw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function _j(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function xj(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function pu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function lt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function jt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function it(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=pu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=pu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function _r(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(lt(n*8+i.type)),i.type==2&&e.push(lt(i.data.length)),e.push(i.data))})}),Js(e)}function hv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function On(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=pu(t,n),s=it(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:jt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=it(o.data),c=jt(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=jt(s[3][0].data)>>>0>0),r.push(a)}return r}function vo(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:lt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:lt(a.data.length)}],n[2].push({data:_r(a.meta),type:2})});var s=_r(n);e.push(lt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Js(e)}function yj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=pu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Js(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var f=Js(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function bn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(yj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Js(e)}function _o(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=lt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Js(e)}function wj(t,e,r,n){var i=Xa(t),s=i.getUint32(4,!0),a=(n>1?12:8)+Nw(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Nw(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function Ej(t,e,r){var n=Xa(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);i&1&&(l=_j(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function op(t,e){var r=new Uint8Array(32),n=Xa(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,xj(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function lp(t,e){var r=new Uint8Array(32),n=Xa(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Tj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return wj(t,e,r,t[0]);case 5:return Ej(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function br(t){var e=it(t);return pu(e[1][0].data)}function Dw(t,e){var r=it(e.data),n=jt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=it(a.data),l=jt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Bm(o[3][0].data);break;case 8:{var c=t[br(o[9][0].data)][0],f=it(c.data),h=t[br(f[1][0].data)][0],d=jt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=it(h.data);s[l]=p[3].map(function(g){return Bm(g.data)}).join("")}break}}),s}function kj(t,e){var r,n,i,s,a,o,l,c,f,h,d,p,g,m,_=it(t),w=jt(_[1][0].data)>>>0,E=jt(_[2][0].data)>>>0,x=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&jt(_[8][0].data)>0||!1,P,W;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,W=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=_[4])==null?void 0:f[0])!=null&&h.data&&e!=1)P=(p=(d=_[4])==null?void 0:d[0])==null?void 0:p.data,W=(m=(g=_[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var M=x?4:1,y=Xa(P),k=[],S=0;S<P.length/2;++S){var I=y.getUint16(S*2,!0);I<65535&&k.push([S,I])}if(k.length!=E)throw"Expected ".concat(E," cells, found ").concat(k.length);var R=[];for(S=0;S<k.length-1;++S)R[k[S][0]]=W.subarray(k[S][1]*M,k[S+1][1]*M);return k.length>=1&&(R[k[k.length-1][0]]=W.subarray(k[k.length-1][1]*M)),{R:w,cells:R}}function Sj(t,e){var r,n=it(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?jt(n[7][0].data)>>>0>0?1:0:-1,s=hv(n[5],function(a){return kj(a,i)});return{nrows:jt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function Aj(t,e,r){var n,i=it(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(jt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(jt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=We(s);var a=it(i[4][0].data),o=Dw(t,t[br(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Dw(t,t[br(a[17][0].data)][0]):[],c=it(a[3][0].data),f=0;c[1].forEach(function(h){var d=it(h.data),p=t[br(d[2][0].data)][0],g=jt(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=Sj(t,p);m.data.forEach(function(_,w){_.forEach(function(E,x){var P=be({r:f+w,c:x}),W=Tj(E,o,l);W&&(r[P]=W)})}),f+=m.nrows})}function Ij(t,e){var r=it(e.data),n={"!ref":"A1"},i=t[br(r[2][0].data)],s=jt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Aj(t,i[0],n),n}function Cj(t,e){var r,n=it(e.data),i={name:(r=n[1])!=null&&r[0]?Bm(n[1][0].data):"",sheets:[]},s=hv(n[2],br);return s.forEach(function(a){t[a].forEach(function(o){var l=jt(o.meta[1][0].data);l==6e3&&i.sheets.push(Ij(t,o))})}),i}function Rj(t,e){var r=vv(),n=it(e.data),i=hv(n[1],br);if(i.forEach(function(s){t[s].forEach(function(a){var o=jt(a.meta[1][0].data);if(o==2){var l=Cj(t,a);l.sheets.forEach(function(c,f){_v(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function cp(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=bn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=On(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&jt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var f=jt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Rj(s,o)}function Pj(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&jt(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Xa(t[7][0].data),f=0,h=[],d=Xa(t[4][0].data),p=0,g=[],m=0;m<e.length;++m){if(e[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,f,!0),d.setUint16(m*2,p,!0);var _,w;switch(typeof e[m]){case"string":_=op({t:"s",v:e[m]},r),w=lp({t:"s",v:e[m]},r);break;case"number":_=op({t:"n",v:e[m]},r),w=lp({t:"n",v:e[m]},r);break;case"boolean":_=op({t:"b",v:e[m]},r),w=lp({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(_),f+=_.length,g.push(w),p+=w.length,++l}for(t[2][0].data=lt(l);m<t[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return t[6][0].data=Js(h),t[3][0].data=Js(g),l}function Fj(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=dn(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(We(n)));var s=f0(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(j){return j.forEach(function(z){typeof z=="string"&&a.push(z)})});var o={},l=[],c=Ne.read(e.numbers,{type:"base64"});c.FileIndex.map(function(j,z){return[j,c.FullPaths[z]]}).forEach(function(j){var z=j[0],K=j[1];if(z.type==2&&z.name.match(/\.iwa/)){var q=z.content,se=bn(q),le=On(se);le.forEach(function(ae){l.push(ae.id),o[ae.id]={deps:[],location:K,type:jt(ae.messages[0].meta[1][0].data)}})}}),l.sort(function(j,z){return j-z});var f=l.filter(function(j){return j>1}).map(function(j){return[j,lt(j)]});c.FileIndex.map(function(j,z){return[j,c.FullPaths[z]]}).forEach(function(j){var z=j[0];if(j[1],!!z.name.match(/\.iwa/)){var K=On(bn(z.content));K.forEach(function(q){q.messages.forEach(function(se){f.forEach(function(le){q.messages.some(function(ae){return jt(ae.meta[1][0].data)!=11006&&vj(ae.data,le[1])})&&o[le[0]].deps.push(q.id)})})})}});for(var h=Ne.find(c,o[1].location),d=On(bn(h.content)),p,g=0;g<d.length;++g){var m=d[g];m.id==1&&(p=m)}var _=br(it(p.messages[0].data)[1][0].data);for(h=Ne.find(c,o[_].location),d=On(bn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==_&&(p=m);for(_=br(it(p.messages[0].data)[2][0].data),h=Ne.find(c,o[_].location),d=On(bn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==_&&(p=m);for(_=br(it(p.messages[0].data)[2][0].data),h=Ne.find(c,o[_].location),d=On(bn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==_&&(p=m);var w=it(p.messages[0].data);{w[6][0].data=lt(n.e.r+1),w[7][0].data=lt(n.e.c+1);var E=br(w[46][0].data),x=Ne.find(c,o[E].location),P=On(bn(x.content));{for(var W=0;W<P.length&&P[W].id!=E;++W);if(P[W].id!=E)throw"Bad ColumnRowUIDMapArchive";var M=it(P[W].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var y=0;y<=n.e.c;++y){var k=[];k[1]=k[2]=[{type:0,data:lt(y+420690)}],M[1].push({type:2,data:_r(k)}),M[2].push({type:0,data:lt(y)}),M[3].push({type:0,data:lt(y)})}M[4]=[],M[5]=[],M[6]=[];for(var S=0;S<=n.e.r;++S)k=[],k[1]=k[2]=[{type:0,data:lt(S+726270)}],M[4].push({type:2,data:_r(k)}),M[5].push({type:0,data:lt(S)}),M[6].push({type:0,data:lt(S)});P[W].messages[0].data=_r(M)}x.content=_o(vo(P)),x.size=x.content.length,delete w[46];var I=it(w[4][0].data);{I[7][0].data=lt(n.e.r+1);var R=it(I[1][0].data),C=br(R[2][0].data);x=Ne.find(c,o[C].location),P=On(bn(x.content));{if(P[0].id!=C)throw"Bad HeaderStorageBucket";var N=it(P[0].messages[0].data);for(S=0;S<s.length;++S){var _e=it(N[2][0].data);_e[1][0].data=lt(S),_e[4][0].data=lt(s[S].length),N[2][S]={type:N[2][0].type,data:_r(_e)}}P[0].messages[0].data=_r(N)}x.content=_o(vo(P)),x.size=x.content.length;var pe=br(I[2][0].data);x=Ne.find(c,o[pe].location),P=On(bn(x.content));{if(P[0].id!=pe)throw"Bad HeaderStorageBucket";for(N=it(P[0].messages[0].data),y=0;y<=n.e.c;++y)_e=it(N[2][0].data),_e[1][0].data=lt(y),_e[4][0].data=lt(n.e.r+1),N[2][y]={type:N[2][0].type,data:_r(_e)};P[0].messages[0].data=_r(N)}x.content=_o(vo(P)),x.size=x.content.length;var Te=br(I[4][0].data);(function(){for(var j=Ne.find(c,o[Te].location),z=On(bn(j.content)),K,q=0;q<z.length;++q){var se=z[q];se.id==Te&&(K=se)}var le=it(K.messages[0].data);{le[3]=[];var ae=[];a.forEach(function(G,qe){ae[1]=[{type:0,data:lt(qe)}],ae[2]=[{type:0,data:lt(1)}],ae[3]=[{type:2,data:gj(G)}],le[3].push({type:2,data:_r(ae)})})}K.messages[0].data=_r(le);var ie=vo(z),Fe=_o(ie);j.content=Fe,j.size=j.content.length})();var ge=it(I[3][0].data);{var ce=ge[1][0];delete ge[2];var V=it(ce.data);{var X=br(V[2][0].data);(function(){for(var j=Ne.find(c,o[X].location),z=On(bn(j.content)),K,q=0;q<z.length;++q){var se=z[q];se.id==X&&(K=se)}var le=it(K.messages[0].data);{delete le[6],delete ge[7];var ae=new Uint8Array(le[5][0].data);le[5]=[];for(var ie=0,Fe=0;Fe<=n.e.r;++Fe){var G=it(ae);ie+=Pj(G,s[Fe],a),G[1][0].data=lt(Fe),le[5].push({data:_r(G),type:2})}le[1]=[{type:0,data:lt(n.e.c+1)}],le[2]=[{type:0,data:lt(n.e.r+1)}],le[3]=[{type:0,data:lt(ie)}],le[4]=[{type:0,data:lt(n.e.r+1)}]}K.messages[0].data=_r(le);var qe=vo(z),$e=_o(qe);j.content=$e,j.size=j.content.length})()}ce.data=_r(V)}I[3][0].data=_r(ge)}w[4][0].data=_r(I)}p.messages[0].data=_r(w);var oe=vo(d),b=_o(oe);return h.content=b,h.size=h.content.length,c}function cI(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function dv(t){cI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function pv(t){cI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Nj(t){return Xe.WS.indexOf(t)>-1?"sheet":t==Xe.CS?"chart":t==Xe.DS?"dialog":t==Xe.MS?"macro":t&&t.length?t:"sheet"}function Dj(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Nj(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Oj(t,e,r,n,i,s,a,o,l,c,f,h){try{s[n]=Ac(wn(t,r,!0),e);var d=Jt(t,e),p;switch(o){case"sheet":p=rU(d,e,i,l,s[n],c,f,h);break;case"chart":if(p=nU(d,e,i,l,s[n],c,f,h),!p||!p["!drawel"])break;var g=lc(p["!drawel"].Target,e),m=lu(g),_=H5(wn(t,g,!0),Ac(wn(t,m,!0),g)),w=lc(_,g),E=lu(w);p=P7(wn(t,w,!0),w,l,Ac(wn(t,E,!0),w),c,p);break;case"macro":p=iU(d,e,i,l,s[n],c,f,h);break;case"dialog":p=sU(d,e,i,l,s[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var x=[];s&&s[n]&&Wt(s[n]).forEach(function(P){var W="";if(s[n][P].Type==Xe.CMNT){W=lc(s[n][P].Target,e);var M=cU(Jt(t,W,!0),W,l);if(!M||!M.length)return;_w(p,M,!1)}s[n][P].Type==Xe.TCMNT&&(W=lc(s[n][P].Target,e),x=x.concat($5(Jt(t,W,!0),l)))}),x&&x.length&&_w(p,x,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function Nn(t){return t.charAt(0)=="/"?t.slice(1):t}function bj(t,e){if(Al(),e=e||{},dv(e),Ln(t,"META-INF/manifest.xml")||Ln(t,"objectdata.xml"))return Rw(t,e);if(Ln(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof cp<"u"){if(t.FileIndex)return cp(t);var r=Ne.utils.cfb_new();return By(t).forEach(function(_e){ze(r,_e,G6(t,_e))}),cp(r)}throw new Error("Unsupported NUMBERS file")}if(!Ln(t,"[Content_Types].xml"))throw Ln(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=By(t),i=Bb(wn(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Jt(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Jt(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Ic=[],i.sst)try{Ic=lU(Jt(t,Nn(i.sst)),i.sst,e)}catch(_e){if(e.WTF)throw _e}e.cellStyles&&i.themes.length&&(l=oU(wn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=aU(Jt(t,Nn(i.style)),i.style,l,e))}i.links.map(function(_e){try{var pe=Ac(wn(t,lu(Nn(_e))),_e);return fU(Jt(t,Nn(_e)),pe,_e,e)}catch{}});var f=tU(Jt(t,Nn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=Jt(t,Nn(i.coreprops[0]),!0),d&&(h=QS(d)),i.extprops.length!==0&&(d=Jt(t,Nn(i.extprops[0]),!0),d&&Gb(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=wn(t,Nn(i.custprops[0]),!0),d&&(p=Xb(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(pe){return pe.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=p),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var m={};e.bookDeps&&i.calcchain&&(m=uU(Jt(t,Nn(i.calcchain)),i.calcchain));var _=0,w={},E,x;{var P=f.Sheets;h.Worksheets=P.length,h.SheetNames=[];for(var W=0;W!=P.length;++W)h.SheetNames[W]=P[W].name}var M=s?"bin":"xml",y=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,y+1)+"_rels/"+i.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");Ln(t,k)||(k="xl/_rels/workbook."+M+".rels");var S=Ac(wn(t,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=hU(Jt(t,Nn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=K5(Jt(t,Nn(i.people[0])),e)),S&&(S=Dj(S,f.Sheets));var I=Jt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=h.Worksheets;++_){var R="sheet";if(S&&S[_]?(E="xl/"+S[_][1].replace(/[\/]?xl\//,""),Ln(t,E)||(E=S[_][1]),Ln(t,E)||(E=k.replace(/_rels\/.*$/,"")+S[_][1]),R=S[_][2]):(E="xl/worksheets/sheet"+(_+1-I)+"."+M,E=E.replace(/sheet0\./,"sheet.")),x=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(h.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==_&&(C=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==h.SheetNames[_].toLowerCase()&&(C=1);if(!C)continue e}}Oj(t,E,x,h.SheetNames[_],_,w,a,R,e,f,l,c)}return g={Directory:i,Workbook:f,Props:h,Custprops:p,Deps:m,Sheets:a,SheetNames:h.SheetNames,Strings:Ic,Styles:c,Themes:l,SSF:St(Oe)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(_e,pe){_e=_e.replace(/^Root Entry[\/]/,""),g.keys.push(_e),g.files[_e]=t.FileIndex[pe]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=Jt(t,Nn(i.vba[0]),!0):i.defaults&&i.defaults.bin===t9&&(g.vbaraw=Jt(t,"xl/vbaProject.bin",!0))),g}function Lj(t,e){var r=e||{},n="Workbook",i=Ne.find(t,n);try{if(n="/!DataSpaces/Version",i=Ne.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(hM(i.content),n="/!DataSpaces/DataSpaceMap",i=Ne.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=pM(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ne.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=mM(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ne.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);vM(i.content)}catch{}if(n="/EncryptionInfo",i=Ne.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=_M(i.content);if(n="/EncryptedPackage",i=Ne.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Mj(t,e){return e.bookType=="ods"?lI(t,e):e.bookType=="numbers"?Fj(t,e):e.bookType=="xlsb"?Vj(t,e):Bj(t,e)}function Vj(t,e){Mo=1024,t&&!t.SSF&&(t.SSF=St(Oe)),t&&t.SSF&&(Al(),q0(t.SSF),e.revssf=Q0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=LA.indexOf(e.bookType)>-1,i=Z1();pv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],aa(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,JS(t.Props,e)),i.coreprops.push(a),ct(e.rels,2,a,Xe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,tA(t.Props)),i.extprops.push(a),ct(e.rels,3,a,Xe.EXT_PROPS),t.Custprops!==t.Props&&Wt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,rA(t.Custprops)),i.custprops.push(a),ct(e.rels,4,a,Xe.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,pU(o-1,a,e,t,f)),i.sheets.push(a),ct(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Xe.WS[0])}if(h){var p=h["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,ze(s,m,vU(p,m)),i.comments.push(m),ct(f,-1,"../comments"+o+"."+r,Xe.CMNT),g=!0),h["!legacy"]&&g&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",OA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&ze(s,lu(a),qo(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,gU(e.Strings,a,e)),i.strs.push(a),ct(e.wbrels,-1,"sharedStrings."+r,Xe.SST)),a="xl/workbook."+r,ze(s,a,dU(t,a)),i.workbooks.push(a),ct(e.rels,1,a,Xe.WB),a="xl/theme/theme1.xml",ze(s,a,sv(t.Themes,e)),i.themes.push(a),ct(e.wbrels,-1,"theme/theme1.xml",Xe.THEME),a="xl/styles."+r,ze(s,a,mU(t,a,e)),i.styles.push(a),ct(e.wbrels,-1,"styles."+r,Xe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ct(e.wbrels,-1,"vbaProject.bin",Xe.VBA)),a="xl/metadata."+r,ze(s,a,_U(a)),i.metadata.push(a),ct(e.wbrels,-1,"metadata."+r,Xe.XLMETA),ze(s,"[Content_Types].xml",qS(i,e)),ze(s,"_rels/.rels",qo(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",qo(e.wbrels)),delete e.revssf,delete e.ssf,s}function Bj(t,e){Mo=1024,t&&!t.SSF&&(t.SSF=St(Oe)),t&&t.SSF&&(Al(),q0(t.SSF),e.revssf=Q0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=LA.indexOf(e.bookType)>-1,i=Z1();pv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],aa(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,JS(t.Props,e)),i.coreprops.push(a),ct(e.rels,2,a,Xe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,tA(t.Props)),i.extprops.push(a),ct(e.rels,3,a,Xe.EXT_PROPS),t.Custprops!==t.Props&&Wt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,rA(t.Custprops)),i.custprops.push(a),ct(e.rels,4,a,Xe.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,KA(o-1,e,t,h)),i.sheets.push(a),ct(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Xe.WS[0])}if(d){var g=d["!comments"],m=!1,_="";if(g&&g.length>0){var w=!1;g.forEach(function(E){E[1].forEach(function(x){x.T==!0&&(w=!0)})}),w&&(_="xl/threadedComments/threadedComment"+o+"."+r,ze(s,_,G5(g,f,e)),i.threadedcomments.push(_),ct(h,-1,"../threadedComments/threadedComment"+o+"."+r,Xe.TCMNT)),_="xl/comments"+o+"."+r,ze(s,_,bA(g)),i.comments.push(_),ct(h,-1,"../comments"+o+"."+r,Xe.CMNT),m=!0}d["!legacy"]&&m&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",OA(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&ze(s,lu(a),qo(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,EA(e.Strings,e)),i.strs.push(a),ct(e.wbrels,-1,"sharedStrings."+r,Xe.SST)),a="xl/workbook."+r,ze(s,a,JA(t)),i.workbooks.push(a),ct(e.rels,1,a,Xe.WB),a="xl/theme/theme1.xml",ze(s,a,sv(t.Themes,e)),i.themes.push(a),ct(e.wbrels,-1,"theme/theme1.xml",Xe.THEME),a="xl/styles."+r,ze(s,a,PA(t,e)),i.styles.push(a),ct(e.wbrels,-1,"styles."+r,Xe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ct(e.wbrels,-1,"vbaProject.bin",Xe.VBA)),a="xl/metadata."+r,ze(s,a,DA()),i.metadata.push(a),ct(e.wbrels,-1,"metadata."+r,Xe.XLMETA),f.length>1&&(a="xl/persons/person.xml",ze(s,a,X5(f)),i.people.push(a),ct(e.wbrels,-1,"persons/person.xml",Xe.PEOPLE)),ze(s,"[Content_Types].xml",qS(i,e)),ze(s,"_rels/.rels",qo(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",qo(e.wbrels)),delete e.revssf,delete e.ssf,s}function mv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=An(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Uj(t,e){return Ne.find(t,"EncryptedPackage")?Lj(t,e):rI(t,e)}function jj(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ke&&Buffer.isBuffer(t)?"buffer":"base64"),r=kS(n,i),bj(r,i)}function uI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Mm(t.slice(r),e);default:break e}return gl.to_workbook(t,e)}function Wj(t,e){var r="",n=mv(t,e);switch(e.type){case"base64":r=An(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=za(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pt(r)),e.type="binary",uI(r,e)}function Hj(t,e){var r=t;return e.type=="base64"&&(r=An(r)),r=ru.utils.decode(1200,r.slice(2),"str"),e.type="binary",uI(r,e)}function zj(t){return t.match(/[^\x00-\x7F]/)?xi(t):t}function up(t,e,r,n){return n?(r.type="string",gl.to_workbook(t,r)):gl.to_workbook(e,r)}function u0(t,e){O1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return u0(new Uint8Array(t),(r=St(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Qo={},r.dateNF&&(Qo.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",n=V6(t),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=zj(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=St(r),r.type="array",u0(b1(n),r)}switch((i=mv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Uj(Ne.read(n,r),r);break;case 9:if(i[1]<=8)return rI(n,r);break;case 60:return Mm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return q8(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return yA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?jj(n,r):up(t,n,r,s);case 239:return i[3]===60?Mm(n,r):up(t,n,r,s);case 255:if(i[1]===254)return Hj(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ra.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ra.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Lm.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return IA.to_workbook(n,r);break;case 10:case 13:case 32:return Wj(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return X8.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Lm.to_workbook(n,r):up(t,n,r,s)}function fI(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Bu(e.file,Ne.write(t,{type:Ke?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ne.write(t,e)}function $j(t,e){var r=St(e||{}),n=Mj(t,r);return Gj(n,r)}function Gj(t,e){var r={},n=Ke?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Ne.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(X0(i))}return e.password&&typeof encrypt_agile<"u"?fI(encrypt_agile(i,e.password),e):e.type==="file"?Bu(e.file,i):e.type=="string"?pt(i):i}function Kj(t,e){var r=e||{},n=zU(t,r);return fI(n,r)}function pi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return nu(xi(n));case"binary":return xi(n);case"string":return t;case"file":return Bu(e.file,n,"utf8");case"buffer":return Ke?cs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pi(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Xj(t,e){switch(e.type){case"base64":return nu(t);case"binary":return t;case"string":return t;case"file":return Bu(e.file,t,"binary");case"buffer":return Ke?cs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function jf(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?nu(r):e.type=="string"?pt(r):r;case"file":return Bu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function hI(t,e){O1(),U7(t);var r=St(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=hI(t,r);return r.type="array",X0(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return pi(MU(t,r),r);case"slk":case"sylk":return pi(xA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return pi(iI(t.Sheets[t.SheetNames[i]],r),r);case"txt":return Xj(pI(t.Sheets[t.SheetNames[i]],r),r);case"csv":return pi(gv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return pi(yA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return jf(Lm.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return pi(gl.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return pi(IA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return pi(wA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return pi(lI(t,r),r);case"wk1":return jf(Ra.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return jf(Ra.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),jf(nI(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Kj(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $j(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function qj(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function dI(t,e,r){var n={};return n.type="file",n.file=e,qj(n),hI(t,n)}function Yj(t,e,r,n,i,s,a,o){var l=Kt(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var g=a?t[r][p]:t[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[p]!=null){if(m==null)if(g.t=="e"&&m===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(f&&m===null)d[s[p]]=null;else continue;else d[s[p]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:ss(g,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function f0(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=rt(f);break;case"number":l=rt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var h=Kt(l.s.r),d=[],p=[],g=0,m=0,_=Array.isArray(t),w=l.s.r,E=0,x={};_&&!t[w]&&(t[w]=[]);var P=c.skipHidden&&t["!cols"]||[],W=c.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(P[E]||{}).hidden)switch(d[E]=Ft(E),r=_?t[w][E]:t[d[E]+h],n){case 1:s[E]=E-l.s.c;break;case 2:s[E]=d[E];break;case 3:s[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ss(r,null,c),m=x[a]||0,!m)x[a]=1;else{do o=a+"_"+m++;while(x[o]);x[a]=m,x[o]=1}s[E]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(W[w]||{}).hidden){var M=Yj(t,l,w,d,n,s,_,c);(M.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=M.row)}return p.length=g,p}var Ow=/"/g;function Qj(t,e,r,n,i,s,a,o){for(var l=!0,c=[],f="",h=Kt(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:ss(p,null,o));for(var g=0,m=0;g!==f.length;++g)if((m=f.charCodeAt(g))===i||m===s||m===34||o.forceQuotes){f='"'+f.replace(Ow,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Ow,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function gv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=rt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=Ft(g));for(var m=0,_=i.s.r;_<=i.e.r;++_)(p[_]||{}).hidden||(f=Qj(t,i,_,h,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function pI(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=gv(t,e);return r}function Jj(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=rt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ft(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=Kt(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function mI(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Nt(n.origin):n.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=rt(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,_){Wt(m).forEach(function(w){(p=d.indexOf(w))==-1&&(d[p=d.length]=w);var E=m[w],x="z",P="",W=be({c:o+p,r:a+_+i});c=mu(s,W),E&&typeof E=="object"&&!(E instanceof Date)?s[W]=E:(typeof E=="number"?x="n":typeof E=="boolean"?x="b":typeof E=="string"?x="s":E instanceof Date?(x="d",n.cellDates||(x="n",E=ar(E)),P=n.dateNF||Oe[14]):E===null&&n.nullError&&(x="e",E=0),c?(c.t=x,c.v=E,delete c.w,delete c.R,P&&(c.z=P)):s[W]=c={t:x,v:E},P&&(c.z=P))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var g=Kt(a);if(i)for(p=0;p<d.length;++p)s[Ft(p+o)+g]={t:"s",v:d[p]};return s["!ref"]=We(f),s}function Zj(t,e){return mI(null,t,e)}function mu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Nt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?mu(t,be(e)):mu(t,be({r:e,c:r||0}))}function eW(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function vv(){return{SheetNames:[],Sheets:{}}}function _v(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(QA(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function tW(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=eW(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function rW(t,e){return t.z=e,t}function gI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function nW(t,e,r){return gI(t,"#"+e,r)}function iW(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function sW(t,e,r,n){for(var i=typeof e!="string"?e:rt(e),s=typeof e=="string"?e:We(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=mu(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Fa={encode_col:Ft,encode_row:Kt,encode_cell:be,encode_range:We,decode_col:K1,decode_row:G1,split_cell:gb,decode_cell:Nt,decode_range:dn,format_cell:ss,sheet_add_aoa:WS,sheet_add_json:mI,sheet_add_dom:sI,aoa_to_sheet:Il,json_to_sheet:Zj,table_to_sheet:aI,table_to_book:hj,sheet_to_csv:gv,sheet_to_txt:pI,sheet_to_json:f0,sheet_to_html:iI,sheet_to_formulae:Jj,sheet_to_row_object_array:f0,sheet_get_cell:mu,book_new:vv,book_append_sheet:_v,book_set_sheet_visibility:tW,cell_set_number_format:rW,cell_set_hyperlink:gI,cell_set_internal_link:nW,cell_add_comment:iW,sheet_set_array_formula:sW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aW={apiKey:"AIzaSyBSYlhken9G5cTpzmQCDA1tUGTo5ztr2gI",authDomain:"appchamcong-2ef18.firebaseapp.com",projectId:"appchamcong-2ef18",storageBucket:"appchamcong-2ef18.firebasestorage.app",messagingSenderId:"651193311180",appId:"1:651193311180:web:2ca1d59ad92e7ddd628769",measurementId:"G-RZWQEWMXTQ"},vI=Mg(aW),dt=$O(vI),zi=BT(vI),xv=(t,e)=>Array.from({length:new Date(e,t,0).getDate()},(r,n)=>n+1),Wf=(t,e,r)=>["CN","T2","T3","T4","T5","T6","T7"][new Date(r,e-1,t).getDay()],yv=(t,e)=>t?[...t].sort((r,n)=>{if(e==="name"){const i=r.name?r.name.split(" ").pop():"",s=n.name?n.name.split(" ").pop():"";return i.localeCompare(s)}else{const i={"Trng Khoa":1,"Ph Khoa":2,"Bc s":3,"iu dng":4,"Y t":5};return(i[r.position]||99)-(i[n.position]||99)}}):[],h0=[{code:"+",label:"Lng thi hn",val:1,type:"SALARY",order:1},{code:"",label:"m, iu dng",val:1,type:"INSURANCE",order:2},{code:"CO",label:"Con m",val:1,type:"INSURANCE",order:3},{code:"TS",label:"Thai sn",val:1,type:"INSURANCE",order:4},{code:"T",label:"Tai nn",val:1,type:"INSURANCE",order:5},{code:"P",label:"Ngh php",val:1,type:"SALARY",order:6},{code:"Bc",label:"B chiu",val:.5,type:"SALARY",order:7},{code:"Hdh",label:"Hc di hn",val:1,type:"SALARY",order:8},{code:"H",label:"Hi ngh, hc ngn",val:1,type:"SALARY",order:9},{code:"Bj",label:"Ngh b ngy",val:1,type:"SALARY",order:10},{code:"No",label:"Ngh khng lng",val:1,type:"UNPAID",order:11},{code:"N",label:"Ngng vic",val:1,type:"SALARY",order:12},{code:"L",label:"Lao ng ngha v",val:1,type:"SALARY",order:13},{code:"Bs",label:"B sng",val:.5,type:"SALARY",order:14},{code:"Tr",label:"Trc",val:1,type:"SALARY",order:15},{code:"Ho",label:"Hc n",val:1,type:"SALARY",order:16},{code:"Hs",label:"Hc sng",val:.5,type:"SALARY",order:17},{code:"Hc",label:"Hc chiu",val:.5,type:"SALARY",order:18},{code:"CTs",label:"Cng tc sng",val:.5,type:"SALARY",order:19},{code:"CTc",label:"Cng tc chiu",val:.5,type:"SALARY",order:20}],wv=({userRole:t,onLogout:e,onOpenChangePass:r,isOpen:n,onClose:i})=>F.jsxs(F.Fragment,{children:[F.jsx("div",{className:`sidebar-overlay ${n?"open":""}`,onClick:i}),F.jsxs("div",{className:`sidebar ${n?"open":""}`,children:[F.jsxs("div",{className:"sidebar-header",children:[F.jsx("span",{children:" App Chm Cng"}),F.jsx("span",{onClick:i,style:{cursor:"pointer",fontSize:24,display:window.innerWidth>768?"none":"block"},children:""})]}),F.jsxs("div",{style:{padding:"20px 10px"},children:[F.jsxs("div",{className:"menu-item active",onClick:i,children:[" ",t==="ADMIN"?"Qun Tr H Thng":"Bng Chm Cng"]}),F.jsx("div",{className:"menu-item",onClick:()=>{r(),i()},children:" i Mt Khu"})]}),F.jsx("div",{style:{marginTop:"auto",padding:"20px"},children:F.jsx("button",{onClick:e,className:"btn btn-logout",style:{width:"100%",justifyContent:"center"},children:"ng Xut"})})]})]}),Ev=({title:t,email:e,notifications:r=[],onMenuClick:n,onShowLegend:i})=>{const[s,a]=Pe.useState(!1),o=r?r.filter(c=>!c.isRead).length:0,l=async()=>{if(s&&o>0){const c=s6(dt);r.filter(f=>!f.isRead).forEach(f=>{const h=fr(dt,"requests",f.id);c.update(h,{isRead:!0})}),await c.commit()}a(!s)};return F.jsxs("div",{className:"top-header",children:[F.jsxs("div",{style:{display:"flex",alignItems:"center",gap:15},children:[F.jsx("button",{className:"menu-btn",onClick:n,children:""}),F.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#1e293b",fontWeight:"700"},children:t})]}),F.jsxs("div",{style:{display:"flex",alignItems:"center",gap:20},children:[F.jsxs("button",{className:"btn",style:{background:"#fff",color:"#64748b",border:"1px solid #e2e8f0",padding:"8px 12px"},onClick:i,children:[" ",F.jsx("span",{style:{display:window.innerWidth<500?"none":"inline"},children:"K hiu"})]}),F.jsxs("div",{className:"notification-bell-container",onClick:l,children:[F.jsx("span",{className:"notification-bell",children:""}),o>0&&F.jsx("span",{className:"badge",children:o})]}),s&&F.jsxs("div",{className:"notification-dropdown",children:[F.jsxs("div",{className:"notif-header",children:["Thng bo (",o," mi)"]}),(!r||r.length===0)&&F.jsx("div",{style:{padding:20,color:"#94a3b8",textAlign:"center"},children:"Khng c thng bo no"}),r&&r.map((c,f)=>F.jsxs("div",{className:`notif-item ${c.isRead?"read":"unread"}`,children:[F.jsxs("div",{style:{fontWeight:"700",color:c.status==="APPROVED"?"#10b981":"#ef4444",marginBottom:4},children:[c.status==="APPROVED"?"  duyt":" T chi",": ",c.empName]}),F.jsxs("div",{style:{fontSize:13,color:"#64748b"},children:["Ngy ",F.jsxs("span",{style:{fontWeight:600},children:[c.day,"/",c.month]}),"  ",F.jsx("b",{style:{color:"#1e293b"},children:c.requestType}),c.status==="REJECTED"&&F.jsx("div",{style:{marginTop:4,fontStyle:"italic",color:"#ef4444"},children:c.rejectReason})]})]},f))]})]})]})},_I=({isOpen:t,onClose:e,symbols:r})=>{if(!t)return null;const n=[...r].sort((i,s)=>(i.order||99)-(s.order||99));return F.jsx("div",{className:"modal-overlay",onClick:e,children:F.jsxs("div",{className:"modal-content modal-lg",onClick:i=>i.stopPropagation(),children:[F.jsxs("div",{className:"modal-header",children:[F.jsx("h3",{children:" Bng K Hiu Chm Cng"}),F.jsx("button",{onClick:e,className:"close-btn",children:""})]}),F.jsx("div",{className:"legend-grid",children:n.map(i=>F.jsxs("div",{className:"legend-item",children:[F.jsx("span",{className:"legend-symbol",children:i.code}),F.jsx("span",{className:"legend-desc",children:i.label})]},i.code))})]})})},oW=({isOpen:t,onClose:e,onSubmit:r,dateInfo:n,symbols:i})=>{const[s,a]=Pe.useState(""),[o,l]=Pe.useState(""),c=[...i].sort((f,h)=>(f.order||99)-(h.order||99));return Pe.useEffect(()=>{c.length>0&&l(c[0].code)},[t,i]),t?F.jsx("div",{className:"modal-overlay",children:F.jsxs("div",{className:"modal-content",children:[F.jsxs("div",{className:"modal-header",children:[F.jsxs("h3",{children:[" Gi Yu Cu (",n.day,"/",n.month,")"]}),F.jsx("button",{onClick:e,className:"close-btn",children:""})]}),F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Sa thnh:"}),F.jsx("select",{className:"select-box",style:{width:"100%"},value:o,onChange:f=>l(f.target.value),children:c.map(f=>F.jsxs("option",{value:f.code,children:[f.code," - ",f.label]},f.code))})]}),F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"L do (bt buc):"}),F.jsx("input",{className:"login-input",value:s,onChange:f=>a(f.target.value),placeholder:"Nhp l do c th..."})]}),F.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:25},children:[F.jsx("button",{className:"btn",onClick:e,children:"Hy b"}),F.jsx("button",{className:"btn btn-primary",onClick:()=>r(o,s),disabled:!s,children:"Gi yu cu"})]})]})}):null},lW=({isOpen:t,onClose:e,onLogout:r})=>{const[n,i]=Pe.useState(""),[s,a]=Pe.useState(""),o=async l=>{if(l.preventDefault(),!!zi.currentUser)try{await jF(zi.currentUser,Qa.credential(zi.currentUser.email,n)),await $F(zi.currentUser,s),alert("Thnh cng! Vui lng ng nhp li."),e(),r()}catch(c){alert("Li: "+c.message)}};return t?F.jsx("div",{className:"modal-overlay",children:F.jsxs("div",{className:"modal-content",children:[F.jsxs("div",{className:"modal-header",children:[F.jsx("h3",{children:" i Mt Khu"}),F.jsx("button",{onClick:e,className:"close-btn",children:""})]}),F.jsxs("form",{onSubmit:o,children:[F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Mt khu c"}),F.jsx("input",{className:"login-input",type:"password",value:n,onChange:l=>i(l.target.value),required:!0})]}),F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Mt khu mi"}),F.jsx("input",{className:"login-input",type:"password",value:s,onChange:l=>a(l.target.value),required:!0,placeholder:"Ti thiu 6 k t"})]}),F.jsx("button",{className:"btn btn-primary",style:{width:"100%",marginTop:15,padding:12},children:"Lu thay i"})]})]})}):null},cW=({isOpen:t,onClose:e,onSave:r,dateInfo:n,symbols:i})=>{const[s,a]=Pe.useState(""),o=[...i].sort((l,c)=>(l.order||99)-(c.order||99));return Pe.useEffect(()=>{o.length>0&&a(o[0].code)},[t,i]),t?F.jsx("div",{className:"modal-overlay",onClick:e,children:F.jsxs("div",{className:"modal-content",onClick:l=>l.stopPropagation(),children:[F.jsxs("div",{className:"modal-header",children:[F.jsxs("h3",{children:["Chm cng (",n.day,"/",n.month,")"]}),F.jsx("button",{onClick:e,className:"close-btn",children:""})]}),F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Chn trng thi:"}),F.jsx("select",{className:"select-box",style:{width:"100%"},value:s,onChange:l=>a(l.target.value),children:o.map(l=>F.jsxs("option",{value:l.code,children:[l.code," - ",l.label]},l.code))})]}),F.jsx("div",{style:{display:"flex",gap:10,marginTop:25},children:F.jsx("button",{className:"btn btn-primary",style:{width:"100%",padding:12},onClick:()=>r(s),children:"Lu li"})})]})}):null},xI=({employees:t,attendanceData:e,onCellClick:r,month:n,year:i,pendingKeys:s=[],symbols:a})=>{const o=xv(n,i),l=c=>{let f=0,h=0,d=0;return o.forEach(p=>{const g=`${c}_${p}_${n}_${i}`,m=e[g];if(m){const _=a.find(w=>w.code===m);_&&(_.type==="SALARY"&&(f+=Number(_.val)),_.type==="UNPAID"&&(h+=Number(_.val)),_.type==="INSURANCE"&&(d+=Number(_.val)))}}),{salary:f,unpaid:h,insurance:d}};return F.jsx("div",{className:"matrix-wrapper",children:F.jsxs("table",{className:"matrix-table",children:[F.jsxs("thead",{children:[F.jsxs("tr",{children:[F.jsx("th",{style:{height:35}}),o.map(c=>F.jsx("th",{className:`th-day-name ${["T7","CN"].includes(Wf(c,n,i))?"bg-weekend":""}`,children:Wf(c,n,i)},c)),F.jsx("th",{colSpan:3,style:{background:"#f1f5f9",color:"#1e293b",letterSpacing:"1px"},children:"TNG HP"})]}),F.jsxs("tr",{children:[F.jsx("th",{style:{top:35},children:"NHN VIN"}),o.map(c=>F.jsx("th",{style:{top:35},className:`th-date-num ${["T7","CN"].includes(Wf(c,n,i))?"bg-weekend":""}`,children:c},c)),F.jsx("th",{className:"col-total col-salary",style:{top:35},children:"Lng"}),F.jsx("th",{className:"col-total col-unpaid",style:{top:35},children:"Ko Lng"}),F.jsx("th",{className:"col-total col-insurance",style:{top:35},children:"BHXH"})]})]}),F.jsx("tbody",{children:t.map(c=>{const f=l(c.id);return F.jsxs("tr",{children:[F.jsx("td",{title:c.name,children:c.name}),o.map(h=>{const d=`${c.id}_${h}_${n}_${i}`,p=e[d]||"";let g=["T7","CN"].includes(Wf(h,n,i))?"bg-weekend":"";return p&&(g="cell-work"),s.includes(d)&&(g+=" cell-pending"),F.jsx("td",{className:g,onClick:()=>r&&r(c,h,p),children:p},h)}),F.jsx("td",{className:"col-total col-salary",children:f.salary>0?f.salary:"-"}),F.jsx("td",{className:"col-total col-unpaid",children:f.unpaid>0?f.unpaid:"-"}),F.jsx("td",{className:"col-total col-insurance",children:f.insurance>0?f.insurance:"-"})]},c.id)})})]})})},uW=({userDept:t,userEmail:e,onLogout:r,onOpenChangePass:n})=>{const[i,s]=Pe.useState(!1),[a,o]=Pe.useState([]),[l,c]=Pe.useState({}),[f,h]=Pe.useState([]),[d,p]=Pe.useState([]),[g,m]=Pe.useState(new Date().getMonth()+1),[_,w]=Pe.useState(new Date().getFullYear()),[E,x]=Pe.useState({isOpen:!1,emp:null,day:null}),[P,W]=Pe.useState({isOpen:!1,emp:null,day:null}),[M,y]=Pe.useState(""),[k,S]=Pe.useState("name"),[I,R]=Pe.useState({lockDate:2,limitHour:10}),[C,N]=Pe.useState(h0),[_e,pe]=Pe.useState(!1);Pe.useEffect(()=>{if(!t)return;const j=Un(fr(dt,"settings","config"),le=>{le.exists()&&R(le.data())}),z=Un(fr(dt,"settings","symbols"),le=>{le.exists()&&le.data().list&&N(le.data().list)});sS(ic(vi(dt,"employees"),va("dept","==",t))).then(le=>o(le.docs.map(ae=>ae.data())));const K=Un(ic(vi(dt,"attendance"),va("dept","==",t)),le=>{const ae={};le.forEach(ie=>{const Fe=ie.data();ae[`${Fe.empId}_${Fe.day}_${Fe.month}_${Fe.year}`]=Fe.status}),c(ae)}),q=Un(ic(vi(dt,"requests"),va("dept","==",t),va("status","==","PENDING")),le=>{h(le.docs.map(ae=>{const ie=ae.data();return`${ie.empId}_${ie.day}_${ie.month}_${ie.year}`}))}),se=Un(ic(vi(dt,"requests"),va("dept","==",t),va("status","in",["APPROVED","REJECTED"])),le=>{p(le.docs.map(ae=>({id:ae.id,...ae.data()})).sort((ae,ie)=>(ie.createdAt||0)-(ae.createdAt||0)))});return()=>{K(),q(),se(),j(),z()}},[t]);const ge=((j,z)=>{const K=j===12?z+1:z,q=j===12?1:j+1,se=new Date(K,q-1,I.lockDate);return se.setHours(23,59,59),new Date>se})(g,_),ce=yv(a.filter(j=>j.name&&j.name.toLowerCase().includes(M.toLowerCase())),k),V=(j,z,K)=>{if(ge)return alert(`  kha s thng ny (Ngy kha: ${I.lockDate})!`);const q=new Date(_,g-1,z),se=new Date;if(se.setHours(0,0,0,0),q>se)return alert("Khng th chm cng cho ngy tng lai!");q<se||q.getTime()===se.getTime()&&new Date().getHours()>=I.limitHour?x({isOpen:!0,emp:j,day:z,month:g,year:_}):W({isOpen:!0,emp:j,day:z,month:g,year:_})},X=j=>{Lo(fr(dt,"attendance",`${P.emp.id}_${P.day}_${g}_${_}`),{empId:P.emp.id,day:P.day,month:g,year:_,dept:P.emp.dept,status:j}),W({isOpen:!1,emp:null,day:null})},oe=async(j,z)=>{if(!z.trim())return alert("Vui lng nhp l do!");await n6(vi(dt,"requests"),{empId:E.emp.id,empName:E.emp.name,dept:t,day:E.day,month:E.month,year:E.year,reason:z,requestType:j,status:"PENDING",isRead:!1,createdAt:Date.now()}),alert(" gi yu cu thnh cng!"),x({isOpen:!1,emp:null,day:null})},b=()=>{const j=xv(g,_),z=a.map(q=>{const se={"M NV":q.id,"Tn NV":q.name};let le=0,ae=0,ie=0;return j.forEach(Fe=>{const G=l[`${q.id}_${Fe}_${g}_${_}`]||"";if(se[`Ngy ${Fe}`]=G,G){const qe=C.find($e=>$e.code===G);qe&&(qe.type==="SALARY"&&(le+=Number(qe.val)),qe.type==="UNPAID"&&(ae+=Number(qe.val)),qe.type==="INSURANCE"&&(ie+=Number(qe.val)))}}),se["Lng TG"]=le,se["Ko Lng"]=ae,se.BHXH=ie,se}),K=Fa.book_new();Fa.book_append_sheet(K,Fa.json_to_sheet(z),"ChamCong"),dI(K,`ChamCong_${t}_T${g}_${_}.xlsx`)};return t?F.jsxs("div",{className:"app-container",children:[F.jsx(wv,{userRole:"KHOA",isOpen:i,onClose:()=>s(!1),onLogout:r,onOpenChangePass:n}),F.jsxs("div",{className:"main-content",children:[F.jsx(Ev,{title:`Khoa: ${t}`,email:e,notifications:d,onMenuClick:()=>s(!0),onShowLegend:()=>pe(!0)}),F.jsx("div",{className:"dashboard-content",children:F.jsxs("div",{className:"card",children:[F.jsxs("div",{className:"control-bar",children:[F.jsxs("div",{className:"filter-group",children:[F.jsx("select",{className:"select-box",value:g,onChange:j=>m(Number(j.target.value)),children:Array.from({length:12},(j,z)=>z+1).map(j=>F.jsxs("option",{value:j,children:["Thng ",j]},j))}),F.jsx("select",{className:"select-box",value:_,onChange:j=>w(Number(j.target.value)),children:Array.from({length:5},(j,z)=>2026+z).map(j=>F.jsx("option",{value:j,children:j},j))})]}),F.jsx("button",{className:"btn btn-success",onClick:b,children:" Xut Excel"})]}),F.jsxs("div",{className:"toolbar",children:[F.jsxs("div",{className:"search-box",children:[F.jsx("span",{className:"search-icon",children:""}),F.jsx("input",{className:"search-input",placeholder:"Tm tn nhn vin...",value:M,onChange:j=>y(j.target.value)})]}),F.jsxs("select",{className:"sort-select",value:k,onChange:j=>S(j.target.value),children:[F.jsx("option",{value:"name",children:"Sp xp: Tn A-Z"}),F.jsx("option",{value:"position",children:"Sp xp: Chc v"})]}),ge&&F.jsx("div",{style:{background:"#fef2f2",color:"#ef4444",padding:"8px 12px",borderRadius:6,fontSize:13,fontWeight:600,display:"flex",alignItems:"center",gap:5},children:"  kha s"})]}),F.jsx(xI,{employees:ce,attendanceData:l,onCellClick:V,month:g,year:_,pendingKeys:f,symbols:C})]})})]}),F.jsx(oW,{isOpen:E.isOpen,onClose:()=>x({...E,isOpen:!1}),onSubmit:oe,dateInfo:E,symbols:C}),F.jsx(cW,{isOpen:P.isOpen,onClose:()=>W({...P,isOpen:!1}),onSave:X,dateInfo:P,symbols:C}),F.jsx(_I,{isOpen:_e,onClose:()=>pe(!1),symbols:C})]}):F.jsxs("div",{className:"loading-screen",children:[F.jsx("div",{className:"loading-spinner"}),"ang ti d liu..."]})},fW=({userEmail:t,onLogout:e,onOpenChangePass:r})=>{const[n,i]=Pe.useState(!1),[s,a]=Pe.useState([]),[o,l]=Pe.useState([]),[c,f]=Pe.useState({}),[h,d]=Pe.useState([]),[p,g]=Pe.useState("ALL"),[m,_]=Pe.useState(new Date().getMonth()+1),[w,E]=Pe.useState(new Date().getFullYear()),[x,P]=Pe.useState(""),[W,M]=Pe.useState("name"),[y,k]=Pe.useState(h0),[S,I]=Pe.useState(!1),[R,C]=Pe.useState({total:0,present:0,unpaid:0});Pe.useEffect(()=>{const X=Un(fr(dt,"settings","symbols"),j=>{j.exists()&&j.data().list&&k(j.data().list)});sS(vi(dt,"employees")).then(j=>{const z=j.docs.map(q=>q.data());a(z);const K=[...new Set(z.map(q=>q.dept))];l(K)});const oe=Un(vi(dt,"attendance"),j=>{const z={};j.forEach(K=>{const q=K.data();z[`${q.empId}_${q.day}_${q.month}_${q.year}`]=q.status}),f(z)}),b=Un(ic(vi(dt,"requests"),va("status","==","PENDING")),j=>d(j.docs.map(z=>({id:z.id,...z.data()}))));return()=>{oe(),b(),X()}},[]),Pe.useEffect(()=>{if(s.length===0)return;const X=new Date,oe=X.getDate(),b=X.getMonth()+1,j=X.getFullYear();let z=0,K=0;s.forEach(q=>{const se=`${q.id}_${oe}_${b}_${j}`,le=c[se];if(le){const ae=y.find(ie=>ie.code===le);ae&&ae.type==="SALARY"?z++:K++}else K++}),C({total:s.length,present:z,unpaid:K})},[c,s,y]);const N=async X=>{confirm(`Duyt yu cu ca ${X.empName}?`)&&(await ky(fr(dt,"requests",X.id),{status:"APPROVED",isRead:!1,createdAt:Date.now()}),await Lo(fr(dt,"attendance",`${X.empId}_${X.day}_${X.month||1}_${X.year||2026}`),{empId:X.empId,day:X.day,month:X.month,year:X.year,dept:X.dept,status:X.requestType}),alert(" duyt!"))},_e=async X=>{const oe=prompt("Nhp l do t chi:");oe!==null&&await ky(fr(dt,"requests",X.id),{status:"REJECTED",rejectReason:oe,isRead:!1,createdAt:Date.now()})},pe=yv(s.filter(X=>(p==="ALL"||X.dept===p)&&X.name&&(X.name.toLowerCase().includes(x.toLowerCase())||X.id.toLowerCase().includes(x.toLowerCase()))),W),Te=()=>{const X=xv(m,w),oe=pe.map(j=>{const z={"M NV":j.id,"Tn NV":j.name,Khoa:j.dept};let K=0,q=0,se=0;return X.forEach(le=>{const ae=c[`${j.id}_${le}_${m}_${w}`]||"";if(z[`Ngy ${le}`]=ae,ae){const ie=y.find(Fe=>Fe.code===ae);ie&&(ie.type==="SALARY"&&(K+=Number(ie.val)),ie.type==="UNPAID"&&(q+=Number(ie.val)),ie.type==="INSURANCE"&&(se+=Number(ie.val)))}}),z["Lng TG"]=K,z["Ko Lng"]=q,z.BHXH=se,z}),b=Fa.book_new();Fa.book_append_sheet(b,Fa.json_to_sheet(oe),"ChamCong"),dI(b,`BaoCao_TongHop_T${m}_${w}.xlsx`)},ge={background:"#fff",padding:"20px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.05), 0 1px 2px rgba(0,0,0,0.1)",flex:1,minWidth:160,textAlign:"left",border:"1px solid #e2e8f0"},ce={fontSize:28,fontWeight:800,lineHeight:1,marginBottom:8},V={fontSize:14,color:"#64748b",fontWeight:600};return F.jsxs("div",{className:"app-container",children:[F.jsx(wv,{userRole:"GIAMDOC",isOpen:n,onClose:()=>i(!1),onLogout:e,onOpenChangePass:r}),F.jsxs("div",{className:"main-content",children:[F.jsx(Ev,{title:"Tng Quan Gim c",email:t,onMenuClick:()=>i(!0),onShowLegend:()=>I(!0)}),F.jsxs("div",{className:"dashboard-content",children:[F.jsxs("div",{style:{display:"flex",gap:20,flexWrap:"wrap",marginBottom:25},children:[F.jsxs("div",{style:{...ge},children:[F.jsx("div",{style:{...ce,color:"#2563eb"},children:R.total}),F.jsx("div",{style:V,children:"Tng nhn s"})]}),F.jsxs("div",{style:{...ge},children:[F.jsx("div",{style:{...ce,color:"#10b981"},children:R.present}),F.jsx("div",{style:V,children:"i lm hm nay"})]}),F.jsxs("div",{style:{...ge},children:[F.jsx("div",{style:{...ce,color:"#ef4444"},children:R.unpaid}),F.jsx("div",{style:V,children:"Vng / Ko lng"})]})]}),h.length>0&&F.jsxs("div",{className:"card",style:{borderLeft:"4px solid #2563eb"},children:[F.jsxs("h3",{children:[" Yu cu ch duyt (",h.length,")"]}),F.jsxs("table",{className:"request-table",children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"Khoa"}),F.jsx("th",{children:"NV"}),F.jsx("th",{children:"Ngy"}),F.jsx("th",{children:"i thnh"}),F.jsx("th",{children:"Thao tc"})]})}),F.jsx("tbody",{children:h.map(X=>F.jsxs("tr",{children:[F.jsx("td",{"data-label":"Khoa",children:X.dept}),F.jsx("td",{"data-label":"NV",style:{fontWeight:600},children:X.empName}),F.jsxs("td",{"data-label":"Ngy",children:[X.day,"/",X.month]}),F.jsx("td",{"data-label":"i",style:{color:"#10b981",fontWeight:"bold",fontSize:14},children:X.requestType}),F.jsx("td",{"data-label":"Thao tc",style:{textAlign:"right"},children:F.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[F.jsx("button",{className:"btn btn-success",onClick:()=>N(X),children:"Chp nhn"}),F.jsx("button",{className:"btn btn-danger",onClick:()=>_e(X),children:"T chi"})]})})]},X.id))})]})]}),F.jsxs("div",{className:"card",children:[F.jsx("h3",{children:"D liu chm cng ton vin"}),F.jsxs("div",{className:"control-bar",children:[F.jsxs("div",{className:"filter-group",children:[F.jsx("label",{style:{fontWeight:600,fontSize:14,color:"#64748b"},children:"Khoa:"}),F.jsxs("select",{className:"select-box",value:p,onChange:X=>g(X.target.value),style:{minWidth:180,fontWeight:600},children:[F.jsx("option",{value:"ALL",children:"Tt c cc khoa"}),o.map(X=>F.jsx("option",{value:X,children:X},X))]}),F.jsx("label",{style:{fontWeight:600,fontSize:14,color:"#64748b",marginLeft:15},children:"Thng:"}),F.jsx("select",{className:"select-box",value:m,onChange:X=>_(Number(X.target.value)),children:Array.from({length:12},(X,oe)=>oe+1).map(X=>F.jsx("option",{value:X,children:X},X))})]}),F.jsx("button",{className:"btn btn-success",onClick:Te,children:" Xut Bo Co"})]}),F.jsxs("div",{className:"toolbar",children:[F.jsxs("div",{className:"search-box",children:[F.jsx("span",{className:"search-icon",children:""}),F.jsx("input",{className:"search-input",placeholder:"Tm nhn vin...",value:x,onChange:X=>P(X.target.value)})]}),F.jsxs("select",{className:"sort-select",value:W,onChange:X=>M(X.target.value),children:[F.jsx("option",{value:"name",children:"Sp xp: Tn A-Z"}),F.jsx("option",{value:"position",children:"Sp xp: Chc v"})]})]}),F.jsx(xI,{employees:pe,attendanceData:c,month:m,year:w,symbols:y})]})]})]}),F.jsx(_I,{isOpen:S,onClose:()=>I(!1),symbols:y})]})},hW=({userEmail:t,onLogout:e,onOpenChangePass:r})=>{const[n,i]=Pe.useState(!1),[s,a]=Pe.useState("employees"),[o,l]=Pe.useState([]),[c,f]=Pe.useState([]),[h,d]=Pe.useState({lockDate:2,limitHour:10}),[p,g]=Pe.useState(h0),[m,_]=Pe.useState({email:"",pass:"",role:"KHOA",dept:""}),[w,E]=Pe.useState(!1),[x,P]=Pe.useState(""),[W,M]=Pe.useState("name");Pe.useEffect(()=>{const V=Un(fr(dt,"settings","config"),j=>{j.exists()&&d(j.data())}),X=Un(fr(dt,"settings","symbols"),j=>{if(j.exists()&&j.data().list){const z=j.data().list.sort((K,q)=>(K.order||99)-(q.order||99));g(z)}}),oe=Un(vi(dt,"employees"),j=>l(j.docs.map(z=>z.data()))),b=Un(vi(dt,"users"),j=>f(j.docs.map(z=>({id:z.id,...z.data()}))));return()=>{oe(),b(),V(),X()}},[]);const y=(V,X)=>{const oe=V+X;if(oe<0||oe>=p.length)return;const b=[...p],j=b[V];b[V]=b[oe],b[oe]=j,g(b)},k=async()=>{await Lo(fr(dt,"settings","config"),h),alert(" lu cu hnh!")},S=async()=>{const V=p.map((X,oe)=>({...X,order:oe+1}));await Lo(fr(dt,"settings","symbols"),{list:V}),g(V),alert(" cp nht k hiu!")},I=()=>{confirm("Khi phc danh sch k hiu gc?")&&g(h0)},R=async(V,X)=>{if(confirm(`Xa ti khon ${X}?`))try{await Sy(fr(dt,"users",V)),alert(" xa!")}catch(oe){alert(oe.message)}},C=async V=>{if(confirm(`Gi mail reset cho ${V}?`))try{await WF(zi,V),alert(" gi mail!")}catch(X){alert(X.message)}},N=async V=>{if(V.preventDefault(),m.role==="KHOA"&&!m.dept)return alert("Vui lng nhp tn Khoa!");E(!0);let X=null;try{X=Mg(Vg().options,"SecondaryApp");const oe=BT(X),b=await HF(oe,m.email,m.pass);await Lo(fr(dt,"users",b.user.uid),{email:m.email,role:m.role,dept:m.role==="KHOA"?m.dept:"",createdAt:new Date().toISOString()}),await fm(oe),alert(` to: ${m.email}`),_({email:"",pass:"",role:"KHOA",dept:""})}catch(oe){alert("Li: "+oe.message)}finally{X&&NP(X),E(!1)}},_e=V=>{const X=V.target.files[0];if(!X)return;const oe=new FileReader;oe.onload=async b=>{const j=Fa.sheet_to_json(u0(b.target.result,{type:"binary"}).Sheets[u0(b.target.result,{type:"binary"}).SheetNames[0]]),z=o.map(q=>q.id);let K=0;for(let q of j)!q.MaNV||z.includes(String(q.MaNV))||(await Lo(fr(dt,"employees",String(q.MaNV)),{id:String(q.MaNV),name:q.TenNV,dept:q.Khoa,position:q.ChucVu}),K++);alert(` thm ${K} nhn vin!`)},oe.readAsBinaryString(X),V.target.value=null},pe=async V=>{confirm("Xa nhn vin ny?")&&await Sy(fr(dt,"employees",V))},Te=(V,X,oe)=>{const b=[...p];b[V][X]=oe,g(b)},ge=yv(o.filter(V=>V.name&&(V.name.toLowerCase().includes(x.toLowerCase())||V.id.toLowerCase().includes(x.toLowerCase())||V.dept.toLowerCase().includes(x.toLowerCase()))),W),ce=V=>({background:s===V?"#2563eb":"white",color:s===V?"white":"#64748b",border:s===V?"none":"1px solid #e2e8f0"});return F.jsxs("div",{className:"app-container",children:[F.jsx(wv,{userRole:"ADMIN",isOpen:n,onClose:()=>i(!1),onLogout:e,onOpenChangePass:r}),F.jsxs("div",{className:"main-content",children:[F.jsx(Ev,{title:"Qun Tr H Thng",email:t,onMenuClick:()=>i(!0),onShowLegend:()=>{}}),F.jsxs("div",{className:"dashboard-content",children:[F.jsxs("div",{style:{marginBottom:25,display:"flex",gap:10,flexWrap:"wrap",paddingBottom:20,borderBottom:"1px solid #e2e8f0"},children:[F.jsx("button",{className:"btn",style:ce("employees"),onClick:()=>a("employees"),children:" Nhn vin"}),F.jsx("button",{className:"btn",style:ce("accounts"),onClick:()=>a("accounts"),children:" Ti khon"}),F.jsx("button",{className:"btn",style:ce("create_acc"),onClick:()=>a("create_acc"),children:" Cp ti khon"}),F.jsx("button",{className:"btn",style:ce("symbols"),onClick:()=>a("symbols"),children:" K hiu cng"}),F.jsx("button",{className:"btn",style:ce("config"),onClick:()=>a("config"),children:" Cu hnh"})]}),s==="config"&&F.jsxs("div",{className:"admin-form-container",children:[F.jsx("h3",{children:" Cu hnh h thng"}),F.jsxs("div",{className:"config-container",children:[F.jsxs("div",{className:"config-item",children:[F.jsx("label",{children:"Gi gii hn (Sng)"}),F.jsx("input",{type:"number",className:"config-input",value:h.limitHour,onChange:V=>d({...h,limitHour:Number(V.target.value)})})]}),F.jsxs("div",{className:"config-item",children:[F.jsx("label",{children:"Ngy kha s thng"}),F.jsx("input",{type:"number",className:"config-input",value:h.lockDate,onChange:V=>d({...h,lockDate:Number(V.target.value)})})]}),F.jsx("button",{className:"btn btn-success",onClick:k,style:{height:45,marginTop:"auto",padding:"0 25px"},children:" Lu cu hnh"})]}),F.jsx("p",{style:{marginTop:20,fontSize:14,color:"#64748b",textAlign:"center"},children:"* V d: Ngy kha s l 2, th n ht ngy 2 thng sau s khng th chm cng cho thng trc ."})]}),s==="symbols"&&F.jsxs("div",{className:"card",children:[F.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,alignItems:"center"},children:[F.jsx("h3",{children:" Qun l k hiu chm cng"}),F.jsxs("div",{style:{display:"flex",gap:15},children:[F.jsx("button",{className:"btn",onClick:I,children:"Khi phc gc"}),F.jsx("button",{className:"btn btn-success",onClick:S,children:" Lu thay i"})]})]}),F.jsx("div",{className:"matrix-wrapper",style:{height:"calc(100vh - 350px)"},children:F.jsxs("table",{className:"request-table",children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{style:{width:80},children:"Th t"}),F.jsx("th",{style:{width:100},children:"M hin th"}),F.jsx("th",{children:"M t y "}),F.jsx("th",{style:{width:120},children:"Gi tr cng"}),F.jsx("th",{style:{width:180},children:"Nhm tnh tng"})]})}),F.jsx("tbody",{children:p.map((V,X)=>F.jsxs("tr",{children:[F.jsxs("td",{"data-label":"TT",style:{display:"flex",gap:10,alignItems:"center"},children:[F.jsx("span",{style:{fontWeight:700,width:20},children:X+1}),F.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[F.jsx("button",{style:{border:"none",background:"none",cursor:"pointer",color:"#94a3b8",padding:2,lineHeight:1,fontSize:18},onClick:()=>y(X,-1),children:""}),F.jsx("button",{style:{border:"none",background:"none",cursor:"pointer",color:"#94a3b8",padding:2,lineHeight:1,fontSize:18},onClick:()=>y(X,1),children:""})]})]}),F.jsx("td",{"data-label":"M",children:F.jsx("input",{value:V.code,onChange:oe=>Te(X,"code",oe.target.value),className:"config-input",style:{width:"100%"}})}),F.jsx("td",{"data-label":"M t",children:F.jsx("input",{value:V.label,onChange:oe=>Te(X,"label",oe.target.value),className:"login-input"})}),F.jsx("td",{"data-label":"Gi tr",children:F.jsx("input",{type:"number",step:"0.5",value:V.val,onChange:oe=>Te(X,"val",oe.target.value),className:"config-input",style:{width:"100%"}})}),F.jsx("td",{"data-label":"Nhm",children:F.jsxs("select",{value:V.type,onChange:oe=>Te(X,"type",oe.target.value),className:"select-box",style:{width:"100%"},children:[F.jsx("option",{value:"SALARY",children:"Lng thi gian"}),F.jsx("option",{value:"UNPAID",children:"Ngh khng lng"}),F.jsx("option",{value:"INSURANCE",children:"Ch  BHXH"})]})})]},V.code))})]})})]}),s==="create_acc"&&F.jsxs("div",{className:"admin-form-container",children:[F.jsx("h3",{children:" Cp ti khon mi"}),F.jsxs("form",{onSubmit:N,children:[F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Email ng nhp"}),F.jsx("input",{className:"login-input",type:"email",value:m.email,onChange:V=>_({...m,email:V.target.value}),required:!0,placeholder:"VD: khoanoi@benhvien.com"})]}),F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Mt khu"}),F.jsx("input",{className:"login-input",type:"text",value:m.pass,onChange:V=>_({...m,pass:V.target.value}),required:!0,placeholder:"Ti thiu 6 k t"})]}),F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Loi ti khon"}),F.jsxs("select",{className:"select-box",style:{width:"100%",padding:12},value:m.role,onChange:V=>_({...m,role:V.target.value}),children:[F.jsx("option",{value:"KHOA",children:"Khoa / Phng ban"}),F.jsx("option",{value:"GIAMDOC",children:"Ban Gim c"}),F.jsx("option",{value:"ADMIN",children:"Qun tr vin h thng"})]})]}),m.role==="KHOA"&&F.jsxs("div",{className:"form-group",children:[F.jsx("label",{children:"Tn Khoa (Hin th)"}),F.jsx("input",{className:"login-input",type:"text",value:m.dept,onChange:V=>_({...m,dept:V.target.value}),required:!0,placeholder:"VD: Khoa Ni Tng Hp"})]}),F.jsx("button",{className:"btn btn-success",style:{width:"100%",marginTop:25,padding:14,fontSize:16},disabled:w,children:w?" ang x l...":" To Ti Khon Ngay"})]})]}),s==="accounts"&&F.jsxs("div",{className:"card",children:[F.jsxs("h3",{children:["Danh sch ti khon h thng (",c.length,")"]}),F.jsx("div",{className:"matrix-wrapper",style:{height:"calc(100vh - 300px)"},children:F.jsxs("table",{className:"request-table",children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"Email ng nhp"}),F.jsx("th",{children:"Quyn hn"}),F.jsx("th",{children:"Khoa ph trch"}),F.jsx("th",{style:{textAlign:"right"},children:"Thao tc"})]})}),F.jsx("tbody",{children:c.map(V=>F.jsxs("tr",{children:[F.jsx("td",{"data-label":"Email",style:{fontWeight:600},children:V.email}),F.jsx("td",{"data-label":"Quyn",children:F.jsx("span",{style:{fontWeight:700,padding:"4px 10px",borderRadius:6,background:V.role==="ADMIN"?"#fee2e2":V.role==="GIAMDOC"?"#dbeafe":"#f1f5f9",color:V.role==="ADMIN"?"#dc2626":V.role==="GIAMDOC"?"#2563eb":"#64748b"},children:V.role})}),F.jsx("td",{"data-label":"Khoa",children:V.dept||"-"}),F.jsx("td",{"data-label":"Thao tc",style:{textAlign:"right"},children:F.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[F.jsx("button",{className:"btn btn-primary",style:{fontSize:13,padding:"8px 12px"},onClick:()=>C(V.email),children:" Gi mail reset"}),F.jsx("button",{className:"btn btn-logout",style:{fontSize:13,padding:"8px 12px"},onClick:()=>R(V.id,V.email),children:" Xa"})]})})]},V.id))})]})})]}),s==="employees"&&F.jsxs("div",{className:"card",children:[F.jsxs("h3",{children:["Danh sch nhn s ton vin (",ge.length,")"]}),F.jsxs("div",{className:"toolbar",style:{marginTop:20,marginBottom:20},children:[F.jsxs("div",{className:"search-box",children:[F.jsx("span",{className:"search-icon",children:""}),F.jsx("input",{className:"search-input",placeholder:"Tm theo tn, m, hoc khoa...",value:x,onChange:V=>P(V.target.value)})]}),F.jsxs("select",{className:"sort-select",value:W,onChange:V=>M(V.target.value),children:[F.jsx("option",{value:"name",children:"Sp xp: Tn A-Z"}),F.jsx("option",{value:"position",children:"Sp xp: Chc v"})]}),F.jsxs("label",{className:"btn btn-primary",style:{cursor:"pointer",marginLeft:"auto"},children:[" Nhp t Excel",F.jsx("input",{type:"file",hidden:!0,onChange:_e,accept:".xlsx, .xls"})]})]}),F.jsx("div",{className:"matrix-wrapper",style:{height:"calc(100vh - 380px)"},children:F.jsxs("table",{className:"request-table",children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"M NV"}),F.jsx("th",{children:"H v Tn"}),F.jsx("th",{children:"Khoa / Phng"}),F.jsx("th",{children:"Chc V"}),F.jsx("th",{style:{textAlign:"right"},children:"Hnh ng"})]})}),F.jsx("tbody",{children:ge.map(V=>F.jsxs("tr",{children:[F.jsx("td",{"data-label":"M",style:{fontWeight:700},children:V.id}),F.jsx("td",{"data-label":"Tn",style:{fontWeight:600,color:"#1e293b"},children:V.name}),F.jsx("td",{"data-label":"Khoa",children:V.dept}),F.jsx("td",{"data-label":"Chc v",children:V.position}),F.jsx("td",{"data-label":"Hnh ng",style:{textAlign:"right"},children:F.jsx("button",{className:"btn btn-logout",style:{fontSize:13,padding:"8px 12px"},onClick:()=>pe(V.id),children:" Xa nhn vin"})})]},V.id))})]})})]})]})]})]})};function dW(){const[t,e]=Pe.useState(null),[r,n]=Pe.useState(null),[i,s]=Pe.useState(!0),[a,o]=Pe.useState(!1),[l,c]=Pe.useState(localStorage.getItem("savedEmail")||""),[f,h]=Pe.useState("");Pe.useEffect(()=>qF(zi,async p=>{if(p){const g=await r6(fr(dt,"users",p.uid));g.exists()?(e(p),n(g.data())):(await fm(zi),e(null),n(null),alert("Ti khon cha c phn quyn!"))}else e(null),n(null);s(!1)}),[]);const d=()=>{t!=null&&t.email&&localStorage.setItem("savedEmail",t.email),fm(zi),window.location.reload()};if(i)return F.jsxs("div",{className:"loading-screen",children:[F.jsx("div",{className:"loading-spinner"}),"ang khi to h thng..."]});if(!t){const p=async g=>{g.preventDefault();try{await zF(zi,l,f)}catch(m){alert("Li ng nhp: "+m.message)}};return F.jsx("div",{className:"login-container",children:F.jsxs("form",{onSubmit:p,className:"login-card",children:[F.jsx("div",{className:"login-icon",children:""}),F.jsx("div",{className:"login-title",children:"H Thng Chm Cng"}),F.jsxs("div",{className:"form-group",style:{textAlign:"left"},children:[F.jsx("label",{children:"Email ng nhp"}),F.jsx("input",{className:"login-input",type:"email",value:l,onChange:g=>c(g.target.value),required:!0,placeholder:"name@example.com",style:{padding:"14px"}})]}),F.jsxs("div",{className:"form-group",style:{textAlign:"left"},children:[F.jsx("label",{children:"Mt khu"}),F.jsx("input",{className:"login-input",type:"password",value:f,onChange:g=>h(g.target.value),required:!0,placeholder:"",style:{padding:"14px"}})]}),F.jsx("button",{className:"btn btn-primary login-btn",children:"NG NHP"})]})})}return F.jsxs(F.Fragment,{children:[r.role==="KHOA"&&F.jsx(uW,{userDept:r.dept,userEmail:t.email,onLogout:d,onOpenChangePass:()=>o(!0)}),r.role==="GIAMDOC"&&F.jsx(fW,{userEmail:t.email,onLogout:d,onOpenChangePass:()=>o(!0)}),r.role==="ADMIN"&&F.jsx(hW,{userEmail:t.email,onLogout:d,onOpenChangePass:()=>o(!0)}),F.jsx(lW,{isOpen:a,onClose:()=>o(!1),onLogout:d})]})}K2(document.getElementById("root")).render(F.jsx(Pe.StrictMode,{children:F.jsx(dW,{})}));
