(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Ow={exports:{}},dh={},Lw={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu=Symbol.for("react.element"),OI=Symbol.for("react.portal"),LI=Symbol.for("react.fragment"),bI=Symbol.for("react.strict_mode"),MI=Symbol.for("react.profiler"),VI=Symbol.for("react.provider"),BI=Symbol.for("react.context"),UI=Symbol.for("react.forward_ref"),jI=Symbol.for("react.suspense"),WI=Symbol.for("react.memo"),HI=Symbol.for("react.lazy"),Zv=Symbol.iterator;function zI(t){return t===null||typeof t!="object"?null:(t=Zv&&t[Zv]||t["@@iterator"],typeof t=="function"?t:null)}var bw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mw=Object.assign,Vw={};function xl(t,e,r){this.props=t,this.context=e,this.refs=Vw,this.updater=r||bw}xl.prototype.isReactComponent={};xl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Bw(){}Bw.prototype=xl.prototype;function Um(t,e,r){this.props=t,this.context=e,this.refs=Vw,this.updater=r||bw}var jm=Um.prototype=new Bw;jm.constructor=Um;Mw(jm,xl.prototype);jm.isPureReactComponent=!0;var e_=Array.isArray,Uw=Object.prototype.hasOwnProperty,Wm={current:null},jw={key:!0,ref:!0,__self:!0,__source:!0};function Ww(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Uw.call(e,n)&&!jw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:vu,type:t,key:s,ref:a,props:i,_owner:Wm.current}}function $I(t,e){return{$$typeof:vu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hm(t){return typeof t=="object"&&t!==null&&t.$$typeof===vu}function GI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var t_=/\/+/g;function dd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?GI(""+t.key):e.toString(36)}function zf(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case vu:case OI:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+dd(a,0):n,e_(i)?(r="",t!=null&&(r=t.replace(t_,"$&/")+"/"),zf(i,e,r,"",function(c){return c})):i!=null&&(Hm(i)&&(i=$I(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(t_,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",e_(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+dd(s,o);a+=zf(s,e,r,l,i)}else if(l=zI(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+dd(s,o++),a+=zf(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function uf(t,e,r){if(t==null)return t;var n=[],i=0;return zf(t,n,"","",function(s){return e.call(r,s,i++)}),n}function KI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var en={current:null},$f={transition:null},XI={ReactCurrentDispatcher:en,ReactCurrentBatchConfig:$f,ReactCurrentOwner:Wm};function Hw(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:uf,forEach:function(t,e,r){uf(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return uf(t,function(){e++}),e},toArray:function(t){return uf(t,function(e){return e})||[]},only:function(t){if(!Hm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=xl;qe.Fragment=LI;qe.Profiler=MI;qe.PureComponent=Um;qe.StrictMode=bI;qe.Suspense=jI;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XI;qe.act=Hw;qe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Mw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Wm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Uw.call(e,l)&&!jw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:vu,type:t.type,key:i,ref:s,props:n,_owner:a}};qe.createContext=function(t){return t={$$typeof:BI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:VI,_context:t},t.Consumer=t};qe.createElement=Ww;qe.createFactory=function(t){var e=Ww.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:UI,render:t}};qe.isValidElement=Hm;qe.lazy=function(t){return{$$typeof:HI,_payload:{_status:-1,_result:t},_init:KI}};qe.memo=function(t,e){return{$$typeof:WI,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=$f.transition;$f.transition={};try{t()}finally{$f.transition=e}};qe.unstable_act=Hw;qe.useCallback=function(t,e){return en.current.useCallback(t,e)};qe.useContext=function(t){return en.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return en.current.useDeferredValue(t)};qe.useEffect=function(t,e){return en.current.useEffect(t,e)};qe.useId=function(){return en.current.useId()};qe.useImperativeHandle=function(t,e,r){return en.current.useImperativeHandle(t,e,r)};qe.useInsertionEffect=function(t,e){return en.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return en.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return en.current.useMemo(t,e)};qe.useReducer=function(t,e,r){return en.current.useReducer(t,e,r)};qe.useRef=function(t){return en.current.useRef(t)};qe.useState=function(t){return en.current.useState(t)};qe.useSyncExternalStore=function(t,e,r){return en.current.useSyncExternalStore(t,e,r)};qe.useTransition=function(){return en.current.useTransition()};qe.version="18.3.1";Lw.exports=qe;var Ne=Lw.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qI=Ne,YI=Symbol.for("react.element"),QI=Symbol.for("react.fragment"),JI=Object.prototype.hasOwnProperty,ZI=qI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eC={key:!0,ref:!0,__self:!0,__source:!0};function zw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)JI.call(e,n)&&!eC.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:YI,type:t,key:s,ref:a,props:i,_owner:ZI.current}}dh.Fragment=QI;dh.jsx=zw;dh.jsxs=zw;Ow.exports=dh;var M=Ow.exports,$w={exports:{}},Cn={},Gw={exports:{}},Kw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(re,H){var se=re.length;re.push(H);e:for(;0<se;){var oe=se-1>>>1,L=re[oe];if(0<i(L,H))re[oe]=H,re[se]=L,se=oe;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var H=re[0],se=re.pop();if(se!==H){re[0]=se;e:for(var oe=0,L=re.length,K=L>>>1;oe<K;){var z=2*(oe+1)-1,G=re[z],ee=z+1,me=re[ee];if(0>i(G,se))ee<L&&0>i(me,G)?(re[oe]=me,re[ee]=se,oe=ee):(re[oe]=G,re[z]=se,oe=z);else if(ee<L&&0>i(me,se))re[oe]=me,re[ee]=se,oe=ee;else break e}}return H}function i(re,H){var se=re.sortIndex-H.sortIndex;return se!==0?se:re.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],f=1,h=null,d=3,p=!1,v=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(re){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=re)n(c),H.sortIndex=H.expirationTime,e(l,H);else break;H=r(c)}}function F(re){if(m=!1,x(re),!v)if(r(l)!==null)v=!0,Z(U);else{var H=r(c);H!==null&&te(F,H.startTime-re)}}function U(re,H){v=!1,m&&(m=!1,y(k),k=-1),p=!0;var se=d;try{for(x(H),h=r(l);h!==null&&(!(h.expirationTime>H)||re&&!P());){var oe=h.callback;if(typeof oe=="function"){h.callback=null,d=h.priorityLevel;var L=oe(h.expirationTime<=H);H=t.unstable_now(),typeof L=="function"?h.callback=L:h===r(l)&&n(l),x(H)}else n(l);h=r(l)}if(h!==null)var K=!0;else{var z=r(c);z!==null&&te(F,z.startTime-H),K=!1}return K}finally{h=null,d=se,p=!1}}var b=!1,w=null,k=-1,S=5,C=-1;function P(){return!(t.unstable_now()-C<S)}function A(){if(w!==null){var re=t.unstable_now();C=re;var H=!0;try{H=w(!0,re)}finally{H?R():(b=!1,w=null)}}else b=!1}var R;if(typeof E=="function")R=function(){E(A)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ue=de.port2;de.port1.onmessage=A,R=function(){ue.postMessage(null)}}else R=function(){_(A,0)};function Z(re){w=re,b||(b=!0,R())}function te(re,H){k=_(function(){re(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(re){re.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,Z(U))},t.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<re?Math.floor(1e3/re):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(re){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var se=d;d=H;try{return re()}finally{d=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(re,H){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var se=d;d=re;try{return H()}finally{d=se}},t.unstable_scheduleCallback=function(re,H,se){var oe=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?oe+se:oe):se=oe,re){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=se+L,re={id:f++,callback:H,priorityLevel:re,startTime:se,expirationTime:L,sortIndex:-1},se>oe?(re.sortIndex=se,e(c,re),r(l)===null&&re===r(c)&&(m?(y(k),k=-1):m=!0,te(F,se-oe))):(re.sortIndex=L,e(l,re),v||p||(v=!0,Z(U))),re},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(re){var H=d;return function(){var se=d;d=H;try{return re.apply(this,arguments)}finally{d=se}}}})(Kw);Gw.exports=Kw;var tC=Gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rC=Ne,An=tC;function ve(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xw=new Set,Nc={};function Ya(t,e){Zo(t,e),Zo(t+"Capture",e)}function Zo(t,e){for(Nc[t]=e,t=0;t<e.length;t++)Xw.add(e[t])}var Qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fp=Object.prototype.hasOwnProperty,nC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r_={},n_={};function iC(t){return fp.call(n_,t)?!0:fp.call(r_,t)?!1:nC.test(t)?n_[t]=!0:(r_[t]=!0,!1)}function sC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function aC(t,e,r,n){if(e===null||typeof e>"u"||sC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tn(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Sr[t]=new tn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Sr[e]=new tn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Sr[t]=new tn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Sr[t]=new tn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Sr[t]=new tn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Sr[t]=new tn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Sr[t]=new tn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Sr[t]=new tn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Sr[t]=new tn(t,5,!1,t.toLowerCase(),null,!1,!1)});var zm=/[\-:]([a-z])/g;function $m(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(zm,$m);Sr[e]=new tn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(zm,$m);Sr[e]=new tn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(zm,$m);Sr[e]=new tn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Sr[t]=new tn(t,1,!1,t.toLowerCase(),null,!1,!1)});Sr.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Sr[t]=new tn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gm(t,e,r,n){var i=Sr.hasOwnProperty(e)?Sr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(aC(e,r,i,n)&&(r=null),n||i===null?iC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var as=rC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ff=Symbol.for("react.element"),ko=Symbol.for("react.portal"),So=Symbol.for("react.fragment"),Km=Symbol.for("react.strict_mode"),hp=Symbol.for("react.profiler"),qw=Symbol.for("react.provider"),Yw=Symbol.for("react.context"),Xm=Symbol.for("react.forward_ref"),dp=Symbol.for("react.suspense"),pp=Symbol.for("react.suspense_list"),qm=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),Qw=Symbol.for("react.offscreen"),i_=Symbol.iterator;function Ul(t){return t===null||typeof t!="object"?null:(t=i_&&t[i_]||t["@@iterator"],typeof t=="function"?t:null)}var Ot=Object.assign,pd;function Yl(t){if(pd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);pd=e&&e[1]||""}return`
`+pd+t}var md=!1;function gd(t,e){if(!t||md)return"";md=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{md=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Yl(t):""}function oC(t){switch(t.tag){case 5:return Yl(t.type);case 16:return Yl("Lazy");case 13:return Yl("Suspense");case 19:return Yl("SuspenseList");case 0:case 2:case 15:return t=gd(t.type,!1),t;case 11:return t=gd(t.type.render,!1),t;case 1:return t=gd(t.type,!0),t;default:return""}}function mp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case So:return"Fragment";case ko:return"Portal";case hp:return"Profiler";case Km:return"StrictMode";case dp:return"Suspense";case pp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Yw:return(t.displayName||"Context")+".Consumer";case qw:return(t._context.displayName||"Context")+".Provider";case Xm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qm:return e=t.displayName||null,e!==null?e:mp(t.type)||"Memo";case ys:e=t._payload,t=t._init;try{return mp(t(e))}catch{}}return null}function lC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mp(e);case 8:return e===Km?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Jw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function cC(t){var e=Jw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function hf(t){t._valueTracker||(t._valueTracker=cC(t))}function Zw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Jw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function f0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gp(t,e){var r=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function s_(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Gs(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function eE(t,e){e=e.checked,e!=null&&Gm(t,"checked",e,!1)}function vp(t,e){eE(t,e);var r=Gs(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_p(t,e.type,r):e.hasOwnProperty("defaultValue")&&_p(t,e.type,Gs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function a_(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function _p(t,e,r){(e!=="number"||f0(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ql=Array.isArray;function Bo(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Gs(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ve(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function o_(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ve(92));if(Ql(r)){if(1<r.length)throw Error(ve(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Gs(r)}}function tE(t,e){var r=Gs(e.value),n=Gs(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function l_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var df,nE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(df=df||document.createElement("div"),df.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=df.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Dc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var uc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uC=["Webkit","ms","Moz","O"];Object.keys(uc).forEach(function(t){uC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),uc[e]=uc[t]})});function iE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||uc.hasOwnProperty(t)&&uc[t]?(""+e).trim():e+"px"}function sE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=iE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var fC=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wp(t,e){if(e){if(fC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ve(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ve(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ve(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ve(62))}}function Ep(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tp=null;function Ym(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var kp=null,Uo=null,jo=null;function c_(t){if(t=yu(t)){if(typeof kp!="function")throw Error(ve(280));var e=t.stateNode;e&&(e=_h(e),kp(t.stateNode,t.type,e))}}function aE(t){Uo?jo?jo.push(t):jo=[t]:Uo=t}function oE(){if(Uo){var t=Uo,e=jo;if(jo=Uo=null,c_(t),e)for(t=0;t<e.length;t++)c_(e[t])}}function lE(t,e){return t(e)}function cE(){}var vd=!1;function uE(t,e,r){if(vd)return t(e,r);vd=!0;try{return lE(t,e,r)}finally{vd=!1,(Uo!==null||jo!==null)&&(cE(),oE())}}function Oc(t,e){var r=t.stateNode;if(r===null)return null;var n=_h(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ve(231,e,typeof r));return r}var Sp=!1;if(Qi)try{var jl={};Object.defineProperty(jl,"passive",{get:function(){Sp=!0}}),window.addEventListener("test",jl,jl),window.removeEventListener("test",jl,jl)}catch{Sp=!1}function hC(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var fc=!1,h0=null,d0=!1,Ap=null,dC={onError:function(t){fc=!0,h0=t}};function pC(t,e,r,n,i,s,a,o,l){fc=!1,h0=null,hC.apply(dC,arguments)}function mC(t,e,r,n,i,s,a,o,l){if(pC.apply(this,arguments),fc){if(fc){var c=h0;fc=!1,h0=null}else throw Error(ve(198));d0||(d0=!0,Ap=c)}}function Qa(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function fE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function u_(t){if(Qa(t)!==t)throw Error(ve(188))}function gC(t){var e=t.alternate;if(!e){if(e=Qa(t),e===null)throw Error(ve(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return u_(i),t;if(s===n)return u_(i),e;s=s.sibling}throw Error(ve(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ve(189))}}if(r.alternate!==n)throw Error(ve(190))}if(r.tag!==3)throw Error(ve(188));return r.stateNode.current===r?t:e}function hE(t){return t=gC(t),t!==null?dE(t):null}function dE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=dE(t);if(e!==null)return e;t=t.sibling}return null}var pE=An.unstable_scheduleCallback,f_=An.unstable_cancelCallback,vC=An.unstable_shouldYield,_C=An.unstable_requestPaint,Gt=An.unstable_now,xC=An.unstable_getCurrentPriorityLevel,Qm=An.unstable_ImmediatePriority,mE=An.unstable_UserBlockingPriority,p0=An.unstable_NormalPriority,yC=An.unstable_LowPriority,gE=An.unstable_IdlePriority,ph=null,xi=null;function wC(t){if(xi&&typeof xi.onCommitFiberRoot=="function")try{xi.onCommitFiberRoot(ph,t,void 0,(t.current.flags&128)===128)}catch{}}var ri=Math.clz32?Math.clz32:kC,EC=Math.log,TC=Math.LN2;function kC(t){return t>>>=0,t===0?32:31-(EC(t)/TC|0)|0}var pf=64,mf=4194304;function Jl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function m0(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Jl(o):(s&=a,s!==0&&(n=Jl(s)))}else a=r&~i,a!==0?n=Jl(a):s!==0&&(n=Jl(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ri(e),i=1<<r,n|=t[r],e&=~i;return n}function SC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ri(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=SC(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Ip(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vE(){var t=pf;return pf<<=1,!(pf&4194240)&&(pf=64),t}function _d(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function _u(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ri(e),t[e]=r}function IC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ri(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Jm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ri(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ft=0;function _E(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var xE,Zm,yE,wE,EE,Cp=!1,gf=[],Os=null,Ls=null,bs=null,Lc=new Map,bc=new Map,Es=[],CC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function h_(t,e){switch(t){case"focusin":case"focusout":Os=null;break;case"dragenter":case"dragleave":Ls=null;break;case"mouseover":case"mouseout":bs=null;break;case"pointerover":case"pointerout":Lc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(e.pointerId)}}function Wl(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=yu(e),e!==null&&Zm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function RC(t,e,r,n,i){switch(e){case"focusin":return Os=Wl(Os,t,e,r,n,i),!0;case"dragenter":return Ls=Wl(Ls,t,e,r,n,i),!0;case"mouseover":return bs=Wl(bs,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Lc.set(s,Wl(Lc.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,bc.set(s,Wl(bc.get(s)||null,t,e,r,n,i)),!0}return!1}function TE(t){var e=ya(t.target);if(e!==null){var r=Qa(e);if(r!==null){if(e=r.tag,e===13){if(e=fE(r),e!==null){t.blockedOn=e,EE(t.priority,function(){yE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Gf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Rp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Tp=n,r.target.dispatchEvent(n),Tp=null}else return e=yu(r),e!==null&&Zm(e),t.blockedOn=r,!1;e.shift()}return!0}function d_(t,e,r){Gf(t)&&r.delete(e)}function PC(){Cp=!1,Os!==null&&Gf(Os)&&(Os=null),Ls!==null&&Gf(Ls)&&(Ls=null),bs!==null&&Gf(bs)&&(bs=null),Lc.forEach(d_),bc.forEach(d_)}function Hl(t,e){t.blockedOn===e&&(t.blockedOn=null,Cp||(Cp=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,PC)))}function Mc(t){function e(i){return Hl(i,t)}if(0<gf.length){Hl(gf[0],t);for(var r=1;r<gf.length;r++){var n=gf[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Os!==null&&Hl(Os,t),Ls!==null&&Hl(Ls,t),bs!==null&&Hl(bs,t),Lc.forEach(e),bc.forEach(e),r=0;r<Es.length;r++)n=Es[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Es.length&&(r=Es[0],r.blockedOn===null);)TE(r),r.blockedOn===null&&Es.shift()}var Wo=as.ReactCurrentBatchConfig,g0=!0;function FC(t,e,r,n){var i=ft,s=Wo.transition;Wo.transition=null;try{ft=1,eg(t,e,r,n)}finally{ft=i,Wo.transition=s}}function NC(t,e,r,n){var i=ft,s=Wo.transition;Wo.transition=null;try{ft=4,eg(t,e,r,n)}finally{ft=i,Wo.transition=s}}function eg(t,e,r,n){if(g0){var i=Rp(t,e,r,n);if(i===null)Cd(t,e,n,v0,r),h_(t,n);else if(RC(i,t,e,r,n))n.stopPropagation();else if(h_(t,n),e&4&&-1<CC.indexOf(t)){for(;i!==null;){var s=yu(i);if(s!==null&&xE(s),s=Rp(t,e,r,n),s===null&&Cd(t,e,n,v0,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Cd(t,e,n,null,r)}}var v0=null;function Rp(t,e,r,n){if(v0=null,t=Ym(n),t=ya(t),t!==null)if(e=Qa(t),e===null)t=null;else if(r=e.tag,r===13){if(t=fE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return v0=t,null}function kE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xC()){case Qm:return 1;case mE:return 4;case p0:case yC:return 16;case gE:return 536870912;default:return 16}default:return 16}}var Cs=null,tg=null,Kf=null;function SE(){if(Kf)return Kf;var t,e=tg,r=e.length,n,i="value"in Cs?Cs.value:Cs.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Kf=i.slice(t,1<n?1-n:void 0)}function Xf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vf(){return!0}function p_(){return!1}function Rn(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?vf:p_,this.isPropagationStopped=p_,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vf)},persist:function(){},isPersistent:vf}),e}var yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rg=Rn(yl),xu=Ot({},yl,{view:0,detail:0}),DC=Rn(xu),xd,yd,zl,mh=Ot({},xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ng,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zl&&(zl&&t.type==="mousemove"?(xd=t.screenX-zl.screenX,yd=t.screenY-zl.screenY):yd=xd=0,zl=t),xd)},movementY:function(t){return"movementY"in t?t.movementY:yd}}),m_=Rn(mh),OC=Ot({},mh,{dataTransfer:0}),LC=Rn(OC),bC=Ot({},xu,{relatedTarget:0}),wd=Rn(bC),MC=Ot({},yl,{animationName:0,elapsedTime:0,pseudoElement:0}),VC=Rn(MC),BC=Ot({},yl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UC=Rn(BC),jC=Ot({},yl,{data:0}),g_=Rn(jC),WC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $C(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=zC[t])?!!e[t]:!1}function ng(){return $C}var GC=Ot({},xu,{key:function(t){if(t.key){var e=WC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?HC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ng,charCode:function(t){return t.type==="keypress"?Xf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KC=Rn(GC),XC=Ot({},mh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),v_=Rn(XC),qC=Ot({},xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ng}),YC=Rn(qC),QC=Ot({},yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),JC=Rn(QC),ZC=Ot({},mh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),e4=Rn(ZC),t4=[9,13,27,32],ig=Qi&&"CompositionEvent"in window,hc=null;Qi&&"documentMode"in document&&(hc=document.documentMode);var r4=Qi&&"TextEvent"in window&&!hc,AE=Qi&&(!ig||hc&&8<hc&&11>=hc),__=" ",x_=!1;function IE(t,e){switch(t){case"keyup":return t4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ao=!1;function n4(t,e){switch(t){case"compositionend":return CE(e);case"keypress":return e.which!==32?null:(x_=!0,__);case"textInput":return t=e.data,t===__&&x_?null:t;default:return null}}function i4(t,e){if(Ao)return t==="compositionend"||!ig&&IE(t,e)?(t=SE(),Kf=tg=Cs=null,Ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return AE&&e.locale!=="ko"?null:e.data;default:return null}}var s4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!s4[t.type]:e==="textarea"}function RE(t,e,r,n){aE(n),e=_0(e,"onChange"),0<e.length&&(r=new rg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var dc=null,Vc=null;function a4(t){UE(t,0)}function gh(t){var e=Ro(t);if(Zw(e))return t}function o4(t,e){if(t==="change")return e}var PE=!1;if(Qi){var Ed;if(Qi){var Td="oninput"in document;if(!Td){var w_=document.createElement("div");w_.setAttribute("oninput","return;"),Td=typeof w_.oninput=="function"}Ed=Td}else Ed=!1;PE=Ed&&(!document.documentMode||9<document.documentMode)}function E_(){dc&&(dc.detachEvent("onpropertychange",FE),Vc=dc=null)}function FE(t){if(t.propertyName==="value"&&gh(Vc)){var e=[];RE(e,Vc,t,Ym(t)),uE(a4,e)}}function l4(t,e,r){t==="focusin"?(E_(),dc=e,Vc=r,dc.attachEvent("onpropertychange",FE)):t==="focusout"&&E_()}function c4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gh(Vc)}function u4(t,e){if(t==="click")return gh(e)}function f4(t,e){if(t==="input"||t==="change")return gh(e)}function h4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ai=typeof Object.is=="function"?Object.is:h4;function Bc(t,e){if(ai(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!fp.call(e,i)||!ai(t[i],e[i]))return!1}return!0}function T_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function k_(t,e){var r=T_(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=T_(r)}}function NE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?NE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function DE(){for(var t=window,e=f0();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=f0(t.document)}return e}function sg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function d4(t){var e=DE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&NE(r.ownerDocument.documentElement,r)){if(n!==null&&sg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=k_(r,s);var a=k_(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var p4=Qi&&"documentMode"in document&&11>=document.documentMode,Io=null,Pp=null,pc=null,Fp=!1;function S_(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Fp||Io==null||Io!==f0(n)||(n=Io,"selectionStart"in n&&sg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pc&&Bc(pc,n)||(pc=n,n=_0(Pp,"onSelect"),0<n.length&&(e=new rg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Io)))}function _f(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Co={animationend:_f("Animation","AnimationEnd"),animationiteration:_f("Animation","AnimationIteration"),animationstart:_f("Animation","AnimationStart"),transitionend:_f("Transition","TransitionEnd")},kd={},OE={};Qi&&(OE=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);function vh(t){if(kd[t])return kd[t];if(!Co[t])return t;var e=Co[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in OE)return kd[t]=e[r];return t}var LE=vh("animationend"),bE=vh("animationiteration"),ME=vh("animationstart"),VE=vh("transitionend"),BE=new Map,A_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ta(t,e){BE.set(t,e),Ya(e,[t])}for(var Sd=0;Sd<A_.length;Sd++){var Ad=A_[Sd],m4=Ad.toLowerCase(),g4=Ad[0].toUpperCase()+Ad.slice(1);ta(m4,"on"+g4)}ta(LE,"onAnimationEnd");ta(bE,"onAnimationIteration");ta(ME,"onAnimationStart");ta("dblclick","onDoubleClick");ta("focusin","onFocus");ta("focusout","onBlur");ta(VE,"onTransitionEnd");Zo("onMouseEnter",["mouseout","mouseover"]);Zo("onMouseLeave",["mouseout","mouseover"]);Zo("onPointerEnter",["pointerout","pointerover"]);Zo("onPointerLeave",["pointerout","pointerover"]);Ya("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ya("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ya("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ya("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ya("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ya("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zl));function I_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,mC(n,e,void 0,t),t.currentTarget=null}function UE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;I_(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;I_(i,o,c),s=l}}}if(d0)throw t=Ap,d0=!1,Ap=null,t}function yt(t,e){var r=e[bp];r===void 0&&(r=e[bp]=new Set);var n=t+"__bubble";r.has(n)||(jE(e,t,2,!1),r.add(n))}function Id(t,e,r){var n=0;e&&(n|=4),jE(r,t,n,e)}var xf="_reactListening"+Math.random().toString(36).slice(2);function Uc(t){if(!t[xf]){t[xf]=!0,Xw.forEach(function(r){r!=="selectionchange"&&(v4.has(r)||Id(r,!1,t),Id(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xf]||(e[xf]=!0,Id("selectionchange",!1,e))}}function jE(t,e,r,n){switch(kE(e)){case 1:var i=FC;break;case 4:i=NC;break;default:i=eg}r=i.bind(null,e,r,t),i=void 0,!Sp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Cd(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ya(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}uE(function(){var c=s,f=Ym(r),h=[];e:{var d=BE.get(t);if(d!==void 0){var p=rg,v=t;switch(t){case"keypress":if(Xf(r)===0)break e;case"keydown":case"keyup":p=KC;break;case"focusin":v="focus",p=wd;break;case"focusout":v="blur",p=wd;break;case"beforeblur":case"afterblur":p=wd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=m_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=LC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=YC;break;case LE:case bE:case ME:p=VC;break;case VE:p=JC;break;case"scroll":p=DC;break;case"wheel":p=e4;break;case"copy":case"cut":case"paste":p=UC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=v_}var m=(e&4)!==0,_=!m&&t==="scroll",y=m?d!==null?d+"Capture":null:d;m=[];for(var E=c,x;E!==null;){x=E;var F=x.stateNode;if(x.tag===5&&F!==null&&(x=F,y!==null&&(F=Oc(E,y),F!=null&&m.push(jc(E,F,x)))),_)break;E=E.return}0<m.length&&(d=new p(d,v,null,r,f),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==Tp&&(v=r.relatedTarget||r.fromElement)&&(ya(v)||v[Ji]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=c,v=v?ya(v):null,v!==null&&(_=Qa(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(m=m_,F="onMouseLeave",y="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(m=v_,F="onPointerLeave",y="onPointerEnter",E="pointer"),_=p==null?d:Ro(p),x=v==null?d:Ro(v),d=new m(F,E+"leave",p,r,f),d.target=_,d.relatedTarget=x,F=null,ya(f)===c&&(m=new m(y,E+"enter",v,r,f),m.target=x,m.relatedTarget=_,F=m),_=F,p&&v)t:{for(m=p,y=v,E=0,x=m;x;x=go(x))E++;for(x=0,F=y;F;F=go(F))x++;for(;0<E-x;)m=go(m),E--;for(;0<x-E;)y=go(y),x--;for(;E--;){if(m===y||y!==null&&m===y.alternate)break t;m=go(m),y=go(y)}m=null}else m=null;p!==null&&C_(h,d,p,m,!1),v!==null&&_!==null&&C_(h,_,v,m,!0)}}e:{if(d=c?Ro(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var U=o4;else if(y_(d))if(PE)U=f4;else{U=c4;var b=l4}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(U=u4);if(U&&(U=U(t,c))){RE(h,U,r,f);break e}b&&b(t,d,c),t==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&_p(d,"number",d.value)}switch(b=c?Ro(c):window,t){case"focusin":(y_(b)||b.contentEditable==="true")&&(Io=b,Pp=c,pc=null);break;case"focusout":pc=Pp=Io=null;break;case"mousedown":Fp=!0;break;case"contextmenu":case"mouseup":case"dragend":Fp=!1,S_(h,r,f);break;case"selectionchange":if(p4)break;case"keydown":case"keyup":S_(h,r,f)}var w;if(ig)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Ao?IE(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(AE&&r.locale!=="ko"&&(Ao||k!=="onCompositionStart"?k==="onCompositionEnd"&&Ao&&(w=SE()):(Cs=f,tg="value"in Cs?Cs.value:Cs.textContent,Ao=!0)),b=_0(c,k),0<b.length&&(k=new g_(k,t,null,r,f),h.push({event:k,listeners:b}),w?k.data=w:(w=CE(r),w!==null&&(k.data=w)))),(w=r4?n4(t,r):i4(t,r))&&(c=_0(c,"onBeforeInput"),0<c.length&&(f=new g_("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=w))}UE(h,e)})}function jc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function _0(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Oc(t,r),s!=null&&n.unshift(jc(t,s,i)),s=Oc(t,e),s!=null&&n.push(jc(t,s,i))),t=t.return}return n}function go(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function C_(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Oc(r,s),l!=null&&a.unshift(jc(r,l,o))):i||(l=Oc(r,s),l!=null&&a.push(jc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var _4=/\r\n?/g,x4=/\u0000|\uFFFD/g;function R_(t){return(typeof t=="string"?t:""+t).replace(_4,`
`).replace(x4,"")}function yf(t,e,r){if(e=R_(e),R_(t)!==e&&r)throw Error(ve(425))}function x0(){}var Np=null,Dp=null;function Op(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Lp=typeof setTimeout=="function"?setTimeout:void 0,y4=typeof clearTimeout=="function"?clearTimeout:void 0,P_=typeof Promise=="function"?Promise:void 0,w4=typeof queueMicrotask=="function"?queueMicrotask:typeof P_<"u"?function(t){return P_.resolve(null).then(t).catch(E4)}:Lp;function E4(t){setTimeout(function(){throw t})}function Rd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Mc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Mc(e)}function Ms(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function F_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var wl=Math.random().toString(36).slice(2),gi="__reactFiber$"+wl,Wc="__reactProps$"+wl,Ji="__reactContainer$"+wl,bp="__reactEvents$"+wl,T4="__reactListeners$"+wl,k4="__reactHandles$"+wl;function ya(t){var e=t[gi];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ji]||r[gi]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=F_(t);t!==null;){if(r=t[gi])return r;t=F_(t)}return e}t=r,r=t.parentNode}return null}function yu(t){return t=t[gi]||t[Ji],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ro(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ve(33))}function _h(t){return t[Wc]||null}var Mp=[],Po=-1;function ra(t){return{current:t}}function Tt(t){0>Po||(t.current=Mp[Po],Mp[Po]=null,Po--)}function vt(t,e){Po++,Mp[Po]=t.current,t.current=e}var Ks={},Wr=ra(Ks),un=ra(!1),Da=Ks;function el(t,e){var r=t.type.contextTypes;if(!r)return Ks;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function fn(t){return t=t.childContextTypes,t!=null}function y0(){Tt(un),Tt(Wr)}function N_(t,e,r){if(Wr.current!==Ks)throw Error(ve(168));vt(Wr,e),vt(un,r)}function WE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ve(108,lC(t)||"Unknown",i));return Ot({},r,n)}function w0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ks,Da=Wr.current,vt(Wr,t),vt(un,un.current),!0}function D_(t,e,r){var n=t.stateNode;if(!n)throw Error(ve(169));r?(t=WE(t,e,Da),n.__reactInternalMemoizedMergedChildContext=t,Tt(un),Tt(Wr),vt(Wr,t)):Tt(un),vt(un,r)}var bi=null,xh=!1,Pd=!1;function HE(t){bi===null?bi=[t]:bi.push(t)}function S4(t){xh=!0,HE(t)}function na(){if(!Pd&&bi!==null){Pd=!0;var t=0,e=ft;try{var r=bi;for(ft=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}bi=null,xh=!1}catch(i){throw bi!==null&&(bi=bi.slice(t+1)),pE(Qm,na),i}finally{ft=e,Pd=!1}}return null}var Fo=[],No=0,E0=null,T0=0,Bn=[],Un=0,Oa=null,Mi=1,Vi="";function ga(t,e){Fo[No++]=T0,Fo[No++]=E0,E0=t,T0=e}function zE(t,e,r){Bn[Un++]=Mi,Bn[Un++]=Vi,Bn[Un++]=Oa,Oa=t;var n=Mi;t=Vi;var i=32-ri(n)-1;n&=~(1<<i),r+=1;var s=32-ri(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Mi=1<<32-ri(e)+i|r<<i|n,Vi=s+t}else Mi=1<<s|r<<i|n,Vi=t}function ag(t){t.return!==null&&(ga(t,1),zE(t,1,0))}function og(t){for(;t===E0;)E0=Fo[--No],Fo[No]=null,T0=Fo[--No],Fo[No]=null;for(;t===Oa;)Oa=Bn[--Un],Bn[Un]=null,Vi=Bn[--Un],Bn[Un]=null,Mi=Bn[--Un],Bn[Un]=null}var Sn=null,Tn=null,It=!1,Zn=null;function $E(t,e){var r=jn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function O_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Sn=t,Tn=Ms(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Sn=t,Tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Oa!==null?{id:Mi,overflow:Vi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=jn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Sn=t,Tn=null,!0):!1;default:return!1}}function Vp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bp(t){if(It){var e=Tn;if(e){var r=e;if(!O_(t,e)){if(Vp(t))throw Error(ve(418));e=Ms(r.nextSibling);var n=Sn;e&&O_(t,e)?$E(n,r):(t.flags=t.flags&-4097|2,It=!1,Sn=t)}}else{if(Vp(t))throw Error(ve(418));t.flags=t.flags&-4097|2,It=!1,Sn=t}}}function L_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Sn=t}function wf(t){if(t!==Sn)return!1;if(!It)return L_(t),It=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Op(t.type,t.memoizedProps)),e&&(e=Tn)){if(Vp(t))throw GE(),Error(ve(418));for(;e;)$E(t,e),e=Ms(e.nextSibling)}if(L_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ve(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Tn=Ms(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Tn=null}}else Tn=Sn?Ms(t.stateNode.nextSibling):null;return!0}function GE(){for(var t=Tn;t;)t=Ms(t.nextSibling)}function tl(){Tn=Sn=null,It=!1}function lg(t){Zn===null?Zn=[t]:Zn.push(t)}var A4=as.ReactCurrentBatchConfig;function $l(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ve(309));var n=r.stateNode}if(!n)throw Error(ve(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ve(284));if(!r._owner)throw Error(ve(290,t))}return t}function Ef(t,e){throw t=Object.prototype.toString.call(e),Error(ve(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function b_(t){var e=t._init;return e(t._payload)}function KE(t){function e(y,E){if(t){var x=y.deletions;x===null?(y.deletions=[E],y.flags|=16):x.push(E)}}function r(y,E){if(!t)return null;for(;E!==null;)e(y,E),E=E.sibling;return null}function n(y,E){for(y=new Map;E!==null;)E.key!==null?y.set(E.key,E):y.set(E.index,E),E=E.sibling;return y}function i(y,E){return y=js(y,E),y.index=0,y.sibling=null,y}function s(y,E,x){return y.index=x,t?(x=y.alternate,x!==null?(x=x.index,x<E?(y.flags|=2,E):x):(y.flags|=2,E)):(y.flags|=1048576,E)}function a(y){return t&&y.alternate===null&&(y.flags|=2),y}function o(y,E,x,F){return E===null||E.tag!==6?(E=Md(x,y.mode,F),E.return=y,E):(E=i(E,x),E.return=y,E)}function l(y,E,x,F){var U=x.type;return U===So?f(y,E,x.props.children,F,x.key):E!==null&&(E.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===ys&&b_(U)===E.type)?(F=i(E,x.props),F.ref=$l(y,E,x),F.return=y,F):(F=t0(x.type,x.key,x.props,null,y.mode,F),F.ref=$l(y,E,x),F.return=y,F)}function c(y,E,x,F){return E===null||E.tag!==4||E.stateNode.containerInfo!==x.containerInfo||E.stateNode.implementation!==x.implementation?(E=Vd(x,y.mode,F),E.return=y,E):(E=i(E,x.children||[]),E.return=y,E)}function f(y,E,x,F,U){return E===null||E.tag!==7?(E=Aa(x,y.mode,F,U),E.return=y,E):(E=i(E,x),E.return=y,E)}function h(y,E,x){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Md(""+E,y.mode,x),E.return=y,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ff:return x=t0(E.type,E.key,E.props,null,y.mode,x),x.ref=$l(y,null,E),x.return=y,x;case ko:return E=Vd(E,y.mode,x),E.return=y,E;case ys:var F=E._init;return h(y,F(E._payload),x)}if(Ql(E)||Ul(E))return E=Aa(E,y.mode,x,null),E.return=y,E;Ef(y,E)}return null}function d(y,E,x,F){var U=E!==null?E.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return U!==null?null:o(y,E,""+x,F);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ff:return x.key===U?l(y,E,x,F):null;case ko:return x.key===U?c(y,E,x,F):null;case ys:return U=x._init,d(y,E,U(x._payload),F)}if(Ql(x)||Ul(x))return U!==null?null:f(y,E,x,F,null);Ef(y,x)}return null}function p(y,E,x,F,U){if(typeof F=="string"&&F!==""||typeof F=="number")return y=y.get(x)||null,o(E,y,""+F,U);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case ff:return y=y.get(F.key===null?x:F.key)||null,l(E,y,F,U);case ko:return y=y.get(F.key===null?x:F.key)||null,c(E,y,F,U);case ys:var b=F._init;return p(y,E,x,b(F._payload),U)}if(Ql(F)||Ul(F))return y=y.get(x)||null,f(E,y,F,U,null);Ef(E,F)}return null}function v(y,E,x,F){for(var U=null,b=null,w=E,k=E=0,S=null;w!==null&&k<x.length;k++){w.index>k?(S=w,w=null):S=w.sibling;var C=d(y,w,x[k],F);if(C===null){w===null&&(w=S);break}t&&w&&C.alternate===null&&e(y,w),E=s(C,E,k),b===null?U=C:b.sibling=C,b=C,w=S}if(k===x.length)return r(y,w),It&&ga(y,k),U;if(w===null){for(;k<x.length;k++)w=h(y,x[k],F),w!==null&&(E=s(w,E,k),b===null?U=w:b.sibling=w,b=w);return It&&ga(y,k),U}for(w=n(y,w);k<x.length;k++)S=p(w,y,k,x[k],F),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?k:S.key),E=s(S,E,k),b===null?U=S:b.sibling=S,b=S);return t&&w.forEach(function(P){return e(y,P)}),It&&ga(y,k),U}function m(y,E,x,F){var U=Ul(x);if(typeof U!="function")throw Error(ve(150));if(x=U.call(x),x==null)throw Error(ve(151));for(var b=U=null,w=E,k=E=0,S=null,C=x.next();w!==null&&!C.done;k++,C=x.next()){w.index>k?(S=w,w=null):S=w.sibling;var P=d(y,w,C.value,F);if(P===null){w===null&&(w=S);break}t&&w&&P.alternate===null&&e(y,w),E=s(P,E,k),b===null?U=P:b.sibling=P,b=P,w=S}if(C.done)return r(y,w),It&&ga(y,k),U;if(w===null){for(;!C.done;k++,C=x.next())C=h(y,C.value,F),C!==null&&(E=s(C,E,k),b===null?U=C:b.sibling=C,b=C);return It&&ga(y,k),U}for(w=n(y,w);!C.done;k++,C=x.next())C=p(w,y,k,C.value,F),C!==null&&(t&&C.alternate!==null&&w.delete(C.key===null?k:C.key),E=s(C,E,k),b===null?U=C:b.sibling=C,b=C);return t&&w.forEach(function(A){return e(y,A)}),It&&ga(y,k),U}function _(y,E,x,F){if(typeof x=="object"&&x!==null&&x.type===So&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case ff:e:{for(var U=x.key,b=E;b!==null;){if(b.key===U){if(U=x.type,U===So){if(b.tag===7){r(y,b.sibling),E=i(b,x.props.children),E.return=y,y=E;break e}}else if(b.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===ys&&b_(U)===b.type){r(y,b.sibling),E=i(b,x.props),E.ref=$l(y,b,x),E.return=y,y=E;break e}r(y,b);break}else e(y,b);b=b.sibling}x.type===So?(E=Aa(x.props.children,y.mode,F,x.key),E.return=y,y=E):(F=t0(x.type,x.key,x.props,null,y.mode,F),F.ref=$l(y,E,x),F.return=y,y=F)}return a(y);case ko:e:{for(b=x.key;E!==null;){if(E.key===b)if(E.tag===4&&E.stateNode.containerInfo===x.containerInfo&&E.stateNode.implementation===x.implementation){r(y,E.sibling),E=i(E,x.children||[]),E.return=y,y=E;break e}else{r(y,E);break}else e(y,E);E=E.sibling}E=Vd(x,y.mode,F),E.return=y,y=E}return a(y);case ys:return b=x._init,_(y,E,b(x._payload),F)}if(Ql(x))return v(y,E,x,F);if(Ul(x))return m(y,E,x,F);Ef(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,E!==null&&E.tag===6?(r(y,E.sibling),E=i(E,x),E.return=y,y=E):(r(y,E),E=Md(x,y.mode,F),E.return=y,y=E),a(y)):r(y,E)}return _}var rl=KE(!0),XE=KE(!1),k0=ra(null),S0=null,Do=null,cg=null;function ug(){cg=Do=S0=null}function fg(t){var e=k0.current;Tt(k0),t._currentValue=e}function Up(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ho(t,e){S0=t,cg=Do=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(cn=!0),t.firstContext=null)}function zn(t){var e=t._currentValue;if(cg!==t)if(t={context:t,memoizedValue:e,next:null},Do===null){if(S0===null)throw Error(ve(308));Do=t,S0.dependencies={lanes:0,firstContext:t}}else Do=Do.next=t;return e}var wa=null;function hg(t){wa===null?wa=[t]:wa.push(t)}function qE(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,hg(e)):(r.next=i.next,i.next=r),e.interleaved=r,Zi(t,n)}function Zi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ws=!1;function dg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $i(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vs(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ze&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Zi(t,r)}return i=n.interleaved,i===null?(e.next=e,hg(n)):(e.next=i.next,i.next=e),n.interleaved=e,Zi(t,r)}function qf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Jm(t,r)}}function M_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function A0(t,e,r,n){var i=t.updateQueue;ws=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,f=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,m=o;switch(d=e,p=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){h=v.call(p,h,d);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,d=typeof v=="function"?v.call(p,h,d):v,d==null)break e;h=Ot({},h,d);break e;case 2:ws=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=h):f=f.next=p,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ba|=a,t.lanes=a,t.memoizedState=h}}function V_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ve(191,i));i.call(n)}}}var wu={},yi=ra(wu),Hc=ra(wu),zc=ra(wu);function Ea(t){if(t===wu)throw Error(ve(174));return t}function pg(t,e){switch(vt(zc,e),vt(Hc,t),vt(yi,wu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:yp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=yp(e,t)}Tt(yi),vt(yi,e)}function nl(){Tt(yi),Tt(Hc),Tt(zc)}function QE(t){Ea(zc.current);var e=Ea(yi.current),r=yp(e,t.type);e!==r&&(vt(Hc,t),vt(yi,r))}function mg(t){Hc.current===t&&(Tt(yi),Tt(Hc))}var Pt=ra(0);function I0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fd=[];function gg(){for(var t=0;t<Fd.length;t++)Fd[t]._workInProgressVersionPrimary=null;Fd.length=0}var Yf=as.ReactCurrentDispatcher,Nd=as.ReactCurrentBatchConfig,La=0,Dt=null,rr=null,ur=null,C0=!1,mc=!1,$c=0,I4=0;function Rr(){throw Error(ve(321))}function vg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ai(t[r],e[r]))return!1;return!0}function _g(t,e,r,n,i,s){if(La=s,Dt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yf.current=t===null||t.memoizedState===null?F4:N4,t=r(n,i),mc){s=0;do{if(mc=!1,$c=0,25<=s)throw Error(ve(301));s+=1,ur=rr=null,e.updateQueue=null,Yf.current=D4,t=r(n,i)}while(mc)}if(Yf.current=R0,e=rr!==null&&rr.next!==null,La=0,ur=rr=Dt=null,C0=!1,e)throw Error(ve(300));return t}function xg(){var t=$c!==0;return $c=0,t}function mi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?Dt.memoizedState=ur=t:ur=ur.next=t,ur}function $n(){if(rr===null){var t=Dt.alternate;t=t!==null?t.memoizedState:null}else t=rr.next;var e=ur===null?Dt.memoizedState:ur.next;if(e!==null)ur=e,rr=t;else{if(t===null)throw Error(ve(310));rr=t,t={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},ur===null?Dt.memoizedState=ur=t:ur=ur.next=t}return ur}function Gc(t,e){return typeof e=="function"?e(t):e}function Dd(t){var e=$n(),r=e.queue;if(r===null)throw Error(ve(311));r.lastRenderedReducer=t;var n=rr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var f=c.lane;if((La&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Dt.lanes|=f,ba|=f}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,ai(n,e.memoizedState)||(cn=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Dt.lanes|=s,ba|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Od(t){var e=$n(),r=e.queue;if(r===null)throw Error(ve(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);ai(s,e.memoizedState)||(cn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function JE(){}function ZE(t,e){var r=Dt,n=$n(),i=e(),s=!ai(n.memoizedState,i);if(s&&(n.memoizedState=i,cn=!0),n=n.queue,yg(r2.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ur!==null&&ur.memoizedState.tag&1){if(r.flags|=2048,Kc(9,t2.bind(null,r,n,i,e),void 0,null),dr===null)throw Error(ve(349));La&30||e2(r,e,i)}return i}function e2(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Dt.updateQueue,e===null?(e={lastEffect:null,stores:null},Dt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function t2(t,e,r,n){e.value=r,e.getSnapshot=n,n2(e)&&i2(t)}function r2(t,e,r){return r(function(){n2(e)&&i2(t)})}function n2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ai(t,r)}catch{return!0}}function i2(t){var e=Zi(t,1);e!==null&&ni(e,t,1,-1)}function B_(t){var e=mi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gc,lastRenderedState:t},e.queue=t,t=t.dispatch=P4.bind(null,Dt,t),[e.memoizedState,t]}function Kc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Dt.updateQueue,e===null?(e={lastEffect:null,stores:null},Dt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function s2(){return $n().memoizedState}function Qf(t,e,r,n){var i=mi();Dt.flags|=t,i.memoizedState=Kc(1|e,r,void 0,n===void 0?null:n)}function yh(t,e,r,n){var i=$n();n=n===void 0?null:n;var s=void 0;if(rr!==null){var a=rr.memoizedState;if(s=a.destroy,n!==null&&vg(n,a.deps)){i.memoizedState=Kc(e,r,s,n);return}}Dt.flags|=t,i.memoizedState=Kc(1|e,r,s,n)}function U_(t,e){return Qf(8390656,8,t,e)}function yg(t,e){return yh(2048,8,t,e)}function a2(t,e){return yh(4,2,t,e)}function o2(t,e){return yh(4,4,t,e)}function l2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function c2(t,e,r){return r=r!=null?r.concat([t]):null,yh(4,4,l2.bind(null,e,t),r)}function wg(){}function u2(t,e){var r=$n();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&vg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function f2(t,e){var r=$n();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&vg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function h2(t,e,r){return La&21?(ai(r,e)||(r=vE(),Dt.lanes|=r,ba|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,cn=!0),t.memoizedState=r)}function C4(t,e){var r=ft;ft=r!==0&&4>r?r:4,t(!0);var n=Nd.transition;Nd.transition={};try{t(!1),e()}finally{ft=r,Nd.transition=n}}function d2(){return $n().memoizedState}function R4(t,e,r){var n=Us(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},p2(t))m2(e,r);else if(r=qE(t,e,r,n),r!==null){var i=Yr();ni(r,t,n,i),g2(r,e,n)}}function P4(t,e,r){var n=Us(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(p2(t))m2(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,ai(o,a)){var l=e.interleaved;l===null?(i.next=i,hg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=qE(t,e,i,n),r!==null&&(i=Yr(),ni(r,t,n,i),g2(r,e,n))}}function p2(t){var e=t.alternate;return t===Dt||e!==null&&e===Dt}function m2(t,e){mc=C0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function g2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Jm(t,r)}}var R0={readContext:zn,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},F4={readContext:zn,useCallback:function(t,e){return mi().memoizedState=[t,e===void 0?null:e],t},useContext:zn,useEffect:U_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Qf(4194308,4,l2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Qf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Qf(4,2,t,e)},useMemo:function(t,e){var r=mi();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=mi();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=R4.bind(null,Dt,t),[n.memoizedState,t]},useRef:function(t){var e=mi();return t={current:t},e.memoizedState=t},useState:B_,useDebugValue:wg,useDeferredValue:function(t){return mi().memoizedState=t},useTransition:function(){var t=B_(!1),e=t[0];return t=C4.bind(null,t[1]),mi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Dt,i=mi();if(It){if(r===void 0)throw Error(ve(407));r=r()}else{if(r=e(),dr===null)throw Error(ve(349));La&30||e2(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,U_(r2.bind(null,n,s,t),[t]),n.flags|=2048,Kc(9,t2.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=mi(),e=dr.identifierPrefix;if(It){var r=Vi,n=Mi;r=(n&~(1<<32-ri(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=$c++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=I4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},N4={readContext:zn,useCallback:u2,useContext:zn,useEffect:yg,useImperativeHandle:c2,useInsertionEffect:a2,useLayoutEffect:o2,useMemo:f2,useReducer:Dd,useRef:s2,useState:function(){return Dd(Gc)},useDebugValue:wg,useDeferredValue:function(t){var e=$n();return h2(e,rr.memoizedState,t)},useTransition:function(){var t=Dd(Gc)[0],e=$n().memoizedState;return[t,e]},useMutableSource:JE,useSyncExternalStore:ZE,useId:d2,unstable_isNewReconciler:!1},D4={readContext:zn,useCallback:u2,useContext:zn,useEffect:yg,useImperativeHandle:c2,useInsertionEffect:a2,useLayoutEffect:o2,useMemo:f2,useReducer:Od,useRef:s2,useState:function(){return Od(Gc)},useDebugValue:wg,useDeferredValue:function(t){var e=$n();return rr===null?e.memoizedState=t:h2(e,rr.memoizedState,t)},useTransition:function(){var t=Od(Gc)[0],e=$n().memoizedState;return[t,e]},useMutableSource:JE,useSyncExternalStore:ZE,useId:d2,unstable_isNewReconciler:!1};function Qn(t,e){if(t&&t.defaultProps){e=Ot({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function jp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ot({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var wh={isMounted:function(t){return(t=t._reactInternals)?Qa(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Yr(),i=Us(t),s=$i(n,i);s.payload=e,r!=null&&(s.callback=r),e=Vs(t,s,i),e!==null&&(ni(e,t,i,n),qf(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Yr(),i=Us(t),s=$i(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Vs(t,s,i),e!==null&&(ni(e,t,i,n),qf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Yr(),n=Us(t),i=$i(r,n);i.tag=2,e!=null&&(i.callback=e),e=Vs(t,i,n),e!==null&&(ni(e,t,n,r),qf(e,t,n))}};function j_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Bc(r,n)||!Bc(i,s):!0}function v2(t,e,r){var n=!1,i=Ks,s=e.contextType;return typeof s=="object"&&s!==null?s=zn(s):(i=fn(e)?Da:Wr.current,n=e.contextTypes,s=(n=n!=null)?el(t,i):Ks),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wh,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function W_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&wh.enqueueReplaceState(e,e.state,null)}function Wp(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},dg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zn(s):(s=fn(e)?Da:Wr.current,i.context=el(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(jp(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&wh.enqueueReplaceState(i,i.state,null),A0(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function il(t,e){try{var r="",n=e;do r+=oC(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ld(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Hp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var O4=typeof WeakMap=="function"?WeakMap:Map;function _2(t,e,r){r=$i(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){F0||(F0=!0,Zp=n),Hp(t,e)},r}function x2(t,e,r){r=$i(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Hp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Hp(t,e),typeof n!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function H_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new O4;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=X4.bind(null,t,e,r),e.then(t,t))}function z_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function $_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=$i(-1,1),e.tag=2,Vs(r,e,1))),r.lanes|=1),t)}var L4=as.ReactCurrentOwner,cn=!1;function Kr(t,e,r,n){e.child=t===null?XE(e,null,r,n):rl(e,t.child,r,n)}function G_(t,e,r,n,i){r=r.render;var s=e.ref;return Ho(e,i),n=_g(t,e,r,n,s,i),r=xg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,es(t,e,i)):(It&&r&&ag(e),e.flags|=1,Kr(t,e,n,i),e.child)}function K_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!Rg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,y2(t,e,s,n,i)):(t=t0(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Bc,r(a,n)&&t.ref===e.ref)return es(t,e,i)}return e.flags|=1,t=js(s,n),t.ref=e.ref,t.return=e,e.child=t}function y2(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Bc(s,n)&&t.ref===e.ref)if(cn=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(cn=!0);else return e.lanes=t.lanes,es(t,e,i)}return zp(t,e,r,n,i)}function w2(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(Lo,_n),_n|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vt(Lo,_n),_n|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,vt(Lo,_n),_n|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,vt(Lo,_n),_n|=n;return Kr(t,e,i,r),e.child}function E2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function zp(t,e,r,n,i){var s=fn(r)?Da:Wr.current;return s=el(e,s),Ho(e,i),r=_g(t,e,r,n,s,i),n=xg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,es(t,e,i)):(It&&n&&ag(e),e.flags|=1,Kr(t,e,r,i),e.child)}function X_(t,e,r,n,i){if(fn(r)){var s=!0;w0(e)}else s=!1;if(Ho(e,i),e.stateNode===null)Jf(t,e),v2(e,r,n),Wp(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=zn(c):(c=fn(r)?Da:Wr.current,c=el(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&W_(e,a,n,c),ws=!1;var d=e.memoizedState;a.state=d,A0(e,n,a,i),l=e.memoizedState,o!==n||d!==l||un.current||ws?(typeof f=="function"&&(jp(e,r,f,n),l=e.memoizedState),(o=ws||j_(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,YE(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Qn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=zn(l):(l=fn(r)?Da:Wr.current,l=el(e,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&W_(e,a,n,l),ws=!1,d=e.memoizedState,a.state=d,A0(e,n,a,i);var v=e.memoizedState;o!==h||d!==v||un.current||ws?(typeof p=="function"&&(jp(e,r,p,n),v=e.memoizedState),(c=ws||j_(e,r,c,n,d,v,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),a.props=n,a.state=v,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return $p(t,e,r,n,s,i)}function $p(t,e,r,n,i,s){E2(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&D_(e,r,!1),es(t,e,s);n=e.stateNode,L4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=rl(e,t.child,null,s),e.child=rl(e,null,o,s)):Kr(t,e,o,s),e.memoizedState=n.state,i&&D_(e,r,!0),e.child}function T2(t){var e=t.stateNode;e.pendingContext?N_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&N_(t,e.context,!1),pg(t,e.containerInfo)}function q_(t,e,r,n,i){return tl(),lg(i),e.flags|=256,Kr(t,e,r,n),e.child}var Gp={dehydrated:null,treeContext:null,retryLane:0};function Kp(t){return{baseLanes:t,cachePool:null,transitions:null}}function k2(t,e,r){var n=e.pendingProps,i=Pt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vt(Pt,i&1),t===null)return Bp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=kh(a,n,0,null),t=Aa(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Kp(r),e.memoizedState=Gp,t):Eg(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return b4(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=js(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=js(o,s):(s=Aa(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Kp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Gp,n}return s=t.child,t=s.sibling,n=js(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Eg(t,e){return e=kh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Tf(t,e,r,n){return n!==null&&lg(n),rl(e,t.child,null,r),t=Eg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function b4(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Ld(Error(ve(422))),Tf(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=kh({mode:"visible",children:n.children},i,0,null),s=Aa(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&rl(e,t.child,null,a),e.child.memoizedState=Kp(a),e.memoizedState=Gp,s);if(!(e.mode&1))return Tf(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ve(419)),n=Ld(s,n,void 0),Tf(t,e,a,n)}if(o=(a&t.childLanes)!==0,cn||o){if(n=dr,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Zi(t,i),ni(n,t,i,-1))}return Cg(),n=Ld(Error(ve(421))),Tf(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=q4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Tn=Ms(i.nextSibling),Sn=e,It=!0,Zn=null,t!==null&&(Bn[Un++]=Mi,Bn[Un++]=Vi,Bn[Un++]=Oa,Mi=t.id,Vi=t.overflow,Oa=e),e=Eg(e,n.children),e.flags|=4096,e)}function Y_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Up(t.return,e,r)}function bd(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function S2(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Kr(t,e,n.children,r),n=Pt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Y_(t,r,e);else if(t.tag===19)Y_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(vt(Pt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&I0(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),bd(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&I0(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}bd(e,!0,r,null,s);break;case"together":bd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function es(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ba|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ve(153));if(e.child!==null){for(t=e.child,r=js(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=js(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function M4(t,e,r){switch(e.tag){case 3:T2(e),tl();break;case 5:QE(e);break;case 1:fn(e.type)&&w0(e);break;case 4:pg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;vt(k0,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(vt(Pt,Pt.current&1),e.flags|=128,null):r&e.child.childLanes?k2(t,e,r):(vt(Pt,Pt.current&1),t=es(t,e,r),t!==null?t.sibling:null);vt(Pt,Pt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return S2(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vt(Pt,Pt.current),n)break;return null;case 22:case 23:return e.lanes=0,w2(t,e,r)}return es(t,e,r)}var A2,Xp,I2,C2;A2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Xp=function(){};I2=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Ea(yi.current);var s=null;switch(r){case"input":i=gp(t,i),n=gp(t,n),s=[];break;case"select":i=Ot({},i,{value:void 0}),n=Ot({},n,{value:void 0}),s=[];break;case"textarea":i=xp(t,i),n=xp(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=x0)}wp(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Nc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Nc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&yt("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};C2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Gl(t,e){if(!It)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Pr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function V4(t,e,r){var n=e.pendingProps;switch(og(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(e),null;case 1:return fn(e.type)&&y0(),Pr(e),null;case 3:return n=e.stateNode,nl(),Tt(un),Tt(Wr),gg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(wf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(rm(Zn),Zn=null))),Xp(t,e),Pr(e),null;case 5:mg(e);var i=Ea(zc.current);if(r=e.type,t!==null&&e.stateNode!=null)I2(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ve(166));return Pr(e),null}if(t=Ea(yi.current),wf(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[gi]=e,n[Wc]=s,t=(e.mode&1)!==0,r){case"dialog":yt("cancel",n),yt("close",n);break;case"iframe":case"object":case"embed":yt("load",n);break;case"video":case"audio":for(i=0;i<Zl.length;i++)yt(Zl[i],n);break;case"source":yt("error",n);break;case"img":case"image":case"link":yt("error",n),yt("load",n);break;case"details":yt("toggle",n);break;case"input":s_(n,s),yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},yt("invalid",n);break;case"textarea":o_(n,s),yt("invalid",n)}wp(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&yf(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&yf(n.textContent,o,t),i=["children",""+o]):Nc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&yt("scroll",n)}switch(r){case"input":hf(n),a_(n,s,!0);break;case"textarea":hf(n),l_(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=x0)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[gi]=e,t[Wc]=n,A2(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ep(r,n),r){case"dialog":yt("cancel",t),yt("close",t),i=n;break;case"iframe":case"object":case"embed":yt("load",t),i=n;break;case"video":case"audio":for(i=0;i<Zl.length;i++)yt(Zl[i],t);i=n;break;case"source":yt("error",t),i=n;break;case"img":case"image":case"link":yt("error",t),yt("load",t),i=n;break;case"details":yt("toggle",t),i=n;break;case"input":s_(t,n),i=gp(t,n),yt("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ot({},n,{value:void 0}),yt("invalid",t);break;case"textarea":o_(t,n),i=xp(t,n),yt("invalid",t);break;default:i=n}wp(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?sE(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&nE(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Dc(t,l):typeof l=="number"&&Dc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Nc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&yt("scroll",t):l!=null&&Gm(t,s,l,a))}switch(r){case"input":hf(t),a_(t,n,!1);break;case"textarea":hf(t),l_(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Gs(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Bo(t,!!n.multiple,s,!1):n.defaultValue!=null&&Bo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=x0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pr(e),null;case 6:if(t&&e.stateNode!=null)C2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ve(166));if(r=Ea(zc.current),Ea(yi.current),wf(e)){if(n=e.stateNode,r=e.memoizedProps,n[gi]=e,(s=n.nodeValue!==r)&&(t=Sn,t!==null))switch(t.tag){case 3:yf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yf(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gi]=e,e.stateNode=n}return Pr(e),null;case 13:if(Tt(Pt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(It&&Tn!==null&&e.mode&1&&!(e.flags&128))GE(),tl(),e.flags|=98560,s=!1;else if(s=wf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(ve(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ve(317));s[gi]=e}else tl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pr(e),s=!1}else Zn!==null&&(rm(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Pt.current&1?ir===0&&(ir=3):Cg())),e.updateQueue!==null&&(e.flags|=4),Pr(e),null);case 4:return nl(),Xp(t,e),t===null&&Uc(e.stateNode.containerInfo),Pr(e),null;case 10:return fg(e.type._context),Pr(e),null;case 17:return fn(e.type)&&y0(),Pr(e),null;case 19:if(Tt(Pt),s=e.memoizedState,s===null)return Pr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Gl(s,!1);else{if(ir!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=I0(t),a!==null){for(e.flags|=128,Gl(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return vt(Pt,Pt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Gt()>sl&&(e.flags|=128,n=!0,Gl(s,!1),e.lanes=4194304)}else{if(!n)if(t=I0(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Gl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!It)return Pr(e),null}else 2*Gt()-s.renderingStartTime>sl&&r!==1073741824&&(e.flags|=128,n=!0,Gl(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Gt(),e.sibling=null,r=Pt.current,vt(Pt,n?r&1|2:r&1),e):(Pr(e),null);case 22:case 23:return Ig(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?_n&1073741824&&(Pr(e),e.subtreeFlags&6&&(e.flags|=8192)):Pr(e),null;case 24:return null;case 25:return null}throw Error(ve(156,e.tag))}function B4(t,e){switch(og(e),e.tag){case 1:return fn(e.type)&&y0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return nl(),Tt(un),Tt(Wr),gg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return mg(e),null;case 13:if(Tt(Pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ve(340));tl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Tt(Pt),null;case 4:return nl(),null;case 10:return fg(e.type._context),null;case 22:case 23:return Ig(),null;case 24:return null;default:return null}}var kf=!1,br=!1,U4=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Oo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(t,e,n)}else r.current=null}function qp(t,e,r){try{r()}catch(n){Bt(t,e,n)}}var Q_=!1;function j4(t,e){if(Np=g0,t=DE(),sg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=a),d===s&&++f===n&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Dp={focusedElem:t,selectionRange:r},g0=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,_=v.memoizedState,y=e.stateNode,E=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:Qn(e.type,m),_);y.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(F){Bt(e,e.return,F)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return v=Q_,Q_=!1,v}function gc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&qp(e,r,s)}i=i.next}while(i!==n)}}function Eh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Yp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function R2(t){var e=t.alternate;e!==null&&(t.alternate=null,R2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gi],delete e[Wc],delete e[bp],delete e[T4],delete e[k4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function P2(t){return t.tag===5||t.tag===3||t.tag===4}function J_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||P2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=x0));else if(n!==4&&(t=t.child,t!==null))for(Qp(t,e,r),t=t.sibling;t!==null;)Qp(t,e,r),t=t.sibling}function Jp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Jp(t,e,r),t=t.sibling;t!==null;)Jp(t,e,r),t=t.sibling}var _r=null,Jn=!1;function gs(t,e,r){for(r=r.child;r!==null;)F2(t,e,r),r=r.sibling}function F2(t,e,r){if(xi&&typeof xi.onCommitFiberUnmount=="function")try{xi.onCommitFiberUnmount(ph,r)}catch{}switch(r.tag){case 5:br||Oo(r,e);case 6:var n=_r,i=Jn;_r=null,gs(t,e,r),_r=n,Jn=i,_r!==null&&(Jn?(t=_r,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):_r.removeChild(r.stateNode));break;case 18:_r!==null&&(Jn?(t=_r,r=r.stateNode,t.nodeType===8?Rd(t.parentNode,r):t.nodeType===1&&Rd(t,r),Mc(t)):Rd(_r,r.stateNode));break;case 4:n=_r,i=Jn,_r=r.stateNode.containerInfo,Jn=!0,gs(t,e,r),_r=n,Jn=i;break;case 0:case 11:case 14:case 15:if(!br&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&qp(r,e,a),i=i.next}while(i!==n)}gs(t,e,r);break;case 1:if(!br&&(Oo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Bt(r,e,o)}gs(t,e,r);break;case 21:gs(t,e,r);break;case 22:r.mode&1?(br=(n=br)||r.memoizedState!==null,gs(t,e,r),br=n):gs(t,e,r);break;default:gs(t,e,r)}}function Z_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new U4),e.forEach(function(n){var i=Y4.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function qn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:_r=o.stateNode,Jn=!1;break e;case 3:_r=o.stateNode.containerInfo,Jn=!0;break e;case 4:_r=o.stateNode.containerInfo,Jn=!0;break e}o=o.return}if(_r===null)throw Error(ve(160));F2(s,a,i),_r=null,Jn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Bt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)N2(e,t),e=e.sibling}function N2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qn(e,t),fi(t),n&4){try{gc(3,t,t.return),Eh(3,t)}catch(m){Bt(t,t.return,m)}try{gc(5,t,t.return)}catch(m){Bt(t,t.return,m)}}break;case 1:qn(e,t),fi(t),n&512&&r!==null&&Oo(r,r.return);break;case 5:if(qn(e,t),fi(t),n&512&&r!==null&&Oo(r,r.return),t.flags&32){var i=t.stateNode;try{Dc(i,"")}catch(m){Bt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&eE(i,s),Ep(o,a);var c=Ep(o,s);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?sE(i,h):f==="dangerouslySetInnerHTML"?nE(i,h):f==="children"?Dc(i,h):Gm(i,f,h,c)}switch(o){case"input":vp(i,s);break;case"textarea":tE(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Bo(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?Bo(i,!!s.multiple,s.defaultValue,!0):Bo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wc]=s}catch(m){Bt(t,t.return,m)}}break;case 6:if(qn(e,t),fi(t),n&4){if(t.stateNode===null)throw Error(ve(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Bt(t,t.return,m)}}break;case 3:if(qn(e,t),fi(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Mc(e.containerInfo)}catch(m){Bt(t,t.return,m)}break;case 4:qn(e,t),fi(t);break;case 13:qn(e,t),fi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Sg=Gt())),n&4&&Z_(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(br=(c=br)||f,qn(e,t),br=c):qn(e,t),fi(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(Ce=t,f=t.child;f!==null;){for(h=Ce=f;Ce!==null;){switch(d=Ce,p=d.child,d.tag){case 0:case 11:case 14:case 15:gc(4,d,d.return);break;case 1:Oo(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(m){Bt(n,r,m)}}break;case 5:Oo(d,d.return);break;case 22:if(d.memoizedState!==null){tx(h);continue}}p!==null?(p.return=d,Ce=p):tx(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=iE("display",a))}catch(m){Bt(t,t.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Bt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:qn(e,t),fi(t),n&4&&Z_(t);break;case 21:break;default:qn(e,t),fi(t)}}function fi(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(P2(r)){var n=r;break e}r=r.return}throw Error(ve(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Dc(i,""),n.flags&=-33);var s=J_(t);Jp(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=J_(t);Qp(t,o,a);break;default:throw Error(ve(161))}}catch(l){Bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function W4(t,e,r){Ce=t,D2(t)}function D2(t,e,r){for(var n=(t.mode&1)!==0;Ce!==null;){var i=Ce,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||kf;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||br;o=kf;var c=br;if(kf=a,(br=l)&&!c)for(Ce=i;Ce!==null;)a=Ce,l=a.child,a.tag===22&&a.memoizedState!==null?rx(i):l!==null?(l.return=a,Ce=l):rx(i);for(;s!==null;)Ce=s,D2(s),s=s.sibling;Ce=i,kf=o,br=c}ex(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ce=s):ex(t)}}function ex(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:br||Eh(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!br)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Qn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&V_(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}V_(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Mc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}br||e.flags&512&&Yp(e)}catch(d){Bt(e,e.return,d)}}if(e===t){Ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function tx(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function rx(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Eh(4,e)}catch(l){Bt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Bt(e,i,l)}}var s=e.return;try{Yp(e)}catch(l){Bt(e,s,l)}break;case 5:var a=e.return;try{Yp(e)}catch(l){Bt(e,a,l)}}}catch(l){Bt(e,e.return,l)}if(e===t){Ce=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ce=o;break}Ce=e.return}}var H4=Math.ceil,P0=as.ReactCurrentDispatcher,Tg=as.ReactCurrentOwner,Wn=as.ReactCurrentBatchConfig,Ze=0,dr=null,er=null,Tr=0,_n=0,Lo=ra(0),ir=0,Xc=null,ba=0,Th=0,kg=0,vc=null,sn=null,Sg=0,sl=1/0,Li=null,F0=!1,Zp=null,Bs=null,Sf=!1,Rs=null,N0=0,_c=0,em=null,Zf=-1,e0=0;function Yr(){return Ze&6?Gt():Zf!==-1?Zf:Zf=Gt()}function Us(t){return t.mode&1?Ze&2&&Tr!==0?Tr&-Tr:A4.transition!==null?(e0===0&&(e0=vE()),e0):(t=ft,t!==0||(t=window.event,t=t===void 0?16:kE(t.type)),t):1}function ni(t,e,r,n){if(50<_c)throw _c=0,em=null,Error(ve(185));_u(t,r,n),(!(Ze&2)||t!==dr)&&(t===dr&&(!(Ze&2)&&(Th|=r),ir===4&&Ts(t,Tr)),hn(t,n),r===1&&Ze===0&&!(e.mode&1)&&(sl=Gt()+500,xh&&na()))}function hn(t,e){var r=t.callbackNode;AC(t,e);var n=m0(t,t===dr?Tr:0);if(n===0)r!==null&&f_(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&f_(r),e===1)t.tag===0?S4(nx.bind(null,t)):HE(nx.bind(null,t)),w4(function(){!(Ze&6)&&na()}),r=null;else{switch(_E(n)){case 1:r=Qm;break;case 4:r=mE;break;case 16:r=p0;break;case 536870912:r=gE;break;default:r=p0}r=j2(r,O2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function O2(t,e){if(Zf=-1,e0=0,Ze&6)throw Error(ve(327));var r=t.callbackNode;if(zo()&&t.callbackNode!==r)return null;var n=m0(t,t===dr?Tr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=D0(t,n);else{e=n;var i=Ze;Ze|=2;var s=b2();(dr!==t||Tr!==e)&&(Li=null,sl=Gt()+500,Sa(t,e));do try{G4();break}catch(o){L2(t,o)}while(!0);ug(),P0.current=s,Ze=i,er!==null?e=0:(dr=null,Tr=0,e=ir)}if(e!==0){if(e===2&&(i=Ip(t),i!==0&&(n=i,e=tm(t,i))),e===1)throw r=Xc,Sa(t,0),Ts(t,n),hn(t,Gt()),r;if(e===6)Ts(t,n);else{if(i=t.current.alternate,!(n&30)&&!z4(i)&&(e=D0(t,n),e===2&&(s=Ip(t),s!==0&&(n=s,e=tm(t,s))),e===1))throw r=Xc,Sa(t,0),Ts(t,n),hn(t,Gt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ve(345));case 2:va(t,sn,Li);break;case 3:if(Ts(t,n),(n&130023424)===n&&(e=Sg+500-Gt(),10<e)){if(m0(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Yr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Lp(va.bind(null,t,sn,Li),e);break}va(t,sn,Li);break;case 4:if(Ts(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ri(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Gt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*H4(n/1960))-n,10<n){t.timeoutHandle=Lp(va.bind(null,t,sn,Li),n);break}va(t,sn,Li);break;case 5:va(t,sn,Li);break;default:throw Error(ve(329))}}}return hn(t,Gt()),t.callbackNode===r?O2.bind(null,t):null}function tm(t,e){var r=vc;return t.current.memoizedState.isDehydrated&&(Sa(t,e).flags|=256),t=D0(t,e),t!==2&&(e=sn,sn=r,e!==null&&rm(e)),t}function rm(t){sn===null?sn=t:sn.push.apply(sn,t)}function z4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ai(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ts(t,e){for(e&=~kg,e&=~Th,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ri(e),n=1<<r;t[r]=-1,e&=~n}}function nx(t){if(Ze&6)throw Error(ve(327));zo();var e=m0(t,0);if(!(e&1))return hn(t,Gt()),null;var r=D0(t,e);if(t.tag!==0&&r===2){var n=Ip(t);n!==0&&(e=n,r=tm(t,n))}if(r===1)throw r=Xc,Sa(t,0),Ts(t,e),hn(t,Gt()),r;if(r===6)throw Error(ve(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,va(t,sn,Li),hn(t,Gt()),null}function Ag(t,e){var r=Ze;Ze|=1;try{return t(e)}finally{Ze=r,Ze===0&&(sl=Gt()+500,xh&&na())}}function Ma(t){Rs!==null&&Rs.tag===0&&!(Ze&6)&&zo();var e=Ze;Ze|=1;var r=Wn.transition,n=ft;try{if(Wn.transition=null,ft=1,t)return t()}finally{ft=n,Wn.transition=r,Ze=e,!(Ze&6)&&na()}}function Ig(){_n=Lo.current,Tt(Lo)}function Sa(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,y4(r)),er!==null)for(r=er.return;r!==null;){var n=r;switch(og(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&y0();break;case 3:nl(),Tt(un),Tt(Wr),gg();break;case 5:mg(n);break;case 4:nl();break;case 13:Tt(Pt);break;case 19:Tt(Pt);break;case 10:fg(n.type._context);break;case 22:case 23:Ig()}r=r.return}if(dr=t,er=t=js(t.current,null),Tr=_n=e,ir=0,Xc=null,kg=Th=ba=0,sn=vc=null,wa!==null){for(e=0;e<wa.length;e++)if(r=wa[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}wa=null}return t}function L2(t,e){do{var r=er;try{if(ug(),Yf.current=R0,C0){for(var n=Dt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}C0=!1}if(La=0,ur=rr=Dt=null,mc=!1,$c=0,Tg.current=null,r===null||r.return===null){ir=1,Xc=e,er=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Tr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=z_(a);if(p!==null){p.flags&=-257,$_(p,a,o,s,e),p.mode&1&&H_(s,c,e),e=p,l=c;var v=e.updateQueue;if(v===null){var m=new Set;m.add(l),e.updateQueue=m}else v.add(l);break e}else{if(!(e&1)){H_(s,c,e),Cg();break e}l=Error(ve(426))}}else if(It&&o.mode&1){var _=z_(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),$_(_,a,o,s,e),lg(il(l,o));break e}}s=l=il(l,o),ir!==4&&(ir=2),vc===null?vc=[s]:vc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=_2(s,l,e);M_(s,y);break e;case 1:o=l;var E=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Bs===null||!Bs.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var F=x2(s,o,e);M_(s,F);break e}}s=s.return}while(s!==null)}V2(r)}catch(U){e=U,er===r&&r!==null&&(er=r=r.return);continue}break}while(!0)}function b2(){var t=P0.current;return P0.current=R0,t===null?R0:t}function Cg(){(ir===0||ir===3||ir===2)&&(ir=4),dr===null||!(ba&268435455)&&!(Th&268435455)||Ts(dr,Tr)}function D0(t,e){var r=Ze;Ze|=2;var n=b2();(dr!==t||Tr!==e)&&(Li=null,Sa(t,e));do try{$4();break}catch(i){L2(t,i)}while(!0);if(ug(),Ze=r,P0.current=n,er!==null)throw Error(ve(261));return dr=null,Tr=0,ir}function $4(){for(;er!==null;)M2(er)}function G4(){for(;er!==null&&!vC();)M2(er)}function M2(t){var e=U2(t.alternate,t,_n);t.memoizedProps=t.pendingProps,e===null?V2(t):er=e,Tg.current=null}function V2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=B4(r,e),r!==null){r.flags&=32767,er=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ir=6,er=null;return}}else if(r=V4(r,e,_n),r!==null){er=r;return}if(e=e.sibling,e!==null){er=e;return}er=e=t}while(e!==null);ir===0&&(ir=5)}function va(t,e,r){var n=ft,i=Wn.transition;try{Wn.transition=null,ft=1,K4(t,e,r,n)}finally{Wn.transition=i,ft=n}return null}function K4(t,e,r,n){do zo();while(Rs!==null);if(Ze&6)throw Error(ve(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ve(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(IC(t,s),t===dr&&(er=dr=null,Tr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Sf||(Sf=!0,j2(p0,function(){return zo(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Wn.transition,Wn.transition=null;var a=ft;ft=1;var o=Ze;Ze|=4,Tg.current=null,j4(t,r),N2(r,t),d4(Dp),g0=!!Np,Dp=Np=null,t.current=r,W4(r),_C(),Ze=o,ft=a,Wn.transition=s}else t.current=r;if(Sf&&(Sf=!1,Rs=t,N0=i),s=t.pendingLanes,s===0&&(Bs=null),wC(r.stateNode),hn(t,Gt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(F0)throw F0=!1,t=Zp,Zp=null,t;return N0&1&&t.tag!==0&&zo(),s=t.pendingLanes,s&1?t===em?_c++:(_c=0,em=t):_c=0,na(),null}function zo(){if(Rs!==null){var t=_E(N0),e=Wn.transition,r=ft;try{if(Wn.transition=null,ft=16>t?16:t,Rs===null)var n=!1;else{if(t=Rs,Rs=null,N0=0,Ze&6)throw Error(ve(331));var i=Ze;for(Ze|=4,Ce=t.current;Ce!==null;){var s=Ce,a=s.child;if(Ce.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var f=Ce;switch(f.tag){case 0:case 11:case 15:gc(8,f,s)}var h=f.child;if(h!==null)h.return=f,Ce=h;else for(;Ce!==null;){f=Ce;var d=f.sibling,p=f.return;if(R2(f),f===c){Ce=null;break}if(d!==null){d.return=p,Ce=d;break}Ce=p}}}var v=s.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}Ce=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ce=a;else e:for(;Ce!==null;){if(s=Ce,s.flags&2048)switch(s.tag){case 0:case 11:case 15:gc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Ce=y;break e}Ce=s.return}}var E=t.current;for(Ce=E;Ce!==null;){a=Ce;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,Ce=x;else e:for(a=E;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Eh(9,o)}}catch(U){Bt(o,o.return,U)}if(o===a){Ce=null;break e}var F=o.sibling;if(F!==null){F.return=o.return,Ce=F;break e}Ce=o.return}}if(Ze=i,na(),xi&&typeof xi.onPostCommitFiberRoot=="function")try{xi.onPostCommitFiberRoot(ph,t)}catch{}n=!0}return n}finally{ft=r,Wn.transition=e}}return!1}function ix(t,e,r){e=il(r,e),e=_2(t,e,1),t=Vs(t,e,1),e=Yr(),t!==null&&(_u(t,1,e),hn(t,e))}function Bt(t,e,r){if(t.tag===3)ix(t,t,r);else for(;e!==null;){if(e.tag===3){ix(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Bs===null||!Bs.has(n))){t=il(r,t),t=x2(e,t,1),e=Vs(e,t,1),t=Yr(),e!==null&&(_u(e,1,t),hn(e,t));break}}e=e.return}}function X4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Yr(),t.pingedLanes|=t.suspendedLanes&r,dr===t&&(Tr&r)===r&&(ir===4||ir===3&&(Tr&130023424)===Tr&&500>Gt()-Sg?Sa(t,0):kg|=r),hn(t,e)}function B2(t,e){e===0&&(t.mode&1?(e=mf,mf<<=1,!(mf&130023424)&&(mf=4194304)):e=1);var r=Yr();t=Zi(t,e),t!==null&&(_u(t,e,r),hn(t,r))}function q4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),B2(t,r)}function Y4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ve(314))}n!==null&&n.delete(e),B2(t,r)}var U2;U2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||un.current)cn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return cn=!1,M4(t,e,r);cn=!!(t.flags&131072)}else cn=!1,It&&e.flags&1048576&&zE(e,T0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Jf(t,e),t=e.pendingProps;var i=el(e,Wr.current);Ho(e,r),i=_g(null,e,n,t,i,r);var s=xg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fn(n)?(s=!0,w0(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,dg(e),i.updater=wh,e.stateNode=i,i._reactInternals=e,Wp(e,n,t,r),e=$p(null,e,n,!0,s,r)):(e.tag=0,It&&s&&ag(e),Kr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Jf(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=J4(n),t=Qn(n,t),i){case 0:e=zp(null,e,n,t,r);break e;case 1:e=X_(null,e,n,t,r);break e;case 11:e=G_(null,e,n,t,r);break e;case 14:e=K_(null,e,n,Qn(n.type,t),r);break e}throw Error(ve(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),zp(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),X_(t,e,n,i,r);case 3:e:{if(T2(e),t===null)throw Error(ve(387));n=e.pendingProps,s=e.memoizedState,i=s.element,YE(t,e),A0(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=il(Error(ve(423)),e),e=q_(t,e,n,r,i);break e}else if(n!==i){i=il(Error(ve(424)),e),e=q_(t,e,n,r,i);break e}else for(Tn=Ms(e.stateNode.containerInfo.firstChild),Sn=e,It=!0,Zn=null,r=XE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(tl(),n===i){e=es(t,e,r);break e}Kr(t,e,n,r)}e=e.child}return e;case 5:return QE(e),t===null&&Bp(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Op(n,i)?a=null:s!==null&&Op(n,s)&&(e.flags|=32),E2(t,e),Kr(t,e,a,r),e.child;case 6:return t===null&&Bp(e),null;case 13:return k2(t,e,r);case 4:return pg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=rl(e,null,n,r):Kr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),G_(t,e,n,i,r);case 7:return Kr(t,e,e.pendingProps,r),e.child;case 8:return Kr(t,e,e.pendingProps.children,r),e.child;case 12:return Kr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,vt(k0,n._currentValue),n._currentValue=a,s!==null)if(ai(s.value,a)){if(s.children===i.children&&!un.current){e=es(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=$i(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Up(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ve(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Up(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Kr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Ho(e,r),i=zn(i),n=n(i),e.flags|=1,Kr(t,e,n,r),e.child;case 14:return n=e.type,i=Qn(n,e.pendingProps),i=Qn(n.type,i),K_(t,e,n,i,r);case 15:return y2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Qn(n,i),Jf(t,e),e.tag=1,fn(n)?(t=!0,w0(e)):t=!1,Ho(e,r),v2(e,n,i),Wp(e,n,i,r),$p(null,e,n,!0,t,r);case 19:return S2(t,e,r);case 22:return w2(t,e,r)}throw Error(ve(156,e.tag))};function j2(t,e){return pE(t,e)}function Q4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(t,e,r,n){return new Q4(t,e,r,n)}function Rg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function J4(t){if(typeof t=="function")return Rg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xm)return 11;if(t===qm)return 14}return 2}function js(t,e){var r=t.alternate;return r===null?(r=jn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function t0(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")Rg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case So:return Aa(r.children,i,s,e);case Km:a=8,i|=8;break;case hp:return t=jn(12,r,e,i|2),t.elementType=hp,t.lanes=s,t;case dp:return t=jn(13,r,e,i),t.elementType=dp,t.lanes=s,t;case pp:return t=jn(19,r,e,i),t.elementType=pp,t.lanes=s,t;case Qw:return kh(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case qw:a=10;break e;case Yw:a=9;break e;case Xm:a=11;break e;case qm:a=14;break e;case ys:a=16,n=null;break e}throw Error(ve(130,t==null?t:typeof t,""))}return e=jn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Aa(t,e,r,n){return t=jn(7,t,n,e),t.lanes=r,t}function kh(t,e,r,n){return t=jn(22,t,n,e),t.elementType=Qw,t.lanes=r,t.stateNode={isHidden:!1},t}function Md(t,e,r){return t=jn(6,t,null,e),t.lanes=r,t}function Vd(t,e,r){return e=jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Z4(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_d(0),this.expirationTimes=_d(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_d(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pg(t,e,r,n,i,s,a,o,l){return t=new Z4(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=jn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dg(s),t}function eR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ko,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function W2(t){if(!t)return Ks;t=t._reactInternals;e:{if(Qa(t)!==t||t.tag!==1)throw Error(ve(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ve(171))}if(t.tag===1){var r=t.type;if(fn(r))return WE(t,r,e)}return e}function H2(t,e,r,n,i,s,a,o,l){return t=Pg(r,n,!0,t,i,s,a,o,l),t.context=W2(null),r=t.current,n=Yr(),i=Us(r),s=$i(n,i),s.callback=e??null,Vs(r,s,i),t.current.lanes=i,_u(t,i,n),hn(t,n),t}function Sh(t,e,r,n){var i=e.current,s=Yr(),a=Us(i);return r=W2(r),e.context===null?e.context=r:e.pendingContext=r,e=$i(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Vs(i,e,a),t!==null&&(ni(t,i,a,s),qf(t,i,a)),a}function O0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Fg(t,e){sx(t,e),(t=t.alternate)&&sx(t,e)}function tR(){return null}var z2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ng(t){this._internalRoot=t}Ah.prototype.render=Ng.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ve(409));Sh(t,e,null,null)};Ah.prototype.unmount=Ng.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ma(function(){Sh(null,t,null,null)}),e[Ji]=null}};function Ah(t){this._internalRoot=t}Ah.prototype.unstable_scheduleHydration=function(t){if(t){var e=wE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Es.length&&e!==0&&e<Es[r].priority;r++);Es.splice(r,0,t),r===0&&TE(t)}};function Dg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ih(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ax(){}function rR(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=O0(a);s.call(c)}}var a=H2(e,n,t,0,null,!1,!1,"",ax);return t._reactRootContainer=a,t[Ji]=a.current,Uc(t.nodeType===8?t.parentNode:t),Ma(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=O0(l);o.call(c)}}var l=Pg(t,0,!1,null,null,!1,!1,"",ax);return t._reactRootContainer=l,t[Ji]=l.current,Uc(t.nodeType===8?t.parentNode:t),Ma(function(){Sh(e,l,r,n)}),l}function Ch(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=O0(a);o.call(l)}}Sh(e,a,t,i)}else a=rR(r,e,t,i,n);return O0(a)}xE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Jl(e.pendingLanes);r!==0&&(Jm(e,r|1),hn(e,Gt()),!(Ze&6)&&(sl=Gt()+500,na()))}break;case 13:Ma(function(){var n=Zi(t,1);if(n!==null){var i=Yr();ni(n,t,1,i)}}),Fg(t,1)}};Zm=function(t){if(t.tag===13){var e=Zi(t,134217728);if(e!==null){var r=Yr();ni(e,t,134217728,r)}Fg(t,134217728)}};yE=function(t){if(t.tag===13){var e=Us(t),r=Zi(t,e);if(r!==null){var n=Yr();ni(r,t,e,n)}Fg(t,e)}};wE=function(){return ft};EE=function(t,e){var r=ft;try{return ft=t,e()}finally{ft=r}};kp=function(t,e,r){switch(e){case"input":if(vp(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=_h(n);if(!i)throw Error(ve(90));Zw(n),vp(n,i)}}}break;case"textarea":tE(t,r);break;case"select":e=r.value,e!=null&&Bo(t,!!r.multiple,e,!1)}};lE=Ag;cE=Ma;var nR={usingClientEntryPoint:!1,Events:[yu,Ro,_h,aE,oE,Ag]},Kl={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iR={bundleType:Kl.bundleType,version:Kl.version,rendererPackageName:Kl.rendererPackageName,rendererConfig:Kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:as.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=hE(t),t===null?null:t.stateNode},findFiberByHostInstance:Kl.findFiberByHostInstance||tR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Af=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Af.isDisabled&&Af.supportsFiber)try{ph=Af.inject(iR),xi=Af}catch{}}Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nR;Cn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dg(e))throw Error(ve(200));return eR(t,e,null,r)};Cn.createRoot=function(t,e){if(!Dg(t))throw Error(ve(299));var r=!1,n="",i=z2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pg(t,1,!1,null,null,r,!1,n,i),t[Ji]=e.current,Uc(t.nodeType===8?t.parentNode:t),new Ng(e)};Cn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ve(188)):(t=Object.keys(t).join(","),Error(ve(268,t)));return t=hE(e),t=t===null?null:t.stateNode,t};Cn.flushSync=function(t){return Ma(t)};Cn.hydrate=function(t,e,r){if(!Ih(e))throw Error(ve(200));return Ch(null,t,e,!0,r)};Cn.hydrateRoot=function(t,e,r){if(!Dg(t))throw Error(ve(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=z2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=H2(e,null,t,1,r??null,i,!1,s,a),t[Ji]=e.current,Uc(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Ah(e)};Cn.render=function(t,e,r){if(!Ih(e))throw Error(ve(200));return Ch(null,t,e,!1,r)};Cn.unmountComponentAtNode=function(t){if(!Ih(t))throw Error(ve(40));return t._reactRootContainer?(Ma(function(){Ch(null,null,t,!1,function(){t._reactRootContainer=null,t[Ji]=null})}),!0):!1};Cn.unstable_batchedUpdates=Ag;Cn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ih(r))throw Error(ve(200));if(t==null||t._reactInternals===void 0)throw Error(ve(38));return Ch(t,e,r,!1,n)};Cn.version="18.3.1-next-f1338f8080-20240426";function $2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($2)}catch(t){console.error(t)}}$2(),$w.exports=Cn;var sR=$w.exports,G2,ox=sR;G2=ox.createRoot,ox.hydrateRoot;var lx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},aR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},X2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),n.push(r[f],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(K2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):aR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new oR;const d=s<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const v=c<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class oR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lR=function(t){const e=K2(t);return X2.encodeByteArray(e,!0)},L0=function(t){return lR(t).replace(/\./g,"")},q2=function(t){try{return X2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR=()=>cR().__FIREBASE_DEFAULTS__,fR=()=>{if(typeof process>"u"||typeof lx>"u")return;const t=lx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},hR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&q2(t[1]);return e&&JSON.parse(e)},Rh=()=>{try{return uR()||fR()||hR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Y2=t=>{var e,r;return(r=(e=Rh())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},dR=t=>{const e=Y2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Q2=()=>{var t;return(t=Rh())===null||t===void 0?void 0:t.config},J2=t=>{var e;return(e=Rh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[L0(JSON.stringify(r)),L0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hr())}function vR(){var t;const e=(t=Rh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _R(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function xR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function yR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wR(){const t=Hr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ER(){return!vR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function TR(){try{return typeof indexedDB=="object"}catch{return!1}}function kR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR="FirebaseError";class os extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=SR,Object.setPrototypeOf(this,os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Eu.prototype.create)}}class Eu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?AR(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new os(i,o,n)}}function AR(t,e){return t.replace(IR,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const IR=/\{\$([^}]+)}/g;function CR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function b0(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(cx(s)&&cx(a)){if(!b0(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function cx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ec(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function tc(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function RR(t,e){const r=new PR(t,e);return r.subscribe.bind(r)}class PR{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");FR(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Bd),i.error===void 0&&(i.error=Bd),i.complete===void 0&&(i.complete=Bd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Bd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(t){return t&&t._delegate?t._delegate:t}class Va{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new pR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OR(e))try{this.getOrInitializeService({instanceIdentifier:_a})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=_a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_a){return this.instances.has(e)}getOptions(e=_a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:DR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=_a){return this.component?this.component.multipleInstances?e:_a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DR(t){return t===_a?void 0:t}function OR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new NR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Qe||(Qe={}));const bR={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},MR=Qe.INFO,VR={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},BR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=VR[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Og{constructor(e){this.name=e,this._logLevel=MR,this._logHandler=BR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const UR=(t,e)=>e.some(r=>t instanceof r);let ux,fx;function jR(){return ux||(ux=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WR(){return fx||(fx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Z2=new WeakMap,nm=new WeakMap,eT=new WeakMap,Ud=new WeakMap,Lg=new WeakMap;function HR(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Ws(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Z2.set(r,t)}).catch(()=>{}),Lg.set(e,t),e}function zR(t){if(nm.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});nm.set(t,e)}let im={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return nm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||eT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ws(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $R(t){im=t(im)}function GR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(jd(this),e,...r);return eT.set(n,e.sort?e.sort():[e]),Ws(n)}:WR().includes(t)?function(...e){return t.apply(jd(this),e),Ws(Z2.get(this))}:function(...e){return Ws(t.apply(jd(this),e))}}function KR(t){return typeof t=="function"?GR(t):(t instanceof IDBTransaction&&zR(t),UR(t,jR())?new Proxy(t,im):t)}function Ws(t){if(t instanceof IDBRequest)return HR(t);if(Ud.has(t))return Ud.get(t);const e=KR(t);return e!==t&&(Ud.set(t,e),Lg.set(e,t)),e}const jd=t=>Lg.get(t);function XR(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Ws(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Ws(a.result),l.oldVersion,l.newVersion,Ws(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const qR=["get","getKey","getAll","getAllKeys","count"],YR=["put","add","delete","clear"],Wd=new Map;function hx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wd.get(e))return Wd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=YR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||qR.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Wd.set(e,s),s}$R(t=>({...t,get:(e,r,n)=>hx(e,r)||t.get(e,r,n),has:(e,r)=>!!hx(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(JR(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function JR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sm="@firebase/app",dx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=new Og("@firebase/app"),ZR="@firebase/app-compat",eP="@firebase/analytics-compat",tP="@firebase/analytics",rP="@firebase/app-check-compat",nP="@firebase/app-check",iP="@firebase/auth",sP="@firebase/auth-compat",aP="@firebase/database",oP="@firebase/data-connect",lP="@firebase/database-compat",cP="@firebase/functions",uP="@firebase/functions-compat",fP="@firebase/installations",hP="@firebase/installations-compat",dP="@firebase/messaging",pP="@firebase/messaging-compat",mP="@firebase/performance",gP="@firebase/performance-compat",vP="@firebase/remote-config",_P="@firebase/remote-config-compat",xP="@firebase/storage",yP="@firebase/storage-compat",wP="@firebase/firestore",EP="@firebase/vertexai-preview",TP="@firebase/firestore-compat",kP="firebase",SP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am="[DEFAULT]",AP={[sm]:"fire-core",[ZR]:"fire-core-compat",[tP]:"fire-analytics",[eP]:"fire-analytics-compat",[nP]:"fire-app-check",[rP]:"fire-app-check-compat",[iP]:"fire-auth",[sP]:"fire-auth-compat",[aP]:"fire-rtdb",[oP]:"fire-data-connect",[lP]:"fire-rtdb-compat",[cP]:"fire-fn",[uP]:"fire-fn-compat",[fP]:"fire-iid",[hP]:"fire-iid-compat",[dP]:"fire-fcm",[pP]:"fire-fcm-compat",[mP]:"fire-perf",[gP]:"fire-perf-compat",[vP]:"fire-rc",[_P]:"fire-rc-compat",[xP]:"fire-gcs",[yP]:"fire-gcs-compat",[wP]:"fire-fst",[TP]:"fire-fst-compat",[EP]:"fire-vertex","fire-js":"fire-js",[kP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al=new Map,om=new Map,lm=new Map;function px(t,e){try{t.container.addComponent(e)}catch(r){ts.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ol(t){const e=t.name;if(lm.has(e))return ts.debug(`There were multiple attempts to register component ${e}.`),!1;lm.set(e,t);for(const r of al.values())px(r,t);for(const r of om.values())px(r,t);return!0}function bg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function vi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hs=new Eu("app","Firebase",IP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const El=SP;function Mg(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:am,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Hs.create("bad-app-name",{appName:String(i)});if(r||(r=Q2()),!r)throw Hs.create("no-options");const s=al.get(i);if(s){if(b0(r,s.options)&&b0(n,s.config))return s;throw Hs.create("duplicate-app",{appName:i})}const a=new LR(i);for(const l of lm.values())a.addComponent(l);const o=new CP(r,n,a);return al.set(i,o),o}function Vg(t=am){const e=al.get(t);if(!e&&t===am&&Q2())return Mg();if(!e)throw Hs.create("no-app",{appName:t});return e}async function RP(t){let e=!1;const r=t.name;al.has(r)?(e=!0,al.delete(r)):om.has(r)&&t.decRefCount()<=0&&(om.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function zs(t,e,r){var n;let i=(n=AP[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ts.warn(o.join(" "));return}ol(new Va(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP="firebase-heartbeat-database",FP=1,qc="firebase-heartbeat-store";let Hd=null;function tT(){return Hd||(Hd=XR(PP,FP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Hs.create("idb-open",{originalErrorMessage:t.message})})),Hd}async function NP(t){try{const r=(await tT()).transaction(qc),n=await r.objectStore(qc).get(rT(t));return await r.done,n}catch(e){if(e instanceof os)ts.warn(e.message);else{const r=Hs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ts.warn(r.message)}}}async function mx(t,e){try{const n=(await tT()).transaction(qc,"readwrite");await n.objectStore(qc).put(e,rT(t)),await n.done}catch(r){if(r instanceof os)ts.warn(r.message);else{const n=Hs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ts.warn(n.message)}}}function rT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=1024,OP=30*24*60*60*1e3;class LP{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new MP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=OP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ts.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=gx(),{heartbeatsToSend:n,unsentEntries:i}=bP(this._heartbeatsCache.heartbeats),s=L0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ts.warn(r),""}}}function gx(){return new Date().toISOString().substring(0,10)}function bP(t,e=DP){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),vx(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),vx(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class MP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return TR()?kR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await NP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return mx(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return mx(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function vx(t){return L0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VP(t){ol(new Va("platform-logger",e=>new QR(e),"PRIVATE")),ol(new Va("heartbeat",e=>new LP(e),"PRIVATE")),zs(sm,dx,t),zs(sm,dx,"esm2017"),zs("fire-js","")}VP("");var BP="firebase",UP="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zs(BP,UP,"app");function Bg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function nT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jP=nT,iT=new Eu("auth","Firebase",nT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=new Og("@firebase/auth");function WP(t,...e){M0.logLevel<=Qe.WARN&&M0.warn(`Auth (${El}): ${t}`,...e)}function r0(t,...e){M0.logLevel<=Qe.ERROR&&M0.error(`Auth (${El}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t,...e){throw Ug(t,...e)}function wi(t,...e){return Ug(t,...e)}function sT(t,e,r){const n=Object.assign(Object.assign({},jP()),{[e]:r});return new Eu("auth","Firebase",n).create(e,{appName:t.name})}function Gi(t){return sT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ug(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return iT.create(t,...e)}function be(t,e,...r){if(!t)throw Ug(e,...r)}function Bi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw r0(e),new Error(e)}function rs(t,e){t||Bi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function HP(){return _x()==="http:"||_x()==="https:"}function _x(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HP()||xR()||"connection"in navigator)?navigator.onLine:!0}function $P(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,r){this.shortDelay=e,this.longDelay=r,rs(r>e,"Short delay should be less than long delay!"),this.isMobile=gR()||yR()}get(){return zP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(t,e){rs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=new ku(3e4,6e4);function ls(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ii(t,e,r,n,i={}){return oT(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Tu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return _R()||(c.referrerPolicy="no-referrer"),aT.fetch()(lT(t,t.config.apiHost,r,o),c)})}async function oT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},GP),e);try{const i=new qP(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw If(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw If(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw If(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw If(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw sT(t,f,c);oi(t,f)}}catch(i){if(i instanceof os)throw i;oi(t,"network-request-failed",{message:String(i)})}}async function Su(t,e,r,n,i={}){const s=await Ii(t,e,r,n,i);return"mfaPendingCredential"in s&&oi(t,"multi-factor-auth-required",{_serverResponse:s}),s}function lT(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?jg(t.config,i):`${t.config.apiScheme}://${i}`}function XP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qP{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(wi(this.auth,"network-request-failed")),KP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function If(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=wi(t,e,n);return i.customData._tokenResponse=r,i}function xx(t){return t!==void 0&&t.enterprise!==void 0}class YP{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return XP(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function QP(t,e){return Ii(t,"GET","/v2/recaptchaConfig",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JP(t,e){return Ii(t,"POST","/v1/accounts:delete",e)}async function cT(t,e){return Ii(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZP(t,e=!1){const r=Lt(t),n=await r.getIdToken(e),i=Wg(n);be(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:xc(zd(i.auth_time)),issuedAtTime:xc(zd(i.iat)),expirationTime:xc(zd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function zd(t){return Number(t)*1e3}function Wg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return r0("JWT malformed, contained fewer than 3 sections"),null;try{const i=q2(r);return i?JSON.parse(i):(r0("Failed to decode base64 JWT payload"),null)}catch(i){return r0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function yx(t){const e=Wg(t);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ll(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof os&&eF(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function eF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=xc(this.lastLoginAt),this.creationTime=xc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V0(t){var e;const r=t.auth,n=await t.getIdToken(),i=await ll(t,cT(r,{idToken:n}));be(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?uT(s.providerUserInfo):[],o=nF(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new um(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,h)}async function rF(t){const e=Lt(t);await V0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nF(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function uT(t){return t.map(e=>{var{providerId:r}=e,n=Bg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iF(t,e){const r=await oT(t,{},async()=>{const n=Tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=lT(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",aT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function sF(t,e){return Ii(t,"POST","/v2/accounts:revokeToken",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){be(e.length!==0,"internal-error");const r=yx(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await iF(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new $o;return n&&(be(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(be(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(be(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $o,this.toJSON())}_performRefresh(){return Bi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t,e){be(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ui{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Bg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new um(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await ll(this,this.stsTokenManager.getToken(this.auth,e));return be(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return ZP(this,e)}reload(){return rF(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ui(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await V0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vi(this.auth.app))return Promise.reject(Gi(this.auth));const e=await this.getIdToken();return await ll(this,JP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,f;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=r.createdAt)!==null&&c!==void 0?c:void 0,E=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:x,emailVerified:F,isAnonymous:U,providerData:b,stsTokenManager:w}=r;be(x&&w,e,"internal-error");const k=$o.fromJSON(this.name,w);be(typeof x=="string",e,"internal-error"),vs(h,e.name),vs(d,e.name),be(typeof F=="boolean",e,"internal-error"),be(typeof U=="boolean",e,"internal-error"),vs(p,e.name),vs(v,e.name),vs(m,e.name),vs(_,e.name),vs(y,e.name),vs(E,e.name);const S=new Ui({uid:x,auth:e,email:d,emailVerified:F,displayName:h,isAnonymous:U,photoURL:v,phoneNumber:p,tenantId:m,stsTokenManager:k,createdAt:y,lastLoginAt:E});return b&&Array.isArray(b)&&(S.providerData=b.map(C=>Object.assign({},C))),_&&(S._redirectEventId=_),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new $o;i.updateFromServerResponse(r);const s=new Ui({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await V0(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];be(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?uT(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new $o;o.updateFromIdToken(n);const l=new Ui({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new um(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx=new Map;function ji(t){rs(t instanceof Function,"Expected a class definition");let e=wx.get(t);return e?(rs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,wx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}fT.type="NONE";const Ex=fT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(t,e,r){return`firebase:${t}:${e}:${r}`}class Go{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=n0(this.userKey,i.apiKey,s),this.fullPersistenceKey=n0("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ui._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Go(ji(Ex),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ji(Ex);const a=n0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(a);if(f){const h=Ui._fromJSON(e,f);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Go(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Go(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(mT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vT(e))return"Blackberry";if(_T(e))return"Webos";if(dT(e))return"Safari";if((e.includes("chrome/")||pT(e))&&!e.includes("edge/"))return"Chrome";if(gT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function hT(t=Hr()){return/firefox\//i.test(t)}function dT(t=Hr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pT(t=Hr()){return/crios\//i.test(t)}function mT(t=Hr()){return/iemobile/i.test(t)}function gT(t=Hr()){return/android/i.test(t)}function vT(t=Hr()){return/blackberry/i.test(t)}function _T(t=Hr()){return/webos/i.test(t)}function Hg(t=Hr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aF(t=Hr()){var e;return Hg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function oF(){return wR()&&document.documentMode===10}function xT(t=Hr()){return Hg(t)||gT(t)||_T(t)||vT(t)||/windows phone/i.test(t)||mT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yT(t,e=[]){let r;switch(t){case"Browser":r=Tx(Hr());break;case"Worker":r=`${Tx(Hr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${El}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cF(t,e={}){return Ii(t,"GET","/v2/passwordPolicy",ls(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF=6;class fF{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:uF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kx(this),this.idTokenSubscription=new kx(this),this.beforeStateQueue=new lF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ji(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await cT(this,{idToken:e}),n=await Ui._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(vi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await V0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$P()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vi(this.app))return Promise.reject(Gi(this));const r=e?Lt(e):null;return r&&be(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vi(this.app)?Promise.reject(Gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vi(this.app)?Promise.reject(Gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ji(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await cF(this),r=new fF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Eu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await sF(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ji(e)||this._popupRedirectResolver;be(r,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[ji(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&WP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ia(t){return Lt(t)}class kx{constructor(e){this.auth=e,this.observer=null,this.addObserver=RR(r=>this.observer=r)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ph={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dF(t){Ph=t}function wT(t){return Ph.loadJS(t)}function pF(){return Ph.recaptchaEnterpriseScript}function mF(){return Ph.gapiScript}function gF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const vF="recaptcha-enterprise",_F="NO_RECAPTCHA";class xF{constructor(e){this.type=vF,this.auth=ia(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{QP(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new YP(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;xx(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{a(c)}).catch(()=>{a(_F)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&xx(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=pF();l.length!==0&&(l+=o),wT(l).then(()=>{i(o,s,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function Sx(t,e,r,n=!1){const i=new xF(t);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},e);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function B0(t,e,r,n){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Sx(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Sx(t,e,r,r==="getOobCode");return n(t,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t,e){const r=bg(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(b0(s,e??{}))return i;oi(i,"already-initialized")}return r.initialize({options:e})}function wF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ji);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function EF(t,e,r){const n=ia(t);be(n._canInitEmulator,n,"emulator-config-failed"),be(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=ET(e),{host:a,port:o}=TF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),kF()}function ET(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function TF(t){const e=ET(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:Ax(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Ax(a)}}}function Ax(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Bi("not implemented")}_getIdTokenResponse(e){return Bi("not implemented")}_linkToIdToken(e,r){return Bi("not implemented")}_getReauthenticationResolver(e){return Bi("not implemented")}}async function SF(t,e){return Ii(t,"POST","/v1/accounts:update",e)}async function AF(t,e){return Ii(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IF(t,e){return Su(t,"POST","/v1/accounts:signInWithPassword",ls(t,e))}async function CF(t,e){return Ii(t,"POST","/v1/accounts:sendOobCode",ls(t,e))}async function RF(t,e){return CF(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PF(t,e){return Su(t,"POST","/v1/accounts:signInWithEmailLink",ls(t,e))}async function FF(t,e){return Su(t,"POST","/v1/accounts:signInWithEmailLink",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc extends zg{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Yc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Yc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return B0(e,r,"signInWithPassword",IF);case"emailLink":return PF(e,{email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return B0(e,n,"signUpPassword",AF);case"emailLink":return FF(e,{idToken:r,email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(t,e){return Su(t,"POST","/v1/accounts:signInWithIdp",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF="http://localhost";class Ba extends zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Ba(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):oi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Bg(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Ba(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Ko(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ko(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ko(e,r)}buildRequest(){const e={requestUri:NF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Tu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function OF(t){const e=ec(tc(t)).link,r=e?ec(tc(e)).deep_link_id:null,n=ec(tc(t)).deep_link_id;return(n?ec(tc(n)).link:null)||n||r||e||t}class $g{constructor(e){var r,n,i,s,a,o;const l=ec(tc(e)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,f=(n=l.oobCode)!==null&&n!==void 0?n:null,h=DF((i=l.mode)!==null&&i!==void 0?i:null);be(c&&f&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=f,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const r=OF(e);try{return new $g(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(){this.providerId=Ja.PROVIDER_ID}static credential(e,r){return Yc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=$g.parseLink(r);return be(n,"argument-error"),Yc._fromEmailAndCode(e,n.code,n.tenantId)}}Ja.PROVIDER_ID="password";Ja.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ja.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au extends TT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends Au{constructor(){super("facebook.com")}static credential(e){return Ba._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.FACEBOOK_SIGN_IN_METHOD="facebook.com";ks.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends Au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ba._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Ss.credential(r,n)}catch{return null}}}Ss.GOOGLE_SIGN_IN_METHOD="google.com";Ss.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Au{constructor(){super("github.com")}static credential(e){return Ba._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.GITHUB_SIGN_IN_METHOD="github.com";As.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Au{constructor(){super("twitter.com")}static credential(e,r){return Ba._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Is.credential(r,n)}catch{return null}}}Is.TWITTER_SIGN_IN_METHOD="twitter.com";Is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LF(t,e){return Su(t,"POST","/v1/accounts:signUp",ls(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Ui._fromIdTokenResponse(e,n,i),a=Ix(n);return new Ua({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Ix(n);return new Ua({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Ix(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0 extends os{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,U0.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new U0(e,r,n,i)}}function kT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?U0._fromErrorAndOperation(t,s,e,n):s})}async function bF(t,e,r=!1){const n=await ll(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ua._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ST(t,e,r=!1){const{auth:n}=t;if(vi(n.app))return Promise.reject(Gi(n));const i="reauthenticate";try{const s=await ll(t,kT(n,i,e,t),r);be(s.idToken,n,"internal-error");const a=Wg(s.idToken);be(a,n,"internal-error");const{sub:o}=a;return be(t.uid===o,n,"user-mismatch"),Ua._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&oi(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AT(t,e,r=!1){if(vi(t.app))return Promise.reject(Gi(t));const n="signIn",i=await kT(t,n,e),s=await Ua._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}async function MF(t,e){return AT(ia(t),e)}async function VF(t,e){return ST(Lt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IT(t){const e=ia(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function BF(t,e,r){const n=ia(t);await B0(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",RF)}async function UF(t,e,r){if(vi(t.app))return Promise.reject(Gi(t));const n=ia(t),a=await B0(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",LF).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&IT(t),l}),o=await Ua._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function jF(t,e,r){return vi(t.app)?Promise.reject(Gi(t)):MF(Lt(t),Ja.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&IT(t),n})}function WF(t,e){return HF(Lt(t),null,e)}async function HF(t,e,r){const{auth:n}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};r&&(s.password=r);const a=await ll(t,SF(n,s));await t._updateTokensIfNecessary(a,!0)}function zF(t,e,r,n){return Lt(t).onIdTokenChanged(e,r,n)}function $F(t,e,r){return Lt(t).beforeAuthStateChanged(e,r)}function GF(t,e,r,n){return Lt(t).onAuthStateChanged(e,r,n)}function fm(t){return Lt(t).signOut()}const j0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(j0,"1"),this.storage.removeItem(j0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=1e3,XF=10;class RT extends CT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);oF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,XF):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},KF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}RT.type="LOCAL";const qF=RT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT extends CT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}PT.type="SESSION";const FT=PT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Fh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await YF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Gg("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(){return window}function JF(t){Ei().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(){return typeof Ei().WorkerGlobalScope<"u"&&typeof Ei().importScripts=="function"}async function ZF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function e3(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function t3(){return NT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="firebaseLocalStorageDb",r3=1,W0="firebaseLocalStorage",OT="fbase_key";class Iu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Nh(t,e){return t.transaction([W0],e?"readwrite":"readonly").objectStore(W0)}function n3(){const t=indexedDB.deleteDatabase(DT);return new Iu(t).toPromise()}function hm(){const t=indexedDB.open(DT,r3);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(W0,{keyPath:OT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(W0)?e(n):(n.close(),await n3(),e(await hm()))})})}async function Cx(t,e,r){const n=Nh(t,!0).put({[OT]:e,value:r});return new Iu(n).toPromise()}async function i3(t,e){const r=Nh(t,!1).get(e),n=await new Iu(r).toPromise();return n===void 0?null:n.value}function Rx(t,e){const r=Nh(t,!0).delete(e);return new Iu(r).toPromise()}const s3=800,a3=3;class LT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>a3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fh._getInstance(t3()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await ZF(),!this.activeServiceWorker)return;this.sender=new QF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||e3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hm();return await Cx(e,j0,"1"),await Rx(e,j0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Cx(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>i3(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Rx(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Nh(i,!1).getAll();return new Iu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),s3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LT.type="LOCAL";const o3=LT;new ku(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l3(t,e){return e?ji(e):(be(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg extends zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ko(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ko(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ko(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function c3(t){return AT(t.auth,new Kg(t),t.bypassAuthState)}function u3(t){const{auth:e,user:r}=t;return be(r,e,"internal-error"),ST(r,new Kg(t),t.bypassAuthState)}async function f3(t){const{auth:e,user:r}=t;return be(r,e,"internal-error"),bF(r,new Kg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return c3;case"linkViaPopup":case"linkViaRedirect":return f3;case"reauthViaPopup":case"reauthViaRedirect":return u3;default:oi(this.auth,"internal-error")}}resolve(e){rs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=new ku(2e3,1e4);class bo extends bT{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,bo.currentPopupAction&&bo.currentPopupAction.cancel(),bo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){rs(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(wi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(wi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,h3.get())};e()}}bo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3="pendingRedirect",i0=new Map;class p3 extends bT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=i0.get(this.auth._key());if(!e){try{const n=await m3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}i0.set(this.auth._key(),e)}return this.bypassAuthState||i0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function m3(t,e){const r=_3(e),n=v3(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function g3(t,e){i0.set(t._key(),e)}function v3(t){return ji(t._redirectPersistence)}function _3(t){return n0(d3,t.config.apiKey,t.name)}async function x3(t,e,r=!1){if(vi(t.app))return Promise.reject(Gi(t));const n=ia(t),i=l3(n,e),a=await new p3(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3=10*60*1e3;class w3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!E3(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!MT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(wi(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=y3&&this.cachedEventUids.clear(),this.cachedEventUids.has(Px(e))}saveEventToCache(e){this.cachedEventUids.add(Px(e)),this.lastProcessedEventTime=Date.now()}}function Px(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function MT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function E3(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T3(t,e={}){return Ii(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,S3=/^https?/;async function A3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await T3(t);for(const r of e)try{if(I3(r))return}catch{}oi(t,"unauthorized-domain")}function I3(t){const e=cm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!S3.test(r))return!1;if(k3.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3=new ku(3e4,6e4);function Fx(){const t=Ei().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function R3(t){return new Promise((e,r)=>{var n,i,s;function a(){Fx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fx(),r(wi(t,"network-request-failed"))},timeout:C3.get()})}if(!((i=(n=Ei().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ei().gapi)===null||s===void 0)&&s.load)a();else{const o=gF("iframefcb");return Ei()[o]=()=>{gapi.load?a():r(wi(t,"network-request-failed"))},wT(`${mF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw s0=null,e})}let s0=null;function P3(t){return s0=s0||R3(t),s0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F3=new ku(5e3,15e3),N3="__/auth/iframe",D3="emulator/auth/iframe",O3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b3(t){const e=t.config;be(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?jg(e,D3):`https://${t.config.authDomain}/${N3}`,n={apiKey:e.apiKey,appName:t.name,v:El},i=L3.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Tu(n).slice(1)}`}async function M3(t){const e=await P3(t),r=Ei().gapi;return be(r,t,"internal-error"),e.open({where:document.body,url:b3(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:O3,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=wi(t,"network-request-failed"),o=Ei().setTimeout(()=>{s(a)},F3.get());function l(){Ei().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B3=500,U3=600,j3="_blank",W3="http://localhost";class Nx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function H3(t,e,r,n=B3,i=U3){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},V3),{width:n.toString(),height:i.toString(),top:s,left:a}),c=Hr().toLowerCase();r&&(o=pT(c)?j3:r),hT(c)&&(e=e||W3,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[p,v])=>`${d}${p}=${v},`,"");if(aF(c)&&o!=="_self")return z3(e||"",o),new Nx(null);const h=window.open(e||"",o,f);be(h,t,"popup-blocked");try{h.focus()}catch{}return new Nx(h)}function z3(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3="__/auth/handler",G3="emulator/auth/handler",K3=encodeURIComponent("fac");async function Dx(t,e,r,n,i,s){be(t.config.authDomain,t,"auth-domain-config-required"),be(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:El,eventId:i};if(e instanceof TT){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",CR(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof Au){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${K3}=${encodeURIComponent(l)}`:"";return`${X3(t)}?${Tu(o).slice(1)}${c}`}function X3({config:t}){return t.emulator?jg(t,G3):`https://${t.authDomain}/${$3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d="webStorageSupport";class q3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=FT,this._completeRedirectFn=x3,this._overrideRedirectResult=g3}async _openPopup(e,r,n,i){var s;rs((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Dx(e,r,n,cm(),i);return H3(e,a,Gg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await Dx(e,r,n,cm(),i);return JF(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(rs(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await M3(e),n=new w3(e);return r.register("authEvent",i=>(be(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send($d,{type:$d},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[$d];a!==void 0&&r(!!a),oi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=A3(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return xT()||dT()||Hg()}}const Y3=q3;var Ox="@firebase/auth",Lx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Z3(t){ol(new Va("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;be(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yT(t)},c=new hF(n,i,s,l);return wF(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ol(new Va("auth-internal",e=>{const r=ia(e.getProvider("auth").getImmediate());return(n=>new Q3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),zs(Ox,Lx,J3(t)),zs(Ox,Lx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN=5*60,tN=J2("authIdTokenMaxAge")||eN;let bx=null;const rN=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>tN)return;const i=r==null?void 0:r.token;bx!==i&&(bx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function VT(t=Vg()){const e=bg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=yF(t,{popupRedirectResolver:Y3,persistence:[o3,qF,FT]}),n=J2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=rN(s.toString());$F(r,a,()=>a(r.currentUser)),zF(r,o=>a(o))}}const i=Y2("auth");return i&&EF(r,`http://${i}`),r}function nN(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}dF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=wi("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",nN().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Z3("Browser");var Mx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ia,BT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,k){function S(){}S.prototype=k.prototype,w.D=k.prototype,w.prototype=new S,w.prototype.constructor=w,w.C=function(C,P,A){for(var R=Array(arguments.length-2),de=2;de<arguments.length;de++)R[de-2]=arguments[de];return k.prototype[P].apply(C,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,k,S){S||(S=0);var C=Array(16);if(typeof k=="string")for(var P=0;16>P;++P)C[P]=k.charCodeAt(S++)|k.charCodeAt(S++)<<8|k.charCodeAt(S++)<<16|k.charCodeAt(S++)<<24;else for(P=0;16>P;++P)C[P]=k[S++]|k[S++]<<8|k[S++]<<16|k[S++]<<24;k=w.g[0],S=w.g[1],P=w.g[2];var A=w.g[3],R=k+(A^S&(P^A))+C[0]+3614090360&4294967295;k=S+(R<<7&4294967295|R>>>25),R=A+(P^k&(S^P))+C[1]+3905402710&4294967295,A=k+(R<<12&4294967295|R>>>20),R=P+(S^A&(k^S))+C[2]+606105819&4294967295,P=A+(R<<17&4294967295|R>>>15),R=S+(k^P&(A^k))+C[3]+3250441966&4294967295,S=P+(R<<22&4294967295|R>>>10),R=k+(A^S&(P^A))+C[4]+4118548399&4294967295,k=S+(R<<7&4294967295|R>>>25),R=A+(P^k&(S^P))+C[5]+1200080426&4294967295,A=k+(R<<12&4294967295|R>>>20),R=P+(S^A&(k^S))+C[6]+2821735955&4294967295,P=A+(R<<17&4294967295|R>>>15),R=S+(k^P&(A^k))+C[7]+4249261313&4294967295,S=P+(R<<22&4294967295|R>>>10),R=k+(A^S&(P^A))+C[8]+1770035416&4294967295,k=S+(R<<7&4294967295|R>>>25),R=A+(P^k&(S^P))+C[9]+2336552879&4294967295,A=k+(R<<12&4294967295|R>>>20),R=P+(S^A&(k^S))+C[10]+4294925233&4294967295,P=A+(R<<17&4294967295|R>>>15),R=S+(k^P&(A^k))+C[11]+2304563134&4294967295,S=P+(R<<22&4294967295|R>>>10),R=k+(A^S&(P^A))+C[12]+1804603682&4294967295,k=S+(R<<7&4294967295|R>>>25),R=A+(P^k&(S^P))+C[13]+4254626195&4294967295,A=k+(R<<12&4294967295|R>>>20),R=P+(S^A&(k^S))+C[14]+2792965006&4294967295,P=A+(R<<17&4294967295|R>>>15),R=S+(k^P&(A^k))+C[15]+1236535329&4294967295,S=P+(R<<22&4294967295|R>>>10),R=k+(P^A&(S^P))+C[1]+4129170786&4294967295,k=S+(R<<5&4294967295|R>>>27),R=A+(S^P&(k^S))+C[6]+3225465664&4294967295,A=k+(R<<9&4294967295|R>>>23),R=P+(k^S&(A^k))+C[11]+643717713&4294967295,P=A+(R<<14&4294967295|R>>>18),R=S+(A^k&(P^A))+C[0]+3921069994&4294967295,S=P+(R<<20&4294967295|R>>>12),R=k+(P^A&(S^P))+C[5]+3593408605&4294967295,k=S+(R<<5&4294967295|R>>>27),R=A+(S^P&(k^S))+C[10]+38016083&4294967295,A=k+(R<<9&4294967295|R>>>23),R=P+(k^S&(A^k))+C[15]+3634488961&4294967295,P=A+(R<<14&4294967295|R>>>18),R=S+(A^k&(P^A))+C[4]+3889429448&4294967295,S=P+(R<<20&4294967295|R>>>12),R=k+(P^A&(S^P))+C[9]+568446438&4294967295,k=S+(R<<5&4294967295|R>>>27),R=A+(S^P&(k^S))+C[14]+3275163606&4294967295,A=k+(R<<9&4294967295|R>>>23),R=P+(k^S&(A^k))+C[3]+4107603335&4294967295,P=A+(R<<14&4294967295|R>>>18),R=S+(A^k&(P^A))+C[8]+1163531501&4294967295,S=P+(R<<20&4294967295|R>>>12),R=k+(P^A&(S^P))+C[13]+2850285829&4294967295,k=S+(R<<5&4294967295|R>>>27),R=A+(S^P&(k^S))+C[2]+4243563512&4294967295,A=k+(R<<9&4294967295|R>>>23),R=P+(k^S&(A^k))+C[7]+1735328473&4294967295,P=A+(R<<14&4294967295|R>>>18),R=S+(A^k&(P^A))+C[12]+2368359562&4294967295,S=P+(R<<20&4294967295|R>>>12),R=k+(S^P^A)+C[5]+4294588738&4294967295,k=S+(R<<4&4294967295|R>>>28),R=A+(k^S^P)+C[8]+2272392833&4294967295,A=k+(R<<11&4294967295|R>>>21),R=P+(A^k^S)+C[11]+1839030562&4294967295,P=A+(R<<16&4294967295|R>>>16),R=S+(P^A^k)+C[14]+4259657740&4294967295,S=P+(R<<23&4294967295|R>>>9),R=k+(S^P^A)+C[1]+2763975236&4294967295,k=S+(R<<4&4294967295|R>>>28),R=A+(k^S^P)+C[4]+1272893353&4294967295,A=k+(R<<11&4294967295|R>>>21),R=P+(A^k^S)+C[7]+4139469664&4294967295,P=A+(R<<16&4294967295|R>>>16),R=S+(P^A^k)+C[10]+3200236656&4294967295,S=P+(R<<23&4294967295|R>>>9),R=k+(S^P^A)+C[13]+681279174&4294967295,k=S+(R<<4&4294967295|R>>>28),R=A+(k^S^P)+C[0]+3936430074&4294967295,A=k+(R<<11&4294967295|R>>>21),R=P+(A^k^S)+C[3]+3572445317&4294967295,P=A+(R<<16&4294967295|R>>>16),R=S+(P^A^k)+C[6]+76029189&4294967295,S=P+(R<<23&4294967295|R>>>9),R=k+(S^P^A)+C[9]+3654602809&4294967295,k=S+(R<<4&4294967295|R>>>28),R=A+(k^S^P)+C[12]+3873151461&4294967295,A=k+(R<<11&4294967295|R>>>21),R=P+(A^k^S)+C[15]+530742520&4294967295,P=A+(R<<16&4294967295|R>>>16),R=S+(P^A^k)+C[2]+3299628645&4294967295,S=P+(R<<23&4294967295|R>>>9),R=k+(P^(S|~A))+C[0]+4096336452&4294967295,k=S+(R<<6&4294967295|R>>>26),R=A+(S^(k|~P))+C[7]+1126891415&4294967295,A=k+(R<<10&4294967295|R>>>22),R=P+(k^(A|~S))+C[14]+2878612391&4294967295,P=A+(R<<15&4294967295|R>>>17),R=S+(A^(P|~k))+C[5]+4237533241&4294967295,S=P+(R<<21&4294967295|R>>>11),R=k+(P^(S|~A))+C[12]+1700485571&4294967295,k=S+(R<<6&4294967295|R>>>26),R=A+(S^(k|~P))+C[3]+2399980690&4294967295,A=k+(R<<10&4294967295|R>>>22),R=P+(k^(A|~S))+C[10]+4293915773&4294967295,P=A+(R<<15&4294967295|R>>>17),R=S+(A^(P|~k))+C[1]+2240044497&4294967295,S=P+(R<<21&4294967295|R>>>11),R=k+(P^(S|~A))+C[8]+1873313359&4294967295,k=S+(R<<6&4294967295|R>>>26),R=A+(S^(k|~P))+C[15]+4264355552&4294967295,A=k+(R<<10&4294967295|R>>>22),R=P+(k^(A|~S))+C[6]+2734768916&4294967295,P=A+(R<<15&4294967295|R>>>17),R=S+(A^(P|~k))+C[13]+1309151649&4294967295,S=P+(R<<21&4294967295|R>>>11),R=k+(P^(S|~A))+C[4]+4149444226&4294967295,k=S+(R<<6&4294967295|R>>>26),R=A+(S^(k|~P))+C[11]+3174756917&4294967295,A=k+(R<<10&4294967295|R>>>22),R=P+(k^(A|~S))+C[2]+718787259&4294967295,P=A+(R<<15&4294967295|R>>>17),R=S+(A^(P|~k))+C[9]+3951481745&4294967295,w.g[0]=w.g[0]+k&4294967295,w.g[1]=w.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+A&4294967295}n.prototype.u=function(w,k){k===void 0&&(k=w.length);for(var S=k-this.blockSize,C=this.B,P=this.h,A=0;A<k;){if(P==0)for(;A<=S;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<k;)if(C[P++]=w.charCodeAt(A++),P==this.blockSize){i(this,C),P=0;break}}else for(;A<k;)if(C[P++]=w[A++],P==this.blockSize){i(this,C),P=0;break}}this.h=P,this.o+=k},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var k=1;k<w.length-8;++k)w[k]=0;var S=8*this.o;for(k=w.length-8;k<w.length;++k)w[k]=S&255,S/=256;for(this.u(w),w=Array(16),k=S=0;4>k;++k)for(var C=0;32>C;C+=8)w[S++]=this.g[k]>>>C&255;return w};function s(w,k){var S=o;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=k(w)}function a(w,k){this.h=k;for(var S=[],C=!0,P=w.length-1;0<=P;P--){var A=w[P]|0;C&&A==k||(S[P]=A,C=!1)}this.g=S}var o={};function l(w){return-128<=w&&128>w?s(w,function(k){return new a([k|0],0>k?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return _(c(-w));for(var k=[],S=1,C=0;w>=S;C++)k[C]=w/S|0,S*=4294967296;return new a(k,0)}function f(w,k){if(w.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w.charAt(0)=="-")return _(f(w.substring(1),k));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(k,8)),C=h,P=0;P<w.length;P+=8){var A=Math.min(8,w.length-P),R=parseInt(w.substring(P,P+A),k);8>A?(A=c(Math.pow(k,A)),C=C.j(A).add(c(R))):(C=C.j(S),C=C.add(c(R)))}return C}var h=l(0),d=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(m(this))return-_(this).m();for(var w=0,k=1,S=0;S<this.g.length;S++){var C=this.i(S);w+=(0<=C?C:4294967296+C)*k,k*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(v(this))return"0";if(m(this))return"-"+_(this).toString(w);for(var k=c(Math.pow(w,6)),S=this,C="";;){var P=F(S,k).g;S=y(S,P.j(k));var A=((0<S.g.length?S.g[0]:S.h)>>>0).toString(w);if(S=P,v(S))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function v(w){if(w.h!=0)return!1;for(var k=0;k<w.g.length;k++)if(w.g[k]!=0)return!1;return!0}function m(w){return w.h==-1}t.l=function(w){return w=y(this,w),m(w)?-1:v(w)?0:1};function _(w){for(var k=w.g.length,S=[],C=0;C<k;C++)S[C]=~w.g[C];return new a(S,~w.h).add(d)}t.abs=function(){return m(this)?_(this):this},t.add=function(w){for(var k=Math.max(this.g.length,w.g.length),S=[],C=0,P=0;P<=k;P++){var A=C+(this.i(P)&65535)+(w.i(P)&65535),R=(A>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);C=R>>>16,A&=65535,R&=65535,S[P]=R<<16|A}return new a(S,S[S.length-1]&-2147483648?-1:0)};function y(w,k){return w.add(_(k))}t.j=function(w){if(v(this)||v(w))return h;if(m(this))return m(w)?_(this).j(_(w)):_(_(this).j(w));if(m(w))return _(this.j(_(w)));if(0>this.l(p)&&0>w.l(p))return c(this.m()*w.m());for(var k=this.g.length+w.g.length,S=[],C=0;C<2*k;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<w.g.length;P++){var A=this.i(C)>>>16,R=this.i(C)&65535,de=w.i(P)>>>16,ue=w.i(P)&65535;S[2*C+2*P]+=R*ue,E(S,2*C+2*P),S[2*C+2*P+1]+=A*ue,E(S,2*C+2*P+1),S[2*C+2*P+1]+=R*de,E(S,2*C+2*P+1),S[2*C+2*P+2]+=A*de,E(S,2*C+2*P+2)}for(C=0;C<k;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=k;C<2*k;C++)S[C]=0;return new a(S,0)};function E(w,k){for(;(w[k]&65535)!=w[k];)w[k+1]+=w[k]>>>16,w[k]&=65535,k++}function x(w,k){this.g=w,this.h=k}function F(w,k){if(v(k))throw Error("division by zero");if(v(w))return new x(h,h);if(m(w))return k=F(_(w),k),new x(_(k.g),_(k.h));if(m(k))return k=F(w,_(k)),new x(_(k.g),k.h);if(30<w.g.length){if(m(w)||m(k))throw Error("slowDivide_ only works with positive integers.");for(var S=d,C=k;0>=C.l(w);)S=U(S),C=U(C);var P=b(S,1),A=b(C,1);for(C=b(C,2),S=b(S,2);!v(C);){var R=A.add(C);0>=R.l(w)&&(P=P.add(S),A=R),C=b(C,1),S=b(S,1)}return k=y(w,P.j(k)),new x(P,k)}for(P=h;0<=w.l(k);){for(S=Math.max(1,Math.floor(w.m()/k.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=c(S),R=A.j(k);m(R)||0<R.l(w);)S-=C,A=c(S),R=A.j(k);v(A)&&(A=d),P=P.add(A),w=y(w,R)}return new x(P,w)}t.A=function(w){return F(this,w).h},t.and=function(w){for(var k=Math.max(this.g.length,w.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)&w.i(C);return new a(S,this.h&w.h)},t.or=function(w){for(var k=Math.max(this.g.length,w.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)|w.i(C);return new a(S,this.h|w.h)},t.xor=function(w){for(var k=Math.max(this.g.length,w.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)^w.i(C);return new a(S,this.h^w.h)};function U(w){for(var k=w.g.length+1,S=[],C=0;C<k;C++)S[C]=w.i(C)<<1|w.i(C-1)>>>31;return new a(S,w.h)}function b(w,k){var S=k>>5;k%=32;for(var C=w.g.length-S,P=[],A=0;A<C;A++)P[A]=0<k?w.i(A+S)>>>k|w.i(A+S+1)<<32-k:w.i(A+S);return new a(P,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,BT=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=f,Ia=a}).apply(typeof Mx<"u"?Mx:typeof self<"u"?self:typeof window<"u"?window:{});var Cf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UT,rc,jT,a0,dm,WT,HT,zT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,T){return u==Array.prototype||u==Object.prototype||(u[g]=T.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cf=="object"&&Cf];for(var g=0;g<u.length;++g){var T=u[g];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var n=r(this);function i(u,g){if(g)e:{var T=n;u=u.split(".");for(var N=0;N<u.length-1;N++){var X=u[N];if(!(X in T))break e;T=T[X]}u=u[u.length-1],N=T[u],g=g(N),g!=N&&g!=null&&e(T,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var T=0,N=!1,X={next:function(){if(!N&&T<u.length){var ne=T++;return{value:g(ne,u[ne]),done:!1}}return N=!0,{done:!0,value:void 0}}};return X[Symbol.iterator]=function(){return X},X}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function f(u,g,T){return u.call.apply(u.bind,arguments)}function h(u,g,T){if(!u)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var X=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(X,N),u.apply(g,X)}}return function(){return u.apply(g,arguments)}}function d(u,g,T){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function p(u,g){var T=Array.prototype.slice.call(arguments,1);return function(){var N=T.slice();return N.push.apply(N,arguments),u.apply(this,N)}}function v(u,g){function T(){}T.prototype=g.prototype,u.aa=g.prototype,u.prototype=new T,u.prototype.constructor=u,u.Qb=function(N,X,ne){for(var Te=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)Te[gt-2]=arguments[gt];return g.prototype[X].apply(N,Te)}}function m(u){const g=u.length;if(0<g){const T=Array(g);for(let N=0;N<g;N++)T[N]=u[N];return T}return[]}function _(u,g){for(let T=1;T<arguments.length;T++){const N=arguments[T];if(l(N)){const X=u.length||0,ne=N.length||0;u.length=X+ne;for(let Te=0;Te<ne;Te++)u[X+Te]=N[Te]}else u.push(N)}}class y{constructor(g,T){this.i=g,this.j=T,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function E(u){return/^[\s\xa0]*$/.test(u)}function x(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function F(u){return F[" "](u),u}F[" "]=function(){};var U=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function b(u,g,T){for(const N in u)g.call(T,u[N],N,u)}function w(u,g){for(const T in u)g.call(void 0,u[T],T,u)}function k(u){const g={};for(const T in u)g[T]=u[T];return g}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,g){let T,N;for(let X=1;X<arguments.length;X++){N=arguments[X];for(T in N)u[T]=N[T];for(let ne=0;ne<S.length;ne++)T=S[ne],Object.prototype.hasOwnProperty.call(N,T)&&(u[T]=N[T])}}function P(u){var g=1;u=u.split(":");const T=[];for(;0<g&&u.length;)T.push(u.shift()),g--;return u.length&&T.push(u.join(":")),T}function A(u){o.setTimeout(()=>{throw u},0)}function R(){var u=H;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class de{constructor(){this.h=this.g=null}add(g,T){const N=ue.get();N.set(g,T),this.h?this.h.next=N:this.g=N,this.h=N}}var ue=new y(()=>new Z,u=>u.reset());class Z{constructor(){this.next=this.g=this.h=null}set(g,T){this.h=g,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let te,re=!1,H=new de,se=()=>{const u=o.Promise.resolve(void 0);te=()=>{u.then(oe)}};var oe=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(T){A(T)}var g=ue;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}re=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const T=()=>{};o.addEventListener("test",T,g),o.removeEventListener("test",T,g)}catch{}return u}();function G(u,g){if(K.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var T=this.type=u.type,N=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(U){e:{try{F(g.nodeName);var X=!0;break e}catch{}X=!1}X||(g=null)}}else T=="mouseover"?g=u.fromElement:T=="mouseout"&&(g=u.toElement);this.relatedTarget=g,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ee[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&G.aa.h.call(this)}}v(G,K);var ee={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var me="closure_listenable_"+(1e6*Math.random()|0),xe=0;function ge(u,g,T,N,X){this.listener=u,this.proxy=null,this.src=g,this.type=T,this.capture=!!N,this.ha=X,this.key=++xe,this.da=this.fa=!1}function fe(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Be(u){this.src=u,this.g={},this.h=0}Be.prototype.add=function(u,g,T,N,X){var ne=u.toString();u=this.g[ne],u||(u=this.g[ne]=[],this.h++);var Te=at(u,g,N,X);return-1<Te?(g=u[Te],T||(g.fa=!1)):(g=new ge(g,this.src,ne,!!N,X),g.fa=T,u.push(g)),g};function W(u,g){var T=g.type;if(T in u.g){var N=u.g[T],X=Array.prototype.indexOf.call(N,g,void 0),ne;(ne=0<=X)&&Array.prototype.splice.call(N,X,1),ne&&(fe(g),u.g[T].length==0&&(delete u.g[T],u.h--))}}function at(u,g,T,N){for(var X=0;X<u.length;++X){var ne=u[X];if(!ne.da&&ne.listener==g&&ne.capture==!!T&&ne.ha==N)return X}return-1}var Ke="closure_lm_"+(1e6*Math.random()|0),st={};function $e(u,g,T,N,X){if(Array.isArray(g)){for(var ne=0;ne<g.length;ne++)$e(u,g[ne],T,N,X);return null}return T=Nn(T),u&&u[me]?u.K(g,T,c(N)?!!N.capture:!1,X):ke(u,g,T,!1,N,X)}function ke(u,g,T,N,X,ne){if(!g)throw Error("Invalid event type");var Te=c(X)?!!X.capture:!!X,gt=Fn(u);if(gt||(u[Ke]=gt=new Be(u)),T=gt.add(g,T,N,Te,ne),T.proxy)return T;if(N=Ct(),T.proxy=N,N.src=u,N.listener=T,u.addEventListener)z||(X=Te),X===void 0&&(X=!1),u.addEventListener(g.toString(),N,X);else if(u.attachEvent)u.attachEvent(Pn(g.toString()),N);else if(u.addListener&&u.removeListener)u.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Ct(){function u(T){return g.call(u.src,u.listener,T)}const g=ca;return u}function Gr(u,g,T,N,X){if(Array.isArray(g))for(var ne=0;ne<g.length;ne++)Gr(u,g[ne],T,N,X);else N=c(N)?!!N.capture:!!N,T=Nn(T),u&&u[me]?(u=u.i,g=String(g).toString(),g in u.g&&(ne=u.g[g],T=at(ne,T,N,X),-1<T&&(fe(ne[T]),Array.prototype.splice.call(ne,T,1),ne.length==0&&(delete u.g[g],u.h--)))):u&&(u=Fn(u))&&(g=u.g[g.toString()],u=-1,g&&(u=at(g,T,N,X)),(T=-1<u?g[u]:null)&&rn(T))}function rn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[me])W(g.i,u);else{var T=u.type,N=u.proxy;g.removeEventListener?g.removeEventListener(T,N,u.capture):g.detachEvent?g.detachEvent(Pn(T),N):g.addListener&&g.removeListener&&g.removeListener(N),(T=Fn(g))?(W(T,u),T.h==0&&(T.src=null,g[Ke]=null)):fe(u)}}}function Pn(u){return u in st?st[u]:st[u]="on"+u}function ca(u,g){if(u.da)u=!0;else{g=new G(g,this);var T=u.listener,N=u.ha||u.src;u.fa&&rn(u),u=T.call(N,g)}return u}function Fn(u){return u=u[Ke],u instanceof Be?u:null}var pr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nn(u){return typeof u=="function"?u:(u[pr]||(u[pr]=function(g){return u.handleEvent(g)}),u[pr])}function _t(){L.call(this),this.i=new Be(this),this.M=this,this.F=null}v(_t,L),_t.prototype[me]=!0,_t.prototype.removeEventListener=function(u,g,T,N){Gr(this,u,g,T,N)};function Ht(u,g){var T,N=u.F;if(N)for(T=[];N;N=N.F)T.push(N);if(u=u.M,N=g.type||g,typeof g=="string")g=new K(g,u);else if(g instanceof K)g.target=g.target||u;else{var X=g;g=new K(N,u),C(g,X)}if(X=!0,T)for(var ne=T.length-1;0<=ne;ne--){var Te=g.g=T[ne];X=qt(Te,N,!0,g)&&X}if(Te=g.g=u,X=qt(Te,N,!0,g)&&X,X=qt(Te,N,!1,g)&&X,T)for(ne=0;ne<T.length;ne++)Te=g.g=T[ne],X=qt(Te,N,!1,g)&&X}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var T=u.g[g],N=0;N<T.length;N++)fe(T[N]);delete u.g[g],u.h--}}this.F=null},_t.prototype.K=function(u,g,T,N){return this.i.add(String(u),g,!1,T,N)},_t.prototype.L=function(u,g,T,N){return this.i.add(String(u),g,!0,T,N)};function qt(u,g,T,N){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var X=!0,ne=0;ne<g.length;++ne){var Te=g[ne];if(Te&&!Te.da&&Te.capture==T){var gt=Te.listener,gr=Te.ha||Te.src;Te.fa&&W(u.i,Te),X=gt.call(gr,N)!==!1&&X}}return X&&!N.defaultPrevented}function mn(u,g,T){if(typeof u=="function")T&&(u=d(u,T));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:o.setTimeout(u,g||0)}function He(u){u.g=mn(()=>{u.g=null,u.i&&(u.i=!1,He(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Rt extends L{constructor(g,T){super(),this.m=g,this.l=T,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function or(u){L.call(this),this.h=u,this.g={}}v(or,L);var Mt=[];function ci(u){b(u.g,function(g,T){this.g.hasOwnProperty(T)&&rn(g)},u),u.g={}}or.prototype.N=function(){or.aa.N.call(this),ci(this)},or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var lo=o.JSON.stringify,nd=o.JSON.parse,id=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function co(){}co.prototype.h=null;function Pl(u){return u.h||(u.h=u.i())}function Fl(){}var ua={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Nl(){K.call(this,"d")}v(Nl,K);function hs(){K.call(this,"c")}v(hs,K);var Pi={},Xu=null;function uo(){return Xu=Xu||new _t}Pi.La="serverreachability";function qu(u){K.call(this,Pi.La,u)}v(qu,K);function fa(u){const g=uo();Ht(g,new qu(g))}Pi.STAT_EVENT="statevent";function Yu(u,g){K.call(this,Pi.STAT_EVENT,u),this.stat=g}v(Yu,K);function mr(u){const g=uo();Ht(g,new Yu(g,u))}Pi.Ma="timingevent";function Qu(u,g){K.call(this,Pi.Ma,u),this.size=g}v(Qu,K);function Fi(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},g)}function ha(){this.g=!0}ha.prototype.xa=function(){this.g=!1};function sd(u,g,T,N,X,ne){u.info(function(){if(u.g)if(ne)for(var Te="",gt=ne.split("&"),gr=0;gr<gt.length;gr++){var rt=gt[gr].split("=");if(1<rt.length){var Ir=rt[0];rt=rt[1];var Cr=Ir.split("_");Te=2<=Cr.length&&Cr[1]=="type"?Te+(Ir+"="+rt+"&"):Te+(Ir+"=redacted&")}}else Te=null;else Te=ne;return"XMLHTTP REQ ("+N+") [attempt "+X+"]: "+g+`
`+T+`
`+Te})}function ad(u,g,T,N,X,ne,Te){u.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+X+"]: "+g+`
`+T+`
`+ne+" "+Te})}function I(u,g,T,N){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+D(u,T)+(N?" "+N:"")})}function V(u,g){u.info(function(){return"TIMEOUT: "+g})}ha.prototype.info=function(){};function D(u,g){if(!u.g)return g;if(!g)return null;try{var T=JSON.parse(g);if(T){for(u=0;u<T.length;u++)if(Array.isArray(T[u])){var N=T[u];if(!(2>N.length)){var X=N[1];if(Array.isArray(X)&&!(1>X.length)){var ne=X[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var Te=1;Te<X.length;Te++)X[Te]=""}}}}return lo(T)}catch{return g}}var O={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},B={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},j;function q(){}v(q,co),q.prototype.g=function(){return new XMLHttpRequest},q.prototype.i=function(){return{}},j=new q;function ie(u,g,T,N){this.j=u,this.i=g,this.l=T,this.R=N||1,this.U=new or(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Q={},J={};function pe(u,g,T){u.L=1,u.v=ef(Di(g)),u.m=T,u.P=!0,Ee(u,null)}function Ee(u,g){u.F=Date.now(),Se(u),u.A=Di(u.v);var T=u.A,N=u.R;Array.isArray(N)||(N=[String(N)]),Fv(T.i,"t",N),u.C=0,T=u.j.J,u.h=new Y,u.g=qv(u.j,T?g:null,!u.m),0<u.O&&(u.M=new Rt(d(u.Y,u,u.g),u.O)),g=u.U,T=u.g,N=u.ca;var X="readystatechange";Array.isArray(X)||(X&&(Mt[0]=X.toString()),X=Mt);for(var ne=0;ne<X.length;ne++){var Te=$e(T,X[ne],N||g.handleEvent,!1,g.h||g);if(!Te)break;g.g[Te.key]=Te}g=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),fa(),sd(u.i,u.u,u.A,u.l,u.R,u.m)}ie.prototype.ca=function(u){u=u.target;const g=this.M;g&&Oi(u)==3?g.j():this.Y(u)},ie.prototype.Y=function(u){try{if(u==this.g)e:{const Cr=Oi(this.g);var g=this.g.Ba();const mo=this.g.Z();if(!(3>Cr)&&(Cr!=3||this.g&&(this.h.h||this.g.oa()||Vv(this.g)))){this.J||Cr!=4||g==7||(g==8||0>=mo?fa(3):fa(2)),mt(this);var T=this.g.Z();this.X=T;t:if(Ae(this)){var N=Vv(this.g);u="";var X=N.length,ne=Oi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){At(this),ot(this);var Te="";break t}this.h.i=new o.TextDecoder}for(g=0;g<X;g++)this.h.h=!0,u+=this.h.i.decode(N[g],{stream:!(ne&&g==X-1)});N.length=0,this.h.g+=u,this.C=0,Te=this.h.g}else Te=this.g.oa();if(this.o=T==200,ad(this.i,this.u,this.A,this.l,this.R,Cr,T),this.o){if(this.T&&!this.K){t:{if(this.g){var gt,gr=this.g;if((gt=gr.g?gr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(gt)){var rt=gt;break t}}rt=null}if(T=rt)I(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ni(this,T);else{this.o=!1,this.s=3,mr(12),At(this),ot(this);break e}}if(this.P){T=!0;let Xn;for(;!this.J&&this.C<Te.length;)if(Xn=_e(this,Te),Xn==J){Cr==4&&(this.s=4,mr(14),T=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Xn==Q){this.s=4,mr(15),I(this.i,this.l,Te,"[Invalid Chunk]"),T=!1;break}else I(this.i,this.l,Xn,null),Ni(this,Xn);if(Ae(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cr!=4||Te.length!=0||this.h.h||(this.s=1,mr(16),T=!1),this.o=this.o&&T,!T)I(this.i,this.l,Te,"[Invalid Chunked Response]"),At(this),ot(this);else if(0<Te.length&&!this.W){this.W=!0;var Ir=this.j;Ir.g==this&&Ir.ba&&!Ir.M&&(Ir.j.info("Great, no buffering proxy detected. Bytes received: "+Te.length),fd(Ir),Ir.M=!0,mr(11))}}else I(this.i,this.l,Te,null),Ni(this,Te);Cr==4&&At(this),this.o&&!this.J&&(Cr==4?$v(this.j,this):(this.o=!1,Se(this)))}else NI(this.g),T==400&&0<Te.indexOf("Unknown SID")?(this.s=3,mr(12)):(this.s=0,mr(13)),At(this),ot(this)}}}catch{}finally{}};function Ae(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function _e(u,g){var T=u.C,N=g.indexOf(`
`,T);return N==-1?J:(T=Number(g.substring(T,N)),isNaN(T)?Q:(N+=1,N+T>g.length?J:(g=g.slice(N,N+T),u.C=N+T,g)))}ie.prototype.cancel=function(){this.J=!0,At(this)};function Se(u){u.S=Date.now()+u.I,Me(u,u.I)}function Me(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Fi(d(u.ba,u),g)}function mt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}ie.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(V(this.i,this.A),this.L!=2&&(fa(),mr(17)),At(this),this.s=2,ot(this)):Me(this,this.S-u)};function ot(u){u.j.G==0||u.J||$v(u.j,u)}function At(u){mt(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,ci(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Ni(u,g){try{var T=u.j;if(T.G!=0&&(T.g==u||gn(T.h,u))){if(!u.K&&gn(T.h,u)&&T.G==3){try{var N=T.Da.g.parse(g)}catch{N=null}if(Array.isArray(N)&&N.length==3){var X=N;if(X[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<u.F)of(T),sf(T);else break e;ud(T),mr(18)}}else T.za=X[1],0<T.za-T.T&&37500>X[2]&&T.F&&T.v==0&&!T.C&&(T.C=Fi(d(T.Za,T),6e3));if(1>=fo(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else ma(T,11)}else if((u.K||T.g==u)&&of(T),!E(g))for(X=T.Da.g.parse(g),g=0;g<X.length;g++){let rt=X[g];if(T.T=rt[0],rt=rt[1],T.G==2)if(rt[0]=="c"){T.K=rt[1],T.ia=rt[2];const Ir=rt[3];Ir!=null&&(T.la=Ir,T.j.info("VER="+T.la));const Cr=rt[4];Cr!=null&&(T.Aa=Cr,T.j.info("SVER="+T.Aa));const mo=rt[5];mo!=null&&typeof mo=="number"&&0<mo&&(N=1.5*mo,T.L=N,T.j.info("backChannelRequestTimeoutMs_="+N)),N=T;const Xn=u.g;if(Xn){const cf=Xn.g?Xn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cf){var ne=N.h;ne.g||cf.indexOf("spdy")==-1&&cf.indexOf("quic")==-1&&cf.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(od(ne,ne.h),ne.h=null))}if(N.D){const hd=Xn.g?Xn.g.getResponseHeader("X-HTTP-Session-Id"):null;hd&&(N.ya=hd,xt(N.I,N.D,hd))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-u.F,T.j.info("Handshake RTT: "+T.R+"ms")),N=T;var Te=u;if(N.qa=Xv(N,N.J?N.ia:null,N.W),Te.K){Tv(N.h,Te);var gt=Te,gr=N.L;gr&&(gt.I=gr),gt.B&&(mt(gt),Se(gt)),N.g=Te}else Hv(N);0<T.i.length&&af(T)}else rt[0]!="stop"&&rt[0]!="close"||ma(T,7);else T.G==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?ma(T,7):cd(T):rt[0]!="noop"&&T.l&&T.l.ta(rt),T.v=0)}}fa(4)}catch{}}var da=class{constructor(u,g){this.g=u,this.map=g}};function ds(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ui(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function fo(u){return u.h?1:u.g?u.g.size:0}function gn(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function od(u,g){u.g?u.g.add(g):u.h=g}function Tv(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}ds.prototype.cancel=function(){if(this.i=kv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function kv(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const T of u.g.values())g=g.concat(T.D);return g}return m(u.i)}function vI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],T=u.length,N=0;N<T;N++)g.push(u[N]);return g}g=[],T=0;for(N in u)g[T++]=u[N];return g}function _I(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var T=0;T<u;T++)g.push(T);return g}g=[],T=0;for(const N in u)g[T++]=N;return g}}}function Sv(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var T=_I(u),N=vI(u),X=N.length,ne=0;ne<X;ne++)g.call(void 0,N[ne],T&&T[ne],u)}var Av=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xI(u,g){if(u){u=u.split("&");for(var T=0;T<u.length;T++){var N=u[T].indexOf("="),X=null;if(0<=N){var ne=u[T].substring(0,N);X=u[T].substring(N+1)}else ne=u[T];g(ne,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function pa(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof pa){this.h=u.h,Ju(this,u.j),this.o=u.o,this.g=u.g,Zu(this,u.s),this.l=u.l;var g=u.i,T=new Ll;T.i=g.i,g.g&&(T.g=new Map(g.g),T.h=g.h),Iv(this,T),this.m=u.m}else u&&(g=String(u).match(Av))?(this.h=!1,Ju(this,g[1]||"",!0),this.o=Dl(g[2]||""),this.g=Dl(g[3]||"",!0),Zu(this,g[4]),this.l=Dl(g[5]||"",!0),Iv(this,g[6]||"",!0),this.m=Dl(g[7]||"")):(this.h=!1,this.i=new Ll(null,this.h))}pa.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Ol(g,Cv,!0),":");var T=this.g;return(T||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Ol(g,Cv,!0),"@"),u.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&u.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&u.push("/"),u.push(Ol(T,T.charAt(0)=="/"?EI:wI,!0))),(T=this.i.toString())&&u.push("?",T),(T=this.m)&&u.push("#",Ol(T,kI)),u.join("")};function Di(u){return new pa(u)}function Ju(u,g,T){u.j=T?Dl(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Zu(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function Iv(u,g,T){g instanceof Ll?(u.i=g,SI(u.i,u.h)):(T||(g=Ol(g,TI)),u.i=new Ll(g,u.h))}function xt(u,g,T){u.i.set(g,T)}function ef(u){return xt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Dl(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ol(u,g,T){return typeof u=="string"?(u=encodeURI(u).replace(g,yI),T&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function yI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Cv=/[#\/\?@]/g,wI=/[#\?:]/g,EI=/[#\?]/g,TI=/[#\?@]/g,kI=/#/g;function Ll(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function ps(u){u.g||(u.g=new Map,u.h=0,u.i&&xI(u.i,function(g,T){u.add(decodeURIComponent(g.replace(/\+/g," ")),T)}))}t=Ll.prototype,t.add=function(u,g){ps(this),this.i=null,u=ho(this,u);var T=this.g.get(u);return T||this.g.set(u,T=[]),T.push(g),this.h+=1,this};function Rv(u,g){ps(u),g=ho(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Pv(u,g){return ps(u),g=ho(u,g),u.g.has(g)}t.forEach=function(u,g){ps(this),this.g.forEach(function(T,N){T.forEach(function(X){u.call(g,X,N,this)},this)},this)},t.na=function(){ps(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),T=[];for(let N=0;N<g.length;N++){const X=u[N];for(let ne=0;ne<X.length;ne++)T.push(g[N])}return T},t.V=function(u){ps(this);let g=[];if(typeof u=="string")Pv(this,u)&&(g=g.concat(this.g.get(ho(this,u))));else{u=Array.from(this.g.values());for(let T=0;T<u.length;T++)g=g.concat(u[T])}return g},t.set=function(u,g){return ps(this),this.i=null,u=ho(this,u),Pv(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Fv(u,g,T){Rv(u,g),0<T.length&&(u.i=null,u.g.set(ho(u,g),m(T)),u.h+=T.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var T=0;T<g.length;T++){var N=g[T];const ne=encodeURIComponent(String(N)),Te=this.V(N);for(N=0;N<Te.length;N++){var X=ne;Te[N]!==""&&(X+="="+encodeURIComponent(String(Te[N]))),u.push(X)}}return this.i=u.join("&")};function ho(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function SI(u,g){g&&!u.j&&(ps(u),u.i=null,u.g.forEach(function(T,N){var X=N.toLowerCase();N!=X&&(Rv(this,N),Fv(this,X,T))},u)),u.j=g}function AI(u,g){const T=new ha;if(o.Image){const N=new Image;N.onload=p(ms,T,"TestLoadImage: loaded",!0,g,N),N.onerror=p(ms,T,"TestLoadImage: error",!1,g,N),N.onabort=p(ms,T,"TestLoadImage: abort",!1,g,N),N.ontimeout=p(ms,T,"TestLoadImage: timeout",!1,g,N),o.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=u}else g(!1)}function II(u,g){const T=new ha,N=new AbortController,X=setTimeout(()=>{N.abort(),ms(T,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:N.signal}).then(ne=>{clearTimeout(X),ne.ok?ms(T,"TestPingServer: ok",!0,g):ms(T,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(X),ms(T,"TestPingServer: error",!1,g)})}function ms(u,g,T,N,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),N(T)}catch{}}function CI(){this.g=new id}function RI(u,g,T){const N=T||"";try{Sv(u,function(X,ne){let Te=X;c(X)&&(Te=lo(X)),g.push(N+ne+"="+encodeURIComponent(Te))})}catch(X){throw g.push(N+"type="+encodeURIComponent("_badmap")),X}}function tf(u){this.l=u.Ub||null,this.j=u.eb||!1}v(tf,co),tf.prototype.g=function(){return new rf(this.l,this.j)},tf.prototype.i=function(u){return function(){return u}}({});function rf(u,g){_t.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(rf,_t),t=rf.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Ml(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||o).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ml(this)),this.g&&(this.readyState=3,Ml(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nv(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nv(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?bl(this):Ml(this),this.readyState==3&&Nv(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,bl(this))},t.Qa=function(u){this.g&&(this.response=u,bl(this))},t.ga=function(){this.g&&bl(this)};function bl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ml(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var T=g.next();!T.done;)T=T.value,u.push(T[0]+": "+T[1]),T=g.next();return u.join(`\r
`)};function Ml(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(rf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Dv(u){let g="";return b(u,function(T,N){g+=N,g+=":",g+=T,g+=`\r
`}),g}function ld(u,g,T){e:{for(N in T){var N=!1;break e}N=!0}N||(T=Dv(T),typeof u=="string"?T!=null&&encodeURIComponent(String(T)):xt(u,g,T))}function Vt(u){_t.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Vt,_t);var PI=/^https?$/i,FI=["POST","PUT"];t=Vt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,T,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():j.g(),this.v=this.o?Pl(this.o):Pl(j),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(ne){Ov(this,ne);return}if(u=T||"",T=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var X in N)T.set(X,N[X]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ne of N.keys())T.set(ne,N.get(ne));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(T.keys()).find(ne=>ne.toLowerCase()=="content-type"),X=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(FI,g,void 0))||N||X||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,Te]of T)this.g.setRequestHeader(ne,Te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Mv(this),this.u=!0,this.g.send(u),this.u=!1}catch(ne){Ov(this,ne)}};function Ov(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Lv(u),nf(u)}function Lv(u){u.A||(u.A=!0,Ht(u,"complete"),Ht(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ht(this,"complete"),Ht(this,"abort"),nf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nf(this,!0)),Vt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?bv(this):this.bb())},t.bb=function(){bv(this)};function bv(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Oi(u)!=4||u.Z()!=2)){if(u.u&&Oi(u)==4)mn(u.Ea,0,u);else if(Ht(u,"readystatechange"),Oi(u)==4){u.h=!1;try{const Te=u.Z();e:switch(Te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var T;if(!(T=g)){var N;if(N=Te===0){var X=String(u.D).match(Av)[1]||null;!X&&o.self&&o.self.location&&(X=o.self.location.protocol.slice(0,-1)),N=!PI.test(X?X.toLowerCase():"")}T=N}if(T)Ht(u,"complete"),Ht(u,"success");else{u.m=6;try{var ne=2<Oi(u)?u.g.statusText:""}catch{ne=""}u.l=ne+" ["+u.Z()+"]",Lv(u)}}finally{nf(u)}}}}function nf(u,g){if(u.g){Mv(u);const T=u.g,N=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Ht(u,"ready");try{T.onreadystatechange=N}catch{}}}function Mv(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Oi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Oi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),nd(g)}};function Vv(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function NI(u){const g={};u=(u.g&&2<=Oi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<u.length;N++){if(E(u[N]))continue;var T=P(u[N]);const X=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const ne=g[X]||[];g[X]=ne,ne.push(T)}w(g,function(N){return N.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vl(u,g,T){return T&&T.internalChannelParams&&T.internalChannelParams[u]||g}function Bv(u){this.Aa=0,this.i=[],this.j=new ha,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vl("baseRetryDelayMs",5e3,u),this.cb=Vl("retryDelaySeedMs",1e4,u),this.Wa=Vl("forwardChannelMaxRetries",2,u),this.wa=Vl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ds(u&&u.concurrentRequestLimit),this.Da=new CI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Bv.prototype,t.la=8,t.G=1,t.connect=function(u,g,T,N){mr(0),this.W=u,this.H=g||{},T&&N!==void 0&&(this.H.OSID=T,this.H.OAID=N),this.F=this.X,this.I=Xv(this,null,this.W),af(this)};function cd(u){if(Uv(u),u.G==3){var g=u.U++,T=Di(u.I);if(xt(T,"SID",u.K),xt(T,"RID",g),xt(T,"TYPE","terminate"),Bl(u,T),g=new ie(u,u.j,g),g.L=2,g.v=ef(Di(T)),T=!1,o.navigator&&o.navigator.sendBeacon)try{T=o.navigator.sendBeacon(g.v.toString(),"")}catch{}!T&&o.Image&&(new Image().src=g.v,T=!0),T||(g.g=qv(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Se(g)}Kv(u)}function sf(u){u.g&&(fd(u),u.g.cancel(),u.g=null)}function Uv(u){sf(u),u.u&&(o.clearTimeout(u.u),u.u=null),of(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function af(u){if(!ui(u.h)&&!u.s){u.s=!0;var g=u.Ga;te||se(),re||(te(),re=!0),H.add(g,u),u.B=0}}function DI(u,g){return fo(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Fi(d(u.Ga,u,g),Gv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const X=new ie(this,this.j,u);let ne=this.o;if(this.S&&(ne?(ne=k(ne),C(ne,this.S)):ne=this.S),this.m!==null||this.O||(X.H=ne,ne=null),this.P)e:{for(var g=0,T=0;T<this.i.length;T++){t:{var N=this.i[T];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(g+=N,4096<g){g=T;break e}if(g===4096||T===this.i.length-1){g=T+1;break e}}g=1e3}else g=1e3;g=Wv(this,X,g),T=Di(this.I),xt(T,"RID",u),xt(T,"CVER",22),this.D&&xt(T,"X-HTTP-Session-Id",this.D),Bl(this,T),ne&&(this.O?g="headers="+encodeURIComponent(String(Dv(ne)))+"&"+g:this.m&&ld(T,this.m,ne)),od(this.h,X),this.Ua&&xt(T,"TYPE","init"),this.P?(xt(T,"$req",g),xt(T,"SID","null"),X.T=!0,pe(X,T,null)):pe(X,T,g),this.G=2}}else this.G==3&&(u?jv(this,u):this.i.length==0||ui(this.h)||jv(this))};function jv(u,g){var T;g?T=g.l:T=u.U++;const N=Di(u.I);xt(N,"SID",u.K),xt(N,"RID",T),xt(N,"AID",u.T),Bl(u,N),u.m&&u.o&&ld(N,u.m,u.o),T=new ie(u,u.j,T,u.B+1),u.m===null&&(T.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Wv(u,T,1e3),T.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),od(u.h,T),pe(T,N,g)}function Bl(u,g){u.H&&b(u.H,function(T,N){xt(g,N,T)}),u.l&&Sv({},function(T,N){xt(g,N,T)})}function Wv(u,g,T){T=Math.min(u.i.length,T);var N=u.l?d(u.l.Na,u.l,u):null;e:{var X=u.i;let ne=-1;for(;;){const Te=["count="+T];ne==-1?0<T?(ne=X[0].g,Te.push("ofs="+ne)):ne=0:Te.push("ofs="+ne);let gt=!0;for(let gr=0;gr<T;gr++){let rt=X[gr].g;const Ir=X[gr].map;if(rt-=ne,0>rt)ne=Math.max(0,X[gr].g-100),gt=!1;else try{RI(Ir,Te,"req"+rt+"_")}catch{N&&N(Ir)}}if(gt){N=Te.join("&");break e}}}return u=u.i.splice(0,T),g.D=u,N}function Hv(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;te||se(),re||(te(),re=!0),H.add(g,u),u.v=0}}function ud(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Fi(d(u.Fa,u),Gv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,zv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Fi(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mr(10),sf(this),zv(this))};function fd(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function zv(u){u.g=new ie(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Di(u.qa);xt(g,"RID","rpc"),xt(g,"SID",u.K),xt(g,"AID",u.T),xt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&xt(g,"TO",u.ja),xt(g,"TYPE","xmlhttp"),Bl(u,g),u.m&&u.o&&ld(g,u.m,u.o),u.L&&(u.g.I=u.L);var T=u.g;u=u.ia,T.L=1,T.v=ef(Di(g)),T.m=null,T.P=!0,Ee(T,u)}t.Za=function(){this.C!=null&&(this.C=null,sf(this),ud(this),mr(19))};function of(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function $v(u,g){var T=null;if(u.g==g){of(u),fd(u),u.g=null;var N=2}else if(gn(u.h,g))T=g.D,Tv(u.h,g),N=1;else return;if(u.G!=0){if(g.o)if(N==1){T=g.m?g.m.length:0,g=Date.now()-g.F;var X=u.B;N=uo(),Ht(N,new Qu(N,T)),af(u)}else Hv(u);else if(X=g.s,X==3||X==0&&0<g.X||!(N==1&&DI(u,g)||N==2&&ud(u)))switch(T&&0<T.length&&(g=u.h,g.i=g.i.concat(T)),X){case 1:ma(u,5);break;case 4:ma(u,10);break;case 3:ma(u,6);break;default:ma(u,2)}}}function Gv(u,g){let T=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(T*=2),T*g}function ma(u,g){if(u.j.info("Error code "+g),g==2){var T=d(u.fb,u),N=u.Xa;const X=!N;N=new pa(N||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ju(N,"https"),ef(N),X?AI(N.toString(),T):II(N.toString(),T)}else mr(2);u.G=0,u.l&&u.l.sa(g),Kv(u),Uv(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),mr(2)):(this.j.info("Failed to ping google.com"),mr(1))};function Kv(u){if(u.G=0,u.ka=[],u.l){const g=kv(u.h);(g.length!=0||u.i.length!=0)&&(_(u.ka,g),_(u.ka,u.i),u.h.i.length=0,m(u.i),u.i.length=0),u.l.ra()}}function Xv(u,g,T){var N=T instanceof pa?Di(T):new pa(T);if(N.g!="")g&&(N.g=g+"."+N.g),Zu(N,N.s);else{var X=o.location;N=X.protocol,g=g?g+"."+X.hostname:X.hostname,X=+X.port;var ne=new pa(null);N&&Ju(ne,N),g&&(ne.g=g),X&&Zu(ne,X),T&&(ne.l=T),N=ne}return T=u.D,g=u.ya,T&&g&&xt(N,T,g),xt(N,"VER",u.la),Bl(u,N),N}function qv(u,g,T){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Vt(new tf({eb:T})):new Vt(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yv(){}t=Yv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function lf(){}lf.prototype.g=function(u,g){return new vn(u,g)};function vn(u,g){_t.call(this),this.g=new Bv(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!E(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!E(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new po(this)}v(vn,_t),vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){cd(this.g)},vn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var T={};T.__data__=u,u=T}else this.u&&(T={},T.__data__=lo(u),u=T);g.i.push(new da(g.Ya++,u)),g.G==3&&af(g)},vn.prototype.N=function(){this.g.l=null,delete this.j,cd(this.g),delete this.g,vn.aa.N.call(this)};function Qv(u){Nl.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const T in g){u=T;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}v(Qv,Nl);function Jv(){hs.call(this),this.status=1}v(Jv,hs);function po(u){this.g=u}v(po,Yv),po.prototype.ua=function(){Ht(this.g,"a")},po.prototype.ta=function(u){Ht(this.g,new Qv(u))},po.prototype.sa=function(u){Ht(this.g,new Jv)},po.prototype.ra=function(){Ht(this.g,"b")},lf.prototype.createWebChannel=lf.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,zT=function(){return new lf},HT=function(){return uo()},WT=Pi,dm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},O.NO_ERROR=0,O.TIMEOUT=8,O.HTTP_ERROR=6,a0=O,B.COMPLETE="complete",jT=B,Fl.EventType=ua,ua.OPEN="a",ua.CLOSE="b",ua.ERROR="c",ua.MESSAGE="d",_t.prototype.listen=_t.prototype.K,rc=Fl,Vt.prototype.listenOnce=Vt.prototype.L,Vt.prototype.getLastError=Vt.prototype.Ka,Vt.prototype.getLastErrorCode=Vt.prototype.Ba,Vt.prototype.getStatus=Vt.prototype.Z,Vt.prototype.getResponseJson=Vt.prototype.Oa,Vt.prototype.getResponseText=Vt.prototype.oa,Vt.prototype.send=Vt.prototype.ea,Vt.prototype.setWithCredentials=Vt.prototype.Ha,UT=Vt}).apply(typeof Cf<"u"?Cf:typeof self<"u"?self:typeof window<"u"?window:{});const Vx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dr.UNAUTHENTICATED=new Dr(null),Dr.GOOGLE_CREDENTIALS=new Dr("google-credentials-uid"),Dr.FIRST_PARTY=new Dr("first-party-uid"),Dr.MOCK_USER=new Dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=new Og("@firebase/firestore");function Xl(){return ja.logLevel}function Re(t,...e){if(ja.logLevel<=Qe.DEBUG){const r=e.map(Xg);ja.debug(`Firestore (${Tl}): ${t}`,...r)}}function ns(t,...e){if(ja.logLevel<=Qe.ERROR){const r=e.map(Xg);ja.error(`Firestore (${Tl}): ${t}`,...r)}}function cl(t,...e){if(ja.logLevel<=Qe.WARN){const r=e.map(Xg);ja.warn(`Firestore (${Tl}): ${t}`,...r)}}function Xg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t="Unexpected state"){const e=`FIRESTORE (${Tl}) INTERNAL ASSERTION FAILED: `+t;throw ns(e),new Error(e)}function ht(t,e){t||Ve()}function je(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends os{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Dr.UNAUTHENTICATED))}shutdown(){}}class sN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class aN{constructor(e){this.t=e,this.currentUser=Dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ht(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Ki;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ki,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ki)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ht(typeof n.accessToken=="string"),new $T(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ht(e===null||typeof e=="string"),new Dr(e)}}class oN{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Dr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lN{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new oN(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Dr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uN{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){ht(this.o===void 0);const n=s=>{s.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ht(typeof r.token=="string"),this.R=r.token,new cN(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=fN(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function it(t,e){return t<e?-1:t>e?1:0}function ul(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ie(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ie(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ie(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return sr.fromMillis(Date.now())}static fromDate(e){return sr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new sr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new sr(0,0))}static max(){return new Ue(new sr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ve(),n===void 0?n=e.length-r:n>e.length-r&&Ve(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Qc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Qc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Et extends Qc{construct(e,r,n){return new Et(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ie(le.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Et(r)}static emptyPath(){return new Et([])}}const hN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wr extends Qc{construct(e,r,n){return new wr(e,r,n)}static isValidIdentifier(e){return hN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new wr(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Ie(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Ie(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ie(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Ie(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wr(r)}static emptyPath(){return new wr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Et.fromString(e))}static fromName(e){return new Fe(Et.fromString(e).popFirst(5))}static empty(){return new Fe(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Et.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Et(e.slice()))}}function dN(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(n===1e9?new sr(r+1,0):new sr(r,n));return new Xs(i,Fe.empty(),e)}function pN(t){return new Xs(t.readTime,t.key,-1)}class Xs{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Xs(Ue.min(),Fe.empty(),-1)}static max(){return new Xs(Ue.max(),Fe.empty(),-1)}}function mN(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Fe.comparator(t.documentKey,e.documentKey),r!==0?r:it(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cu(t){if(t.code!==le.FAILED_PRECONDITION||t.message!==gN)throw t;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new he((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof he?r:he.resolve(r)}catch(r){return he.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):he.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):he.reject(r)}static resolve(e){return new he((r,n)=>{r(e)})}static reject(e){return new he((r,n)=>{n(e)})}static waitFor(e){return new he((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=he.resolve(!1);for(const n of e)r=r.next(i=>i?he.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new he((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(f=>{a[c]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new he((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function _N(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ru(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}qg.oe=-1;function Dh(t){return t==null}function H0(t){return t===0&&1/t==-1/0}function xN(t){return typeof t=="number"&&Number.isInteger(t)&&!H0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Za(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function KT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,r){this.comparator=e,this.root=r||xr.EMPTY}insert(e,r){return new bt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,xr.BLACK,null,null))}remove(e){return new bt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rf(this.root,e,this.comparator,!0)}}class Rf{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??xr.RED,this.left=i??xr.EMPTY,this.right=s??xr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new xr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return xr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return xr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ve();const e=this.left.check();if(e!==this.right.check())throw Ve();return e+(this.isRed()?0:1)}}xr.EMPTY=null,xr.RED=!0,xr.BLACK=!1;xr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve()}get value(){throw Ve()}get color(){throw Ve()}get left(){throw Ve()}get right(){throw Ve()}copy(e,r,n,i,s){return this}insert(e,r,n){return new xr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.comparator=e,this.data=new bt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Ux(this.data.getIterator())}getIteratorFrom(e){return new Ux(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof kr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new kr(this.comparator);return r.data=e,r}}class Ux{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.fields=e,e.sort(wr.comparator)}static empty(){return new kn([])}unionWith(e){let r=new kr(wr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new kn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ul(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new XT("Invalid base64 string: "+s):s}}(e);return new Ar(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ar(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ar.EMPTY_BYTE_STRING=new Ar("");const yN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qs(t){if(ht(!!t),typeof t=="string"){let e=0;const r=yN.exec(t);if(ht(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:$t(t.seconds),nanos:$t(t.nanos)}}function $t(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wa(t){return typeof t=="string"?Ar.fromBase64String(t):Ar.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Qg(t){const e=t.mapValue.fields.__previous_value__;return Yg(e)?Qg(e):e}function Jc(t){const e=qs(t.mapValue.fields.__local_write_time__.timestampValue);return new sr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Zc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Zc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf={mapValue:{}};function Ha(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Yg(t)?4:TN(t)?9007199254740991:EN(t)?10:11:Ve()}function Si(t,e){if(t===e)return!0;const r=Ha(t);if(r!==Ha(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jc(t).isEqual(Jc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=qs(i.timestampValue),o=qs(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Wa(i.bytesValue).isEqual(Wa(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return $t(i.geoPointValue.latitude)===$t(s.geoPointValue.latitude)&&$t(i.geoPointValue.longitude)===$t(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return $t(i.integerValue)===$t(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=$t(i.doubleValue),o=$t(s.doubleValue);return a===o?H0(a)===H0(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return ul(t.arrayValue.values||[],e.arrayValue.values||[],Si);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Bx(a)!==Bx(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Si(a[l],o[l])))return!1;return!0}(t,e);default:return Ve()}}function eu(t,e){return(t.values||[]).find(r=>Si(r,e))!==void 0}function fl(t,e){if(t===e)return 0;const r=Ha(t),n=Ha(e);if(r!==n)return it(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return it(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=$t(s.integerValue||s.doubleValue),l=$t(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return jx(t.timestampValue,e.timestampValue);case 4:return jx(Jc(t),Jc(e));case 5:return it(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Wa(s),l=Wa(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=it(o[c],l[c]);if(f!==0)return f}return it(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=it($t(s.latitude),$t(a.latitude));return o!==0?o:it($t(s.longitude),$t(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Wx(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,f;const h=s.fields||{},d=a.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,v=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=it(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0);return m!==0?m:Wx(p,v)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Pf.mapValue&&a===Pf.mapValue)return 0;if(s===Pf.mapValue)return 1;if(a===Pf.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=it(l[h],f[h]);if(d!==0)return d;const p=fl(o[l[h]],c[f[h]]);if(p!==0)return p}return it(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Ve()}}function jx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return it(t,e);const r=qs(t),n=qs(e),i=it(r.seconds,n.seconds);return i!==0?i:it(r.nanos,n.nanos)}function Wx(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=fl(r[i],n[i]);if(s)return s}return it(r.length,n.length)}function hl(t){return pm(t)}function pm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=qs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Wa(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Fe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=pm(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${pm(r.fields[a])}`;return i+"}"}(t.mapValue):Ve()}function Hx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mm(t){return!!t&&"integerValue"in t}function Jg(t){return!!t&&"arrayValue"in t}function zx(t){return!!t&&"nullValue"in t}function $x(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function o0(t){return!!t&&"mapValue"in t}function EN(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function yc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Za(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=yc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=yc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function TN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!o0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=yc(r)}setAll(e){let r=wr.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=yc(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());o0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Si(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];o0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Za(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new on(yc(this.value))}}function qT(t){const e=[];return Za(t.fields,(r,n)=>{const i=new wr([r]);if(o0(n)){const s=qT(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new kn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Mr(e,0,Ue.min(),Ue.min(),Ue.min(),on.empty(),0)}static newFoundDocument(e,r,n,i){return new Mr(e,1,r,Ue.min(),n,i,0)}static newNoDocument(e,r){return new Mr(e,2,r,Ue.min(),Ue.min(),on.empty(),0)}static newUnknownDocument(e,r){return new Mr(e,3,r,Ue.min(),Ue.min(),on.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e,r){this.position=e,this.inclusive=r}}function Gx(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Fe.comparator(Fe.fromName(a.referenceValue),r.key):n=fl(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Kx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Si(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e,r="asc"){this.field=e,this.dir=r}}function kN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{}class tr extends YT{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new AN(e,r,n):r==="array-contains"?new RN(e,n):r==="in"?new PN(e,n):r==="not-in"?new FN(e,n):r==="array-contains-any"?new NN(e,n):new tr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new IN(e,n):new CN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(fl(r,this.value)):r!==null&&Ha(this.value)===Ha(r)&&this.matchesComparison(fl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class li extends YT{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new li(e,r)}matches(e){return QT(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function QT(t){return t.op==="and"}function JT(t){return SN(t)&&QT(t)}function SN(t){for(const e of t.filters)if(e instanceof li)return!1;return!0}function gm(t){if(t instanceof tr)return t.field.canonicalString()+t.op.toString()+hl(t.value);if(JT(t))return t.filters.map(e=>gm(e)).join(",");{const e=t.filters.map(r=>gm(r)).join(",");return`${t.op}(${e})`}}function ZT(t,e){return t instanceof tr?function(n,i){return i instanceof tr&&n.op===i.op&&n.field.isEqual(i.field)&&Si(n.value,i.value)}(t,e):t instanceof li?function(n,i){return i instanceof li&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&ZT(a,i.filters[o]),!0):!1}(t,e):void Ve()}function ek(t){return t instanceof tr?function(r){return`${r.field.canonicalString()} ${r.op} ${hl(r.value)}`}(t):t instanceof li?function(r){return r.op.toString()+" {"+r.getFilters().map(ek).join(" ,")+"}"}(t):"Filter"}class AN extends tr{constructor(e,r,n){super(e,r,n),this.key=Fe.fromName(n.referenceValue)}matches(e){const r=Fe.comparator(e.key,this.key);return this.matchesComparison(r)}}class IN extends tr{constructor(e,r){super(e,"in",r),this.keys=tk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class CN extends tr{constructor(e,r){super(e,"not-in",r),this.keys=tk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function tk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class RN extends tr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Jg(r)&&eu(r.arrayValue,this.value)}}class PN extends tr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&eu(this.value.arrayValue,r)}}class FN extends tr{constructor(e,r){super(e,"not-in",r)}matches(e){if(eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!eu(this.value.arrayValue,r)}}class NN extends tr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Jg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>eu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function Xx(t,e=null,r=[],n=[],i=null,s=null,a=null){return new DN(t,e,r,n,i,s,a)}function Zg(t){const e=je(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>gm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Dh(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>hl(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>hl(n)).join(",")),e.ue=r}return e.ue}function e1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!kN(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!ZT(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Kx(t.startAt,e.startAt)&&Kx(t.endAt,e.endAt)}function vm(t){return Fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ON(t,e,r,n,i,s,a,o){return new Pu(t,e,r,n,i,s,a,o)}function Oh(t){return new Pu(t)}function qx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rk(t){return t.collectionGroup!==null}function wc(t){const e=je(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new kr(wr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new $0(s,n))}),r.has(wr.keyField().canonicalString())||e.ce.push(new $0(wr.keyField(),n))}return e.ce}function Ti(t){const e=je(t);return e.le||(e.le=LN(e,wc(t))),e.le}function LN(t,e){if(t.limitType==="F")return Xx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new $0(i.field,s)});const r=t.endAt?new z0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new z0(t.startAt.position,t.startAt.inclusive):null;return Xx(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function _m(t,e){const r=t.filters.concat([e]);return new Pu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function xm(t,e,r){return new Pu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Lh(t,e){return e1(Ti(t),Ti(e))&&t.limitType===e.limitType}function nk(t){return`${Zg(Ti(t))}|lt:${t.limitType}`}function yo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>ek(i)).join(", ")}]`),Dh(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>hl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>hl(i)).join(",")),`Target(${n})`}(Ti(t))}; limitType=${t.limitType})`}function bh(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Fe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of wc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=Gx(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,wc(n),i)||n.endAt&&!function(a,o,l){const c=Gx(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,wc(n),i))}(t,e)}function bN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ik(t){return(e,r)=>{let n=!1;for(const i of wc(t)){const s=MN(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function MN(t,e,r){const n=t.field.isKeyField()?Fe.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?fl(l,c):Ve()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Za(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return KT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=new bt(Fe.comparator);function is(){return VN}const sk=new bt(Fe.comparator);function nc(...t){let e=sk;for(const r of t)e=e.insert(r.key,r);return e}function ak(t){let e=sk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ta(){return Ec()}function ok(){return Ec()}function Ec(){return new kl(t=>t.toString(),(t,e)=>t.isEqual(e))}const BN=new bt(Fe.comparator),UN=new kr(Fe.comparator);function Ye(...t){let e=UN;for(const r of t)e=e.add(r);return e}const jN=new kr(it);function WN(){return jN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:H0(e)?"-0":e}}function lk(t){return{integerValue:""+t}}function HN(t,e){return xN(e)?lk(e):t1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(){this._=void 0}}function zN(t,e,r){return t instanceof G0?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Yg(s)&&(s=Qg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof tu?uk(t,e):t instanceof ru?fk(t,e):function(i,s){const a=ck(i,s),o=Yx(a)+Yx(i.Pe);return mm(a)&&mm(i.Pe)?lk(o):t1(i.serializer,o)}(t,e)}function $N(t,e,r){return t instanceof tu?uk(t,e):t instanceof ru?fk(t,e):r}function ck(t,e){return t instanceof K0?function(n){return mm(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class G0 extends Mh{}class tu extends Mh{constructor(e){super(),this.elements=e}}function uk(t,e){const r=hk(e);for(const n of t.elements)r.some(i=>Si(i,n))||r.push(n);return{arrayValue:{values:r}}}class ru extends Mh{constructor(e){super(),this.elements=e}}function fk(t,e){let r=hk(e);for(const n of t.elements)r=r.filter(i=>!Si(i,n));return{arrayValue:{values:r}}}class K0 extends Mh{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Yx(t){return $t(t.integerValue||t.doubleValue)}function hk(t){return Jg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function GN(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof tu&&i instanceof tu||n instanceof ru&&i instanceof ru?ul(n.elements,i.elements,Si):n instanceof K0&&i instanceof K0?Si(n.Pe,i.Pe):n instanceof G0&&i instanceof G0}(t.transform,e.transform)}class KN{constructor(e,r){this.version=e,this.transformResults=r}}class Qr{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Qr}static exists(e){return new Qr(void 0,e)}static updateTime(e){return new Qr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function l0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Vh{}function dk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Bh(t.key,Qr.none()):new Fu(t.key,t.data,Qr.none());{const r=t.data,n=on.empty();let i=new kr(wr.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new sa(t.key,n,new kn(i.toArray()),Qr.none())}}function XN(t,e,r){t instanceof Fu?function(i,s,a){const o=i.value.clone(),l=Jx(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof sa?function(i,s,a){if(!l0(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=Jx(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(pk(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Tc(t,e,r,n){return t instanceof Fu?function(s,a,o,l){if(!l0(s.precondition,a))return o;const c=s.value.clone(),f=Zx(s.fieldTransforms,l,a);return c.setAll(f),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof sa?function(s,a,o,l){if(!l0(s.precondition,a))return o;const c=Zx(s.fieldTransforms,l,a),f=a.data;return f.setAll(pk(s)),f.setAll(c),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return l0(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function qN(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=ck(n.transform,i||null);s!=null&&(r===null&&(r=on.empty()),r.set(n.field,s))}return r||null}function Qx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ul(n,i,(s,a)=>GN(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Fu extends Vh{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class sa extends Vh{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Jx(t,e,r){const n=new Map;ht(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,$N(a,o,r[i]))}return n}function Zx(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,zN(s,a,e))}return n}class Bh extends Vh{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class YN extends Vh{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&XN(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Tc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Tc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=ok();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=dk(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ye())}isEqual(e){return this.batchId===e.batchId&&ul(this.mutations,e.mutations,(r,n)=>Qx(r,n))&&ul(this.baseMutations,e.baseMutations,(r,n)=>Qx(r,n))}}class r1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){ht(e.mutations.length===n.length);let i=function(){return BN}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new r1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt,Je;function eD(t){switch(t){default:return Ve();case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0}}function mk(t){if(t===void 0)return ns("GRPC error has no .code"),le.UNKNOWN;switch(t){case Qt.OK:return le.OK;case Qt.CANCELLED:return le.CANCELLED;case Qt.UNKNOWN:return le.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return le.INTERNAL;case Qt.UNAVAILABLE:return le.UNAVAILABLE;case Qt.UNAUTHENTICATED:return le.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case Qt.NOT_FOUND:return le.NOT_FOUND;case Qt.ALREADY_EXISTS:return le.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return le.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case Qt.ABORTED:return le.ABORTED;case Qt.OUT_OF_RANGE:return le.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return le.UNIMPLEMENTED;case Qt.DATA_LOSS:return le.DATA_LOSS;default:return Ve()}}(Je=Qt||(Qt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD=new Ia([4294967295,4294967295],0);function ey(t){const e=tD().encode(t),r=new BT;return r.update(e),new Uint8Array(r.digest())}function ty(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ia([r,n],0),new Ia([i,s],0)]}class n1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ic(`Invalid padding: ${r}`);if(n<0)throw new ic(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ic(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ic(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Ia.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Ia.fromNumber(n)));return i.compare(rD)===1&&(i=new Ia([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=ey(e),[n,i]=ty(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n1(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=ey(e),[n,i]=ty(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ic extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Uh(Ue.min(),i,new bt(it),is(),Ye())}}class Nu{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Nu(n,r,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class gk{constructor(e,r){this.targetId=e,this.me=r}}class vk{constructor(e,r,n=Ar.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ry{constructor(){this.fe=0,this.ge=iy(),this.pe=Ar.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ye(),r=Ye(),n=Ye();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ve()}}),new Nu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=iy()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ht(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class nD{constructor(e){this.Le=e,this.Be=new Map,this.ke=is(),this.qe=ny(),this.Qe=new bt(it)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Ve()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(vm(s))if(n===0){const a=new Fe(s.path);this.Ue(r,a,Mr.newNoDocument(a,Ue.min()))}else ht(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Wa(n).toUint8Array()}catch(l){if(l instanceof XT)return cl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new n1(a,i,s)}catch(l){return cl(l instanceof ic?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&vm(o.target)){const l=new Fe(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Mr.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Ye();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Uh(e,r,this.Qe,this.ke,n);return this.ke=is(),this.qe=ny(),this.Qe=new bt(it),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new ry,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new kr(it),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Re("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ry),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function ny(){return new bt(Fe.comparator)}function iy(){return new bt(Fe.comparator)}const iD={asc:"ASCENDING",desc:"DESCENDING"},sD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aD={and:"AND",or:"OR"};class oD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function ym(t,e){return t.useProto3Json||Dh(e)?e:{value:e}}function X0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _k(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function lD(t,e){return X0(t,e.toTimestamp())}function ki(t){return ht(!!t),Ue.fromTimestamp(function(r){const n=qs(r);return new sr(n.seconds,n.nanos)}(t))}function i1(t,e){return wm(t,e).canonicalString()}function wm(t,e){const r=function(i){return new Et(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function xk(t){const e=Et.fromString(t);return ht(kk(e)),e}function Em(t,e){return i1(t.databaseId,e.path)}function Gd(t,e){const r=xk(e);if(r.get(1)!==t.databaseId.projectId)throw new Ie(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ie(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Fe(wk(r))}function yk(t,e){return i1(t.databaseId,e)}function cD(t){const e=xk(t);return e.length===4?Et.emptyPath():wk(e)}function Tm(t){return new Et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wk(t){return ht(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function sy(t,e,r){return{name:Em(t,e),fields:r.value.mapValue.fields}}function uD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ve()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,f){return c.useProto3Json?(ht(f===void 0||typeof f=="string"),Ar.fromBase64String(f||"")):(ht(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ar.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const f=c.code===void 0?le.UNKNOWN:mk(c.code);return new Ie(f,c.message||"")}(a);r=new vk(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gd(t,n.document.name),s=ki(n.document.updateTime),a=n.document.createTime?ki(n.document.createTime):Ue.min(),o=new on({mapValue:{fields:n.document.fields}}),l=Mr.newFoundDocument(i,s,a,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new c0(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Gd(t,n.document),s=n.readTime?ki(n.readTime):Ue.min(),a=Mr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new c0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Gd(t,n.document),s=n.removedTargetIds||[];r=new c0([],s,i,null)}else{if(!("filter"in e))return Ve();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new ZN(i,s),o=n.targetId;r=new gk(o,a)}}return r}function fD(t,e){let r;if(e instanceof Fu)r={update:sy(t,e.key,e.value)};else if(e instanceof Bh)r={delete:Em(t,e.key)};else if(e instanceof sa)r={update:sy(t,e.key,e.data),updateMask:yD(e.fieldMask)};else{if(!(e instanceof YN))return Ve();r={verify:Em(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof G0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof tu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ru)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof K0)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Ve()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:lD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ve()}(t,e.precondition)),r}function hD(t,e){return t&&t.length>0?(ht(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ki(i.updateTime):ki(s);return a.isEqual(Ue.min())&&(a=ki(s)),new KN(a,i.transformResults||[])}(r,e))):[]}function dD(t,e){return{documents:[yk(t,e.path)]}}function pD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=yk(t,i);const s=function(c){if(c.length!==0)return Tk(li.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:wo(d.field),direction:vD(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=ym(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function mD(t){let e=cD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){ht(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=Ek(h);return d instanceof li&&JT(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(v){return new $0(Eo(v.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,Dh(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new z0(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new z0(p,d)}(r.endAt)),ON(e,i,a,s,o,"F",l,c)}function gD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Ek(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Eo(r.unaryFilter.field);return tr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Eo(r.unaryFilter.field);return tr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Eo(r.unaryFilter.field);return tr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Eo(r.unaryFilter.field);return tr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ve()}}(t):t.fieldFilter!==void 0?function(r){return tr.create(Eo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ve()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return li.create(r.compositeFilter.filters.map(n=>Ek(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ve()}}(r.compositeFilter.op))}(t):Ve()}function vD(t){return iD[t]}function _D(t){return sD[t]}function xD(t){return aD[t]}function wo(t){return{fieldPath:t.canonicalString()}}function Eo(t){return wr.fromServerFormat(t.fieldPath)}function Tk(t){return t instanceof tr?function(r){if(r.op==="=="){if($x(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NAN"}};if(zx(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if($x(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NOT_NAN"}};if(zx(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wo(r.field),op:_D(r.op),value:r.value}}}(t):t instanceof li?function(r){const n=r.getFilters().map(i=>Tk(i));return n.length===1?n[0]:{compositeFilter:{op:xD(r.op),filters:n}}}(t):Ve()}function yD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function kk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,r,n,i,s=Ue.min(),a=Ue.min(),o=Ar.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e){this.ct=e}}function ED(t){const e=mD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(){this.un=new kD}addToCollectionParentIndex(e,r){return this.un.add(r),he.resolve()}getCollectionParents(e,r){return he.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return he.resolve()}deleteFieldIndex(e,r){return he.resolve()}deleteAllFieldIndexes(e){return he.resolve()}createTargetIndexes(e,r){return he.resolve()}getDocumentsMatchingTarget(e,r){return he.resolve(null)}getIndexType(e,r){return he.resolve(0)}getFieldIndexes(e,r){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,r){return he.resolve(Xs.min())}getMinOffsetFromCollectionGroup(e,r){return he.resolve(Xs.min())}updateCollectionGroup(e,r,n){return he.resolve()}updateIndexEntries(e,r){return he.resolve()}}class kD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new kr(Et.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new kr(Et.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new dl(0)}static kn(){return new dl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(){this.changes=new kl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Mr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?he.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Tc(n.mutation,i,kn.empty(),sr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ye()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ye()){const i=Ta();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=nc();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ta();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ye()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=is();const a=Ec(),o=function(){return Ec()}();return r.forEach((l,c)=>{const f=n.get(c.key);i.has(c.key)&&(f===void 0||f.mutation instanceof sa)?s=s.insert(c.key,c):f!==void 0?(a.set(c.key,f.mutation.getFieldMask()),Tc(f.mutation,c,f.mutation.getFieldMask(),sr.now())):a.set(c.key,kn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,f)=>a.set(c,f)),r.forEach((c,f)=>{var h;return o.set(c,new AD(f,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Ec();let i=new bt((a,o)=>a-o),s=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||kn.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(i.get(o.batchId)||Ye()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=ok();f.forEach(d=>{if(!s.has(d)){const p=dk(r.get(d),n.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return he.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):rk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):he.resolve(Ta());let o=-1,l=s;return a.next(c=>he.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?he.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Ye())).next(f=>({batchId:o,changes:ak(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Fe(r)).next(n=>{let i=nc();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=nc();return this.indexManager.getCollectionParents(e,s).next(o=>he.forEach(o,l=>{const c=function(h,d){return new Pu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const f=c.getKey();a.get(f)===null&&(a=a.insert(f,Mr.newInvalidDocument(f)))});let o=nc();return a.forEach((l,c)=>{const f=s.get(l);f!==void 0&&Tc(f.mutation,c,kn.empty(),sr.now()),bh(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return he.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ki(i.createTime)}}(r)),he.resolve()}getNamedQuery(e,r){return he.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:ED(i.bundledQuery),readTime:ki(i.readTime)}}(r)),he.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.overlays=new bt(Fe.comparator),this.Ir=new Map}getOverlay(e,r){return he.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ta();return he.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),he.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),he.resolve()}getOverlaysForCollection(e,r,n){const i=Ta(),s=r.length+1,a=new Fe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return he.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new bt((c,f)=>c-f);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=s.get(c.largestBatchId);f===null&&(f=Ta(),s=s.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=Ta(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=i)););return he.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new JN(r,n));let s=this.Ir.get(r);s===void 0&&(s=Ye(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(){this.sessionToken=Ar.EMPTY_BYTE_STRING}getSessionToken(e){return he.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,he.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(){this.Tr=new kr(lr.Er),this.dr=new kr(lr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new lr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new lr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Fe(new Et([])),n=new lr(r,e),i=new lr(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Fe(new Et([])),n=new lr(r,e),i=new lr(r,e+1);let s=Ye();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new lr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class lr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Fe.comparator(e.key,r.key)||it(e.wr,r.wr)}static Ar(e,r){return it(e.wr,r.wr)||Fe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new kr(lr.Er)}checkEmpty(e){return he.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new QN(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new lr(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return he.resolve(a)}lookupMutationBatch(e,r){return he.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return he.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),he.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new kr(it);return r.forEach(i=>{const s=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),he.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Fe.isDocumentKey(s)||(s=s.child(""));const a=new lr(new Fe(s),0);let o=new kr(it);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),he.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){ht(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return he.forEach(r.mutations,i=>{const s=new lr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new lr(r,0),i=this.br.firstAfterOrEqual(n);return he.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,he.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.Mr=e,this.docs=function(){return new bt(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return he.resolve(n?n.document.mutableCopy():Mr.newInvalidDocument(r))}getEntries(e,r){let n=is();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Mr.newInvalidDocument(i))}),he.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=is();const a=r.path,o=new Fe(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||mN(pN(f),n)<=0||(i.has(f.key)||bh(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return he.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Ve()}Or(e,r){return he.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new DD(this)}getSize(e){return he.resolve(this.size)}}class DD extends SD{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),he.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e){this.persistence=e,this.Nr=new kl(r=>Zg(r),e1),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new s1,this.targetCount=0,this.kr=dl.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),he.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new dl(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,he.resolve()}updateTargetData(e,r){return this.Kn(r),he.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),he.waitFor(s).next(()=>i)}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return he.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),he.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),he.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),he.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return he.resolve(n)}containsKey(e,r){return he.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,r){this.qr={},this.overlays={},this.Qr=new qg(0),this.Kr=!1,this.Kr=!0,this.$r=new PD,this.referenceDelegate=e(this),this.Ur=new OD(this),this.indexManager=new TD,this.remoteDocumentCache=function(i){return new ND(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new wD(r),this.Gr=new CD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new RD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new FD(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Re("MemoryPersistence","Starting transaction:",e);const i=new bD(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return he.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class bD extends vN{constructor(e){super(),this.currentSequenceNumber=e}}class a1{constructor(e){this.persistence=e,this.Jr=new s1,this.Yr=null}static Zr(e){return new a1(e)}get Xr(){if(this.Yr)return this.Yr;throw Ve()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),he.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),he.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),he.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.Xr,n=>{const i=Fe.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Ue.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return he.or([()=>he.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Ye(),i=Ye();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new o1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ER()?8:_N(Hr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new MD;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Xl()<=Qe.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",yo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),he.resolve()):(Xl()<=Qe.DEBUG&&Re("QueryEngine","Query:",yo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Xl()<=Qe.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",yo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ti(r))):he.resolve())}Yi(e,r){if(qx(r))return he.resolve(null);let n=Ti(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=xm(r,null,"F"),n=Ti(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Ye(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,xm(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return qx(r)||i.isEqual(Ue.min())?he.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?he.resolve(null):(Xl()<=Qe.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),yo(r)),this.rs(e,a,r,dN(i,-1)).next(o=>o))})}ts(e,r){let n=new kr(ik(e));return r.forEach((i,s)=>{bh(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Xl()<=Qe.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",yo(r)),this.Ji.getDocumentsMatchingQuery(e,r,Xs.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new bt(it),this._s=new kl(s=>Zg(s),e1),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ID(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function UD(t,e,r,n){return new BD(t,e,r,n)}async function Sk(t,e){const r=je(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Ye();for(const c of i){a.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of s){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function jD(t,e){const r=je(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let p=he.resolve();return d.forEach(v=>{p=p.next(()=>f.getEntry(l,v)).next(m=>{const _=c.docVersions.get(v);ht(_!==null),m.version.compareTo(_)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),f.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Ye();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Ak(t){const e=je(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function WD(t,e){const r=je(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Ar.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),i=i.insert(h,p),function(m,_,y){return m.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,p,f)&&o.push(r.Ur.updateTargetData(s,p))});let l=is(),c=Ye();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(HD(s,a,e.documentUpdates).next(f=>{l=f.Ps,c=f.Is})),!n.isEqual(Ue.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return he.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function HD(t,e,r){let n=Ye(),i=Ye();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=is();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ue.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Re("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function zD(t,e){const r=je(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function $D(t,e){const r=je(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,he.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Ps(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function km(t,e,r){const n=je(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ru(a))throw a;Re("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function ay(t,e,r){const n=je(t);let i=Ue.min(),s=Ye();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,f){const h=je(l),d=h._s.get(f);return d!==void 0?he.resolve(h.os.get(d)):h.Ur.getTargetData(c,f)}(n,a,Ti(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Ue.min(),r?s:Ye())).next(o=>(GD(n,bN(e),o),{documents:o,Ts:s})))}function GD(t,e,r){let n=t.us.get(e)||Ue.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class oy{constructor(){this.activeTargetIds=WN()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KD{constructor(){this.so=new oy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new oy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ff=null;function Kd(){return Ff===null?Ff=function(){return 268435456+Math.round(2147483648*Math.random())}():Ff++,"0x"+Ff.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="WebChannelConnection";class QD extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Kd(),l=this.xo(r,n.toUriEncodedString());Re("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(f=>(Re("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw cl("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=qD[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Kd();return new Promise((a,o)=>{const l=new UT;l.setWithCredentials(!0),l.listenOnce(jT.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case a0.NO_ERROR:const f=l.getResponseJson();Re(Fr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case a0.TIMEOUT:Re(Fr,`RPC '${e}' ${s} timed out`),o(new Ie(le.DEADLINE_EXCEEDED,"Request time out"));break;case a0.HTTP_ERROR:const h=l.getStatus();if(Re(Fr,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const v=function(_){const y=_.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(y)>=0?y:le.UNKNOWN}(p.status);o(new Ie(v,p.message))}else o(new Ie(le.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ie(le.UNAVAILABLE,"Connection failed."));break;default:Ve()}}finally{Re(Fr,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Re(Fr,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Kd(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=zT(),o=HT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Re(Fr,`Creating RPC '${e}' stream ${i}: ${f}`,l);const h=a.createWebChannel(f,l);let d=!1,p=!1;const v=new YD({Io:_=>{p?Re(Fr,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(d||(Re(Fr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Re(Fr,`RPC '${e}' stream ${i} sending:`,_),h.send(_))},To:()=>h.close()}),m=(_,y,E)=>{_.listen(y,x=>{try{E(x)}catch(F){setTimeout(()=>{throw F},0)}})};return m(h,rc.EventType.OPEN,()=>{p||(Re(Fr,`RPC '${e}' stream ${i} transport opened.`),v.yo())}),m(h,rc.EventType.CLOSE,()=>{p||(p=!0,Re(Fr,`RPC '${e}' stream ${i} transport closed`),v.So())}),m(h,rc.EventType.ERROR,_=>{p||(p=!0,cl(Fr,`RPC '${e}' stream ${i} transport errored:`,_),v.So(new Ie(le.UNAVAILABLE,"The operation could not be completed")))}),m(h,rc.EventType.MESSAGE,_=>{var y;if(!p){const E=_.data[0];ht(!!E);const x=E,F=x.error||((y=x[0])===null||y===void 0?void 0:y.error);if(F){Re(Fr,`RPC '${e}' stream ${i} received error:`,F);const U=F.status;let b=function(S){const C=Qt[S];if(C!==void 0)return mk(C)}(U),w=F.message;b===void 0&&(b=le.INTERNAL,w="Unknown error status: "+U+" with message "+F.message),p=!0,v.So(new Ie(b,w)),h.close()}else Re(Fr,`RPC '${e}' stream ${i} received:`,E),v.bo(E)}}),m(o,WT.STAT_EVENT,_=>{_.stat===dm.PROXY?Re(Fr,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===dm.NOPROXY&&Re(Fr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function Xd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(t){return new oD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ik(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===le.RESOURCE_EXHAUSTED?(ns(r.toString()),ns("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new Ie(le.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class JD extends Ck{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=uD(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?ki(a.readTime):Ue.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Tm(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=vm(l)?{documents:dD(s,l)}:{query:pD(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=_k(s,a.resumeToken);const c=ym(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ue.min())>0){o.readTime=X0(s,a.snapshotVersion.toTimestamp());const c=ym(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=gD(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Tm(this.serializer),r.removeTarget=e,this.a_(r)}}class ZD extends Ck{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return ht(!!e.streamToken),this.lastStreamToken=e.streamToken,ht(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ht(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=hD(e.writeResults,e.commitTime),n=ki(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Tm(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>fD(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Ie(le.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,wm(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ie(le.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,wm(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(le.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class tO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ns(r),this.D_=!1):Re("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{eo(this)&&(Re("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=je(l);c.L_.add(4),await Du(c),c.q_.set("Unknown"),c.L_.delete(4),await Wh(c)}(this))})}),this.q_=new tO(n,i)}}async function Wh(t){if(eo(t))for(const e of t.B_)await e(!0)}async function Du(t){for(const e of t.B_)await e(!1)}function Rk(t,e){const r=je(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),f1(r)?u1(r):Sl(r).r_()&&c1(r,e))}function l1(t,e){const r=je(t),n=Sl(r);r.N_.delete(e),n.r_()&&Pk(r,e),r.N_.size===0&&(n.r_()?n.o_():eo(r)&&r.q_.set("Unknown"))}function c1(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Sl(t).A_(e)}function Pk(t,e){t.Q_.xe(e),Sl(t).R_(e)}function u1(t){t.Q_=new nD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Sl(t).start(),t.q_.v_()}function f1(t){return eo(t)&&!Sl(t).n_()&&t.N_.size>0}function eo(t){return je(t).L_.size===0}function Fk(t){t.Q_=void 0}async function nO(t){t.q_.set("Online")}async function iO(t){t.N_.forEach((e,r)=>{c1(t,e)})}async function sO(t,e){Fk(t),f1(t)?(t.q_.M_(e),u1(t)):t.q_.set("Unknown")}async function aO(t,e,r){if(t.q_.set("Online"),e instanceof vk&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await q0(t,n)}else if(e instanceof c0?t.Q_.Ke(e):e instanceof gk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ue.min()))try{const n=await Ak(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(c);f&&s.N_.set(c,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(Ar.EMPTY_BYTE_STRING,f.snapshotVersion)),Pk(s,l);const h=new Ps(f.target,l,c,f.sequenceNumber);c1(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Re("RemoteStore","Failed to raise snapshot:",n),await q0(t,n)}}async function q0(t,e,r){if(!Ru(e))throw e;t.L_.add(1),await Du(t),t.q_.set("Offline"),r||(r=()=>Ak(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Re("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Wh(t)})}function Nk(t,e){return e().catch(r=>q0(t,r,e))}async function Hh(t){const e=je(t),r=Ys(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;oO(e);)try{const i=await zD(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,lO(e,i)}catch(i){await q0(e,i)}Dk(e)&&Ok(e)}function oO(t){return eo(t)&&t.O_.length<10}function lO(t,e){t.O_.push(e);const r=Ys(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Dk(t){return eo(t)&&!Ys(t).n_()&&t.O_.length>0}function Ok(t){Ys(t).start()}async function cO(t){Ys(t).p_()}async function uO(t){const e=Ys(t);for(const r of t.O_)e.m_(r.mutations)}async function fO(t,e,r){const n=t.O_.shift(),i=r1.from(n,e,r);await Nk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Hh(t)}async function hO(t,e){e&&Ys(t).V_&&await async function(n,i){if(function(a){return eD(a)&&a!==le.ABORTED}(i.code)){const s=n.O_.shift();Ys(n).s_(),await Nk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Hh(n)}}(t,e),Dk(t)&&Ok(t)}async function cy(t,e){const r=je(t);r.asyncQueue.verifyOperationInProgress(),Re("RemoteStore","RemoteStore received new credentials");const n=eo(r);r.L_.add(3),await Du(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Wh(r)}async function dO(t,e){const r=je(t);e?(r.L_.delete(2),await Wh(r)):e||(r.L_.add(2),await Du(r),r.q_.set("Unknown"))}function Sl(t){return t.K_||(t.K_=function(r,n,i){const s=je(r);return s.w_(),new JD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:nO.bind(null,t),Ro:iO.bind(null,t),mo:sO.bind(null,t),d_:aO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),f1(t)?u1(t):t.q_.set("Unknown")):(await t.K_.stop(),Fk(t))})),t.K_}function Ys(t){return t.U_||(t.U_=function(r,n,i){const s=je(r);return s.w_(),new ZD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:cO.bind(null,t),mo:hO.bind(null,t),f_:uO.bind(null,t),g_:fO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Hh(t)):(await t.U_.stop(),t.O_.length>0&&(Re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new h1(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function d1(t,e){if(ns("AsyncQueue",`${e}: ${t}`),Ru(t))return new Ie(le.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Fe.comparator(r.key,n.key):(r,n)=>Fe.comparator(r.key,n.key),this.keyedMap=nc(),this.sortedSet=new bt(this.comparator)}static emptySet(e){return new Xo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Xo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Xo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(){this.W_=new bt(Fe.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Ve():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class pl{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new pl(e,r,Xo.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class mO{constructor(){this.queries=fy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=je(r),s=i.queries;i.queries=fy(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ie(le.ABORTED,"Firestore shutting down"))}}function fy(){return new kl(t=>nk(t),Lh)}async function p1(t,e){const r=je(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new pO,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=d1(a,`Initialization of query '${yo(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&g1(r)}async function m1(t,e){const r=je(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function gO(t,e){const r=je(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&g1(r)}function vO(t,e,r){const n=je(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function g1(t){t.Y_.forEach(e=>{e.next()})}var Sm,hy;(hy=Sm||(Sm={})).ea="default",hy.Cache="cache";class v1{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new pl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=pl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Sm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.key=e}}class bk{constructor(e){this.key=e}}class _O{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ye(),this.mutatedKeys=Ye(),this.Aa=ik(e),this.Ra=new Xo(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new uy,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),p=bh(this.query,h)?h:null,v=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;d&&p?d.data.isEqual(p.data)?v!==m&&(n.track({type:3,doc:p}),_=!0):this.ga(d,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),_=!0):d&&!p&&(n.track({type:1,doc:d}),_=!0,(l||c)&&(o=!0)),_&&(p?(a=a.add(p),s=m?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,h)=>function(p,v){const m=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve()}};return m(p)-m(v)}(f.type,h.type)||this.Aa(f.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new pl(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new uy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ye(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new bk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new Lk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Ye();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return pl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class xO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class yO{constructor(e){this.key=e,this.va=!1}}class wO{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new kl(o=>nk(o),Lh),this.Ma=new Map,this.xa=new Set,this.Oa=new bt(Fe.comparator),this.Na=new Map,this.La=new s1,this.Ba={},this.ka=new Map,this.qa=dl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function EO(t,e,r=!0){const n=Wk(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Mk(n,e,r,!0),i}async function TO(t,e){const r=Wk(t);await Mk(r,e,!0,!1)}async function Mk(t,e,r,n){const i=await $D(t.localStore,Ti(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await kO(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Rk(t.remoteStore,i),o}async function kO(t,e,r,n,i){t.Ka=(h,d,p)=>async function(m,_,y,E){let x=_.view.ma(y);x.ns&&(x=await ay(m.localStore,_.query,!1).then(({documents:w})=>_.view.ma(w,x)));const F=E&&E.targetChanges.get(_.targetId),U=E&&E.targetMismatches.get(_.targetId)!=null,b=_.view.applyChanges(x,m.isPrimaryClient,F,U);return py(m,_.targetId,b.wa),b.snapshot}(t,h,d,p);const s=await ay(t.localStore,e,!0),a=new _O(e,s.Ts),o=a.ma(s.documents),l=Nu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);py(t,r,c.wa);const f=new xO(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function SO(t,e,r){const n=je(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Lh(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await km(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&l1(n.remoteStore,i.targetId),Am(n,i.targetId)}).catch(Cu)):(Am(n,i.targetId),await km(n.localStore,i.targetId,!0))}async function AO(t,e){const r=je(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),l1(r.remoteStore,n.targetId))}async function IO(t,e,r){const n=OO(t);try{const i=await function(a,o){const l=je(a),c=sr.now(),f=o.reduce((p,v)=>p.add(v.key),Ye());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=is(),m=Ye();return l.cs.getEntries(p,f).next(_=>{v=_,v.forEach((y,E)=>{E.isValidDocument()||(m=m.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(_=>{h=_;const y=[];for(const E of o){const x=qN(E,h.get(E.key).overlayedDocument);x!=null&&y.push(new sa(E.key,x,qT(x.value.mapValue),Qr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,y,o)}).next(_=>{d=_;const y=_.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,_.batchId,y)})}).then(()=>({batchId:d.batchId,changes:ak(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new bt(it)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await Ou(n,i.changes),await Hh(n.remoteStore)}catch(i){const s=d1(i,"Failed to persist write");r.reject(s)}}async function Vk(t,e){const r=je(t);try{const n=await WD(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(ht(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ht(a.va):i.removedDocuments.size>0&&(ht(a.va),a.va=!1))}),await Ou(r,n,e)}catch(n){await Cu(n)}}function dy(t,e,r){const n=je(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=je(a);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&g1(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function CO(t,e,r){const n=je(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new bt(Fe.comparator);a=a.insert(s,Mr.newNoDocument(s,Ue.min()));const o=Ye().add(s),l=new Uh(Ue.min(),new Map,new bt(it),a,o);await Vk(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),_1(n)}else await km(n.localStore,e,!1).then(()=>Am(n,e,r)).catch(Cu)}async function RO(t,e){const r=je(t),n=e.batch.batchId;try{const i=await jD(r.localStore,e);Uk(r,n,null),Bk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ou(r,i)}catch(i){await Cu(i)}}async function PO(t,e,r){const n=je(t);try{const i=await function(a,o){const l=je(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(ht(h!==null),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);Uk(n,e,r),Bk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ou(n,i)}catch(i){await Cu(i)}}function Bk(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function Uk(t,e,r){const n=je(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Am(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||jk(t,n)})}function jk(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(l1(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),_1(t))}function py(t,e,r){for(const n of r)n instanceof Lk?(t.La.addReference(n.key,e),FO(t,n)):n instanceof bk?(Re("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||jk(t,n.key)):Ve()}function FO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Re("SyncEngine","New document in limbo: "+r),t.xa.add(n),_1(t))}function _1(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Fe(Et.fromString(e)),n=t.qa.next();t.Na.set(n,new yO(r)),t.Oa=t.Oa.insert(r,n),Rk(t.remoteStore,new Ps(Ti(Oh(r.path)),n,"TargetPurposeLimboResolution",qg.oe))}}async function Ou(t,e,r){const n=je(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=o1.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const f=je(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>he.forEach(c,d=>he.forEach(d.$i,p=>f.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>he.forEach(d.Ui,p=>f.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!Ru(h))throw h;Re("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=f.os.get(d),v=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(v);f.os=f.os.insert(d,m)}}}(n.localStore,s))}async function NO(t,e){const r=je(t);if(!r.currentUser.isEqual(e)){Re("SyncEngine","User change. New user:",e.toKey());const n=await Sk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ie(le.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ou(r,n.hs)}}function DO(t,e){const r=je(t),n=r.Na.get(e);if(n&&n.va)return Ye().add(n.key);{let i=Ye();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function Wk(t){const e=je(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CO.bind(null,e),e.Ca.d_=gO.bind(null,e.eventManager),e.Ca.$a=vO.bind(null,e.eventManager),e}function OO(t){const e=je(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=RO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PO.bind(null,e),e}class Y0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=jh(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return UD(this.persistence,new VD,e.initialUser,this.serializer)}Ga(e){return new LD(a1.Zr,this.serializer)}Wa(e){return new KD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Y0.provider={build:()=>new Y0};class Im{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>dy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=NO.bind(null,this.syncEngine),await dO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mO}()}createDatastore(e){const r=jh(e.databaseInfo.databaseId),n=function(s){return new QD(s)}(e.databaseInfo);return function(s,a,o,l){return new eO(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new rO(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>dy(this.syncEngine,r,0),function(){return ly.D()?new ly:new XD}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,f){const h=new wO(i,s,a,o,l,c);return f&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=je(i);Re("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Du(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Im.provider={build:()=>new Im};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ns("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Dr.UNAUTHENTICATED,this.clientId=GT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Re("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Re("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=d1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qd(t,e){t.asyncQueue.verifyOperationInProgress(),Re("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Sk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function my(t,e){t.asyncQueue.verifyOperationInProgress();const r=await bO(t);Re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>cy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>cy(e.remoteStore,i)),t._onlineComponents=e}async function bO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Re("FirestoreClient","Using user provided OfflineComponentProvider");try{await qd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===le.FAILED_PRECONDITION||i.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;cl("Error using user provided cache. Falling back to memory cache: "+r),await qd(t,new Y0)}}else Re("FirestoreClient","Using default OfflineComponentProvider"),await qd(t,new Y0);return t._offlineComponents}async function Hk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Re("FirestoreClient","Using user provided OnlineComponentProvider"),await my(t,t._uninitializedComponentsProvider._online)):(Re("FirestoreClient","Using default OnlineComponentProvider"),await my(t,new Im))),t._onlineComponents}function MO(t){return Hk(t).then(e=>e.syncEngine)}async function Q0(t){const e=await Hk(t),r=e.eventManager;return r.onListen=EO.bind(null,e.syncEngine),r.onUnlisten=SO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=TO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=AO.bind(null,e.syncEngine),r}function VO(t,e,r={}){const n=new Ki;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new x1({next:d=>{f.Za(),a.enqueueAndForget(()=>m1(s,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new Ie(le.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new Ie(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new v1(Oh(o.path),f,{includeMetadataChanges:!0,_a:!0});return p1(s,h)}(await Q0(t),t.asyncQueue,e,r,n)),n.promise}function BO(t,e,r={}){const n=new Ki;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new x1({next:d=>{f.Za(),a.enqueueAndForget(()=>m1(s,h)),d.fromCache&&l.source==="server"?c.reject(new Ie(le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new v1(o,f,{includeMetadataChanges:!0,_a:!0});return p1(s,h)}(await Q0(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t,e,r){if(!r)throw new Ie(le.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function UO(t,e,r,n){if(e===!0&&n===!0)throw new Ie(le.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function vy(t){if(!Fe.isDocumentKey(t))throw new Ie(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _y(t){if(Fe.isDocumentKey(t))throw new Ie(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ve()}function Jr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ie(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=zh(t);throw new Ie(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ie(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zk((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ie(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $h{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new iN;switch(n.type){case"firstParty":return new lN(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ie(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=gy.get(r);n&&(Re("ComponentProvider","Removing Datastore"),gy.delete(r),n.terminate())}(this),Promise.resolve()}}function jO(t,e,r,n={}){var i;const s=(t=Jr(t,$h))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&cl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Dr.MOCK_USER;else{o=mR(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Ie(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Dr(c)}t._authCredentials=new sN(new $T(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new to(this.firestore,e,this._query)}}class Ur{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $s(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ur(this.firestore,e,this._key)}}class $s extends to{constructor(e,r,n){super(e,r,Oh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ur(this.firestore,null,new Fe(e))}withConverter(e){return new $s(this.firestore,e,this._path)}}function an(t,e,...r){if(t=Lt(t),$k("collection","path",e),t instanceof $h){const n=Et.fromString(e,...r);return _y(n),new $s(t,null,n)}{if(!(t instanceof Ur||t instanceof $s))throw new Ie(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Et.fromString(e,...r));return _y(n),new $s(t.firestore,null,n)}}function ln(t,e,...r){if(t=Lt(t),arguments.length===1&&(e=GT.newId()),$k("doc","path",e),t instanceof $h){const n=Et.fromString(e,...r);return vy(n),new Ur(t,null,new Fe(n))}{if(!(t instanceof Ur||t instanceof $s))throw new Ie(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Et.fromString(e,...r));return vy(n),new Ur(t.firestore,t instanceof $s?t.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ik(this,"async_queue_retry"),this.Vu=()=>{const n=Xd();n&&Re("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Xd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Xd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ki;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ru(e))throw e;Re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw ns("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=h1.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ve()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function wy(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Ai extends $h{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new yy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yy(e),this._firestoreClient=void 0,await e}}}function WO(t,e){const r=typeof t=="object"?t:Vg(),n=typeof t=="string"?t:"(default)",i=bg(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=dR("firestore");s&&jO(i,...s)}return i}function Lu(t){if(t._terminated)throw new Ie(le.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HO(t),t._firestoreClient}function HO(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,f){return new wN(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,zk(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new LO(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ml(Ar.fromBase64String(e))}catch(r){throw new Ie(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ml(Ar.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ie(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ie(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ie(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zO=/^__.*__$/;class $O{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new sa(e,this.data,this.fieldMask,r,this.fieldTransforms):new Fu(e,this.data,r,this.fieldTransforms)}}class Gk{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new sa(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Kk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve()}}class T1{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new T1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return J0(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Kk(this.Cu)&&zO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||jh(e)}Qu(e,r,n,i=!1){return new T1({Cu:e,methodName:r,qu:n,path:wr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mu(t){const e=t._freezeSettings(),r=jh(t._databaseId);return new GO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function k1(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);S1("Data must be an object, but it was:",a,n);const o=Yk(n,a);let l,c;if(s.merge)l=new kn(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=Cm(e,h,r);if(!a.contains(d))throw new Ie(le.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);Jk(f,d)||f.push(d)}l=new kn(f),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new $O(new on(o),l,c)}class Gh extends y1{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gh}}function Xk(t,e,r,n){const i=t.Qu(1,e,r);S1("Data must be an object, but it was:",i,n);const s=[],a=on.empty();Za(n,(l,c)=>{const f=A1(e,l,r);c=Lt(c);const h=i.Nu(f);if(c instanceof Gh)s.push(f);else{const d=Vu(c,h);d!=null&&(s.push(f),a.set(f,d))}});const o=new kn(s);return new Gk(a,o,i.fieldTransforms)}function qk(t,e,r,n,i,s){const a=t.Qu(1,e,r),o=[Cm(e,n,r)],l=[i];if(s.length%2!=0)throw new Ie(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(Cm(e,s[d])),l.push(s[d+1]);const c=[],f=on.empty();for(let d=o.length-1;d>=0;--d)if(!Jk(c,o[d])){const p=o[d];let v=l[d];v=Lt(v);const m=a.Nu(p);if(v instanceof Gh)c.push(p);else{const _=Vu(v,m);_!=null&&(c.push(p),f.set(p,_))}}const h=new kn(c);return new Gk(f,h,a.fieldTransforms)}function KO(t,e,r,n=!1){return Vu(r,t.Qu(n?4:3,e))}function Vu(t,e){if(Qk(t=Lt(t)))return S1("Unsupported field value:",e,t),Yk(t,e);if(t instanceof y1)return function(n,i){if(!Kk(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Vu(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Lt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return HN(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=sr.fromDate(n);return{timestampValue:X0(i.serializer,s)}}if(n instanceof sr){const s=new sr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:X0(i.serializer,s)}}if(n instanceof w1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ml)return{bytesValue:_k(i.serializer,n._byteString)};if(n instanceof Ur){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:i1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof E1)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return t1(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${zh(n)}`)}(t,e)}function Yk(t,e){const r={};return KT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Za(t,(n,i)=>{const s=Vu(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Qk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof sr||t instanceof w1||t instanceof ml||t instanceof Ur||t instanceof y1||t instanceof E1)}function S1(t,e,r){if(!Qk(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=zh(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Cm(t,e,r){if((e=Lt(e))instanceof bu)return e._internalPath;if(typeof e=="string")return A1(t,e);throw J0("Field path arguments must be of type string or ",t,!1,void 0,r)}const XO=new RegExp("[~\\*/\\[\\]]");function A1(t,e,r){if(e.search(XO)>=0)throw J0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new bu(...e.split("."))._internalPath}catch{throw J0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function J0(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new Ie(le.INVALID_ARGUMENT,o+t+l)}function Jk(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ur(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(I1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class qO extends Zk{data(){return super.data()}}function I1(t,e){return typeof e=="string"?A1(t,e):e instanceof bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ie(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class C1{}class YO extends C1{}function sc(t,e,...r){let n=[];e instanceof C1&&n.push(e),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof R1).length,o=s.filter(l=>l instanceof Kh).length;if(a>1||a>0&&o>0)throw new Ie(le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Kh extends YO{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Kh(e,r,n)}_apply(e){const r=this._parse(e);return tS(e._query,r),new to(e.firestore,e.converter,_m(e._query,r))}_parse(e){const r=Mu(e.firestore);return function(s,a,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Ie(le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Ty(h,f);const p=[];for(const v of h)p.push(Ey(l,s,v));d={arrayValue:{values:p}}}else d=Ey(l,s,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Ty(h,f),d=KO(o,a,h,f==="in"||f==="not-in");return tr.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function xs(t,e,r){const n=e,i=I1("where",t);return Kh._create(i,n,r)}class R1 extends C1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new R1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:li.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)tS(a,l),a=_m(a,l)}(e._query,r),new to(e.firestore,e.converter,_m(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Ey(t,e,r){if(typeof(r=Lt(r))=="string"){if(r==="")throw new Ie(le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rk(e)&&r.indexOf("/")!==-1)throw new Ie(le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Et.fromString(r));if(!Fe.isDocumentKey(n))throw new Ie(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Hx(t,new Fe(n))}if(r instanceof Ur)return Hx(t,r._key);throw new Ie(le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zh(r)}.`)}function Ty(t,e){if(!Array.isArray(t)||t.length===0)throw new Ie(le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tS(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ie(le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class QO{convertValue(e,r="none"){switch(Ha(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Za(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>$t(a.doubleValue));return new E1(s)}convertGeoPoint(e){return new w1($t(e.latitude),$t(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Qg(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Jc(e));default:return null}}convertTimestamp(e){const r=qs(e);return new sr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Et.fromString(e);ht(kk(n));const i=new Zc(n.get(1),n.get(3)),s=new Fe(n.popFirst(5));return i.isEqual(r)||ns(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class rS extends Zk{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new u0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(I1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class u0 extends rS{data(e={}){return super.data(e)}}class nS{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new ac(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new u0(this._firestore,this._userDataWriter,n.key,n,new ac(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ie(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new u0(i._firestore,i._userDataWriter,o.doc.key,o.doc,new ac(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new u0(i._firestore,i._userDataWriter,o.doc.key,o.doc,new ac(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,f=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:JO(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function JO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO(t){t=Jr(t,Ur);const e=Jr(t.firestore,Ai);return VO(Lu(e),t._key).then(r=>iS(e,t,r))}class F1 extends QO{constructor(e){super(),this.firestore=e}convertBytes(e){return new ml(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ur(this.firestore,null,r)}}function Mo(t){t=Jr(t,to);const e=Jr(t.firestore,Ai),r=Lu(e),n=new F1(e);return eS(t._query),BO(r,t._query).then(i=>new nS(e,n,t,i))}function Fs(t,e,r){t=Jr(t,Ur);const n=Jr(t.firestore,Ai),i=P1(t.converter,e,r);return Bu(n,[k1(Mu(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Qr.none())])}function ky(t,e,r,...n){t=Jr(t,Ur);const i=Jr(t.firestore,Ai),s=Mu(i);let a;return a=typeof(e=Lt(e))=="string"||e instanceof bu?qk(s,"updateDoc",t._key,e,r,n):Xk(s,"updateDoc",t._key,e),Bu(i,[a.toMutation(t._key,Qr.exists(!0))])}function e6(t){return Bu(Jr(t.firestore,Ai),[new Bh(t._key,Qr.none())])}function t6(t,e){const r=Jr(t.firestore,Ai),n=ln(t),i=P1(t.converter,e);return Bu(r,[k1(Mu(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Qr.exists(!1))]).then(()=>n)}function Wi(t,...e){var r,n,i;t=Lt(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||wy(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(wy(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,f;if(t instanceof Ur)c=Jr(t.firestore,Ai),f=Oh(t._key.path),l={next:h=>{e[a]&&e[a](iS(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Jr(t,to);c=Jr(h.firestore,Ai),f=h._query;const d=new F1(c);l={next:p=>{e[a]&&e[a](new nS(c,d,h,p))},error:e[a+1],complete:e[a+2]},eS(t._query)}return function(d,p,v,m){const _=new x1(m),y=new v1(p,_,v);return d.asyncQueue.enqueueAndForget(async()=>p1(await Q0(d),y)),()=>{_.Za(),d.asyncQueue.enqueueAndForget(async()=>m1(await Q0(d),y))}}(Lu(c),f,o,l)}function Bu(t,e){return function(n,i){const s=new Ki;return n.asyncQueue.enqueueAndForget(async()=>IO(await MO(n),i,s)),s.promise}(Lu(t),e)}function iS(t,e,r){const n=r.docs.get(e._key),i=new F1(t);return new rS(t,i,e._key,n,new ac(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Mu(e)}set(e,r,n){this._verifyNotCommitted();const i=Yd(e,this._firestore),s=P1(i.converter,r,n),a=k1(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,Qr.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const s=Yd(e,this._firestore);let a;return a=typeof(r=Lt(r))=="string"||r instanceof bu?qk(this._dataReader,"WriteBatch.update",s._key,r,n,i):Xk(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(a.toMutation(s._key,Qr.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Yd(e,this._firestore);return this._mutations=this._mutations.concat(new Bh(r._key,Qr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(le.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Yd(t,e){if((t=Lt(t)).firestore!==e)throw new Ie(le.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){return Lu(t=Jr(t,Ai)),new r6(t,e=>Bu(t,e))}(function(e,r=!0){(function(i){Tl=i})(El),ol(new Va("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Ai(new aN(n.getProvider("auth-internal")),new uN(n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ie(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zc(c.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),zs(Vx,"4.7.3",e),zs(Vx,"4.7.3","esm2017")})();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Z0={};Z0.version="0.18.5";var sS=1252,i6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},D1=function(t){i6.indexOf(t)!=-1&&(sS=N1[0]=t)};function s6(){D1(1252)}var ei=function(t){D1(t)};function O1(){ei(1200),s6()}function Sy(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function a6(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function aS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var oc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?a6(t.slice(2)):e==254&&r==255?aS(t.slice(2)):e==65279?t.slice(1):t},Nf=function(e){return String.fromCharCode(e)},Ay=function(e){return String.fromCharCode(e)},nu,Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function iu(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ns.charAt(s)+Ns.charAt(a)+Ns.charAt(o)+Ns.charAt(l);return e}function In(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Ns.indexOf(t.charAt(c++)),a=Ns.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ns.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ns.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cs=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Qs(t){return Ge?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Iy(t){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var wn=function(e){return Ge?cs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Xh(t){if(typeof ArrayBuffer>"u")return wn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function aa(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function o6(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function L1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return L1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var fr=Ge?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:cs(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function l6(t){for(var e=[],r=0,n=t.length+250,i=Qs(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Qs(65535),n=65530)}return e.push(i.slice(0,r)),fr(e)}var Zr=/\u0000/g,lc=/[\u0001-\u0006]/g;function qo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ti(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}function b1(t,e){var r=""+t;return r.length>=e?r:Ut(" ",e-r.length)+r}function eh(t,e){var r=""+t;return r.length>=e?r:r+Ut(" ",e-r.length)}function c6(t,e){var r=""+Math.round(t);return r.length>=e?r:Ut("0",e-r.length)+r}function u6(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}var Cy=Math.pow(2,32);function vo(t,e){if(t>Cy||t<-Cy)return c6(t,e);var r=Math.round(t);return u6(r,e)}function th(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Ry=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Qd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function f6(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Py={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},h6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,f=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,f=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=s):(f=c,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function ka(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=_6(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var oS=new Date(1899,11,31,0,0,0),d6=oS.getTime(),p6=new Date(1900,2,1,0,0,0);function lS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=p6&&(r+=24*60*60*1e3),(r-(d6+(t.getTimezoneOffset()-oS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function M1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function m6(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function g6(t){var e=t<0?12:11,r=M1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function v6(t){var e=M1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function su(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=g6(t):e===10?r=t.toFixed(10).substr(0,12):r=v6(t),M1(m6(r.toUpperCase()))}function za(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):su(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Gn(14,lS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function _6(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function x6(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Qd[r.m-1][1];case 5:return Qd[r.m-1][0];default:return Qd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Ry[r.q][0];default:return Ry[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ti(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ti(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?ti(l,c):"";return f}function Ds(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var cS=/%/g;function y6(t,e,r){var n=e.replace(cS,""),i=e.length-n.length;return Xi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function w6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Xi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+uS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var fS=/# (\?+)( ?)\/( ?)(\d+)/;function E6(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ut(" ",t[1].length+1+t[4].length):b1(a,t[1].length)+t[2]+"/"+t[3]+ti(o,t[4].length))}function T6(t,e,r){return r+(e===0?"":""+e)+Ut(" ",t[1].length+2+t[4].length)}var hS=/^#*0*\.([0#]+)/,dS=/\).*[0#]/,pS=/\(###\) ###\\?-####/;function Xr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Fy(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Ny(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function k6(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function S6(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function On(t,e,r){if(t.charCodeAt(0)===40&&!e.match(dS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?On("n",n,r):"("+On("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return w6(t,e,r);if(e.indexOf("%")!==-1)return y6(t,e,r);if(e.indexOf("E")!==-1)return uS(e,r);if(e.charCodeAt(0)===36)return"$"+On(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+vo(l,e.length);if(e.match(/^[#?]+$/))return i=vo(r,0),i==="0"&&(i=""),i.length>e.length?i:Xr(e.substr(0,e.length-i.length))+i;if(s=e.match(fS))return E6(s,l,c);if(e.match(/^#+0+$/))return c+vo(l,e.length-e.indexOf("0"));if(s=e.match(hS))return i=Fy(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Xr(s[1])).replace(/\.$/,"."+Xr(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+Ut("0",Xr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Fy(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Ds(vo(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+On(t,e,-r):Ds(""+(Math.floor(r)+k6(r,s[1].length)))+"."+ti(Ny(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return On(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=qo(On(t,e.replace(/[\\-]/g,""),r)),a=0,qo(qo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(pS))return i=On(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=rh(l,Math.pow(10,a)-1,!1),i=""+c,f=Xi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=eh(o[2],a),f.length<s[4].length&&(f=Xr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=rh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?b1(o[1],a)+s[2]+"/"+s[3]+eh(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=vo(r,0),e.length<=i.length?i:Xr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Xr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Ny(r,s[1].length),r<0?"-"+On(t,e,-r):Ds(S6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ti(0,3-v.length):"")+v})+"."+ti(a,s[1].length);switch(e){case"###,##0.00":return On(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ds(vo(l,0));return p!=="0"?c+p:"";case"###,###.00":return On(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return On(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function A6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Xi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function I6(t,e,r){var n=e.replace(cS,""),i=e.length-n.length;return Xi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function mS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+mS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function di(t,e,r){if(t.charCodeAt(0)===40&&!e.match(dS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?di("n",n,r):"("+di("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return A6(t,e,r);if(e.indexOf("%")!==-1)return I6(t,e,r);if(e.indexOf("E")!==-1)return mS(e,r);if(e.charCodeAt(0)===36)return"$"+di(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ti(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Xr(e.substr(0,e.length-i.length))+i;if(s=e.match(fS))return T6(s,l,c);if(e.match(/^#+0+$/))return c+ti(l,e.length-e.indexOf("0"));if(s=e.match(hS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Xr(s[1])).replace(/\.$/,"."+Xr(s[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+Ut("0",Xr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Ds(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):Ds(""+r)+"."+Ut("0",s[1].length);if(s=e.match(/^#,#*,#0/))return di(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=qo(di(t,e.replace(/[\\-]/g,""),r)),a=0,qo(qo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(pS))return i=di(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=rh(l,Math.pow(10,a)-1,!1),i=""+c,f=Xi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=eh(o[2],a),f.length<s[4].length&&(f=Xr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=rh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?b1(o[1],a)+s[2]+"/"+s[3]+eh(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Xr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Xr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):Ds(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ti(0,3-v.length):"")+v})+"."+ti(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Ds(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return di(t,e.slice(0,e.lastIndexOf(".")),r)+Xr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Xi(t,e,r){return(r|0)===r?di(t,e,r):On(t,e,r)}function C6(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var gS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Al(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":th(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(gS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function R6(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!th(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),v=p==="("||p===")"?p:"t";i[i.length]={t:v,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=ka(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=ka(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=ka(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",a+=5,d="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(gS)){if(c==null&&(c=ka(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Al(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,y=0,E;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",_<1&&(_=1);break;case"s":(E=i[a].v.match(/\.0+$/))&&(y=Math.max(y,E[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",F;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=x6(i[a].t.charCodeAt(0),i[a].v,c,y),i[a].t="t";break;case"n":case"?":for(F=a+1;i[F]!=null&&((o=i[F].t)==="?"||o==="D"||(o===" "||o==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[a].v+=i[F].v,i[F]={v:"",t:";"},++F;x+=i[a].v,a=F-1;break;case"G":i[a].t="t",i[a].v=za(e,r);break}var U="",b,w;if(x.length>0){x.charCodeAt(0)==40?(b=e<0&&x.charCodeAt(0)===45?-e:e,w=Xi("n",x,b)):(b=e<0&&n>1?-e:e,w=Xi("n",x,b),b<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),F=w.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var S=i.length;if(k===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(F>=i[a].v.length-1?(F-=i[a].v.length,i[a].v=w.substr(F+1,i[a].v.length)):F<0?i[a].v="":(i[a].v=w.substr(0,F+1),F=-1),i[a].t="t",S=a);F>=0&&S<i.length&&(i[S].v=w.substr(0,F+1)+i[S].v)}else if(k!==i.length&&w.indexOf("E")===-1){for(F=w.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,U=i[a].v.substr(f+1);f>=0;--f)F>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(U=w.charAt(F--)+U);i[a].v=U,i[a].t="t",S=a}for(F>=0&&S<i.length&&(i[S].v=w.substr(0,F+1)+i[S].v),F=w.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,U=i[a].v.substr(0,f);f<i[a].v.length;++f)F<w.length&&(U+=w.charAt(F++));i[a].v=U,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(b=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Xi(i[a].t,i[a].v,b),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var Dy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Oy(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function P6(t,e){var r=C6(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Dy),o=r[1].match(Dy);return Oy(e,a)?[n,r[0]]:Oy(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Gn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:De)[t],n==null&&(n=r.table&&r.table[Py[t]]||De[Py[t]]),n==null&&(n=h6[t]||"General");break}if(th(n,0))return za(e,r);e instanceof Date&&(e=lS(e,r.date1904));var i=P6(n,e);if(th(i[1]))return za(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return R6(i[1],e,r,i[0])}function qi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(De[r]==null){e<0&&(e=r);continue}if(De[r]==t){e=r;break}}e<0&&(e=391)}return De[e]=t,e}function qh(t){for(var e=0;e!=392;++e)t[e]!==void 0&&qi(t[e],e)}function Il(){De=f6()}var F6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function N6(t){var e=typeof t=="number"?De[t]:t;return e=e.replace(vS,"(\\d+)"),new RegExp("^"+e+"$")}function D6(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(vS)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var O6=function(){var t={};t.version="1.2.0";function e(){for(var w=0,k=new Array(256),S=0;S!=256;++S)w=S,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,k[S]=w;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(w){var k=0,S=0,C=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)P[C]=w[C];for(C=0;C!=256;++C)for(S=w[C],k=256+C;k<4096;k+=256)S=P[k]=S>>>8^w[S&255];var A=[];for(C=1;C!=16;++C)A[C-1]=typeof Int32Array<"u"?P.subarray(C*256,C*256+256):P.slice(C*256,C*256+256);return A}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],f=i[5],h=i[6],d=i[7],p=i[8],v=i[9],m=i[10],_=i[11],y=i[12],E=i[13],x=i[14];function F(w,k){for(var S=k^-1,C=0,P=w.length;C<P;)S=S>>>8^r[(S^w.charCodeAt(C++))&255];return~S}function U(w,k){for(var S=k^-1,C=w.length-15,P=0;P<C;)S=x[w[P++]^S&255]^E[w[P++]^S>>8&255]^y[w[P++]^S>>16&255]^_[w[P++]^S>>>24]^m[w[P++]]^v[w[P++]]^p[w[P++]]^d[w[P++]]^h[w[P++]]^f[w[P++]]^c[w[P++]]^l[w[P++]]^o[w[P++]]^a[w[P++]]^s[w[P++]]^r[w[P++]];for(C+=15;P<C;)S=S>>>8^r[(S^w[P++])&255];return~S}function b(w,k){for(var S=k^-1,C=0,P=w.length,A=0,R=0;C<P;)A=w.charCodeAt(C++),A<128?S=S>>>8^r[(S^A)&255]:A<2048?(S=S>>>8^r[(S^(192|A>>6&31))&255],S=S>>>8^r[(S^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,R=w.charCodeAt(C++)&1023,S=S>>>8^r[(S^(240|A>>8&7))&255],S=S>>>8^r[(S^(128|A>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(A&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|A>>12&15))&255],S=S>>>8^r[(S^(128|A>>6&63))&255],S=S>>>8^r[(S^(128|A&63))&255]);return~S}return t.table=r,t.bstr=F,t.buf=U,t.str=b,t}(),Pe=function(){var e={};e.version="1.2.1";function r(I,V){for(var D=I.split("/"),O=V.split("/"),B=0,j=0,q=Math.min(D.length,O.length);B<q;++B){if(j=D[B].length-O[B].length)return j;if(D[B]!=O[B])return D[B]<O[B]?-1:1}return D.length-O.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function s(I,V){typeof V=="string"&&(V=new Date(V));var D=V.getHours();D=D<<6|V.getMinutes(),D=D<<5|V.getSeconds()>>>1,I.write_shift(2,D);var O=V.getFullYear()-1980;O=O<<4|V.getMonth()+1,O=O<<5|V.getDate(),I.write_shift(2,O)}function a(I){var V=I.read_shift(2)&65535,D=I.read_shift(2)&65535,O=new Date,B=D&31;D>>>=5;var j=D&15;D>>>=4,O.setMilliseconds(0),O.setFullYear(D+1980),O.setMonth(j-1),O.setDate(B);var q=V&31;V>>>=5;var ie=V&63;return V>>>=6,O.setHours(V),O.setMinutes(ie),O.setSeconds(q<<1),O}function o(I){yr(I,0);for(var V={},D=0;I.l<=I.length-4;){var O=I.read_shift(2),B=I.read_shift(2),j=I.l+B,q={};switch(O){case 21589:D=I.read_shift(1),D&1&&(q.mtime=I.read_shift(4)),B>5&&(D&2&&(q.atime=I.read_shift(4)),D&4&&(q.ctime=I.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}I.l=j,V[O]=q}return V}var l;function c(){return l||(l={})}function f(I,V){if(I[0]==80&&I[1]==75)return Fl(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return Yu(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var D=3,O=512,B=0,j=0,q=0,ie=0,Y=0,Q=[],J=I.slice(0,512);yr(J,0);var pe=h(J);switch(D=pe[0],D){case 3:O=512;break;case 4:O=4096;break;case 0:if(pe[1]==0)return Fl(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}O!==512&&(J=I.slice(0,O),yr(J,28));var Ee=I.slice(0,O);d(J,D);var Ae=J.read_shift(4,"i");if(D===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);J.l+=4,q=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ie=J.read_shift(4,"i"),B=J.read_shift(4,"i"),Y=J.read_shift(4,"i"),j=J.read_shift(4,"i");for(var _e=-1,Se=0;Se<109&&(_e=J.read_shift(4,"i"),!(_e<0));++Se)Q[Se]=_e;var Me=p(I,O);_(Y,j,Me,O,Q);var mt=E(Me,q,Q,O);mt[q].name="!Directory",B>0&&ie!==R&&(mt[ie].name="!MiniFAT"),mt[Q[0]].name="!FAT",mt.fat_addrs=Q,mt.ssz=O;var ot={},At=[],Ni=[],da=[];x(q,mt,Me,At,B,ot,Ni,ie),v(Ni,da,At),At.shift();var ds={FileIndex:Ni,FullPaths:da};return V&&V.raw&&(ds.raw={header:Ee,sectors:Me}),ds}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(de,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function d(I,V){var D=9;switch(I.l+=2,D=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,V){for(var D=Math.ceil(I.length/V)-1,O=[],B=1;B<D;++B)O[B-1]=I.slice(B*V,(B+1)*V);return O[D-1]=I.slice(D*V),O}function v(I,V,D){for(var O=0,B=0,j=0,q=0,ie=0,Y=D.length,Q=[],J=[];O<Y;++O)Q[O]=J[O]=O,V[O]=D[O];for(;ie<J.length;++ie)O=J[ie],B=I[O].L,j=I[O].R,q=I[O].C,Q[O]===O&&(B!==-1&&Q[B]!==B&&(Q[O]=Q[B]),j!==-1&&Q[j]!==j&&(Q[O]=Q[j])),q!==-1&&(Q[q]=O),B!==-1&&O!=Q[O]&&(Q[B]=Q[O],J.lastIndexOf(B)<ie&&J.push(B)),j!==-1&&O!=Q[O]&&(Q[j]=Q[O],J.lastIndexOf(j)<ie&&J.push(j));for(O=1;O<Y;++O)Q[O]===O&&(j!==-1&&Q[j]!==j?Q[O]=Q[j]:B!==-1&&Q[B]!==B&&(Q[O]=Q[B]));for(O=1;O<Y;++O)if(I[O].type!==0){if(ie=O,ie!=Q[ie])do ie=Q[ie],V[O]=V[ie]+"/"+V[O];while(ie!==0&&Q[ie]!==-1&&ie!=Q[ie]);Q[O]=-1}for(V[0]+="/",O=1;O<Y;++O)I[O].type!==2&&(V[O]+="/")}function m(I,V,D){for(var O=I.start,B=I.size,j=[],q=O;D&&B>0&&q>=0;)j.push(V.slice(q*A,q*A+A)),B-=A,q=xa(D,q*4);return j.length===0?ae(0):fr(j).slice(0,I.size)}function _(I,V,D,O,B){var j=R;if(I===R){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var q=D[I],ie=(O>>>2)-1;if(!q)return;for(var Y=0;Y<ie&&(j=xa(q,Y*4))!==R;++Y)B.push(j);_(xa(q,O-4),V-1,D,O,B)}}function y(I,V,D,O,B){var j=[],q=[];B||(B=[]);var ie=O-1,Y=0,Q=0;for(Y=V;Y>=0;){B[Y]=!0,j[j.length]=Y,q.push(I[Y]);var J=D[Math.floor(Y*4/O)];if(Q=Y*4&ie,O<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+O);if(!I[J])break;Y=xa(I[J],Q)}return{nodes:j,data:Gy([q])}}function E(I,V,D,O){var B=I.length,j=[],q=[],ie=[],Y=[],Q=O-1,J=0,pe=0,Ee=0,Ae=0;for(J=0;J<B;++J)if(ie=[],Ee=J+V,Ee>=B&&(Ee-=B),!q[Ee]){Y=[];var _e=[];for(pe=Ee;pe>=0;){_e[pe]=!0,q[pe]=!0,ie[ie.length]=pe,Y.push(I[pe]);var Se=D[Math.floor(pe*4/O)];if(Ae=pe*4&Q,O<4+Ae)throw new Error("FAT boundary crossed: "+pe+" 4 "+O);if(!I[Se]||(pe=xa(I[Se],Ae),_e[pe]))break}j[Ee]={nodes:ie,data:Gy([Y])}}return j}function x(I,V,D,O,B,j,q,ie){for(var Y=0,Q=O.length?2:0,J=V[I].data,pe=0,Ee=0,Ae;pe<J.length;pe+=128){var _e=J.slice(pe,pe+128);yr(_e,64),Ee=_e.read_shift(2),Ae=z1(_e,0,Ee-Q),O.push(Ae);var Se={name:Ae,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Me=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Me!==0&&(Se.ct=F(_e,_e.l-8));var mt=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);mt!==0&&(Se.mt=F(_e,_e.l-8)),Se.start=_e.read_shift(4,"i"),Se.size=_e.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=R,Se.name=""),Se.type===5?(Y=Se.start,B>0&&Y!==R&&(V[Y].name="!StreamData")):Se.size>=4096?(Se.storage="fat",V[Se.start]===void 0&&(V[Se.start]=y(D,Se.start,V.fat_addrs,V.ssz)),V[Se.start].name=Se.name,Se.content=V[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:Y!==R&&Se.start!==R&&V[Y]&&(Se.content=m(Se,V[Y].data,(V[ie]||{}).data))),Se.content&&yr(Se.content,0),j[Ae]=Se,q.push(Se)}}function F(I,V){return new Date((yn(I,V+4)/1e7*Math.pow(2,32)+yn(I,V)/1e7-11644473600)*1e3)}function U(I,V){return c(),f(l.readFileSync(I),V)}function b(I,V){var D=V&&V.type;switch(D||Ge&&Buffer.isBuffer(I)&&(D="buffer"),D||"base64"){case"file":return U(I,V);case"base64":return f(wn(In(I)),V);case"binary":return f(wn(I),V)}return f(I,V)}function w(I,V){var D=V||{},O=D.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=O+"/",I.FileIndex[0]={name:O,type:5}),D.CLSID&&(I.FileIndex[0].clsid=D.CLSID),k(I)}function k(I){var V="Sh33tJ5";if(!Pe.find(I,"/"+V)){var D=ae(4);D[0]=55,D[1]=D[3]=50,D[2]=54,I.FileIndex.push({name:V,type:2,content:D,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),S(I)}}function S(I,V){w(I);for(var D=!1,O=!1,B=I.FullPaths.length-1;B>=0;--B){var j=I.FileIndex[B];switch(j.type){case 0:O?D=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(j.R*j.L*j.C)&&(D=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!V)){var q=new Date(1987,1,19),ie=0,Y=Object.create?Object.create(null):{},Q=[];for(B=0;B<I.FullPaths.length;++B)Y[I.FullPaths[B]]=!0,I.FileIndex[B].type!==0&&Q.push([I.FullPaths[B],I.FileIndex[B]]);for(B=0;B<Q.length;++B){var J=n(Q[B][0]);O=Y[J],O||(Q.push([J,{name:i(J).replace("/",""),type:1,clsid:Z,ct:q,mt:q,content:null}]),Y[J]=!0)}for(Q.sort(function(Ae,_e){return r(Ae[0],_e[0])}),I.FullPaths=[],I.FileIndex=[],B=0;B<Q.length;++B)I.FullPaths[B]=Q[B][0],I.FileIndex[B]=Q[B][1];for(B=0;B<Q.length;++B){var pe=I.FileIndex[B],Ee=I.FullPaths[B];if(pe.name=i(Ee).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||Z,B===0)pe.C=Q.length>1?1:-1,pe.size=0,pe.type=5;else if(Ee.slice(-1)=="/"){for(ie=B+1;ie<Q.length&&n(I.FullPaths[ie])!=Ee;++ie);for(pe.C=ie>=Q.length?-1:ie,ie=B+1;ie<Q.length&&n(I.FullPaths[ie])!=n(Ee);++ie);pe.R=ie>=Q.length?-1:ie,pe.type=1}else n(I.FullPaths[B+1]||"")==n(Ee)&&(pe.R=B+1),pe.type=2}}}function C(I,V){var D=V||{};if(D.fileType=="mad")return mr(I,D);switch(S(I),D.fileType){case"zip":return Nl(I,D)}var O=function(Ae){for(var _e=0,Se=0,Me=0;Me<Ae.FileIndex.length;++Me){var mt=Ae.FileIndex[Me];if(mt.content){var ot=mt.content.length;ot>0&&(ot<4096?_e+=ot+63>>6:Se+=ot+511>>9)}}for(var At=Ae.FullPaths.length+3>>2,Ni=_e+7>>3,da=_e+127>>7,ds=Ni+Se+At+da,ui=ds+127>>7,fo=ui<=109?0:Math.ceil((ui-109)/127);ds+ui+fo+127>>7>ui;)fo=++ui<=109?0:Math.ceil((ui-109)/127);var gn=[1,fo,ui,da,At,Se,_e,0];return Ae.FileIndex[0].size=_e<<6,gn[7]=(Ae.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn}(I),B=ae(O[7]<<9),j=0,q=0;{for(j=0;j<8;++j)B.write_shift(1,ue[j]);for(j=0;j<8;++j)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),j=0;j<3;++j)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,O[2]),B.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:R),B.write_shift(4,O[3]),B.write_shift(-4,O[1]?O[0]-1:R),B.write_shift(4,O[1]),j=0;j<109;++j)B.write_shift(-4,j<O[2]?O[1]+j:-1)}if(O[1])for(q=0;q<O[1];++q){for(;j<236+q*127;++j)B.write_shift(-4,j<O[2]?O[1]+j:-1);B.write_shift(-4,q===O[1]-1?R:q+1)}var ie=function(Ae){for(q+=Ae;j<q-1;++j)B.write_shift(-4,j+1);Ae&&(++j,B.write_shift(-4,R))};for(q=j=0,q+=O[1];j<q;++j)B.write_shift(-4,te.DIFSECT);for(q+=O[2];j<q;++j)B.write_shift(-4,te.FATSECT);ie(O[3]),ie(O[4]);for(var Y=0,Q=0,J=I.FileIndex[0];Y<I.FileIndex.length;++Y)J=I.FileIndex[Y],J.content&&(Q=J.content.length,!(Q<4096)&&(J.start=q,ie(Q+511>>9)));for(ie(O[6]+7>>3);B.l&511;)B.write_shift(-4,te.ENDOFCHAIN);for(q=j=0,Y=0;Y<I.FileIndex.length;++Y)J=I.FileIndex[Y],J.content&&(Q=J.content.length,!(!Q||Q>=4096)&&(J.start=q,ie(Q+63>>6)));for(;B.l&511;)B.write_shift(-4,te.ENDOFCHAIN);for(j=0;j<O[4]<<2;++j){var pe=I.FullPaths[j];if(!pe||pe.length===0){for(Y=0;Y<17;++Y)B.write_shift(4,0);for(Y=0;Y<3;++Y)B.write_shift(4,-1);for(Y=0;Y<12;++Y)B.write_shift(4,0);continue}J=I.FileIndex[j],j===0&&(J.start=J.size?J.start-1:R);var Ee=j===0&&D.root||J.name;if(Q=2*(Ee.length+1),B.write_shift(64,Ee,"utf16le"),B.write_shift(2,Q),B.write_shift(1,J.type),B.write_shift(1,J.color),B.write_shift(-4,J.L),B.write_shift(-4,J.R),B.write_shift(-4,J.C),J.clsid)B.write_shift(16,J.clsid,"hex");else for(Y=0;Y<4;++Y)B.write_shift(4,0);B.write_shift(4,J.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,J.start),B.write_shift(4,J.size),B.write_shift(4,0)}for(j=1;j<I.FileIndex.length;++j)if(J=I.FileIndex[j],J.size>=4096)if(B.l=J.start+1<<9,Ge&&Buffer.isBuffer(J.content))J.content.copy(B,B.l,0,J.size),B.l+=J.size+511&-512;else{for(Y=0;Y<J.size;++Y)B.write_shift(1,J.content[Y]);for(;Y&511;++Y)B.write_shift(1,0)}for(j=1;j<I.FileIndex.length;++j)if(J=I.FileIndex[j],J.size>0&&J.size<4096)if(Ge&&Buffer.isBuffer(J.content))J.content.copy(B,B.l,0,J.size),B.l+=J.size+63&-64;else{for(Y=0;Y<J.size;++Y)B.write_shift(1,J.content[Y]);for(;Y&63;++Y)B.write_shift(1,0)}if(Ge)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function P(I,V){var D=I.FullPaths.map(function(Y){return Y.toUpperCase()}),O=D.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),B=!1;V.charCodeAt(0)===47?(B=!0,V=D[0].slice(0,-1)+V):B=V.indexOf("/")!==-1;var j=V.toUpperCase(),q=B===!0?D.indexOf(j):O.indexOf(j);if(q!==-1)return I.FileIndex[q];var ie=!j.match(lc);for(j=j.replace(Zr,""),ie&&(j=j.replace(lc,"!")),q=0;q<D.length;++q)if((ie?D[q].replace(lc,"!"):D[q]).replace(Zr,"")==j||(ie?O[q].replace(lc,"!"):O[q]).replace(Zr,"")==j)return I.FileIndex[q];return null}var A=64,R=-2,de="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(I,V,D){c();var O=C(I,D);l.writeFileSync(V,O)}function H(I){for(var V=new Array(I.length),D=0;D<I.length;++D)V[D]=String.fromCharCode(I[D]);return V.join("")}function se(I,V){var D=C(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,D),D;case"binary":return typeof D=="string"?D:H(D);case"base64":return iu(typeof D=="string"?D:H(D));case"buffer":if(Ge)return Buffer.isBuffer(D)?D:cs(D);case"array":return typeof D=="string"?wn(D):D}return D}var oe;function L(I){try{var V=I.InflateRaw,D=new V;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)oe=I;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function K(I,V){if(!oe)return co(I,V);var D=oe.InflateRaw,O=new D,B=O._processChunk(I.slice(I.l),O._finishFlushFlag);return I.l+=O.bytesRead,B}function z(I){return oe?oe.deflateRawSync(I):He(I)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var ge=typeof Uint8Array<"u",fe=ge?new Uint8Array(256):[],Be=0;Be<256;++Be)fe[Be]=xe(Be);function W(I,V){var D=fe[I&255];return V<=8?D>>>8-V:(D=D<<8|fe[I>>8&255],V<=16?D>>>16-V:(D=D<<8|fe[I>>16&255],D>>>24-V))}function at(I,V){var D=V&7,O=V>>>3;return(I[O]|(D<=6?0:I[O+1]<<8))>>>D&3}function Ke(I,V){var D=V&7,O=V>>>3;return(I[O]|(D<=5?0:I[O+1]<<8))>>>D&7}function st(I,V){var D=V&7,O=V>>>3;return(I[O]|(D<=4?0:I[O+1]<<8))>>>D&15}function $e(I,V){var D=V&7,O=V>>>3;return(I[O]|(D<=3?0:I[O+1]<<8))>>>D&31}function ke(I,V){var D=V&7,O=V>>>3;return(I[O]|(D<=1?0:I[O+1]<<8))>>>D&127}function Ct(I,V,D){var O=V&7,B=V>>>3,j=(1<<D)-1,q=I[B]>>>O;return D<8-O||(q|=I[B+1]<<8-O,D<16-O)||(q|=I[B+2]<<16-O,D<24-O)||(q|=I[B+3]<<24-O),q&j}function Gr(I,V,D){var O=V&7,B=V>>>3;return O<=5?I[B]|=(D&7)<<O:(I[B]|=D<<O&255,I[B+1]=(D&7)>>8-O),V+3}function rn(I,V,D){var O=V&7,B=V>>>3;return D=(D&1)<<O,I[B]|=D,V+1}function Pn(I,V,D){var O=V&7,B=V>>>3;return D<<=O,I[B]|=D&255,D>>>=8,I[B+1]=D,V+8}function ca(I,V,D){var O=V&7,B=V>>>3;return D<<=O,I[B]|=D&255,D>>>=8,I[B+1]=D&255,I[B+2]=D>>>8,V+16}function Fn(I,V){var D=I.length,O=2*D>V?2*D:V+5,B=0;if(D>=V)return I;if(Ge){var j=Iy(O);if(I.copy)I.copy(j);else for(;B<I.length;++B)j[B]=I[B];return j}else if(ge){var q=new Uint8Array(O);if(q.set)q.set(I);else for(;B<D;++B)q[B]=I[B];return q}return I.length=O,I}function pr(I){for(var V=new Array(I),D=0;D<I;++D)V[D]=0;return V}function Nn(I,V,D){var O=1,B=0,j=0,q=0,ie=0,Y=I.length,Q=ge?new Uint16Array(32):pr(32);for(j=0;j<32;++j)Q[j]=0;for(j=Y;j<D;++j)I[j]=0;Y=I.length;var J=ge?new Uint16Array(Y):pr(Y);for(j=0;j<Y;++j)Q[B=I[j]]++,O<B&&(O=B),J[j]=0;for(Q[0]=0,j=1;j<=O;++j)Q[j+16]=ie=ie+Q[j-1]<<1;for(j=0;j<Y;++j)ie=I[j],ie!=0&&(J[j]=Q[ie+16]++);var pe=0;for(j=0;j<Y;++j)if(pe=I[j],pe!=0)for(ie=W(J[j],O)>>O-pe,q=(1<<O+4-pe)-1;q>=0;--q)V[ie|q<<pe]=pe&15|j<<4;return O}var _t=ge?new Uint16Array(512):pr(512),Ht=ge?new Uint16Array(32):pr(32);if(!ge){for(var qt=0;qt<512;++qt)_t[qt]=0;for(qt=0;qt<32;++qt)Ht[qt]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);Nn(I,Ht,32);var D=[];for(V=0;V<=143;V++)D.push(8);for(;V<=255;V++)D.push(9);for(;V<=279;V++)D.push(7);for(;V<=287;V++)D.push(8);Nn(D,_t,288)})();var mn=function(){for(var V=ge?new Uint8Array(32768):[],D=0,O=0;D<me.length-1;++D)for(;O<me[D+1];++O)V[O]=D;for(;O<32768;++O)V[O]=29;var B=ge?new Uint8Array(259):[];for(D=0,O=0;D<ee.length-1;++D)for(;O<ee[D+1];++O)B[O]=D;function j(ie,Y){for(var Q=0;Q<ie.length;){var J=Math.min(65535,ie.length-Q),pe=Q+J==ie.length;for(Y.write_shift(1,+pe),Y.write_shift(2,J),Y.write_shift(2,~J&65535);J-- >0;)Y[Y.l++]=ie[Q++]}return Y.l}function q(ie,Y){for(var Q=0,J=0,pe=ge?new Uint16Array(32768):[];J<ie.length;){var Ee=Math.min(65535,ie.length-J);if(Ee<10){for(Q=Gr(Y,Q,+(J+Ee==ie.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,Ee),Y.write_shift(2,~Ee&65535);Ee-- >0;)Y[Y.l++]=ie[J++];Q=Y.l*8;continue}Q=Gr(Y,Q,+(J+Ee==ie.length)+2);for(var Ae=0;Ee-- >0;){var _e=ie[J];Ae=(Ae<<5^_e)&32767;var Se=-1,Me=0;if((Se=pe[Ae])&&(Se|=J&-32768,Se>J&&(Se-=32768),Se<J))for(;ie[Se+Me]==ie[J+Me]&&Me<250;)++Me;if(Me>2){_e=B[Me],_e<=22?Q=Pn(Y,Q,fe[_e+1]>>1)-1:(Pn(Y,Q,3),Q+=5,Pn(Y,Q,fe[_e-23]>>5),Q+=3);var mt=_e<8?0:_e-4>>2;mt>0&&(ca(Y,Q,Me-ee[_e]),Q+=mt),_e=V[J-Se],Q=Pn(Y,Q,fe[_e]>>3),Q-=3;var ot=_e<4?0:_e-2>>1;ot>0&&(ca(Y,Q,J-Se-me[_e]),Q+=ot);for(var At=0;At<Me;++At)pe[Ae]=J&32767,Ae=(Ae<<5^ie[J])&32767,++J;Ee-=Me-1}else _e<=143?_e=_e+48:Q=rn(Y,Q,1),Q=Pn(Y,Q,fe[_e]),pe[Ae]=J&32767,++J}Q=Pn(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?j(Y,Q):q(Y,Q)}}();function He(I){var V=ae(50+Math.floor(I.length*1.1)),D=mn(I,V);return V.slice(0,D)}var Rt=ge?new Uint16Array(32768):pr(32768),or=ge?new Uint16Array(32768):pr(32768),Mt=ge?new Uint16Array(128):pr(128),ci=1,lo=1;function nd(I,V){var D=$e(I,V)+257;V+=5;var O=$e(I,V)+1;V+=5;var B=st(I,V)+4;V+=4;for(var j=0,q=ge?new Uint8Array(19):pr(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=ge?new Uint8Array(8):pr(8),J=ge?new Uint8Array(8):pr(8),pe=q.length,Ee=0;Ee<B;++Ee)q[G[Ee]]=j=Ke(I,V),Y<j&&(Y=j),Q[j]++,V+=3;var Ae=0;for(Q[0]=0,Ee=1;Ee<=Y;++Ee)J[Ee]=Ae=Ae+Q[Ee-1]<<1;for(Ee=0;Ee<pe;++Ee)(Ae=q[Ee])!=0&&(ie[Ee]=J[Ae]++);var _e=0;for(Ee=0;Ee<pe;++Ee)if(_e=q[Ee],_e!=0){Ae=fe[ie[Ee]]>>8-_e;for(var Se=(1<<7-_e)-1;Se>=0;--Se)Mt[Ae|Se<<_e]=_e&7|Ee<<3}var Me=[];for(Y=1;Me.length<D+O;)switch(Ae=Mt[ke(I,V)],V+=Ae&7,Ae>>>=3){case 16:for(j=3+at(I,V),V+=2,Ae=Me[Me.length-1];j-- >0;)Me.push(Ae);break;case 17:for(j=3+Ke(I,V),V+=3;j-- >0;)Me.push(0);break;case 18:for(j=11+ke(I,V),V+=7;j-- >0;)Me.push(0);break;default:Me.push(Ae),Y<Ae&&(Y=Ae);break}var mt=Me.slice(0,D),ot=Me.slice(D);for(Ee=D;Ee<286;++Ee)mt[Ee]=0;for(Ee=O;Ee<30;++Ee)ot[Ee]=0;return ci=Nn(mt,Rt,286),lo=Nn(ot,or,30),V}function id(I,V){if(I[0]==3&&!(I[1]&3))return[Qs(V),2];for(var D=0,O=0,B=Iy(V||1<<18),j=0,q=B.length>>>0,ie=0,Y=0;!(O&1);){if(O=Ke(I,D),D+=3,O>>>1)O>>1==1?(ie=9,Y=5):(D=nd(I,D),ie=ci,Y=lo);else{D&7&&(D+=8-(D&7));var Q=I[D>>>3]|I[(D>>>3)+1]<<8;if(D+=32,Q>0)for(!V&&q<j+Q&&(B=Fn(B,j+Q),q=B.length);Q-- >0;)B[j++]=I[D>>>3],D+=8;continue}for(;;){!V&&q<j+32767&&(B=Fn(B,j+32767),q=B.length);var J=Ct(I,D,ie),pe=O>>>1==1?_t[J]:Rt[J];if(D+=pe&15,pe>>>=4,!(pe>>>8&255))B[j++]=pe;else{if(pe==256)break;pe-=257;var Ee=pe<8?0:pe-4>>2;Ee>5&&(Ee=0);var Ae=j+ee[pe];Ee>0&&(Ae+=Ct(I,D,Ee),D+=Ee),J=Ct(I,D,Y),pe=O>>>1==1?Ht[J]:or[J],D+=pe&15,pe>>>=4;var _e=pe<4?0:pe-2>>1,Se=me[pe];for(_e>0&&(Se+=Ct(I,D,_e),D+=_e),!V&&q<Ae&&(B=Fn(B,Ae+100),q=B.length);j<Ae;)B[j]=B[j-Se],++j}}}return V?[B,D+7>>>3]:[B.slice(0,j),D+7>>>3]}function co(I,V){var D=I.slice(I.l||0),O=id(D,V);return I.l+=O[1],O[0]}function Pl(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function Fl(I,V){var D=I;yr(D,0);var O=[],B=[],j={FileIndex:O,FullPaths:B};w(j,{root:V.root});for(var q=D.length-4;(D[q]!=80||D[q+1]!=75||D[q+2]!=5||D[q+3]!=6)&&q>=0;)--q;D.l=q+4,D.l+=4;var ie=D.read_shift(2);D.l+=6;var Y=D.read_shift(4);for(D.l=Y,q=0;q<ie;++q){D.l+=20;var Q=D.read_shift(4),J=D.read_shift(4),pe=D.read_shift(2),Ee=D.read_shift(2),Ae=D.read_shift(2);D.l+=8;var _e=D.read_shift(4),Se=o(D.slice(D.l+pe,D.l+pe+Ee));D.l+=pe+Ee+Ae;var Me=D.l;D.l=_e+4,ua(D,Q,J,j,Se),D.l=Me}return j}function ua(I,V,D,O,B){I.l+=2;var j=I.read_shift(2),q=I.read_shift(2),ie=a(I);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var Y=I.read_shift(4),Q=I.read_shift(4),J=I.read_shift(4),pe=I.read_shift(2),Ee=I.read_shift(2),Ae="",_e=0;_e<pe;++_e)Ae+=String.fromCharCode(I[I.l++]);if(Ee){var Se=o(I.slice(I.l,I.l+Ee));(Se[21589]||{}).mt&&(ie=Se[21589].mt),((B||{})[21589]||{}).mt&&(ie=B[21589].mt)}I.l+=Ee;var Me=I.slice(I.l,I.l+Q);switch(q){case 8:Me=K(I,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var mt=!1;j&8&&(Y=I.read_shift(4),Y==134695760&&(Y=I.read_shift(4),mt=!0),Q=I.read_shift(4),J=I.read_shift(4)),Q!=V&&Pl(mt,"Bad compressed size: "+V+" != "+Q),J!=D&&Pl(mt,"Bad uncompressed size: "+D+" != "+J),Fi(O,Ae,Me,{unsafe:!0,mt:ie})}function Nl(I,V){var D=V||{},O=[],B=[],j=ae(1),q=D.compression?8:0,ie=0,Y=0,Q=0,J=0,pe=0,Ee=I.FullPaths[0],Ae=Ee,_e=I.FileIndex[0],Se=[],Me=0;for(Y=1;Y<I.FullPaths.length;++Y)if(Ae=I.FullPaths[Y].slice(Ee.length),_e=I.FileIndex[Y],!(!_e.size||!_e.content||Ae=="Sh33tJ5")){var mt=J,ot=ae(Ae.length);for(Q=0;Q<Ae.length;++Q)ot.write_shift(1,Ae.charCodeAt(Q)&127);ot=ot.slice(0,ot.l),Se[pe]=O6.buf(_e.content,0);var At=_e.content;q==8&&(At=z(At)),j=ae(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,ie),j.write_shift(2,q),_e.mt?s(j,_e.mt):j.write_shift(4,0),j.write_shift(-4,Se[pe]),j.write_shift(4,At.length),j.write_shift(4,_e.content.length),j.write_shift(2,ot.length),j.write_shift(2,0),J+=j.length,O.push(j),J+=ot.length,O.push(ot),J+=At.length,O.push(At),j=ae(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,ie),j.write_shift(2,q),j.write_shift(4,0),j.write_shift(-4,Se[pe]),j.write_shift(4,At.length),j.write_shift(4,_e.content.length),j.write_shift(2,ot.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,mt),Me+=j.l,B.push(j),Me+=ot.length,B.push(ot),++pe}return j=ae(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,pe),j.write_shift(2,pe),j.write_shift(4,Me),j.write_shift(4,J),j.write_shift(2,0),fr([fr(O),fr(B),j])}var hs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pi(I,V){if(I.ctype)return I.ctype;var D=I.name||"",O=D.match(/\.([^\.]+)$/);return O&&hs[O[1]]||V&&(O=(D=V).match(/[\.\\]([^\.\\])+$/),O&&hs[O[1]])?hs[O[1]]:"application/octet-stream"}function Xu(I){for(var V=iu(I),D=[],O=0;O<V.length;O+=76)D.push(V.slice(O,O+76));return D.join(`\r
`)+`\r
`}function uo(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var J=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],O=V.split(`\r
`),B=0;B<O.length;++B){var j=O[B];if(j.length==0){D.push("");continue}for(var q=0;q<j.length;){var ie=76,Y=j.slice(q,q+ie);Y.charAt(ie-1)=="="?ie--:Y.charAt(ie-2)=="="?ie-=2:Y.charAt(ie-3)=="="&&(ie-=3),Y=j.slice(q,q+ie),q+=ie,q<j.length&&(Y+="="),D.push(Y)}}return D.join(`\r
`)}function qu(I){for(var V=[],D=0;D<I.length;++D){for(var O=I[D];D<=I.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+I[++D];V.push(O)}for(var B=0;B<V.length;++B)V[B]=V[B].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return wn(V.join(`\r
`))}function fa(I,V,D){for(var O="",B="",j="",q,ie=0;ie<10;++ie){var Y=V[ie];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":O=Q[2].trim();break;case"content-type":j=Q[2].trim();break;case"content-transfer-encoding":B=Q[2].trim();break}}switch(++ie,B.toLowerCase()){case"base64":q=wn(In(V.slice(ie).join("")));break;case"quoted-printable":q=qu(V.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var J=Fi(I,O.slice(D.length),q,{unsafe:!0});j&&(J.ctype=j)}function Yu(I,V){if(H(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=V&&V.root||"",O=(Ge&&Buffer.isBuffer(I)?I.toString("binary"):H(I)).split(`\r
`),B=0,j="";for(B=0;B<O.length;++B)if(j=O[B],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),D||(D=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),j.slice(0,D.length)!=D););var q=(O[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var ie="--"+(q[1]||""),Y=[],Q=[],J={FileIndex:Y,FullPaths:Q};w(J);var pe,Ee=0;for(B=0;B<O.length;++B){var Ae=O[B];Ae!==ie&&Ae!==ie+"--"||(Ee++&&fa(J,O.slice(pe,B),D),pe=B)}return J}function mr(I,V){var D=V||{},O=D.boundary||"SheetJS";O="------="+O;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],j=I.FullPaths[0],q=j,ie=I.FileIndex[0],Y=1;Y<I.FullPaths.length;++Y)if(q=I.FullPaths[Y].slice(j.length),ie=I.FileIndex[Y],!(!ie.size||!ie.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var Q=ie.content,J=Ge&&Buffer.isBuffer(Q)?Q.toString("binary"):H(Q),pe=0,Ee=Math.min(1024,J.length),Ae=0,_e=0;_e<=Ee;++_e)(Ae=J.charCodeAt(_e))>=32&&Ae<128&&++pe;var Se=pe>=Ee*4/5;B.push(O),B.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+q),B.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),B.push("Content-Type: "+Pi(ie,q)),B.push(""),B.push(Se?uo(J):Xu(J))}return B.push(O+`--\r
`),B.join(`\r
`)}function Qu(I){var V={};return w(V,I),V}function Fi(I,V,D,O){var B=O&&O.unsafe;B||w(I);var j=!B&&Pe.find(I,V);if(!j){var q=I.FullPaths[0];V.slice(0,q.length)==q?q=V:(q.slice(-1)!="/"&&(q+="/"),q=(q+V).replace("//","/")),j={name:i(V),type:2},I.FileIndex.push(j),I.FullPaths.push(q),B||Pe.utils.cfb_gc(I)}return j.content=D,j.size=D?D.length:0,O&&(O.CLSID&&(j.clsid=O.CLSID),O.mt&&(j.mt=O.mt),O.ct&&(j.ct=O.ct)),j}function ha(I,V){w(I);var D=Pe.find(I,V);if(D){for(var O=0;O<I.FileIndex.length;++O)if(I.FileIndex[O]==D)return I.FileIndex.splice(O,1),I.FullPaths.splice(O,1),!0}return!1}function sd(I,V,D){w(I);var O=Pe.find(I,V);if(O){for(var B=0;B<I.FileIndex.length;++B)if(I.FileIndex[B]==O)return I.FileIndex[B].name=i(D),I.FullPaths[B]=D,!0}return!1}function ad(I){S(I,!0)}return e.find=P,e.read=b,e.parse=f,e.write=se,e.writeFile=re,e.utils={cfb_new:Qu,cfb_add:Fi,cfb_del:ha,cfb_mov:sd,cfb_gc:ad,ReadShift:kc,CheckField:BS,prep_blob:yr,bconcat:fr,use_zlib:L,_deflateRaw:He,_inflateRaw:co,consts:te},e}();function L6(t){return typeof t=="string"?Xh(t):Array.isArray(t)?o6(t):t}function Uu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Xh(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?_i(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([L6(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=aa(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function b6(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Wt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ly(t,e){for(var r=[],n=Wt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Yh(t){for(var e=[],r=Wt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Qh(t){for(var e=[],r=Wt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function M6(t){for(var e=[],r=Wt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var nh=new Date(1899,11,30,0,0,0);function ar(t,e){var r=t.getTime(),n=nh.getTime()+(t.getTimezoneOffset()-nh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _S=new Date,V6=nh.getTime()+(_S.getTimezoneOffset()-nh.getTimezoneOffset())*6e4,by=_S.getTimezoneOffset();function Jh(t){var e=new Date;return e.setTime(t*24*60*60*1e3+V6),e.getTimezoneOffset()!==by&&e.setTime(e.getTime()+(e.getTimezoneOffset()-by)*6e4),e}function B6(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var My=new Date("2017-02-19T19:06:09.000Z"),xS=isNaN(My.getFullYear())?new Date("2/19/17"):My,U6=xS.getFullYear()==2017;function kt(t,e){var r=new Date(t);if(U6)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(xS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function $a(t,e){if(Ge&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return _i(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return _i(aS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return _i(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return _i(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function St(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=St(t[r]));return e}function Ut(t,e){for(var r="";r.length<e;)r+=t;return r}function ii(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var j6=["january","february","march","april","may","june","july","august","september","october","november","december"];function gl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&j6.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var W6=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function yS(t){return t?t.content&&t.type?$a(t.content,!0):t.data?oc(t.data):t.asNodeBuffer&&Ge?oc(t.asNodeBuffer().toString("binary")):t.asBinary?oc(t.asBinary()):t._data&&t._data.getContent?oc($a(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function wS(t){if(!t)return null;if(t.data)return Sy(t.data);if(t.asNodeBuffer&&Ge)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Sy(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function H6(t){return t&&t.name.slice(-4)===".bin"?wS(t):yS(t)}function Mn(t,e){for(var r=t.FullPaths||Wt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function V1(t,e){var r=Mn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Jt(t,e,r){if(!r)return H6(V1(t,e));if(!e)return null;try{return Jt(t,e)}catch{return null}}function En(t,e,r){if(!r)return yS(V1(t,e));if(!e)return null;try{return En(t,e)}catch{return null}}function z6(t,e,r){return wS(V1(t,e))}function Vy(t){for(var e=t.FullPaths||Wt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ze(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ge?n=cs(r):n=l6(r),Pe.utils.cfb_add(t,e,n)}Pe.utils.cfb_add(t,e,r)}else t.file(e,r)}function B1(){return Pe.utils.cfb_new()}function ES(t,e){switch(e.type){case"base64":return Pe.read(t,{type:"base64"});case"binary":return Pe.read(t,{type:"binary"});case"buffer":case"array":return Pe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function cc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Xt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,By=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,G6=/<[^>]*>/g,$r=Xt.match(By)?By:G6,K6=/<\w*:/,X6=/<(\/?)\w+:/;function Le(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match($6),o=0,l="",c=0,f="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ci(t){return t.replace(X6,"<$1")}var TS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},U1=Yh(TS),et=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return TS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),j1=/[&<>'"]/g,q6=/[\u0000-\u0008\u000b-\u001f]/g;function ut(t){var e=t+"";return e.replace(j1,function(r){return U1[r]}).replace(q6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Uy(t){return ut(t).replace(/ /g,"_x0020_")}var kS=/[\u0000-\u001f]/g;function W1(t){var e=t+"";return e.replace(j1,function(r){return U1[r]}).replace(/\n/g,"<br/>").replace(kS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Y6(t){var e=t+"";return e.replace(j1,function(r){return U1[r]}).replace(kS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jy=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Q6(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function wt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jd(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Wy(t){var e=Qs(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Hy(t){return cs(t,"binary").toString("utf8")}var Df="foo bar baz",pt=Ge&&(Hy(Df)==Jd(Df)&&Hy||Wy(Df)==Jd(Df)&&Wy)||Jd,_i=Ge?function(t){return cs(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},au=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),SS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),J6=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Z6=/<\/?(?:vt:)?variant>/g,eL=/<(?:vt:)([^>]*)>([\s\S]*)</;function zy(t,e){var r=Le(t),n=t.match(J6(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(Z6,"").match(eL);a&&i.push({v:pt(a[2]),t:a[1]})}),i}var AS=/(^\s|\s$|\n)/;function Er(t,e){return"<"+t+(e.match(AS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ou(t){return Wt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ye(t,e,r){return"<"+t+(r!=null?ou(r):"")+(e!=null?(e.match(AS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Rm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function tL(t,e){switch(typeof t){case"string":var r=ye("vt:lpwstr",ut(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ye((t|0)==t?"vt:i4":"vt:r8",ut(String(t)));case"boolean":return ye("vt:bool",t?"true":"false")}if(t instanceof Date)return ye("vt:filetime",Rm(t));throw new Error("Unable to serialize "+t)}function H1(t){if(Ge&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return pt(aa(L1(t)));throw new Error("Bad input format: expected Buffer or string")}var lu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ro=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],xn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function rL(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function nL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var $y=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Gy=Ge?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:cs(e)})):$y(t)}:$y,Ky=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Hi(t,i)));return n.join("").replace(Zr,"")},z1=Ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Zr,""):Ky(t,e,r)}:Ky,Xy=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},IS=Ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Xy(t,e,r)}:Xy,qy=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(To(t,i)));return n.join("")},ju=Ge?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):qy(e,r,n)}:qy,CS=function(t,e){var r=yn(t,e);return r>0?ju(t,e+4,e+4+r-1):""},RS=CS,PS=function(t,e){var r=yn(t,e);return r>0?ju(t,e+4,e+4+r-1):""},FS=PS,NS=function(t,e){var r=2*yn(t,e);return r>0?ju(t,e+4,e+4+r-1):""},DS=NS,OS=function(e,r){var n=yn(e,r);return n>0?z1(e,r+4,r+4+n):""},LS=OS,bS=function(t,e){var r=yn(t,e);return r>0?ju(t,e+4,e+4+r):""},MS=bS,VS=function(t,e){return rL(t,e)},ih=VS,$1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ge&&(RS=function(e,r){if(!Buffer.isBuffer(e))return CS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},FS=function(e,r){if(!Buffer.isBuffer(e))return PS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},DS=function(e,r){if(!Buffer.isBuffer(e))return NS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},LS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},MS=function(e,r){if(!Buffer.isBuffer(e))return bS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ih=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):VS(e,r)},$1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var To=function(t,e){return t[e]},Hi=function(t,e){return t[e+1]*256+t[e]},iL=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},yn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},xa=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},sL=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function kc(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Hi(this,c)),c+=2;t*=2;break;case"utf8":r=ju(this,this.l,this.l+t);break;case"utf16le":t*=2,r=z1(this,this.l,this.l+t);break;case"wstr":return kc.call(this,t,"dbcs");case"lpstr-ansi":r=RS(this,this.l),t=4+yn(this,this.l);break;case"lpstr-cp":r=FS(this,this.l),t=4+yn(this,this.l);break;case"lpwstr":r=DS(this,this.l),t=4+2*yn(this,this.l);break;case"lpp4":t=4+yn(this,this.l),r=LS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+yn(this,this.l),r=MS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=To(this,this.l+t++))!==0;)s.push(Nf(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Hi(this,this.l+t))!==0;)s.push(Nf(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=To(this,c),this.l=c+1,o=kc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Nf(Hi(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=To(this,c),this.l=c+1,o=kc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Nf(To(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=To(this,this.l),this.l++,n;case 2:return n=(e==="i"?iL:Hi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?xa:sL)(this,this.l),this.l+=4,n):(i=yn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=ih(this,this.l):i=ih([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=IS(this,this.l,t);break}}return this.l+=t,r}var aL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},oL=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},lL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function cL(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)lL(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,aL(this,e,this.l);break;case 8:if(n=8,r==="f"){nL(this,e,this.l);break}case 16:break;case-4:n=4,oL(this,e,this.l);break}return this.l+=n,this}function BS(t,e){var r=IS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function yr(t,e){t.l=e,t.read_shift=kc,t.chk=BS,t.write_shift=cL}function zr(t,e){t.l+=e}function ae(t){var e=Qs(t);return yr(e,0),e}function us(t,e,r){if(t){var n,i,s;yr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=pu[o]||pu[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=c.f&&c.f(t,s,r);if(t.l=l,e(f,c,o))return}}}function dn(){var t=[],e=Ge?256:2048,r=function(c){var f=ae(c);return yr(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),fr(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ce(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=pu[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&$1(r)&&t.push(r)}}function Sc(t,e,r){var n=St(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Yy(t,e,r){var n=St(t);return n.s=Sc(n.s,e.s,r),n.e=Sc(n.e,e.s,r),n}function Ac(t,e){if(t.cRel&&t.c<0)for(t=St(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=St(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Oe(t);return!t.cRel&&t.cRel!=null&&(r=hL(r)),!t.rRel&&t.rRel!=null&&(r=uL(r)),r}function Zd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ft(t.s.c)+":"+(t.e.cRel?"":"$")+Ft(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Kt(t.s.r)+":"+(t.e.rRel?"":"$")+Kt(t.e.r):Ac(t.s,e.biff)+":"+Ac(t.e,e.biff)}function G1(t){return parseInt(fL(t),10)-1}function Kt(t){return""+(t+1)}function uL(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function fL(t){return t.replace(/\$(\d+)$/,"$1")}function K1(t){for(var e=dL(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ft(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function hL(t){return t.replace(/^([A-Z])/,"$$$1")}function dL(t){return t.replace(/^\$([A-Z])/,"$1")}function pL(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Oe(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function pn(t){var e=t.indexOf(":");return e==-1?{s:Nt(t),e:Nt(t)}:{s:Nt(t.slice(0,e)),e:Nt(t.slice(e+1))}}function We(t,e){return typeof e>"u"||typeof e=="number"?We(t.s,t.e):(typeof t!="string"&&(t=Oe(t)),typeof e!="string"&&(e=Oe(e)),t==e?t:t+":"+e)}function tt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Qy(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Gn(t.z,r?ar(e):e)}catch{}try{return t.w=Gn((t.XF||{}).numFmtId||(r?14:0),r?ar(e):e)}catch{return""+e}}function ss(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?fs[t.v]||t.v:e==null?Qy(t,t.v):Qy(t,e))}function oa(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function US(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Nt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=tt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},v=a+h,m=o+d;if(c.s.r>v&&(c.s.r=v),c.s.c>m&&(c.s.c=m),c.e.r<v&&(c.e.r=v),c.e.c<m&&(c.e.c=m),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||De[14],n.cellDates?(p.t="d",p.w=Gn(p.z,ar(p.v))):(p.t="n",p.v=ar(p.v),p.w=Gn(p.z,p.v))):p.t="s";if(i)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var _=Oe({c:m,r:v});s[_]&&s[_].z&&(p.z=s[_].z),s[_]=p}}}return c.s.c<1e7&&(s["!ref"]=We(c)),s}function Cl(t,e){return US(null,t,e)}function mL(t){return t.read_shift(4,"i")}function si(t,e){return e||(e=ae(4)),e.write_shift(4,t),e}function jr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function hr(t,e){var r=!1;return e==null&&(r=!0,e=ae(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function gL(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function vL(t,e){return e||(e=ae(4)),e.write_shift(2,0),e.write_shift(2,0),e}function X1(t,e){var r=t.l,n=t.read_shift(1),i=jr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(gL(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function _L(t,e){var r=!1;return e==null&&(r=!0,e=ae(15+4*t.t.length)),e.write_shift(1,0),hr(t.t,e),r?e.slice(0,e.l):e}var xL=X1;function yL(t,e){var r=!1;return e==null&&(r=!0,e=ae(23+4*t.t.length)),e.write_shift(1,1),hr(t.t,e),e.write_shift(4,1),vL({},e),r?e.slice(0,e.l):e}function Kn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function no(t,e){return e==null&&(e=ae(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function io(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function so(t,e){return e==null&&(e=ae(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var wL=jr,jS=hr;function q1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function sh(t,e){var r=!1;return e==null&&(r=!0,e=ae(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var EL=jr,Pm=q1,Y1=sh;function Q1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?ih([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):xa(e,0)>>2;return r?i/100:i}function WS(t,e){e==null&&(e=ae(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function HS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function TL(t,e){return e||(e=ae(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ao=HS,Rl=TL;function Br(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ga(t,e){return(e||ae(8)).write_shift(8,t,"f")}function kL(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Ca[i];c&&(e.rgb=uu(c));break;case 2:e.rgb=uu([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function ah(t,e){if(e||(e=ae(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function SL(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function AL(t,e){e||(e=ae(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function zS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function IL(t){return zS(t,1)}function CL(t){return zS(t,2)}var J1=2,nn=3,Of=11,Jy=12,oh=19,Lf=64,RL=65,PL=71,FL=4108,NL=4126,cr=80,$S=81,DL=[cr,$S],Fm={1:{n:"CodePage",t:J1},2:{n:"Category",t:cr},3:{n:"PresentationFormat",t:cr},4:{n:"ByteCount",t:nn},5:{n:"LineCount",t:nn},6:{n:"ParagraphCount",t:nn},7:{n:"SlideCount",t:nn},8:{n:"NoteCount",t:nn},9:{n:"HiddenCount",t:nn},10:{n:"MultimediaClipCount",t:nn},11:{n:"ScaleCrop",t:Of},12:{n:"HeadingPairs",t:FL},13:{n:"TitlesOfParts",t:NL},14:{n:"Manager",t:cr},15:{n:"Company",t:cr},16:{n:"LinksUpToDate",t:Of},17:{n:"CharacterCount",t:nn},19:{n:"SharedDoc",t:Of},22:{n:"HyperlinksChanged",t:Of},23:{n:"AppVersion",t:nn,p:"version"},24:{n:"DigSig",t:RL},26:{n:"ContentType",t:cr},27:{n:"ContentStatus",t:cr},28:{n:"Language",t:cr},29:{n:"Version",t:cr},255:{},2147483648:{n:"Locale",t:oh},2147483651:{n:"Behavior",t:oh},1919054434:{}},Nm={1:{n:"CodePage",t:J1},2:{n:"Title",t:cr},3:{n:"Subject",t:cr},4:{n:"Author",t:cr},5:{n:"Keywords",t:cr},6:{n:"Comments",t:cr},7:{n:"Template",t:cr},8:{n:"LastAuthor",t:cr},9:{n:"RevNumber",t:cr},10:{n:"EditTime",t:Lf},11:{n:"LastPrinted",t:Lf},12:{n:"CreatedDate",t:Lf},13:{n:"ModifiedDate",t:Lf},14:{n:"PageCount",t:nn},15:{n:"WordCount",t:nn},16:{n:"CharCount",t:nn},17:{n:"Thumbnail",t:PL},18:{n:"Application",t:cr},19:{n:"DocSecurity",t:nn},255:{},2147483648:{n:"Locale",t:oh},2147483651:{n:"Behavior",t:oh},1919054434:{}},Zy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},OL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function LL(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var bL=LL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ca=St(bL),fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Dm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Z1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ML(t){var e=Z1();if(!t||!t.match)return e;var r={};if((t.match($r)||[]).forEach(function(n){var i=Le(n);switch(i[0].replace(K6,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Dm[i.ContentType]]!==void 0&&e[Dm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==nr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function KS(t,e){var r=M6(Dm),n=[],i;n[n.length]=Xt,n[n.length]=ye("Types",null,{xmlns:nr.CT,"xmlns:xsd":nr.xsd,"xmlns:xsi":nr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ye("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=ye("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:bf[l][e.bookType]||bf[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=ye("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:bf[l][e.bookType]||bf[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=ye("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Xe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cu(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ic(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match($r)||[]).forEach(function(i){var s=Le(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:cc(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Yo(t){var e=[Xt,ye("Relationships",null,{xmlns:nr.RELS})];return Wt(t["!id"]).forEach(function(r){e[e.length]=ye("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ct(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Xe.HLINK,Xe.XPATH,Xe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var VL="application/vnd.oasis.opendocument.spreadsheet";function BL(t,e){for(var r=H1(t),n,i;n=lu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Le(n[0],!1),i.path=="/"&&i.type!==VL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function UL(t){var e=[Xt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function ew(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function jL(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function WL(t){var e=[Xt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(ew(t[r][0],t[r][1])),e.push(jL("",t[r][0]));return e.push(ew("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function XS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Z0.version+"</meta:generator></office:meta></office:document-meta>"}var Hn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],HL=function(){for(var t=new Array(Hn.length),e=0;e<Hn.length;++e){var r=Hn[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function qS(t){var e={};t=pt(t);for(var r=0;r<Hn.length;++r){var n=Hn[r],i=t.match(HL[r]);i!=null&&i.length>0&&(e[n[1]]=et(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=kt(e[n[1]]))}return e}function ep(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ut(e),n[n.length]=r?ye(t,e,r):Er(t,e))}function YS(t,e){var r=e||{},n=[Xt,ye("cp:coreProperties",null,{"xmlns:cp":nr.CORE_PROPS,"xmlns:dc":nr.dc,"xmlns:dcterms":nr.dcterms,"xmlns:dcmitype":nr.dcmitype,"xmlns:xsi":nr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&ep("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Rm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&ep("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Rm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Hn.length;++s){var a=Hn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ep(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ra=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],QS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function JS(t,e,r,n){var i=[];if(typeof t=="string")i=zy(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?zy(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function zL(t,e,r){var n={};return e||(e={}),t=pt(t),Ra.forEach(function(i){var s=(t.match(au(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=et(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&JS(n.HeadingPairs,n.TitlesOfParts,e,r),e}function ZS(t){var e=[],r=ye;return t||(t={}),t.Application="SheetJS",e[e.length]=Xt,e[e.length]=ye("Properties",null,{xmlns:nr.EXT_PROPS,"xmlns:vt":nr.vt}),Ra.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ut(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ut(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var $L=/<[^>]+>[^<]*/g;function GL(t,e){var r={},n="",i=t.match($L);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Le(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=et(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=et(f);break;case"bool":r[n]=wt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=kt(f);break;case"cy":case"error":r[n]=et(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function eA(t){var e=[Xt,ye("Properties",null,{xmlns:nr.CUST_PROPS,"xmlns:vt":nr.vt})];if(!t)return e.join("");var r=1;return Wt(t).forEach(function(i){++r,e[e.length]=ye("property",tL(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ut(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Om={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tp;function KL(t,e,r){tp||(tp=Yh(Om)),e=tp[e]||e,t[e]=r}function XL(t,e){var r=[];return Wt(Om).map(function(n){for(var i=0;i<Hn.length;++i)if(Hn[i][1]==n)return Hn[i];for(i=0;i<Ra.length;++i)if(Ra[i][1]==n)return Ra[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Er(Om[n[1]]||n[1],i))}}),ye("DocumentProperties",r.join(""),{xmlns:xn.o})}function qL(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Wt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Hn.length;++a)if(s==Hn[a][1])return;for(a=0;a<Ra.length;++a)if(s==Ra[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(ye(Uy(s),o,{"dt:dt":l}))}}),e&&Wt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ye(Uy(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+xn.o+'">'+i.join("")+"</"+n+">"}function ev(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function YL(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ae(8);return a.write_shift(4,n),a.write_shift(4,i),a}function tA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function rA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function nA(t,e,r){return e===31?rA(t):tA(t,e,r)}function Lm(t,e,r){return nA(t,e,r===!1?0:4)}function QL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return nA(t,e,0)}function JL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Zr,""),t.l-i&2&&(t.l+=2)}return r}function ZL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function e8(t){var e=t.l,r=lh(t,$S);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=lh(t,nn);return[r,n]}function t8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(e8(t));return r}function tw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Zr,"").replace(lc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function iA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function r8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function lh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Jy&&n!==e&&DL.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Jy?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return tA(t,n,4).replace(Zr,"");case 31:return rA(t);case 64:return ev(t);case 65:return iA(t);case 71:return r8(t);case 80:return Lm(t,n,!s.raw).replace(Zr,"");case 81:return QL(t,n).replace(Zr,"");case 4108:return t8(t);case 4126:case 4127:return n==4127?JL(t):ZL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function rw(t,e){var r=ae(4),n=ae(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ae(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=YL(e);break;case 31:case 80:for(n=ae(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return fr([r,n])}function nw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var f=t.read_shift(4),h=t.read_shift(4);s[a]=[f,h+r]}s.sort(function(E,x){return E[1]-x[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(d[v.n]=lh(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ei(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[a][0]===1){if(o=d.CodePage=lh(t,J1),ei(o),l!==-1){var m=t.l;t.l=s[l][1],c=tw(t,o),t.l=m}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=tw(t,o)}else{var _=c[s[a][0]],y;switch(t[t.l]){case 65:t.l+=4,y=iA(t);break;case 30:t.l+=4,y=Lm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=Lm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=zt(t,4);break;case 64:t.l+=4,y=kt(ev(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[_]=y}}return t.l=r+n,d}var sA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function n8(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function iw(t,e,r){var n=ae(8),i=[],s=[],a=8,o=0,l=ae(8),c=ae(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=ae(8),c.write_shift(4,0),i.unshift(c);var f=[ae(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=ae(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=fr(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(sA.indexOf(t[o][0])>-1||QS.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],p=0;if(e){p=+e[t[o][0]];var v=r[p];if(v.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=rw(v.t,d)}else{var _=n8(d);_==-1&&(_=31,d=String(d)),l=rw(_,d)}s.push(l),c=ae(8),c.write_shift(4,e?p:2+o),i.push(c),a+=8+l.length}var y=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,y),y+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),fr([n].concat(i).concat(s))}function sw(t,e,r){var n=t.content;if(!n)return{};yr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Pe.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=nw(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=s,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=nw(n,null)}catch{}for(p in v)d[p]=v[p];return d.FMTID=[s,a],d}function aw(t,e,r,n,i,s){var a=ae(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Pe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=iw(t,r,n);if(o.push(l),i){var c=iw(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return fr(o)}function _s(t,e){return t.read_shift(e),null}function i8(t,e){e||(e=ae(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function s8(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function zt(t,e){return t.read_shift(e)===1}function qr(t,e){return e||(e=ae(2)),e.write_shift(2,+!!t),e}function Zt(t){return t.read_shift(2,"u")}function Vn(t,e){return e||(e=ae(2)),e.write_shift(2,t),e}function aA(t,e){return s8(t,e,Zt)}function a8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function oA(t,e,r){return r||(r=ae(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Wu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function o8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function l8(t){var e=t.t||"",r=ae(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ae(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return fr(i)}function Ka(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Hu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ka(t,n,r)}function oo(t,e,r){if(r.biff>5)return Hu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function lA(t,e,r){return r||(r=ae(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function c8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function u8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Zr,"");return n&&(t.l+=24),i}function f8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Zr,"");return r+a}function h8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return u8(t);case"0303000000000000c000000000000046":return f8(t);default:throw new Error("Unsupported Moniker "+r)}}function Mf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Zr,""):"";return r}function ow(t,e){e||(e=ae(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function d8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",f,h;i&16&&(s=Mf(t,r-t.l)),i&128&&(a=Mf(t,r-t.l)),(i&257)===257&&(o=Mf(t,r-t.l)),(i&257)===1&&(l=h8(t,r-t.l)),i&8&&(c=Mf(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(h=ev(t)),t.l=r;var d=a||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return f&&(p.guid=f),h&&(p.time=h),s&&(p.Tooltip=s),p}function p8(t){var e=ae(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),ow(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&ow(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function cA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function uA(t,e){var r=cA(t);return r[3]=0,r}function Ri(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Xa(t,e,r,n){return n||(n=ae(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function m8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function g8(t,e,r){return e===0?"":oo(t,e,r)}function v8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function fA(t){var e=t.read_shift(2),r=Q1(t);return[e,r]}function _8(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Wu(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Zh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function hA(t,e){return e||(e=ae(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function dA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var x8=dA;function pA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function y8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function w8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Nr(t){t.l+=2,t.l+=t.read_shift(2)}var E8={0:Nr,4:Nr,5:Nr,6:Nr,7:w8,8:Nr,9:Nr,10:Nr,11:Nr,12:Nr,13:y8,14:Nr,15:Nr,16:Nr,17:Nr,18:Nr,19:Nr,20:Nr,21:pA};function T8(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(E8[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Vf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function tv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ae(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function k8(t,e){return e===0||t.read_shift(2),1200}function S8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=oo(t,0,r);return t.read_shift(e+n-t.l),i}function A8(t,e){var r=!e||e.biff==8,n=ae(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function I8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function C8(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Wu(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function R8(t,e){var r=!e||e.biff>=8?2:1,n=ae(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function P8(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(o8(t));return s.Count=n,s.Unique=i,s}function F8(t,e){var r=ae(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=l8(t[i]);var s=fr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function N8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function D8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function O8(t){var e=m8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function L8(t){return t.read_shift(2),t.read_shift(4)}function lw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function b8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function M8(){var t=ae(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function V8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function B8(t){var e=ae(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function U8(){}function j8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Wu(t,0,r),n}function W8(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ae(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function H8(t){var e=Ri(t);return e.isst=t.read_shift(4),e}function z8(t,e,r,n){var i=ae(10);return Xa(t,e,n,i),i.write_shift(4,r),i}function $8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ri(t);r.biff==2&&t.l++;var s=Hu(t,n-t.l,r);return i.val=s,i}function G8(t,e,r,n,i){var s=!i||i.biff==8,a=ae(8+ +s+(1+s)*r.length);return Xa(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function K8(t,e,r){var n=t.read_shift(2),i=oo(t,0,r);return[n,i]}function X8(t,e,r,n){var i=r&&r.biff==5;n||(n=ae(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var q8=oo;function cw(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function Y8(t,e){var r=e.biff==8||!e.biff?4:2,n=ae(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Q8(t){var e=t.read_shift(2),r=t.read_shift(2),n=fA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function J8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(fA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function Z8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function eb(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=OL[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function tb(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=eb(t,e,n.fStyle,r),n}function uw(t,e,r,n){var i=r&&r.biff==5;n||(n=ae(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function rb(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function nb(t){var e=ae(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function fw(t,e,r){var n=Ri(t);(r.biff==2||e==9)&&++t.l;var i=a8(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function ib(t,e,r,n,i,s){var a=ae(8);return Xa(t,e,n,a),oA(r,s,a),a}function sb(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ri(t),i=Br(t);return n.val=i,n}function ab(t,e,r,n){var i=ae(14);return Xa(t,e,n,i),Ga(r,i),i}var hw=g8;function ob(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ka(t,s),o=[];n>t.l;)o.push(Hu(t));return[s,i,a,o]}function dw(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=_8(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var lb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function pw(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ka(t,a,r);i&32&&(c=lb[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:TV(t,f,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function mA(t,e,r){if(r.biff<8)return cb(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(v8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function cb(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Wu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function ub(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ka(t,n,r),a=Ka(t,i,r);return[s,a]}function fb(t,e,r){var n=dA(t);t.l++;var i=t.read_shift(1);return e-=8,[kV(t,e,r),i,n]}function mw(t,e,r){var n=x8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,wV(t,e,r)]}function hb(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function db(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=oo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function pb(t,e,r){return db(t,e,r)}function mb(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Zh(t));return r}function gb(t){var e=ae(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)hA(t[r],e);return e}function vb(t,e,r){if(r&&r.biff<8)return xb(t,e,r);var n=pA(t),i=T8(t,e-22,n[1]);return{cmo:n,ft:i}}var _b={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function xb(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((_b[n]||zr)(t,e,r)),{cmo:[i,n,s],ft:a}}function yb(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=c8(t,6,r);var o=t.read_shift(2);t.read_shift(2),Zt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Ka(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function wb(t,e){var r=Zh(t);t.l+=16;var n=d8(t,e-24);return[r,n]}function Eb(t){var e=ae(24),r=Nt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return fr([e,p8(t[1])])}function Tb(t,e){t.read_shift(2);var r=Zh(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function kb(t){var e=t[1].Tooltip,r=ae(10+2*(e.length+1));r.write_shift(2,2048);var n=Nt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Sb(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Zy[r]||r,r=t.read_shift(2),e[1]=Zy[r]||r,e}function Ab(t){return t||(t=ae(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Ib(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(uA(t));return r}function Cb(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(uA(t));return r}function Rb(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function gA(t,e,r){if(!r.cellStyles)return zr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Pb(t,e){var r=ae(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Fb(t,e){var r={};return e<32||(t.l+=16,r.header=Br(t),r.footer=Br(t),t.l+=2),r}function Nb(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function Db(t){for(var e=ae(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var Ob=Ri,Lb=aA,bb=Hu;function Mb(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function Vb(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ri(t);++t.l;var i=oo(t,e-7,r);return n.t="str",n.val=i,n}function Bb(t){var e=Ri(t);++t.l;var r=Br(t);return e.t="n",e.val=r,e}function Ub(t,e,r){var n=ae(15);return Ku(n,t,e),n.write_shift(8,r,"f"),n}function jb(t){var e=Ri(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Wb(t,e,r){var n=ae(9);return Ku(n,t,e),n.write_shift(2,r),n}function Hb(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function zb(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function $b(t,e,r){var n=t.l+e,i=Ri(t),s=t.read_shift(2),a=Ka(t,s,r);return t.l=n,i.t="str",i.val=a,i}var Gb=[2,3,48,49,131,139,140,245],bm=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Yh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Qs(1);switch(l.type){case"base64":f=wn(In(o));break;case"binary":f=wn(o);break;case"buffer":case"array":f=o;break}yr(f,0);var h=f.read_shift(1),d=!!(h&136),p=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,_=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(_=f.read_shift(2));var y=f.read_shift(2),E=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var x=[],F={},U=Math.min(f.length,h==2?521:_-10-(p?264:0)),b=v?32:11;f.l<U&&f[f.l]!=13;)switch(F={},F.name=nu.utils.decode(E,f.slice(f.l,f.l+b)).replace(/[\u0000\r\n].*$/g,""),f.l+=b,F.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(F.offset=f.read_shift(4)),F.len=f.read_shift(1),h==2&&(F.offset=f.read_shift(2)),F.dec=f.read_shift(1),F.name.length&&x.push(F),h!=2&&(f.l+=v?13:14),F.type){case"B":(!p||F.len!=8)&&l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var w=0,k=0;for(c[0]=[],k=0;k!=x.length;++k)c[0][k]=x[k].name;for(;m-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,c[++w]=[],k=0,k=0;k!=x.length;++k){var S=f.slice(f.l,f.l+x[k].len);f.l+=x[k].len,yr(S,0);var C=nu.utils.decode(E,S);switch(x[k].type){case"C":C.trim().length&&(c[w][k]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[w][k]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[w][k]=C;break;case"F":c[w][k]=parseFloat(C.trim());break;case"+":case"I":c[w][k]=v?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[w][k]=!0;break;case"N":case"F":c[w][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][k]="##MEMO##"+(v?parseInt(C.trim(),10):S.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[w][k]=+C||0);break;case"@":c[w][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[w][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[w][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][k]=-S.read_shift(-8,"f");break;case"B":if(p&&x[k].len==8){c[w][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=x[k].len;break;case"0":if(x[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Cl(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function i(o,l){try{return oa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ei(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=dn(),h=hh(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),v=o["!cols"]||[],m=0,_=0,y=0,E=1;for(m=0;m<d.length;++m){if(((v[m]||{}).DBF||{}).name){d[m]=v[m].DBF.name,++y;continue}if(d[m]!=null){if(++y,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(_=0;_<1024;++_)if(d.indexOf(d[m]+"_"+_)==-1){d[m]+="_"+_;break}}}}var x=tt(o["!ref"]),F=[],U=[],b=[];for(m=0;m<=x.e.c-x.s.c;++m){var w="",k="",S=0,C=[];for(_=0;_<p.length;++_)p[_][m]!=null&&C.push(p[_][m]);if(C.length==0||d[m]==null){F[m]="?";continue}for(_=0;_<C.length;++_){switch(typeof C[_]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=C[_]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(C[_]).length),w=w&&w!=k?"C":k}S>250&&(S=250),k=((v[m]||{}).DBF||{}).type,k=="C"&&v[m].DBF.len>S&&(S=v[m].DBF.len),w=="B"&&k=="N"&&(w="N",b[m]=v[m].DBF.dec,S=v[m].DBF.len),U[m]=w=="C"||k=="N"?S:s[w]||0,E+=U[m],F[m]=w}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,p.length),P.write_shift(2,296+32*y),P.write_shift(2,E),m=0;m<4;++m)P.write_shift(4,0);for(P.write_shift(4,0|(+e[sS]||3)<<8),m=0,_=0;m<d.length;++m)if(d[m]!=null){var A=f.next(32),R=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,R,"sbcs"),A.write_shift(1,F[m]=="?"?"C":F[m],"sbcs"),A.write_shift(4,_),A.write_shift(1,U[m]||s[F[m]]||0),A.write_shift(1,b[m]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),_+=U[m]||s[F[m]]||0}var de=f.next(264);for(de.write_shift(4,13),m=0;m<65;++m)de.write_shift(4,0);for(m=0;m<p.length;++m){var ue=f.next(E);for(ue.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(F[_]){case"L":ue.write_shift(1,p[m][_]==null?63:p[m][_]?84:70);break;case"B":ue.write_shift(8,p[m][_]||0,"f");break;case"N":var Z="0";for(typeof p[m][_]=="number"&&(Z=p[m][_].toFixed(b[_]||0)),y=0;y<U[_]-Z.length;++y)ue.write_shift(1,32);ue.write_shift(1,Z,"sbcs");break;case"D":p[m][_]?(ue.write_shift(4,("0000"+p[m][_].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(p[m][_].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+p[m][_].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var te=String(p[m][_]!=null?p[m][_]:"").slice(0,U[_]);for(ue.write_shift(1,te,"sbcs"),y=0;y<U[_]-te.length;++y)ue.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),vA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Wt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var v=t[p];return typeof v=="number"?Ay(v):v},n=function(d,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?d:Ay(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return s(In(d),p);case"binary":return s(d,p);case"buffer":return s(Ge&&Buffer.isBuffer(d)?d.toString("binary"):aa(d),p);case"array":return s($a(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var v=d.split(/[\n\r]+/),m=-1,_=-1,y=0,E=0,x=[],F=[],U=null,b={},w=[],k=[],S=[],C=0,P;for(+p.codepage>=0&&ei(+p.codepage);y!==v.length;++y){C=0;var A=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=A.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),de=R[0],ue;if(A.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&F.push(A.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,te=!1,re=!1,H=!1,se=-1,oe=-1;for(E=1;E<R.length;++E)switch(R[E].charAt(0)){case"A":break;case"X":_=parseInt(R[E].slice(1))-1,te=!0;break;case"Y":for(m=parseInt(R[E].slice(1))-1,te||(_=0),P=x.length;P<=m;++P)x[P]=[];break;case"K":ue=R[E].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(ii(ue))?isNaN(gl(ue).getDate())||(ue=kt(ue)):(ue=ii(ue),U!==null&&Al(U)&&(ue=Jh(ue))),Z=!0;break;case"E":H=!0;var L=Qo(R[E].slice(1),{r:m,c:_});x[m][_]=[x[m][_],L];break;case"S":re=!0,x[m][_]=[x[m][_],"S5S"];break;case"G":break;case"R":se=parseInt(R[E].slice(1))-1;break;case"C":oe=parseInt(R[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}if(Z&&(x[m][_]&&x[m][_].length==2?x[m][_][0]=ue:x[m][_]=ue,U=null),re){if(H)throw new Error("SYLK shared formula cannot have own formula");var K=se>-1&&x[se][oe];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");x[m][_][1]=LA(K[1],{r:m-se,c:_-oe})}break;case"F":var z=0;for(E=1;E<R.length;++E)switch(R[E].charAt(0)){case"X":_=parseInt(R[E].slice(1))-1,++z;break;case"Y":for(m=parseInt(R[E].slice(1))-1,P=x.length;P<=m;++P)x[P]=[];break;case"M":C=parseInt(R[E].slice(1))/20;break;case"F":break;case"G":break;case"P":U=F[parseInt(R[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[E].slice(1).split(" "),P=parseInt(S[0],10);P<=parseInt(S[1],10);++P)C=parseInt(S[2],10),k[P-1]=C===0?{hidden:!0}:{wch:C},Js(k[P-1]);break;case"C":_=parseInt(R[E].slice(1))-1,k[_]||(k[_]={});break;case"R":m=parseInt(R[E].slice(1))-1,w[m]||(w[m]={}),C>0?(w[m].hpt=C,w[m].hpx=_l(C)):C===0&&(w[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}z<1&&(U=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}}return w.length>0&&(b["!rows"]=w),k.length>0&&(b["!cols"]=k),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,b]}function a(d,p){var v=i(d,p),m=v[0],_=v[1],y=Cl(m,p);return Wt(_).forEach(function(E){y[E]=_[E]}),y}function o(d,p){return oa(a(d,p),p)}function l(d,p,v,m){var _="C;Y"+(v+1)+";X"+(m+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+ov(d.f,{r:v,c:m}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(d,p){p.forEach(function(v,m){var _="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=fu(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=hu(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function f(d,p){p.forEach(function(v,m){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*du(v.hpx)+";"),_.length>2&&d.push(_+"R"+(m+1))})}function h(d,p){var v=["ID;PWXL;N;E"],m=[],_=tt(d["!ref"]),y,E=Array.isArray(d),x=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&c(v,d["!cols"]),d["!rows"]&&f(v,d["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var F=_.s.r;F<=_.e.r;++F)for(var U=_.s.c;U<=_.e.c;++U){var b=Oe({r:F,c:U});y=E?(d[F]||[])[U]:d[b],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,d,F,U))}return v.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),_A=function(){function t(s,a){switch(a.type){case"base64":return e(In(s),a);case"binary":return e(s,a);case"buffer":return e(Ge&&Buffer.isBuffer(s)?s.toString("binary"):aa(s),a);case"array":return e($a(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),p=d[0],v=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(ii(v))?isNaN(gl(v).getDate())?h[l][c]=v:h[l][c]=kt(v):h[l][c]=ii(v),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Cl(t(s,a),a)}function n(s,a){return oa(r(s,a),a)}var i=function(){var s=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=tt(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){a(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var m=Oe({r:p,c:v});if(h=d?(l[p]||[])[v]:l[m],!h){a(c,1,0,"");continue}switch(h.t){case"n":var _=h.w;!_&&h.v!=null&&(_=h.v),_==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,_,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Gn(h.z||De[14],ar(kt(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var y=`\r
`,E=c.join(y);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),xA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),v=-1,m=-1,_=0,y=[];_!==p.length;++_){var E=p[_].trim().split(":");if(E[0]==="cell"){var x=Nt(E[1]);if(y.length<=x.r)for(v=y.length;v<=x.r;++v)y[v]||(y[v]=[]);switch(v=x.r,m=x.c,E[2]){case"t":y[v][m]=t(E[3]);break;case"v":y[v][m]=+E[3];break;case"vtf":var F=E[E.length-1];case"vtc":switch(E[3]){case"nl":y[v][m]=!!+E[4];break;default:y[v][m]=+E[4];break}E[2]=="vtf"&&(y[v][m]=[y[v][m],F])}}}return d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),y}function n(h,d){return Cl(r(h,d),d)}function i(h,d){return oa(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],v,m="",_=pn(h["!ref"]),y=Array.isArray(h),E=_.s.r;E<=_.e.r;++E)for(var x=_.s.c;x<=_.e.c;++x)if(m=Oe({r:E,c:x}),v=y?(h[E]||[])[x]:h[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(e(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=e(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var F=ar(kt(v.v));p[2]="vtc",p[3]="nd",p[4]=""+F,p[5]=v.w||Gn(v.z||De[14],F);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),vl=function(){function t(f,h,d,p,v){v.raw?h[d][p]=f:f===""||(f==="TRUE"?h[d][p]=!0:f==="FALSE"?h[d][p]=!1:isNaN(ii(f))?isNaN(gl(f).getDate())?h[d][p]=f:h[d][p]=kt(f):h[d][p]=ii(f))}function e(f,h){var d=h||{},p=[];if(!f||f.length===0)return p;for(var v=f.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var _=10,y=0,E=0;E<=m;++E)y=v[E].indexOf(" "),y==-1?y=v[E].length:y++,_=Math.max(_,y);for(E=0;E<=m;++E){p[E]=[];var x=0;for(t(v[E].slice(0,_).trim(),p,E,x,d),x=1;x<=(v[E].length-_)/10+1;++x)t(v[E].slice(_+(x-1)*10,_+x*10).trim(),p,E,x,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,p=0,v=0;p<f.length;++p)(v=f.charCodeAt(p))==34?d=!d:!d&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p]);if(!v.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p])}return v.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(f,h){var d=h||{},p="",v=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=i(f.slice(0,1024)):d&&d.FS?p=d.FS:p=i(f.slice(0,1024));var _=0,y=0,E=0,x=0,F=0,U=p.charCodeAt(0),b=!1,w=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=d.dateNF!=null?N6(d.dateNF):null;function C(){var P=f.slice(x,F),A={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)A.t="z";else if(d.raw)A.t="s",A.v=P;else if(P.trim().length===0)A.t="s",A.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(A.t="s",A.v=P.slice(2,-1).replace(/""/g,'"')):o9(P)?(A.t="n",A.f=P.slice(1)):(A.t="s",A.v=P);else if(P=="TRUE")A.t="b",A.v=!0;else if(P=="FALSE")A.t="b",A.v=!1;else if(!isNaN(E=ii(P)))A.t="n",d.cellText!==!1&&(A.w=P),A.v=E;else if(!isNaN(gl(P).getDate())||S&&P.match(S)){A.z=d.dateNF||De[14];var R=0;S&&P.match(S)&&(P=D6(P,d.dateNF,P.match(S)||[]),R=1),d.cellDates?(A.t="d",A.v=kt(P,R)):(A.t="n",A.v=ar(kt(P,R))),d.cellText!==!1&&(A.w=Gn(A.z,A.v instanceof Date?ar(A.v):A.v)),d.cellNF||delete A.z}else A.t="s",A.v=P;if(A.t=="z"||(d.dense?(v[_]||(v[_]=[]),v[_][y]=A):v[Oe({c:y,r:_})]=A),x=F+1,k=f.charCodeAt(x),m.e.c<y&&(m.e.c=y),m.e.r<_&&(m.e.r=_),w==U)++y;else if(y=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;F<f.length;++F)switch(w=f.charCodeAt(F)){case 34:k===34&&(b=!b);break;case U:case 10:case 13:if(!b&&C())break e;break}return F-x>0&&C(),v["!ref"]=We(m),v}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):Cl(e(f,h),h)}function o(f,h){var d="",p=h.type=="string"?[0,0,0,0]:mv(f,h);switch(h.type){case"base64":d=In(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof nu<"u"||(d=Ge&&Buffer.isBuffer(f)?f.toString("binary"):aa(f));break;case"array":d=$a(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=pt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=pt(d):h.type=="binary"&&typeof nu<"u",d.slice(0,19)=="socialcalc:version:"?xA.to_sheet(h.type=="string"?d:pt(d),h):a(d,h)}function l(f,h){return oa(o(f,h),h)}function c(f){for(var h=[],d=tt(f["!ref"]),p,v=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var _=[],y=d.s.c;y<=d.e.c;++y){var E=Oe({r:m,c:y});if(p=v?(f[m]||[])[y]:f[E],!p||p.v==null){_.push("          ");continue}for(var x=(p.w||(ss(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";_.push(x+(y===0?" ":""))}h.push(_.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function Kb(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=vA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return vl.to_workbook(t,e)}}var Pa=function(){function t(L,K,z){if(L){yr(L,L.l||0);for(var G=z.Enum||se;L.l<L.length;){var ee=L.read_shift(2),me=G[ee]||G[65535],xe=L.read_shift(2),ge=L.l+xe,fe=me.f&&me.f(L,xe,z);if(L.l=ge,K(fe,me,ee))return}}}function e(L,K){switch(K.type){case"base64":return r(wn(In(L)),K);case"binary":return r(wn(L),K);case"buffer":case"array":return r(L,K)}throw"Unsupported type "+K.type}function r(L,K){if(!L)return L;var z=K||{},G=z.dense?[]:{},ee="Sheet1",me="",xe=0,ge={},fe=[],Be=[],W={s:{r:0,c:0},e:{r:0,c:0}},at=z.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)z.Enum=se,t(L,function(ke,Ct,Gr){switch(Gr){case 0:z.vers=ke,ke>=4096&&(z.qpro=!0);break;case 6:W=ke;break;case 204:ke&&(me=ke);break;case 222:me=ke;break;case 15:case 51:z.qpro||(ke[1].v=ke[1].v.slice(1));case 13:case 14:case 16:Gr==14&&(ke[2]&112)==112&&(ke[2]&15)>1&&(ke[2]&15)<15&&(ke[1].z=z.dateNF||De[14],z.cellDates&&(ke[1].t="d",ke[1].v=Jh(ke[1].v))),z.qpro&&ke[3]>xe&&(G["!ref"]=We(W),ge[ee]=G,fe.push(ee),G=z.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},xe=ke[3],ee=me||"Sheet"+(xe+1),me="");var rn=z.dense?(G[ke[0].r]||[])[ke[0].c]:G[Oe(ke[0])];if(rn){rn.t=ke[1].t,rn.v=ke[1].v,ke[1].z!=null&&(rn.z=ke[1].z),ke[1].f!=null&&(rn.f=ke[1].f);break}z.dense?(G[ke[0].r]||(G[ke[0].r]=[]),G[ke[0].r][ke[0].c]=ke[1]):G[Oe(ke[0])]=ke[1];break}},z);else if(L[2]==26||L[2]==14)z.Enum=oe,L[2]==14&&(z.qpro=!0,L.l=0),t(L,function(ke,Ct,Gr){switch(Gr){case 204:ee=ke;break;case 22:ke[1].v=ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ke[3]>xe&&(G["!ref"]=We(W),ge[ee]=G,fe.push(ee),G=z.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},xe=ke[3],ee="Sheet"+(xe+1)),at>0&&ke[0].r>=at)break;z.dense?(G[ke[0].r]||(G[ke[0].r]=[]),G[ke[0].r][ke[0].c]=ke[1]):G[Oe(ke[0])]=ke[1],W.e.c<ke[0].c&&(W.e.c=ke[0].c),W.e.r<ke[0].r&&(W.e.r=ke[0].r);break;case 27:ke[14e3]&&(Be[ke[14e3][0]]=ke[14e3][1]);break;case 1537:Be[ke[0]]=ke[1],ke[0]==xe&&(ee=ke[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(G["!ref"]=We(W),ge[me||ee]=G,fe.push(me||ee),!Be.length)return{SheetNames:fe,Sheets:ge};for(var Ke={},st=[],$e=0;$e<Be.length;++$e)ge[fe[$e]]?(st.push(Be[$e]||fe[$e]),Ke[Be[$e]]=ge[Be[$e]]||ge[fe[$e]]):(st.push(Be[$e]),Ke[Be[$e]]={"!ref":"A1"});return{SheetNames:st,Sheets:Ke}}function n(L,K){var z=K||{};if(+z.codepage>=0&&ei(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var G=dn(),ee=tt(L["!ref"]),me=Array.isArray(L),xe=[];we(G,0,s(1030)),we(G,6,l(ee));for(var ge=Math.min(ee.e.r,8191),fe=ee.s.r;fe<=ge;++fe)for(var Be=Kt(fe),W=ee.s.c;W<=ee.e.c;++W){fe===ee.s.r&&(xe[W]=Ft(W));var at=xe[W]+Be,Ke=me?(L[fe]||[])[W]:L[at];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?we(G,13,p(fe,W,Ke.v)):we(G,14,m(fe,W,Ke.v));else{var st=ss(Ke);we(G,15,h(fe,W,st.slice(0,239)))}}return we(G,1),G.end()}function i(L,K){var z=K||{};if(+z.codepage>=0&&ei(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var G=dn();we(G,0,a(L));for(var ee=0,me=0;ee<L.SheetNames.length;++ee)(L.Sheets[L.SheetNames[ee]]||{})["!ref"]&&we(G,27,H(L.SheetNames[ee],me++));var xe=0;for(ee=0;ee<L.SheetNames.length;++ee){var ge=L.Sheets[L.SheetNames[ee]];if(!(!ge||!ge["!ref"])){for(var fe=tt(ge["!ref"]),Be=Array.isArray(ge),W=[],at=Math.min(fe.e.r,8191),Ke=fe.s.r;Ke<=at;++Ke)for(var st=Kt(Ke),$e=fe.s.c;$e<=fe.e.c;++$e){Ke===fe.s.r&&(W[$e]=Ft($e));var ke=W[$e]+st,Ct=Be?(ge[Ke]||[])[$e]:ge[ke];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")we(G,23,C(Ke,$e,xe,Ct.v));else{var Gr=ss(Ct);we(G,22,w(Ke,$e,xe,Gr.slice(0,239)))}}++xe}}return we(G,1),G.end()}function s(L){var K=ae(2);return K.write_shift(2,L),K}function a(L){var K=ae(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var z=0,G=0,ee=0,me=0;me<L.SheetNames.length;++me){var xe=L.SheetNames[me],ge=L.Sheets[xe];if(!(!ge||!ge["!ref"])){++ee;var fe=pn(ge["!ref"]);z<fe.e.r&&(z=fe.e.r),G<fe.e.c&&(G=fe.e.c)}}return z>8191&&(z=8191),K.write_shift(2,z),K.write_shift(1,ee),K.write_shift(1,G),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(L,K,z){var G={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&z.qpro?(G.s.c=L.read_shift(1),L.l++,G.s.r=L.read_shift(2),G.e.c=L.read_shift(1),L.l++,G.e.r=L.read_shift(2),G):(G.s.c=L.read_shift(2),G.s.r=L.read_shift(2),K==12&&z.qpro&&(L.l+=2),G.e.c=L.read_shift(2),G.e.r=L.read_shift(2),K==12&&z.qpro&&(L.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(L){var K=ae(8);return K.write_shift(2,L.s.c),K.write_shift(2,L.s.r),K.write_shift(2,L.e.c),K.write_shift(2,L.e.r),K}function c(L,K,z){var G=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(G[0].c=L.read_shift(1),G[3]=L.read_shift(1),G[0].r=L.read_shift(2),L.l+=2):(G[2]=L.read_shift(1),G[0].c=L.read_shift(2),G[0].r=L.read_shift(2)),G}function f(L,K,z){var G=L.l+K,ee=c(L,K,z);if(ee[1].t="s",z.vers==20768){L.l++;var me=L.read_shift(1);return ee[1].v=L.read_shift(me,"utf8"),ee}return z.qpro&&L.l++,ee[1].v=L.read_shift(G-L.l,"cstr"),ee}function h(L,K,z){var G=ae(7+z.length);G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,L),G.write_shift(1,39);for(var ee=0;ee<G.length;++ee){var me=z.charCodeAt(ee);G.write_shift(1,me>=128?95:me)}return G.write_shift(1,0),G}function d(L,K,z){var G=c(L,K,z);return G[1].v=L.read_shift(2,"i"),G}function p(L,K,z){var G=ae(7);return G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,L),G.write_shift(2,z,"i"),G}function v(L,K,z){var G=c(L,K,z);return G[1].v=L.read_shift(8,"f"),G}function m(L,K,z){var G=ae(13);return G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,L),G.write_shift(8,z,"f"),G}function _(L,K,z){var G=L.l+K,ee=c(L,K,z);if(ee[1].v=L.read_shift(8,"f"),z.qpro)L.l=G;else{var me=L.read_shift(2);F(L.slice(L.l,L.l+me),ee),L.l+=me}return ee}function y(L,K,z){var G=K&32768;return K&=-32769,K=(G?L:0)+(K>=8192?K-16384:K),(G?"":"$")+(z?Ft(K):Kt(K))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(L,K){yr(L,0);for(var z=[],G=0,ee="",me="",xe="",ge="";L.l<L.length;){var fe=L[L.l++];switch(fe){case 0:z.push(L.read_shift(8,"f"));break;case 1:me=y(K[0].c,L.read_shift(2),!0),ee=y(K[0].r,L.read_shift(2),!1),z.push(me+ee);break;case 2:{var Be=y(K[0].c,L.read_shift(2),!0),W=y(K[0].r,L.read_shift(2),!1);me=y(K[0].c,L.read_shift(2),!0),ee=y(K[0].r,L.read_shift(2),!1),z.push(Be+W+":"+me+ee)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(L.read_shift(2));break;case 6:{for(var at="";fe=L[L.l++];)at+=String.fromCharCode(fe);z.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ge=z.pop(),xe=z.pop(),z.push(["AND","OR"][fe-20]+"("+xe+","+ge+")");break;default:if(fe<32&&x[fe])ge=z.pop(),xe=z.pop(),z.push(xe+x[fe]+ge);else if(E[fe]){if(G=E[fe][1],G==69&&(G=L[L.l++]),G>z.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+z.join("|")+"|");return}var Ke=z.slice(-G);z.length-=G,z.push(E[fe][0]+"("+Ke.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}z.length==1?K[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function U(L){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=L.read_shift(2),K[3]=L[L.l++],K[0].c=L[L.l++],K}function b(L,K){var z=U(L);return z[1].t="s",z[1].v=L.read_shift(K-4,"cstr"),z}function w(L,K,z,G){var ee=ae(6+G.length);ee.write_shift(2,L),ee.write_shift(1,z),ee.write_shift(1,K),ee.write_shift(1,39);for(var me=0;me<G.length;++me){var xe=G.charCodeAt(me);ee.write_shift(1,xe>=128?95:xe)}return ee.write_shift(1,0),ee}function k(L,K){var z=U(L);z[1].v=L.read_shift(2);var G=z[1].v>>1;if(z[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return z[1].v=G,z}function S(L,K){var z=U(L),G=L.read_shift(4),ee=L.read_shift(4),me=L.read_shift(2);if(me==65535)return G===0&&ee===3221225472?(z[1].t="e",z[1].v=15):G===0&&ee===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var xe=me&32768;return me=(me&32767)-16446,z[1].v=(1-xe*2)*(ee*Math.pow(2,me+32)+G*Math.pow(2,me)),z}function C(L,K,z,G){var ee=ae(14);if(ee.write_shift(2,L),ee.write_shift(1,z),ee.write_shift(1,K),G==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var me=0,xe=0,ge=0,fe=0;return G<0&&(me=1,G=-G),xe=Math.log2(G)|0,G/=Math.pow(2,xe-31),fe=G>>>0,fe&2147483648||(G/=2,++xe,fe=G>>>0),G-=fe,fe|=2147483648,fe>>>=0,G*=Math.pow(2,32),ge=G>>>0,ee.write_shift(4,ge),ee.write_shift(4,fe),xe+=16383+(me?32768:0),ee.write_shift(2,xe),ee}function P(L,K){var z=S(L);return L.l+=K-14,z}function A(L,K){var z=U(L),G=L.read_shift(4);return z[1].v=G>>6,z}function R(L,K){var z=U(L),G=L.read_shift(8,"f");return z[1].v=G,z}function de(L,K){var z=R(L);return L.l+=K-10,z}function ue(L,K){return L[L.l+K-1]==0?L.read_shift(K,"cstr"):""}function Z(L,K){var z=L[L.l++];z>K-1&&(z=K-1);for(var G="";G.length<z;)G+=String.fromCharCode(L[L.l++]);return G}function te(L,K,z){if(!(!z.qpro||K<21)){var G=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ee=L.read_shift(K-21,"cstr");return[G,ee]}}function re(L,K){for(var z={},G=L.l+K;L.l<G;){var ee=L.read_shift(2);if(ee==14e3){for(z[ee]=[0,""],z[ee][0]=L.read_shift(2);L[L.l];)z[ee][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return z}function H(L,K){var z=ae(5+L.length);z.write_shift(2,14e3),z.write_shift(2,K);for(var G=0;G<L.length;++G){var ee=L.charCodeAt(G);z[z.l++]=ee>127?95:ee}return z[z.l++]=0,z}var se={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function Xb(t){var e={},r=t.match($r),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Le(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=N1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var qb=function(){var t=au("t"),e=au("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:et(a[1])},l=s.match(e);return l&&(o.s=Xb(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),Yb=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Qb=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Jb=/<(?:\w+:)?r>/,Zb=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=et(pt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pt(t),r&&(n.h=W1(n.t))):t.match(Jb)&&(n.r=pt(t),n.t=et(pt((t.replace(Zb,"").match(Qb)||[]).join("").replace($r,""))),r&&(n.h=Yb(qb(n.r)))),n):{t:""}}var eM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tM=/<(?:\w+:)?(?:si|sstItem)>/g,rM=/<\/(?:\w+:)?(?:si|sstItem)>/;function nM(t,e){var r=[],n="";if(!t)return r;var i=t.match(eM);if(i){n=i[2].replace(tM,"").split(rM);for(var s=0;s!=n.length;++s){var a=rv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Le(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var iM=/^\s|\s$|[\t\n\r]/;function yA(t,e){if(!e.bookSST)return"";var r=[Xt];r[r.length]=ye("sst",null,{xmlns:ro[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(iM)&&(s+=' xml:space="preserve"'),s+=">"+ut(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sM(t){return[t.read_shift(4),t.read_shift(4)]}function aM(t,e){var r=[],n=!1;return us(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function oM(t,e){return e||(e=ae(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var lM=_L;function cM(t){var e=dn();ce(e,159,oM(t));for(var r=0;r<t.length;++r)ce(e,19,lM(t[r]));return ce(e,160),e.end()}function wA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Yi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function uM(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Yi(t,4),e.U=Yi(t,4),e.W=Yi(t,4),e}function fM(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function hM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(fM(t));return e}function dM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function pM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Yi(t,4),e.U=Yi(t,4),e.W=Yi(t,4),e}function mM(t){var e=pM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function EA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function TA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function gM(t){var e=Yi(t);switch(e.Minor){case 2:return[e.Minor,vM(t)];case 3:return[e.Minor,_M()];case 4:return[e.Minor,xM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function vM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=EA(t,r),i=TA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function _M(){throw new Error("File is password-protected: ECMA-376 Extensible")}function xM(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace($r,function(s){var a=Le(s);switch(Ci(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function yM(t,e){var r={},n=r.EncryptionVersionInfo=Yi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=EA(t,i),e-=i,r.EncryptionVerifier=TA(t,e),r}function wM(t){var e={},r=e.EncryptionVersionInfo=Yi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function nv(t){var e=0,r,n=wA(t),i=n.length+1,s,a,o,l,c;for(r=Qs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var kA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var f=a[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=wA(a),l=s(o),c=o.length,f=Qs(16),h=0;h!=16;++h)f[h]=0;var d,p,v;for((c&1)===1&&(d=l>>8,f[c]=i(t[0],d),--c,d=l&255,p=o[o.length-1],f[c]=i(p,d));c>0;)--c,d=l>>8,f[c]=i(o[c],d),--c,d=l&255,f[c]=i(o[c],d);for(c=15,v=15-o.length;v>0;)d=l>>8,f[c]=i(t[v],d),--c,--v,d=l&255,f[c]=i(o[c],d),--c,--v;return f}}(),EM=function(t,e,r,n,i){i||(i=e),n||(n=kA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},TM=function(t){var e=0,r=kA(t);return function(n){var i=EM("",n,e,r);return e=i[1],i[0]}};function kM(t,e,r,n){var i={key:Zt(t),verificationBytes:Zt(t)};return r.password&&(i.verifier=nv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=TM(r.password)),i}function SM(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=wM(t):n.Data=yM(t,e),n}function AM(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?SM(t,e-2,n):kM(t,r.biff>=8?e:e-2,r,n),n}var SA=function(){function t(i,s){switch(s.type){case"base64":return e(In(i),s);case"binary":return e(i,s);case"buffer":return e(Ge&&Buffer.isBuffer(i)?i.toString("binary"):aa(i),s);case"array":return e($a(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,v,m=-1;v=d.exec(f);){switch(v[0]){case"\\cell":var _=f.slice(p,d.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var y={v:_,t:"s"};Array.isArray(o)?o[h][m]=y:o[Oe({r:h,c:m})]=y}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=We(c),o}function r(i,s){return oa(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=tt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Oe({r:c,c:f});o=l?(i[c]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ss(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function IM(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function uu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function CM(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function RM(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function ch(t,e){if(e===0)return t;var r=CM(IM(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),uu(RM(r))}var AA=6,PM=15,FM=1,Vr=AA;function fu(t){return Math.floor((t+Math.round(128/Vr)/256)*Vr)}function hu(t){return Math.floor((t-5)/Vr*100+.5)/100}function uh(t){return Math.round((t*Vr+5)/Vr*256)/256}function rp(t){return uh(hu(fu(t)))}function iv(t){var e=Math.abs(t-rp(t)),r=Vr;if(e>.005)for(Vr=FM;Vr<PM;++Vr)Math.abs(t-rp(t))<=e&&(e=Math.abs(t-rp(t)),r=Vr);Vr=r}function Js(t){t.width?(t.wpx=fu(t.width),t.wch=hu(t.wpx),t.MDW=Vr):t.wpx?(t.wch=hu(t.wpx),t.width=uh(t.wch),t.MDW=Vr):typeof t.wch=="number"&&(t.width=uh(t.wch),t.wpx=fu(t.width),t.MDW=Vr),t.customWidth&&delete t.customWidth}var NM=96,IA=NM;function du(t){return t*96/IA}function _l(t){return t*IA/96}var DM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function OM(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match($r)||[]).forEach(function(a){var o=Le(a);switch(Ci(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=wt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=wt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function LM(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match($r)||[]).forEach(function(a){var o=Le(a);switch(Ci(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function bM(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match($r)||[]).forEach(function(a){var o=Le(a);switch(Ci(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=pt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?wt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?wt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?wt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?wt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?wt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?wt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?wt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=N1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=wt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ca[i.color.index];i.color.index==81&&(l=Ca[1]),l||(l=Ca[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=ch(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function MM(t,e,r){e.NumberFmt=[];for(var n=Wt(De),i=0;i<n.length;++i)e.NumberFmt[n[i]]=De[n[i]];var s=t[0].match($r);if(s)for(i=0;i<s.length;++i){var a=Le(s[i]);switch(Ci(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=et(pt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}qi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function VM(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ye("numFmt",null,{numFmtId:n,formatCode:ut(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ye("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Bf=["numFmtId","fillId","fontId","borderId","xfId"],Uf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BM(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match($r)||[]).forEach(function(s){var a=Le(s),o=0;switch(Ci(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=parseInt(n[Bf[o]],10));for(o=0;o<Uf.length;++o)n[Uf[o]]&&(n[Uf[o]]=wt(n[Uf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=wt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function UM(t){var e=[];return e[e.length]=ye("cellXfs",null),t.forEach(function(r){e[e.length]=ye("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ye("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var jM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&MM(h,f,c),(h=o.match(i))&&bM(h,f,l,c),(h=o.match(n))&&LM(h,f,l,c),(h=o.match(s))&&OM(h,f,l,c),(h=o.match(r))&&BM(h,f,c),f}}();function CA(t,e){var r=[Xt,ye("styleSheet",null,{xmlns:ro[0],"xmlns:vt":nr.vt})],n;return t.SSF&&(n=VM(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=UM(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function WM(t,e){var r=t.read_shift(2),n=jr(t);return[r,n]}function HM(t,e,r){r||(r=ae(6+4*e.length)),r.write_shift(2,t),hr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function zM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=SL(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=kL(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jr(t),n}function $M(t,e){e||(e=ae(25+4*32)),e.write_shift(2,t.sz*20),AL(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ah(t.color,e);var n=0;return n=2,e.write_shift(1,n),hr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var GM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],np,KM=zr;function gw(t,e){e||(e=ae(4*3+8*7+16*1)),np||(np=Yh(GM));var r=np[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ah({auto:1},e),ah({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function XM(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function RA(t,e,r){r||(r=ae(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ql(t,e){return e||(e=ae(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var qM=zr;function YM(t,e){return e||(e=ae(51)),e.write_shift(1,0),ql(null,e),ql(null,e),ql(null,e),ql(null,e),ql(null,e),e.length>e.l?e.slice(0,e.l):e}function QM(t,e){return e||(e=ae(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),sh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function JM(t,e,r){var n=ae(2052);return n.write_shift(4,t),sh(e,n),sh(r,n),n.length>n.l?n.slice(0,n.l):n}function ZM(t,e,r){var n={};n.NumberFmt=[];for(var i in De)n.NumberFmt[i]=De[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return us(t,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],qi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=ch(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function e5(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ce(t,615,si(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ce(t,44,HM(i,e[i]))}),ce(t,616))}}function t5(t){var e=1;ce(t,611,si(e)),ce(t,43,$M({sz:12,color:{theme:1},name:"Calibri",family:2})),ce(t,612)}function r5(t){var e=2;ce(t,603,si(e)),ce(t,45,gw({patternType:"none"})),ce(t,45,gw({patternType:"gray125"})),ce(t,604)}function n5(t){var e=1;ce(t,613,si(e)),ce(t,46,YM()),ce(t,614)}function i5(t){var e=1;ce(t,626,si(e)),ce(t,47,RA({numFmtId:0},65535)),ce(t,627)}function s5(t,e){ce(t,617,si(e.length)),e.forEach(function(r){ce(t,47,RA(r,0))}),ce(t,618)}function a5(t){var e=1;ce(t,619,si(e)),ce(t,48,QM({xfId:0,name:"Normal"})),ce(t,620)}function o5(t){var e=0;ce(t,505,si(e)),ce(t,506)}function l5(t){var e=0;ce(t,508,JM(e,"TableStyleMedium9","PivotStyleMedium4")),ce(t,509)}function c5(t,e){var r=dn();return ce(r,278),e5(r,t.SSF),t5(r),r5(r),n5(r),i5(r),s5(r,e.cellXfs),a5(r),o5(r),l5(r),ce(r,279),r.end()}var u5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function f5(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match($r)||[]).forEach(function(i){var s=Le(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[u5.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function h5(){}function d5(){}var p5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,m5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,g5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function v5(t,e,r){e.themeElements={};var n;[["clrScheme",p5,f5],["fontScheme",m5,h5],["fmtScheme",g5,d5]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var _5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function PA(t,e){(!t||t.length===0)&&(t=sv());var r,n={};if(!(r=t.match(_5)))throw new Error("themeElements not found in theme");return v5(r[0],n,e),n.raw=t,n}function sv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function x5(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=ES(s,{type:"array"})}catch{return}var o=En(a,"theme/theme/theme1.xml",!0);if(o)return PA(o,r)}}function y5(t){return t.read_shift(4)}function w5(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=E5(t,4);break;case 2:e.xclrValue=cA(t);break;case 3:e.xclrValue=y5(t);break;case 4:t.l+=4;break}return t.l+=8,e}function E5(t,e){return zr(t,e)}function T5(t,e){return zr(t,e)}function k5(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=w5(t);break;case 6:n[1]=T5(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function S5(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(k5(t,r-t.l));return{ixfe:n,ext:s}}function A5(t,e){e.forEach(function(r){switch(r[0]){}})}function I5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:jr(t)}}function C5(t){var e=ae(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),hr(t.name,e),e.slice(0,e.l)}function R5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function P5(t){var e=ae(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function F5(t,e){var r=ae(8+2*e.length);return r.write_shift(4,t),hr(e,r),r.slice(0,r.l)}function N5(t){return t.l+=4,t.read_shift(4)!=0}function D5(t,e){var r=ae(8);return r.write_shift(4,t),r.write_shift(4,1),r}function O5(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return us(t,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function L5(){var t=dn();return ce(t,332),ce(t,334,si(1)),ce(t,335,C5({name:"XLDAPR",version:12e4,flags:3496657072})),ce(t,336),ce(t,339,F5(1,"XLDAPR")),ce(t,52),ce(t,35,si(514)),ce(t,4096,si(0)),ce(t,4097,Vn(1)),ce(t,36),ce(t,53),ce(t,340),ce(t,337,D5(1)),ce(t,51,P5([[1,0]])),ce(t,338),ce(t,333),t.end()}function b5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace($r,function(o){var l=Le(o);switch(Ci(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function FA(){var t=[Xt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function M5(t){var e=[];if(!t)return e;var r=1;return(t.match($r)||[]).forEach(function(n){var i=Le(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function V5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Oe(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function B5(t,e,r){var n=[];return us(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function U5(t,e,r,n){if(!t)return t;var i=n||{},s=!1;us(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function j5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Vo=1024;function NA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ye("xml",null,{"xmlns:v":xn.v,"xmlns:o":xn.o,"xmlns:x":xn.x,"xmlns:mv":xn.mv}).replace(/\/>/,">"),ye("o:shapelayout",ye("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ye("v:shapetype",[ye("v:stroke",null,{joinstyle:"miter"}),ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Vo<t*1e3;)Vo+=1e3;return e.forEach(function(s){var a=Nt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ye("v:fill",l,o),f={on:"t",obscured:"t"};++Vo,i=i.concat(["<v:shape"+ou({id:"_x0000_s"+Vo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ye("v:shadow",null,f),ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Er("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Er("x:AutoFill","False"),Er("x:Row",String(a.r)),Er("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function vw(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Nt(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=tt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=We(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function W5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Le(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Nt(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&rv(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function DA(t){var e=[Xt,ye("comments",null,{xmlns:ro[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ut(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(ut(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Er("t",ut(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Er("t",ut(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function H5(t,e){var r=[],n=!1,i={},s=0;return t.replace($r,function(o,l){var c=Le(o);switch(Ci(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function z5(t,e,r){var n=[Xt,ye("ThreadedComments",null,{xmlns:nr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ye("threadedComment",Er("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function $5(t,e){var r=[],n=!1;return t.replace($r,function(s){var a=Le(s);switch(Ci(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function G5(t){var e=[Xt,ye("personList",null,{xmlns:nr.TCMNT,"xmlns:x":ro[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ye("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function K5(t){var e={};e.iauthor=t.read_shift(4);var r=ao(t);return e.rfx=r.s,e.ref=Oe(r.s),t.l+=16,e}function X5(t,e){return e==null&&(e=ae(36)),e.write_shift(4,t[1].iauthor),Rl(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var q5=jr;function Y5(t){return hr(t.slice(0,54))}function Q5(t,e){var r=[],n=[],i={},s=!1;return us(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function J5(t){var e=dn(),r=[];return ce(e,628),ce(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ce(e,632,Y5(i.a)))})}),ce(e,631),ce(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Nt(n[0]),e:Nt(n[0])};ce(e,635,X5([s,i])),i.t&&i.t.length>0&&ce(e,637,yL(i)),ce(e,636),delete i.iauthor})}),ce(e,634),ce(e,629),e.end()}var Z5="application/vnd.ms-office.vbaProject";function e9(t){var e=Pe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pe.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Pe.write(e)}function t9(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Pe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var OA=["xlsb","xlsm","xlam","biff8","xla"];function r9(){return{"!type":"dialog"}}function n9(){return{"!type":"dialog"}}function i9(){return{"!type":"macro"}}function s9(){return{"!type":"macro"}}var Qo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,i+(o?"":"$")+Ft(f)+(l?"":"$")+Kt(c)}return function(i,s){return e=s,i.replace(t,r)}}(),av=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ov=function(){return function(e,r){return e.replace(av,function(n,i,s,a,o,l){var c=K1(a)-(s?0:r.c),f=G1(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function LA(t,e){return t.replace(av,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ft(K1(s)+e.c))+(a=="$"?a+o:Kt(G1(o)+e.r))})}function a9(t,e,r){var n=pn(e),i=n.s,s=Nt(r),a={r:s.r-i.r,c:s.c-i.c};return LA(t,a)}function o9(t){return t.length!=1}function _w(t){return t.replace(/_xlfn\./g,"")}function Yt(t){t.l+=1}function Zs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return MA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Zs(t),o=Zs(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function MA(t){var e=Zs(t),r=Zs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function l9(t,e,r){if(r.biff<8)return MA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Zs(t),a=Zs(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function VA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return c9(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Zs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function c9(t){var e=Zs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function u9(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function f9(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return h9(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function h9(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function d9(t,e,r){var n=(t[t.l++]&96)>>5,i=bA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function p9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=bA(t,s,r);return[n,i,a]}function m9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function g9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function v9(t,e,r){var n=(t[t.l++]&96)>>5,i=l9(t,e-1,r);return[n,i]}function _9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function xw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function x9(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function y9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function w9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function E9(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function T9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function BA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function k9(t){return t.read_shift(2),BA(t)}function S9(t){return t.read_shift(2),BA(t)}function A9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=VA(t,0,r);return[n,i]}function I9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=f9(t,0,r);return[n,i]}function C9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=VA(t,0,r);return[n,i,s]}function R9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[NV[i],WA[i],n]}function P9(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:F9(t);return[i,(s[0]===0?WA:FV)[s[1]]]}function F9(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function N9(t,e,r){t.l+=r&&r.biff==2?3:4}function D9(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function O9(t){return t.l++,fs[t.read_shift(1)]}function L9(t){return t.l++,t.read_shift(2)}function b9(t){return t.l++,t.read_shift(1)!==0}function M9(t){return t.l++,Br(t)}function V9(t,e,r){return t.l++,Wu(t,e-1,r)}function B9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=fs[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Br(t);break;case 2:r[1]=oo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function U9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ao:Zh)(t));return i}function j9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=B9(t,r.biff);return a}function W9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function H9(t,e,r){if(r.biff==5)return z9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function z9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function $9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function G9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function K9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function X9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var q9=zr,Y9=zr,Q9=zr;function zu(t,e,r){return t.l+=2,[u9(t)]}function lv(t){return t.l+=6,[]}var J9=zu,Z9=lv,eV=lv,tV=zu;function UA(t){return t.l+=2,[Zt(t),t.read_shift(2)&1]}var rV=zu,nV=UA,iV=lv,sV=zu,aV=zu,oV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=oV[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function cV(t){return t.l+=2,[t.read_shift(4)]}function uV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function fV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function hV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function dV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function pV(t){return t.l+=4,[0,0]}var yw={1:{n:"PtgExp",f:D9},2:{n:"PtgTbl",f:Q9},3:{n:"PtgAdd",f:Yt},4:{n:"PtgSub",f:Yt},5:{n:"PtgMul",f:Yt},6:{n:"PtgDiv",f:Yt},7:{n:"PtgPower",f:Yt},8:{n:"PtgConcat",f:Yt},9:{n:"PtgLt",f:Yt},10:{n:"PtgLe",f:Yt},11:{n:"PtgEq",f:Yt},12:{n:"PtgGe",f:Yt},13:{n:"PtgGt",f:Yt},14:{n:"PtgNe",f:Yt},15:{n:"PtgIsect",f:Yt},16:{n:"PtgUnion",f:Yt},17:{n:"PtgRange",f:Yt},18:{n:"PtgUplus",f:Yt},19:{n:"PtgUminus",f:Yt},20:{n:"PtgPercent",f:Yt},21:{n:"PtgParen",f:Yt},22:{n:"PtgMissArg",f:Yt},23:{n:"PtgStr",f:V9},26:{n:"PtgSheet",f:uV},27:{n:"PtgEndSheet",f:fV},28:{n:"PtgErr",f:O9},29:{n:"PtgBool",f:b9},30:{n:"PtgInt",f:L9},31:{n:"PtgNum",f:M9},32:{n:"PtgArray",f:_9},33:{n:"PtgFunc",f:R9},34:{n:"PtgFuncVar",f:P9},35:{n:"PtgName",f:W9},36:{n:"PtgRef",f:A9},37:{n:"PtgArea",f:d9},38:{n:"PtgMemArea",f:$9},39:{n:"PtgMemErr",f:q9},40:{n:"PtgMemNoMem",f:Y9},41:{n:"PtgMemFunc",f:G9},42:{n:"PtgRefErr",f:K9},43:{n:"PtgAreaErr",f:m9},44:{n:"PtgRefN",f:I9},45:{n:"PtgAreaN",f:v9},46:{n:"PtgMemAreaN",f:hV},47:{n:"PtgMemNoMemN",f:dV},57:{n:"PtgNameX",f:H9},58:{n:"PtgRef3d",f:C9},59:{n:"PtgArea3d",f:p9},60:{n:"PtgRefErr3d",f:X9},61:{n:"PtgAreaErr3d",f:g9},255:{}},mV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gV={1:{n:"PtgElfLel",f:UA},2:{n:"PtgElfRw",f:sV},3:{n:"PtgElfCol",f:J9},6:{n:"PtgElfRwV",f:aV},7:{n:"PtgElfColV",f:tV},10:{n:"PtgElfRadical",f:rV},11:{n:"PtgElfRadicalS",f:iV},13:{n:"PtgElfColS",f:Z9},15:{n:"PtgElfColSV",f:eV},16:{n:"PtgElfRadicalLel",f:nV},25:{n:"PtgList",f:lV},29:{n:"PtgSxName",f:cV},255:{}},vV={0:{n:"PtgAttrNoop",f:pV},1:{n:"PtgAttrSemi",f:T9},2:{n:"PtgAttrIf",f:w9},4:{n:"PtgAttrChoose",f:x9},8:{n:"PtgAttrGoto",f:y9},16:{n:"PtgAttrSum",f:N9},32:{n:"PtgAttrBaxcel",f:xw},33:{n:"PtgAttrBaxcel",f:xw},64:{n:"PtgAttrSpace",f:k9},65:{n:"PtgAttrSpaceSemi",f:S9},128:{n:"PtgAttrIfError",f:E9},255:{}};function $u(t,e,r,n){if(n.biff<8)return zr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=j9(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=U9(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(zr(t,e)),s}function Gu(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=yw[s]||yw[mV[s]],(s===24||s===25)&&(i=(s===24?gV:vV)[t[t.l+1]]),!i||!i.f?zr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function _V(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var xV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function jA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ww(t,e,r){var n=jA(t,e,r);return n=="#REF"?n:yV(n,r)}function Lr(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,p,v="";if(!t[0]||!t[0][0])return"";for(var m=-1,_="",y=0,E=t[0].length;y<E;++y){var x=t[0][y];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:_=Ut(" ",t[0][m][1][1]);break;case 1:_=Ut("\r",t[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+_,m=-1}o.push(c+xV[x[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Sc(x[1][1],a,i),o.push(Ac(f,s));break;case"PtgRefN":f=r?Sc(x[1][1],r,i):x[1][1],o.push(Ac(f,s));break;case"PtgRef3d":h=x[1][1],f=Sc(x[1][2],a,i),v=ww(n,h,i),o.push(v+"!"+Ac(f,s));break;case"PtgFunc":case"PtgFuncVar":var F=x[1][0],U=x[1][1];F||(F=0),F&=127;var b=F==0?[]:o.slice(-F);o.length-=F,U==="User"&&(U=b.shift()),o.push(U+"("+b.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=Yy(x[1][1],r?{s:r}:a,i),o.push(Zd(p,i));break;case"PtgArea":p=Yy(x[1][1],a,i),o.push(Zd(p,i));break;case"PtgArea3d":h=x[1][1],p=x[1][2],v=ww(n,h,i),o.push(v+"!"+Zd(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2];var w=(n.names||[])[d-1]||(n[0]||[])[d],k=w?w.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var S=x[1][1];d=x[1][2];var C;if(i.biff<=5)S<0&&(S=-S),n[S]&&(C=n[S][d]);else{var P="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][d]&&n[S][d].itab>0&&(P=n.SheetNames[n[S][d].itab-1]+"!"):P=n.SheetNames[d-1]+"!"),n[S]&&n[S][d])P+=n[S][d].Name;else if(n[0]&&n[0][d])P+=n[0][d].Name;else{var A=(jA(n,S,i)||"").split(";;");A[d-1]?P=A[d-1]:P+="SH33TJSERRX"}o.push(P);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var R="(",de=")";if(m>=0){switch(_="",t[0][m][1][0]){case 2:R=Ut(" ",t[0][m][1][1])+R;break;case 3:R=Ut("\r",t[0][m][1][1])+R;break;case 4:de=Ut(" ",t[0][m][1][1])+de;break;case 5:de=Ut("\r",t[0][m][1][1])+de;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(R+o.pop()+de);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Oe(f)]){var Z=n.sharedf[Oe(f)];o.push(Lr(Z,a,ue,n,i))}else{var te=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Lr(c[1],a,ue,n,i)),te=!0;break}te||o.push(x[1])}break;case"PtgArray":o.push("{"+_V(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&re.indexOf(t[0][y][0])==-1){x=t[0][m];var H=!0;switch(x[1][0]){case 4:H=!1;case 0:_=Ut(" ",x[1][1]);break;case 5:H=!1;case 1:_=Ut("\r",x[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((H?_:"")+o.pop()+(H?"":_)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function wV(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],zr(t,e-2)];var o=Gu(t,a,r);return e!==a+i&&(s=$u(t,e-a-i,o,r)),t.l=n,[o,s]}function EV(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],zr(t,e-2)];var o=Gu(t,a,r);return e!==a+i&&(s=$u(t,e-a-i,o,r)),t.l=n,[o,s]}function TV(t,e,r,n){var i=t.l+e,s=Gu(t,n,r),a;return i!==t.l&&(a=$u(t,i-t.l,s,r)),[s,a]}function kV(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Gu(t,s,r);return s==65535?[[],zr(t,e-2)]:(e!==s+2&&(i=$u(t,n-s-2,a,r)),[a,i])}function SV(t){var e;if(Hi(t,t.l+6)!==65535)return[Br(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function AV(t){if(t==null){var e=ae(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ga(t);return Ga(0)}function ip(t,e,r){var n=t.l+e,i=Ri(t);r.biff==2&&++t.l;var s=SV(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=EV(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function IV(t,e,r,n,i){var s=Xa(e,r,i),a=AV(t.v),o=ae(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ae(t.bf.length),f=0;f<t.bf.length;++f)c[f]=t.bf[f];var h=fr([s,a,o,c]);return h}function ed(t,e,r){var n=t.read_shift(4),i=Gu(t,n,r),s=t.read_shift(4),a=s>0?$u(t,s,i,r):null;return[i,a]}var CV=ed,td=ed,RV=ed,PV=ed,FV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},WA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ew(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function DV(t){var e="of:="+t.replace(av,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function sp(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function OV(t){return t.replace(/\./,"!")}var Cc={},Jo={},Rc=typeof Map<"u";function cv(t,e,r){var n=0,i=t.length;if(r){if(Rc?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Rc?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Rc?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function rd(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Vr=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=hu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=uh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Fa(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function la(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){qi(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function HA(t,e,r,n,i,s){try{n.cellNF&&(t.z=De[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=kt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(De[e]==null&&qi(F6[e]||"General",e),t.t==="e")t.w=t.w||fs[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=su(t.v);else if(t.t==="d"){var a=ar(t.v);(a|0)===a?t.w=a.toString(10):t.w=su(a)}else{if(t.v===void 0)return"";t.w=za(t.v,Jo)}else t.t==="d"?t.w=Gn(e,ar(t.v),Jo):t.w=Gn(e,t.v,Jo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ch(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ch(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function LV(t,e,r){if(t&&t["!ref"]){var n=tt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function bV(t,e){var r=tt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=We(r))}var MV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,VV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,BV=/<(?:\w:)?hyperlink [^>]*>/mg,UV=/"(\w*:\w*)"/,jV=/<(?:\w:)?col\b[^>]*[\/]?>/g,WV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HV=/<(?:\w:)?pageMargins[^>]*\/>/g,zA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,zV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$V=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function GV(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(VV);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var d=c.match(zA);d?uv(d[0],o,i,r):(d=c.match(zV))&&XV(d[0],d[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=c.slice(p,p+50).match(UV);v&&bV(o,v[1])}var m=c.match($V);m&&m[1]&&oB(m[1],i);var _=[];if(e.cellStyles){var y=c.match(jV);y&&rB(_,y)}h&&uB(h[1],o,e,l,s,a);var E=f.match(WV);E&&(o["!autofilter"]=iB(E[0]));var x=[],F=f.match(MV);if(F)for(p=0;p!=F.length;++p)x[p]=tt(F[p].slice(F[p].indexOf('"')+1));var U=f.match(BV);U&&ZV(o,U,n);var b=f.match(HV);if(b&&(o["!margins"]=eB(Le(b[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=We(l)),e.sheetRows>0&&o["!ref"]){var w=tt(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=We(w))}return _.length>0&&(o["!cols"]=_),x.length>0&&(o["!merges"]=x),o}function KV(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+We(t[r])+'"/>';return e+"</mergeCells>"}function uv(t,e,r,n){var i=Le(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=et(pt(i.codeName)))}function XV(t,e,r,n,i){uv(t.slice(0,t.indexOf(">")),r,n,i)}function qV(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=_i(ut(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+ye("outlinePr",null,c)}!s&&!o||(i[i.length]=ye("sheetPr",o,a))}var YV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function JV(t){var e={sheet:1};return YV.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),QV.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=nv(t.password).toString(16).toUpperCase()),ye("sheetProtection",null,e)}function ZV(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Le(pt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+et(s.location))):(s.Target="#"+et(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=tt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Oe({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function eB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function tB(t){return Fa(t),ye("pageMargins",null,t)}function rB(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Le(e[n],!0);i.hidden&&(i.hidden=wt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,iv(i.width)),Js(i);s<=a;)t[s++]=St(i)}}function nB(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=ye("col",null,rd(i,n)));return r[r.length]="</cols>",r.join("")}function iB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function sB(t,e,r,n){var i=typeof t.ref=="string"?t.ref:We(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=pn(i);a.s.r==a.e.r&&(a.e.r=pn(e["!ref"]).e.r,i=We(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ye("autoFilter",null,{ref:i})}var aB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oB(t,e){e.Views||(e.Views=[{}]),(t.match(aB)||[]).forEach(function(r,n){var i=Le(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),wt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function lB(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ye("sheetViews",ye("sheetView",null,i),{})}function cB(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=fs[t.v];break;case"d":n&&n.cellDates?i=kt(t.v,-1).toISOString():(t=St(t),t.t="n",i=""+(t.v=ar(kt(t.v)))),typeof t.z>"u"&&(t.z=De[14]);break;default:i=t.v;break}var o=Er("v",ut(i)),l={r:e},c=la(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Er("v",""+cv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ye("f",ut(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),ye("c",o,l)}var uB=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=au("v"),a=au("f");return function(l,c,f,h,d,p){for(var v=0,m="",_=[],y=[],E=0,x=0,F=0,U="",b,w,k=0,S=0,C,P,A=0,R=0,de=Array.isArray(p.CellXf),ue,Z=[],te=[],re=Array.isArray(c),H=[],se={},oe=!1,L=!!f.sheetStubs,K=l.split(e),z=0,G=K.length;z!=G;++z){m=K[z].trim();var ee=m.length;if(ee!==0){var me=0;e:for(v=0;v<ee;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(w=Le(m.slice(me,v),!0),k=w.r!=null?parseInt(w.r,10):k+1,S=-1,f.sheetRows&&f.sheetRows<k)continue;se={},oe=!1,w.ht&&(oe=!0,se.hpt=parseFloat(w.ht),se.hpx=_l(se.hpt)),w.hidden=="1"&&(oe=!0,se.hidden=!0),w.outlineLevel!=null&&(oe=!0,se.level=+w.outlineLevel),oe&&(H[k-1]=se)}break;case"<":me=v;break}if(me>=v)break;if(w=Le(m.slice(me,v),!0),k=w.r!=null?parseInt(w.r,10):k+1,S=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(se={},oe=!1,w.ht&&(oe=!0,se.hpt=parseFloat(w.ht),se.hpx=_l(se.hpt)),w.hidden=="1"&&(oe=!0,se.hidden=!0),w.outlineLevel!=null&&(oe=!0,se.level=+w.outlineLevel),oe&&(H[k-1]=se)),_=m.slice(v).split(t);for(var xe=0;xe!=_.length&&_[xe].trim().charAt(0)=="<";++xe);for(_=_.slice(xe),v=0;v!=_.length;++v)if(m=_[v].trim(),m.length!==0){if(y=m.match(r),E=v,x=0,F=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(E=0,U=y[1],x=0;x!=U.length&&!((F=U.charCodeAt(x)-64)<1||F>26);++x)E=26*E+F;--E,S=E}else++S;for(x=0;x!=m.length&&m.charCodeAt(x)!==62;++x);if(++x,w=Le(m.slice(0,x),!0),w.r||(w.r=Oe({r:k-1,c:S})),U=m.slice(x),b={t:""},(y=U.match(s))!=null&&y[1]!==""&&(b.v=et(y[1])),f.cellFormula){if((y=U.match(a))!=null&&y[1]!==""){if(b.f=et(pt(y[1])).replace(/\r\n/g,`
`),f.xlfn||(b.f=_w(b.f)),y[0].indexOf('t="array"')>-1)b.F=(U.match(i)||[])[1],b.F.indexOf(":")>-1&&Z.push([tt(b.F),b.F]);else if(y[0].indexOf('t="shared"')>-1){P=Le(y[0]);var ge=et(pt(y[1]));f.xlfn||(ge=_w(ge)),te[parseInt(P.si,10)]=[P,ge,w.r]}}else(y=U.match(/<f[^>]*\/>/))&&(P=Le(y[0]),te[P.si]&&(b.f=a9(te[P.si][1],te[P.si][2],w.r)));var fe=Nt(w.r);for(x=0;x<Z.length;++x)fe.r>=Z[x][0].s.r&&fe.r<=Z[x][0].e.r&&fe.c>=Z[x][0].s.c&&fe.c<=Z[x][0].e.c&&(b.F=Z[x][1])}if(w.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(L)b.t="z";else continue;else b.t=w.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),b.t){case"n":if(b.v==""||b.v==null){if(!L)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!L)continue;b.t="z"}else C=Cc[parseInt(b.v,10)],b.v=C.t,b.r=C.r,f.cellHTML&&(b.h=C.h);break;case"str":b.t="s",b.v=b.v!=null?pt(b.v):"",f.cellHTML&&(b.h=W1(b.v));break;case"inlineStr":y=U.match(n),b.t="s",y!=null&&(C=rv(y[1]))?(b.v=C.t,f.cellHTML&&(b.h=C.h)):b.v="";break;case"b":b.v=wt(b.v);break;case"d":f.cellDates?b.v=kt(b.v,1):(b.v=ar(kt(b.v,1)),b.t="n");break;case"e":(!f||f.cellText!==!1)&&(b.w=b.v),b.v=GS[b.v];break}if(A=R=0,ue=null,de&&w.s!==void 0&&(ue=p.CellXf[w.s],ue!=null&&(ue.numFmtId!=null&&(A=ue.numFmtId),f.cellStyles&&ue.fillId!=null&&(R=ue.fillId))),HA(b,A,R,f,d,p),f.cellDates&&de&&b.t=="n"&&Al(De[A])&&(b.t="d",b.v=Jh(b.v)),w.cm&&f.xlmeta){var Be=(f.xlmeta.Cell||[])[+w.cm-1];Be&&Be.type=="XLDAPR"&&(b.D=!0)}if(re){var W=Nt(w.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=b}else c[w.r]=b}}}}H.length>0&&(c["!rows"]=H)}}();function fB(t,e,r,n){var i=[],s=[],a=tt(t["!ref"]),o="",l,c="",f=[],h=0,d=0,p=t["!rows"],v=Array.isArray(t),m={r:c},_,y=-1;for(d=a.s.c;d<=a.e.c;++d)f[d]=Ft(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Kt(h),d=a.s.c;d<=a.e.c;++d){l=f[d]+c;var E=v?(t[h]||[])[d]:t[l];E!==void 0&&(o=cB(E,l,t,e))!=null&&s.push(o)}(s.length>0||p&&p[h])&&(m={r:c},p&&p[h]&&(_=p[h],_.hidden&&(m.hidden=1),y=-1,_.hpx?y=du(_.hpx):_.hpt&&(y=_.hpt),y>-1&&(m.ht=y,m.customHeight=1),_.level&&(m.outlineLevel=_.level)),i[i.length]=ye("row",s.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},_=p[h],_.hidden&&(m.hidden=1),y=-1,_.hpx?y=du(_.hpx):_.hpt&&(y=_.hpt),y>-1&&(m.ht=y,m.customHeight=1),_.level&&(m.outlineLevel=_.level),i[i.length]=ye("row","",m));return i.join("")}function $A(t,e,r,n){var i=[Xt,ye("worksheet",null,{xmlns:ro[0],"xmlns:r":nr.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=tt(c);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=We(f)}n||(n={}),l["!comments"]=[];var h=[];qV(l,r,t,e,i),i[i.length]=ye("dimension",null,{ref:c}),i[i.length]=lB(l,e,t,r),e.sheetFormat&&(i[i.length]=ye("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=nB(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=fB(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=JV(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=sB(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=KV(l["!merges"]));var d=-1,p,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=ct(n,-1,ut(m[1].Target).replace(/#.*$/,""),Xe.HLINK),p["r:id"]="rId"+v),(d=m[1].Target.indexOf("#"))>-1&&(p.location=ut(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=ut(m[1].Tooltip)),i[i.length]=ye("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=tB(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Er("ignoredErrors",ye("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(v=ct(n,-1,"../drawings/drawing"+(t+1)+".xml",Xe.DRAW),i[i.length]=ye("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=h),l["!comments"].length>0&&(v=ct(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Xe.VML),i[i.length]=ye("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function hB(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function dB(t,e,r){var n=ae(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=du(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var h=-1,d=-1,p=f<<10;p<f+1<<10;++p){c.c=p;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Oe(c)];v&&(h<0&&(h=p),d=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function pB(t,e,r,n){var i=dB(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ce(t,0,i)}var mB=ao,gB=Rl;function vB(){}function _B(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=wL(t),r}function xB(t,e,r){r==null&&(r=ae(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return ah({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jS(t,r),r.slice(0,r.l)}function yB(t){var e=Kn(t);return[e]}function wB(t,e,r){return r==null&&(r=ae(8)),no(e,r)}function EB(t){var e=io(t);return[e]}function TB(t,e,r){return r==null&&(r=ae(4)),so(e,r)}function kB(t){var e=Kn(t),r=t.read_shift(1);return[e,r,"b"]}function SB(t,e,r){return r==null&&(r=ae(9)),no(e,r),r.write_shift(1,t.v?1:0),r}function AB(t){var e=io(t),r=t.read_shift(1);return[e,r,"b"]}function IB(t,e,r){return r==null&&(r=ae(5)),so(e,r),r.write_shift(1,t.v?1:0),r}function CB(t){var e=Kn(t),r=t.read_shift(1);return[e,r,"e"]}function RB(t,e,r){return r==null&&(r=ae(9)),no(e,r),r.write_shift(1,t.v),r}function PB(t){var e=io(t),r=t.read_shift(1);return[e,r,"e"]}function FB(t,e,r){return r==null&&(r=ae(8)),so(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function NB(t){var e=Kn(t),r=t.read_shift(4);return[e,r,"s"]}function DB(t,e,r){return r==null&&(r=ae(12)),no(e,r),r.write_shift(4,e.v),r}function OB(t){var e=io(t),r=t.read_shift(4);return[e,r,"s"]}function LB(t,e,r){return r==null&&(r=ae(8)),so(e,r),r.write_shift(4,e.v),r}function bB(t){var e=Kn(t),r=Br(t);return[e,r,"n"]}function MB(t,e,r){return r==null&&(r=ae(16)),no(e,r),Ga(t.v,r),r}function GA(t){var e=io(t),r=Br(t);return[e,r,"n"]}function VB(t,e,r){return r==null&&(r=ae(12)),so(e,r),Ga(t.v,r),r}function BB(t){var e=Kn(t),r=Q1(t);return[e,r,"n"]}function UB(t,e,r){return r==null&&(r=ae(12)),no(e,r),WS(t.v,r),r}function jB(t){var e=io(t),r=Q1(t);return[e,r,"n"]}function WB(t,e,r){return r==null&&(r=ae(8)),so(e,r),WS(t.v,r),r}function HB(t){var e=Kn(t),r=X1(t);return[e,r,"is"]}function zB(t){var e=Kn(t),r=jr(t);return[e,r,"str"]}function $B(t,e,r){return r==null&&(r=ae(12+4*t.v.length)),no(e,r),hr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function GB(t){var e=io(t),r=jr(t);return[e,r,"str"]}function KB(t,e,r){return r==null&&(r=ae(8+4*t.v.length)),so(e,r),hr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function XB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}function qB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}function YB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=Br(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}function QB(t,e,r){var n=t.l+e,i=Kn(t);i.r=r["!row"];var s=jr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=td(t,n-t.l,r);a[3]=Lr(o,null,i,r.supbooks,r)}else t.l=n;return a}var JB=ao,ZB=Rl;function e7(t,e){return e==null&&(e=ae(4)),e.write_shift(4,t),e}function t7(t,e){var r=t.l+e,n=ao(t),i=q1(t),s=jr(t),a=jr(t),o=jr(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function r7(t,e){var r=ae(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Rl({s:Nt(t[0]),e:Nt(t[0])},r),Y1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return hr(i||"",r),hr(t[1].Tooltip||"",r),hr("",r),r.slice(0,r.l)}function n7(){}function i7(t,e,r){var n=t.l+e,i=HS(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=CV(t,n-t.l,r);a[1]=o}else t.l=n;return a}function s7(t,e,r){var n=t.l+e,i=ao(t),s=[i];if(r.cellFormula){var a=PV(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function a7(t,e,r){r==null&&(r=ae(18));var n=rd(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var KA=["left","right","top","bottom","header","footer"];function o7(t){var e={};return KA.forEach(function(r){e[r]=Br(t)}),e}function l7(t,e){return e==null&&(e=ae(6*8)),Fa(t),KA.forEach(function(r){Ga(t[r],e)}),e}function c7(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function u7(t,e,r){r==null&&(r=ae(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function f7(t){var e=ae(24);return e.write_shift(4,4),e.write_shift(4,1),Rl(t,e),e}function h7(t,e){return e==null&&(e=ae(16*4+2)),e.write_shift(2,t.password?nv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function d7(){}function p7(){}function m7(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,v,m,_,y,E,x,F,U,b=[];o.biff=12,o["!row"]=0;var w=0,k=!1,S=[],C={},P=o.supbooks||i.supbooks||[[]];if(P.sharedf=C,P.arrayf=S,P.SheetNames=i.SheetNames||i.Sheets.map(function(re){return re.name}),!o.supbooks&&(o.supbooks=P,i.Names))for(var A=0;A<i.Names.length;++A)P[0][A+1]=i.Names[A];var R=[],de=[],ue=!1;pu[16]={n:"BrtShortReal",f:GA};var Z;if(us(t,function(H,se,oe){if(!d)switch(oe){case 148:c=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),F=Kt(_=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=_l(H.hpt)),de[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:H[2]},H[2]){case"n":v.v=H[1];break;case"s":x=Cc[H[1]],v.v=x.t,v.r=x.r;break;case"b":v.v=!!H[1];break;case"e":v.v=H[1],o.cellText!==!1&&(v.w=fs[v.v]);break;case"str":v.t="s",v.v=H[1];break;case"is":v.t="s",v.v=H[1].t;break}if((m=a.CellXf[H[0].iStyleRef])&&HA(v,m.numFmtId,null,o,s,a),y=H[0].c==-1?y+1:H[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=v):l[Ft(y)+F]=v,o.cellFormula){for(k=!1,w=0;w<S.length;++w){var L=S[w];p.r>=L[0].s.r&&p.r<=L[0].e.r&&y>=L[0].s.c&&y<=L[0].e.c&&(v.F=We(L[0]),k=!0)}!k&&H.length>3&&(v.f=H[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>y&&(f.s.c=y),f.e.r<p.r&&(f.e.r=p.r),f.e.c<y&&(f.e.c=y),o.cellDates&&m&&v.t=="n"&&Al(De[m.numFmtId])){var K=ka(v.v);K&&(v.t="d",v.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}Z&&(Z.type=="XLDAPR"&&(v.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},y=H[0].c==-1?y+1:H[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=v):l[Ft(y)+F]=v,f.s.r>p.r&&(f.s.r=p.r),f.s.c>y&&(f.s.c=y),f.e.r<p.r&&(f.e.r=p.r),f.e.c<y&&(f.e.c=y),Z&&(Z.type=="XLDAPR"&&(v.D=!0),Z=void 0);break;case 176:b.push(H);break;case 49:Z=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var z=n["!id"][H.relId];for(z?(H.Target=z.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=z):H.relId==""&&(H.Target="#"+H.loc),_=H.rfx.s.r;_<=H.rfx.e.r;++_)for(y=H.rfx.s.c;y<=H.rfx.e.c;++y)o.dense?(l[_]||(l[_]=[]),l[_][y]||(l[_][y]={t:"z",v:void 0}),l[_][y].l=H):(E=Oe({c:y,r:_}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=H);break;case 426:if(!o.cellFormula)break;S.push(H),U=o.dense?l[_][y]:l[Ft(y)+F],U.f=Lr(H[1],f,{r:p.r,c:y},P,o),U.F=We(H[0]);break;case 427:if(!o.cellFormula)break;C[Oe(H[0].s)]=H[1],U=o.dense?l[_][y]:l[Ft(y)+F],U.f=Lr(H[1],f,{r:p.r,c:y},P,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)R[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},ue||(ue=!0,iv(H.w/256)),Js(R[H.e+1]);break;case 161:l["!autofilter"]={ref:We(H)};break;case 476:l["!margins"]=H;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),H.name&&(i.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),H.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!se.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=We(c||f)),o.sheetRows&&l["!ref"]){var te=tt(l["!ref"]);o.sheetRows<=+te.e.r&&(te.e.r=o.sheetRows-1,te.e.r>f.e.r&&(te.e.r=f.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>f.e.c&&(te.e.c=f.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),l["!fullref"]=l["!ref"],l["!ref"]=We(te))}return b.length>0&&(l["!merges"]=b),R.length>0&&(l["!cols"]=R),de.length>0&&(l["!rows"]=de),l}function g7(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=St(e),e.z=e.z||De[14],e.v=ar(kt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=la(i.cellXfs,e,i),e.l&&s["!links"].push([Oe(l),e.l]),e.c&&s["!comments"].push([Oe(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=cv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?ce(t,18,LB(e,l)):ce(t,7,DB(e,l))):(l.t="str",a?ce(t,17,KB(e,l)):ce(t,6,$B(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ce(t,13,WB(e,l)):ce(t,2,UB(e,l)):a?ce(t,16,VB(e,l)):ce(t,5,MB(e,l)),!0;case"b":return l.t="b",a?ce(t,15,IB(e,l)):ce(t,4,SB(e,l)),!0;case"e":return l.t="e",a?ce(t,14,FB(e,l)):ce(t,3,RB(e,l)),!0}return a?ce(t,12,TB(e,l)):ce(t,1,wB(e,l)),!0}function v7(t,e,r,n){var i=tt(e["!ref"]||"A1"),s,a="",o=[];ce(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=c;++f){a=Kt(f),pB(t,e,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=Ft(d)),s=o[d]+a;var p=l?(e[f]||[])[d]:e[s];if(!p){h=!1;continue}h=g7(t,p,f,d,n,e,h)}}ce(t,146)}function _7(t,e){!e||!e["!merges"]||(ce(t,177,e7(e["!merges"].length)),e["!merges"].forEach(function(r){ce(t,176,ZB(r))}),ce(t,178))}function x7(t,e){!e||!e["!cols"]||(ce(t,390),e["!cols"].forEach(function(r,n){r&&ce(t,60,a7(n,r))}),ce(t,391))}function y7(t,e){!e||!e["!ref"]||(ce(t,648),ce(t,649,f7(tt(e["!ref"]))),ce(t,650))}function w7(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=ct(r,-1,n[1].Target.replace(/#.*$/,""),Xe.HLINK);ce(t,494,r7(n,i))}}),delete e["!links"]}function E7(t,e,r,n){if(e["!comments"].length>0){var i=ct(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Xe.VML);ce(t,551,Y1("rId"+i)),e["!legacy"]=i}}function T7(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:We(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=pn(s);o.s.r==o.e.r&&(o.e.r=pn(e["!ref"]).e.r,s=We(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ce(t,161,Rl(tt(s))),ce(t,162)}}function k7(t,e,r){ce(t,133),ce(t,137,u7(e,r)),ce(t,138),ce(t,134)}function S7(t,e){e["!protect"]&&ce(t,535,h7(e["!protect"]))}function A7(t,e,r,n){var i=dn(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=tt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ce(i,129),(r.vbaraw||a["!outline"])&&ce(i,147,xB(o,a["!outline"])),ce(i,148,gB(l)),k7(i,a,r.Workbook),x7(i,a),v7(i,a,t,e),S7(i,a),T7(i,a,r,t),_7(i,a),w7(i,a,n),a["!margins"]&&ce(i,476,l7(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&y7(i,a),E7(i,a,t,n),ce(i,130),i.end()}function I7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=et((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function C7(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=I7(h);f.s.r=f.s.c=0,f.e.c=o,c=Ft(o),d[0].forEach(function(p,v){a[c+Kt(v)]={t:"n",v:p,z:d[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=We(f)),a}function R7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(zA);return o&&uv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function P7(t,e){t.l+=10;var r=jr(t);return{name:r}}function F7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return us(t,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var fv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],N7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],D7=[],O7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Tw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=wt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function kw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=wt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function XA(t){kw(t.WBProps,fv),kw(t.CalcPr,O7),Tw(t.WBView,N7),Tw(t.Sheets,D7),Jo.date1904=wt(t.WBProps.date1904)}function L7(t){return!t.Workbook||!t.Workbook.WBProps?"false":wt(t.Workbook.WBProps.date1904)?"true":"false"}var b7="][*?/\\".split("");function qA(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return b7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function M7(t,e,r){t.forEach(function(n,i){qA(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function V7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];M7(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)LV(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var B7=/<\w+:workbook/;function U7(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace($r,function(l,c){var f=Le(l);switch(Ci(f[0])){case"<?xml":break;case"<workbook":l.match(B7)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fv.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=wt(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=pt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=et(pt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=pt(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),wt(f.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=et(pt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),ro.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XA(r),r}function YA(t){var e=[Xt];e[e.length]=ye("workbook",null,{xmlns:ro[0],"xmlns:r":nr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(fv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ye("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:ut(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ye("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=ye("definedName",ut(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function j7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Pm(t),r.name=jr(t),r}function W7(t,e){return e||(e=ae(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Y1(t.strRelID,e),hr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function H7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?jr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function z7(t,e){e||(e=ae(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),jS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function $7(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function G7(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=EL(t),a=RV(t,0,r),o=q1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function K7(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],pu[16]={n:"BrtFRTArchID$",f:$7},us(t,function(l,c,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),XA(r),r.Names=s,r.supbooks=a,r}function X7(t,e){ce(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ce(t,156,W7(i))}ce(t,144)}function q7(t,e){e||(e=ae(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return hr("SheetJS",e),hr(Z0.version,e),hr(Z0.version,e),hr("7262",e),e.length>e.l?e.slice(0,e.l):e}function Y7(t,e){e||(e=ae(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Q7(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ce(t,135),ce(t,158,Y7(i)),ce(t,136))}}function J7(t,e){var r=dn();return ce(r,131),ce(r,128,q7()),ce(r,153,z7(t.Workbook&&t.Workbook.WBProps||null)),Q7(r,t),X7(r,t),ce(r,132),r.end()}function Z7(t,e,r){return e.slice(-4)===".bin"?K7(t,r):U7(t,r)}function eU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?m7(t,n,r,i,s,a,o):GV(t,n,r,i,s,a,o)}function tU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?F7(t,n,r,i,s):R7(t,n,r,i,s)}function rU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?i9():s9()}function nU(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?r9():n9()}function iU(t,e,r,n){return e.slice(-4)===".bin"?ZM(t,r,n):jM(t,r,n)}function sU(t,e,r){return PA(t,r)}function aU(t,e,r){return e.slice(-4)===".bin"?aM(t,r):nM(t,r)}function oU(t,e,r){return e.slice(-4)===".bin"?Q5(t,r):W5(t,r)}function lU(t,e,r){return e.slice(-4)===".bin"?B5(t):M5(t)}function cU(t,e,r,n){return r.slice(-4)===".bin"?U5(t,e,r,n):void 0}function uU(t,e,r){return e.slice(-4)===".bin"?O5(t,e,r):b5(t,e,r)}function fU(t,e,r){return(e.slice(-4)===".bin"?J7:YA)(t)}function hU(t,e,r,n,i){return(e.slice(-4)===".bin"?A7:$A)(t,r,n,i)}function dU(t,e,r){return(e.slice(-4)===".bin"?c5:CA)(t,r)}function pU(t,e,r){return(e.slice(-4)===".bin"?cM:yA)(t,r)}function mU(t,e,r){return(e.slice(-4)===".bin"?J5:DA)(t)}function gU(t){return(t.slice(-4)===".bin"?L5:FA)()}var QA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,JA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(QA),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(JA),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function vU(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(QA),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(JA),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Pc;function _U(t,e){var r=Pc[t]||et(t);return r==="General"?za(e):Gn(r,e)}function xU(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=wt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=kt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[et(e)]=i}function yU(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||fs[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=su(t.v):t.w=za(t.v):t.w=_U(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Pc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Al(n)){var i=ka(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function wU(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=DM[n.Pattern]||n.Pattern)}t[e.ID]=e}function EU(t,e,r,n,i,s,a,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var p=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&p.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wt(t);break;case"String":n.t="s",n.r=jy(et(t)),n.v=t.indexOf("<")>-1?et(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(kt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=et(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=jy(e||t));break}if(yU(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=et(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Qo(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Qo("RC:RC",i):n.ArrayRange&&(n.F=Qo(n.ArrayRange,i),l.push([tt(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(p.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function TU(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function ap(t,e){var r=e||{};Il();var n=oc(H1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=St(r);return a.type="string",vl.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){i.indexOf("<"+Ct)>=0&&(s=!0)}),s)return lj(n,r);Pc={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},p="",v={},m={},_=Yn('<Data ss:Type="String">'),y=0,E=0,x=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},b={},w="",k=0,S=[],C={},P={},A=0,R=[],de=[],ue={},Z=[],te,re=!1,H=[],se=[],oe={},L=0,K=0,z={Sheets:[],WBProps:{date1904:!1}},G={};lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=lu.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?EU(n.slice(y,o.index),w,_,l[l.length-1][0]=="comment"?ue:v,{c:E,r:x},U,Z[E],m,H,r):(w="",_=Yn(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(de.length>0&&(v.c=de),(!r.sheetRows||r.sheetRows>x)&&v.v!==void 0&&(r.dense?(d[x]||(d[x]=[]),d[x][E]=v):d[Ft(E)+Kt(x)]=v),v.HRef&&(v.l={Target:et(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(L=E+(parseInt(v.MergeAcross,10)|0),K=x+(parseInt(v.MergeDown,10)|0),S.push({s:{c:E,r:x},e:{c:L,r:K}})),!r.sheetStubs)v.MergeAcross?E=L+1:++E;else if(v.MergeAcross||v.MergeDown){for(var me=E;me<=L;++me)for(var xe=x;xe<=K;++xe)(me>E||xe>x)&&(r.dense?(d[xe]||(d[xe]=[]),d[xe][me]={t:"z"}):d[Ft(me)+Kt(xe)]={t:"z"});E=L+1}else++E;else v=vU(o[0]),v.Index&&(E=+v.Index-1),E<F.s.c&&(F.s.c=E),E>F.e.c&&(F.e.c=E),o[0].slice(-2)==="/>"&&++E,de=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<F.s.r&&(F.s.r=x),x>F.e.r&&(F.e.r=x),o[0].slice(-2)==="/>"&&(m=Yn(o[0]),m.Index&&(x=+m.Index-1)),E=0,++x):(m=Yn(o[0]),m.Index&&(x=+m.Index-1),oe={},(m.AutoFitHeight=="0"||m.Height)&&(oe.hpx=parseInt(m.Height,10),oe.hpt=du(oe.hpx),se[x]=oe),m.Hidden=="1"&&(oe.hidden=!0,se[x]=oe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(d["!ref"]=We(F),r.sheetRows&&r.sheetRows<=F.e.r&&(d["!fullref"]=d["!ref"],F.e.r=r.sheetRows-1,d["!ref"]=We(F))),S.length&&(d["!merges"]=S),Z.length>0&&(d["!cols"]=Z),se.length>0&&(d["!rows"]=se),f[p]=d}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=E=0,l.push([o[3],!1]),c=Yn(o[0]),p=et(c.Name),d=r.dense?[]:{},S=[],H=[],se=[],G={name:p,Hidden:0},z.Sheets.push(G);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Z=[],re=!1}break;case"style":o[1]==="/"?wU(U,b,r):b=Yn(o[0]);break;case"numberformat":b.nf=et(Yn(o[0]).Format||"General"),Pc[b.nf]&&(b.nf=Pc[b.nf]);for(var ge=0;ge!=392&&De[ge]!=b.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(De[ge]==null){qi(b.nf,ge);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(te=Yn(o[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!re&&te.wpx>10){re=!0,Vr=AA;for(var fe=0;fe<Z.length;++fe)Z[fe]&&Js(Z[fe])}re&&Js(te),Z[te.Index-1||Z.length]=te;for(var Be=0;Be<+te.Span;++Be)Z[Z.length]=St(te);break;case"namedrange":if(o[1]==="/")break;z.Names||(z.Names=[]);var W=Le(o[0]),at={Name:W.Name,Ref:Qo(W.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(at.Sheet=z.Sheets.length-1),z.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;b.Interior=Yn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?KL(C,ee,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));TU(ue),de.push(ue)}else l.push([o[3],!1]),c=Yn(o[0]),ue={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ke=Yn(o[0]);d["!autofilter"]={ref:Qo(Ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Rw(n,r);var st=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:st=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:st=!1}break;case"excelworkbook":switch(o[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:st=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:st=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else A=o.index+o[0].length;break;case"header":d["!margins"]||Fa(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].header=+Le(o[0]).Margin);break;case"footer":d["!margins"]||Fa(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].footer=+Le(o[0]).Margin);break;case"pagemargins":var $e=Le(o[0]);d["!margins"]||Fa(d["!margins"]={},"xlml"),isNaN(+$e.Top)||(d["!margins"].top=+$e.Top),isNaN(+$e.Left)||(d["!margins"].left=+$e.Left),isNaN(+$e.Right)||(d["!margins"].right=+$e.Right),isNaN(+$e.Bottom)||(d["!margins"].bottom=+$e.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:st=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:st=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:st=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:st=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:st=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:st=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:st=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:st=!1}break;case"smarttags":break;default:st=!1;break}if(st||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?xU(P,ee,R,n.slice(A,o.index)):(R=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ke={};return!r.bookSheets&&!r.bookProps&&(ke.Sheets=f),ke.SheetNames=h,ke.Workbook=z,ke.SSF=St(De),ke.Props=C,ke.Custprops=P,ke}function Mm(t,e){switch(dv(e=e||{}),e.type||"base64"){case"base64":return ap(In(t),e);case"binary":case"buffer":case"file":return ap(t,e);case"array":return ap(aa(t),e)}}function kU(t,e){var r=[];return t.Props&&r.push(XL(t.Props,e)),t.Custprops&&r.push(qL(t.Props,t.Custprops)),r.join("")}function SU(){return""}function AU(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ye("NumberFormat",null,{"ss:Format":ut(De[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ye("Style",s.join(""),a))}),ye("Styles",r.join(""))}function ZA(t){return ye("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ov(t.Ref,{r:0,c:0})})}function IU(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(ZA(i)))}return ye("Names",r.join(""))}function CU(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(ZA(o)))}return s.join("")}function RU(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ye("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ye("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ye("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ye("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Er("ProtectContents","True")),t["!protect"].objects&&i.push(Er("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Er("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Er("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Er("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ye("WorksheetOptions",i.join(""),{xmlns:xn.x})}function PU(t){return t.map(function(e){var r=Q6(e.t||""),n=ye("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ye("Comment",n,{"ss:Author":e.a})}).join("")}function FU(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+ut(ov(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Nt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=ut(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=ut(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=fs[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||De[14]);break;case"s":h="String",d=Y6(t.v||"");break}var p=la(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var v=t.v!=null?d:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(t.c||[]).length>0&&(m+=PU(t.c)),ye("Cell",m,o)}function NU(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=_l(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function DU(t,e,r,n){if(!t["!ref"])return"";var i=tt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,y){Js(_);var E=!!_.width,x=rd(y,_),F={"ss:Index":y+1};E&&(F["ss:Width"]=fu(x.width)),_.hidden&&(F["ss:Hidden"]="1"),o.push(ye("Column",null,F))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var f=[NU(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(d=!0);break}if(!d){var p={r:c,c:h},v=Oe(p),m=l?(t[c]||[])[h]:t[v];f.push(FU(m,v,t,e,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function OU(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?CU(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?DU(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(RU(s,e,t,r)),n.join("")}function LU(t,e){e||(e={}),t.SSF||(t.SSF=St(De)),t.SSF&&(Il(),qh(t.SSF),e.revssf=Qh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],la(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kU(t,e)),r.push(SU()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ye("Worksheet",OU(n,e,t),{"ss:Name":ut(t.SheetNames[n])}));return r[2]=AU(t,e),r[3]=IU(t),Xt+ye("Workbook",r.join(""),{xmlns:xn.ss,"xmlns:o":xn.o,"xmlns:x":xn.x,"xmlns:ss":xn.ss,"xmlns:dt":xn.dt,"xmlns:html":xn.html})}function bU(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=IL(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=CL(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var MU=[60,1084,2066,2165,2175];function VU(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Hi(r,r.l),c=Vm[l],f=0;c!=null&&MU.indexOf(l)>-1;)s=Hi(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,c=Vm[l=Hi(r,r.l)];var h=fr(a);yr(h,0);var d=0;h.lens=[];for(var p=0;p<a.length;++p)h.lens.push(d),d+=a[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function hi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=De[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||fs[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=su(t.v):t.w=za(t.v):t.w=Gn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Al(De[n]||String(n))){var i=ka(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function jf(t,e,r){return{v:t,ixfe:e,t:r}}function BU(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",f={},h,d="",p,v,m,_,y={},E=[],x,F,U=[],b=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(He){return He<8?Ca[He]:He<64&&b[He-8]||Ca[He]},C=function(He,Rt,or){var Mt=Rt.XF.data;if(!(!Mt||!Mt.patternType||!or||!or.cellStyles)){Rt.s={},Rt.s.patternType=Mt.patternType;var ci;(ci=uu(S(Mt.icvFore)))&&(Rt.s.fgColor={rgb:ci}),(ci=uu(S(Mt.icvBack)))&&(Rt.s.bgColor={rgb:ci})}},P=function(He,Rt,or){if(!(oe>1)&&!(or.sheetRows&&He.r>=or.sheetRows)){if(or.cellStyles&&Rt.XF&&Rt.XF.data&&C(He,Rt,or),delete Rt.ixfe,delete Rt.XF,h=He,d=Oe(He),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),He.r<a.s.r&&(a.s.r=He.r),He.c<a.s.c&&(a.s.c=He.c),He.r+1>a.e.r&&(a.e.r=He.r+1),He.c+1>a.e.c&&(a.e.c=He.c+1),or.cellFormula&&Rt.f){for(var Mt=0;Mt<E.length;++Mt)if(!(E[Mt][0].s.c>He.c||E[Mt][0].s.r>He.r)&&!(E[Mt][0].e.c<He.c||E[Mt][0].e.r<He.r)){Rt.F=We(E[Mt][0]),(E[Mt][0].s.c!=He.c||E[Mt][0].s.r!=He.r)&&delete Rt.f,Rt.f&&(Rt.f=""+Lr(E[Mt][1],a,He,H,A));break}}or.dense?(i[He.r]||(i[He.r]=[]),i[He.r][He.c]=Rt):i[d]=Rt}},A={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var R,de=[],ue=[],Z=[],te=[],re=!1,H=[];H.SheetNames=A.snames,H.sharedf=A.sharedf,H.arrayf=A.arrayf,H.names=[],H.XTI=[];var se=0,oe=0,L=0,K=[],z=[],G;A.codepage=1200,ei(1200);for(var ee=!1;t.l<t.length-1;){var me=t.l,xe=t.read_shift(2);if(xe===0&&se===10)break;var ge=t.l===t.length?0:t.read_shift(2),fe=Vm[xe];if(fe&&fe.f){if(e.bookSheets&&se===133&&xe!==133)break;if(se=xe,fe.r===2||fe.r==12){var Be=t.read_shift(2);if(ge-=2,!A.enc&&Be!==xe&&((Be&255)<<8|Be>>8)!==xe)throw new Error("rt mismatch: "+Be+"!="+xe);fe.r==12&&(t.l+=10,ge-=10)}var W={};if(xe===10?W=fe.f(t,ge,A):W=VU(xe,fe,t,ge,A),oe==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(xe){case 34:r.opts.Date1904=w.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(t.l=0),A.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=W;break;case 66:var at=Number(W);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}ei(A.codepage=at),ee=!0;break;case 317:A.rrtabid=W;break;case 25:A.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:A.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(i["!type"]="dialog"),W.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),W.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:U.push(W);break;case 430:H.push([W]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(W);break;case 24:case 536:G={Name:W.Name,Ref:Lr(W.rgce,a,null,H,A)},W.itab>0&&(G.Sheet=W.itab-1),H.names.push(G),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(z[W.itab-1]={ref:We(W.rgce[0][0][1][2])});break;case 22:A.ExternCount=W;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(W),H.XTI=H.XTI.concat(W);break;case 2196:if(A.biff<8)break;G!=null&&(G.Comment=W[1]);break;case 18:i["!protect"]=W;break;case 19:W!==0&&A.WTF&&console.error("Password verifier: "+W);break;case 133:s[W.pos]=W,A.snames.push(W.name);break;case 10:{if(--oe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=We(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ke=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=We(a),a.e.r=Ke}a.e.r++,a.e.c++}de.length>0&&(i["!merges"]=de),ue.length>0&&(i["!objects"]=ue),Z.length>0&&(i["!cols"]=Z),te.length>0&&(i["!rows"]=te),w.Sheets.push(k)}c===""?f=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),A.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(A.biff=5,ee=!0,ei(A.codepage=28591)),A.biff==8&&W.BIFFVer==0&&W.dt==16&&(A.biff=2),oe++)break;if(i=e.dense?[]:{},A.biff<8&&!ee&&(ee=!0,ei(A.codepage=e.codepage||1252)),A.biff<5||W.BIFFVer==0&&W.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var st={pos:t.l-ge,name:c};s[st.pos]=st,A.snames.push(c)}else c=(s[me]||{name:""}).name;W.dt==32&&(i["!type"]="chart"),W.dt==64&&(i["!type"]="macro"),de=[],ue=[],A.arrayf=E=[],Z=[],te=[],re=!1,k={Hidden:(s[me]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[W.r]||[])[W.c]:i[Oe({c:W.c,r:W.r})])&&++W.c,x={ixfe:W.ixfe,XF:U[W.ixfe]||{},v:W.val,t:"n"},L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:W.c,r:W.r},x,e);break;case 5:case 517:x={ixfe:W.ixfe,XF:U[W.ixfe],v:W.val,t:W.t},L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:W.c,r:W.r},x,e);break;case 638:x={ixfe:W.ixfe,XF:U[W.ixfe],v:W.rknum,t:"n"},L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:W.c,r:W.r},x,e);break;case 189:for(var $e=W.c;$e<=W.C;++$e){var ke=W.rkrec[$e-W.c][0];x={ixfe:ke,XF:U[ke],v:W.rkrec[$e-W.c][1],t:"n"},L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:$e,r:W.r},x,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(x=jf(W.val,W.cell.ixfe,W.tt),x.XF=U[x.ixfe],e.cellFormula){var Ct=W.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var Gr=Ct[0][0][1][0],rn=Ct[0][0][1][1],Pn=Oe({r:Gr,c:rn});y[Pn]?x.f=""+Lr(W.formula,a,W.cell,H,A):x.F=((e.dense?(i[Gr]||[])[rn]:i[Pn])||{}).F}else x.f=""+Lr(W.formula,a,W.cell,H,A)}L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P(W.cell,x,e),o=W}break;case 7:case 519:if(o)o.val=W,x=jf(W,o.cell.ixfe,"s"),x.XF=U[x.ixfe],e.cellFormula&&(x.f=""+Lr(o.formula,a,o.cell,H,A)),L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P(o.cell,x,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(W);var ca=Oe(W[0].s);if(p=e.dense?(i[W[0].s.r]||[])[W[0].s.c]:i[ca],e.cellFormula&&p){if(!o||!ca||!p)break;p.f=""+Lr(W[1],a,W[0],H,A),p.F=We(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;y[Oe(o.cell)]=W[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Oe(o.cell)],(p||{}).f=""+Lr(W[0],a,h,H,A)}}break;case 253:x=jf(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(x.h=l[W.isst].h),x.XF=U[x.ixfe],L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:W.c,r:W.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:W.ixfe,XF:U[W.ixfe],t:"z"},L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:W.c,r:W.r},x,e));break;case 190:if(e.sheetStubs)for(var Fn=W.c;Fn<=W.C;++Fn){var pr=W.ixfe[Fn-W.c];x={ixfe:pr,XF:U[pr],t:"z"},L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:Fn,r:W.r},x,e)}break;case 214:case 516:case 4:x=jf(W.val,W.ixfe,"s"),x.XF=U[x.ixfe],L>0&&(x.z=K[x.ixfe>>8&63]),hi(x,e,r.opts.Date1904),P({c:W.c,r:W.r},x,e);break;case 0:case 512:oe===1&&(a=W);break;case 252:l=W;break;case 1054:if(A.biff==4){K[L++]=W[1];for(var Nn=0;Nn<L+163&&De[Nn]!=W[1];++Nn);Nn>=163&&qi(W[1],L+163)}else qi(W[1],W[0]);break;case 30:{K[L++]=W;for(var _t=0;_t<L+163&&De[_t]!=W;++_t);_t>=163&&qi(W,L+163)}break;case 229:de=de.concat(W);break;case 93:ue[W.cmo[0]]=A.lastobj=W;break;case 438:A.lastobj.TxO=W;break;case 127:A.lastobj.ImData=W;break;case 440:for(_=W[0].s.r;_<=W[0].e.r;++_)for(m=W[0].s.c;m<=W[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Oe({c:m,r:_})],p&&(p.l=W[1]);break;case 2048:for(_=W[0].s.r;_<=W[0].e.r;++_)for(m=W[0].s.c;m<=W[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Oe({c:m,r:_})],p&&p.l&&(p.l.Tooltip=W[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;p=e.dense?(i[W[0].r]||[])[W[0].c]:i[Oe(W[0])];var Ht=ue[W[2]];p||(e.dense?(i[W[0].r]||(i[W[0].r]=[]),p=i[W[0].r][W[0].c]={t:"z"}):p=i[Oe(W[0])]={t:"z"},a.e.r=Math.max(a.e.r,W[0].r),a.s.r=Math.min(a.s.r,W[0].r),a.e.c=Math.max(a.e.c,W[0].c),a.s.c=Math.min(a.s.c,W[0].c)),p.c||(p.c=[]),v={a:W[1],t:Ht.TxO.t},p.c.push(v)}break;case 2173:A5(U[W.ixfe],W.ext);break;case 125:{if(!A.cellStyles)break;for(;W.e>=W.s;)Z[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},re||(re=!0,iv(W.w/256)),Js(Z[W.e+1])}break;case 520:{var qt={};W.level!=null&&(te[W.r]=qt,qt.level=W.level),W.hidden&&(te[W.r]=qt,qt.hidden=!0),W.hpt&&(te[W.r]=qt,qt.hpt=W.hpt,qt.hpx=_l(W.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Fa(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=W;break;case 161:i["!margins"]||Fa(i["!margins"]={}),i["!margins"].header=W.header,i["!margins"].footer=W.footer;break;case 574:W.RTL&&(w.Views[0].RTL=!0);break;case 146:b=W;break;case 2198:R=W;break;case 140:F=W;break;case 442:c?k.CodeName=W||k.name:w.WBProps.CodeName=W||"ThisWorkbook";break}}else fe||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),t.l+=ge}return r.SheetNames=Wt(s).sort(function(mn,He){return Number(mn)-Number(He)}).map(function(mn){return s[mn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&z.forEach(function(mn,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=mn}),r.Strings=l,r.SSF=St(De),A.enc&&(r.Encryption=A.enc),R&&(r.Themes=R),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),H.names.length>0&&(w.Names=H.names),r.Workbook=w,r}var Fc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function UU(t,e,r){var n=Pe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=sw(n,Fm,Fc.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Pe.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=sw(a,Nm,Fc.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(JS(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function jU(t,e){var r=[],n=[],i=[],s=0,a,o=Ly(Fm,"n"),l=Ly(Nm,"n");if(t.Props)for(a=Wt(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Wt(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)sA.indexOf(i[s][0])>-1||QS.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Pe.utils.cfb_add(e,"/SummaryInformation",aw(n,Fc.SI,l,Nm)),(r.length||c.length)&&Pe.utils.cfb_add(e,"/DocumentSummaryInformation",aw(r,Fc.DSI,o,Fm,c.length?c:null,Fc.UDI))}function eI(t,e){e||(e={}),dv(e),O1(),e.codepage&&D1(e.codepage);var r,n;if(t.FullPaths){if(Pe.find(t,"/encryption"))throw new Error("File is password-protected");r=Pe.find(t,"!CompObj"),n=Pe.find(t,"/Workbook")||Pe.find(t,"/Book")}else{switch(e.type){case"base64":t=wn(In(t));break;case"binary":t=wn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}yr(t,0),n={content:t}}var i,s;if(r&&bU(r),e.bookProps&&!e.bookSheets)i={};else{var a=Ge?"buffer":"array";if(n&&n.content)i=BU(n.content,e);else if((s=Pe.find(t,"PerfectOffice_MAIN"))&&s.content)i=Pa.to_workbook(s.content,(e.type=a,e));else if((s=Pe.find(t,"NativeContent_MAIN"))&&s.content)i=Pa.to_workbook(s.content,(e.type=a,e));else throw(s=Pe.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Pe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=e9(t))}var o={};return t.FullPaths&&UU(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function WU(t,e){var r=e||{},n=Pe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pe.utils.cfb_add(n,i,tI(t,r)),r.biff==8&&(t.Props||t.Custprops)&&jU(t,n),r.biff==8&&t.vbaraw&&t9(n,Pe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var pu={0:{f:hB},1:{f:yB},2:{f:BB},3:{f:CB},4:{f:kB},5:{f:bB},6:{f:zB},7:{f:NB},8:{f:QB},9:{f:YB},10:{f:XB},11:{f:qB},12:{f:EB},13:{f:jB},14:{f:PB},15:{f:AB},16:{f:GA},17:{f:GB},18:{f:OB},19:{f:X1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:G7},40:{},42:{},43:{f:zM},44:{f:WM},45:{f:KM},46:{f:qM},47:{f:XM},48:{},49:{f:mL},50:{},51:{f:R5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gA},62:{f:HB},63:{f:V5},64:{f:d7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:c7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:_B},148:{f:mB,p:16},151:{f:n7},152:{},153:{f:H7},154:{},155:{},156:{f:j7},157:{},158:{},159:{T:1,f:sM},160:{T:-1},161:{T:1,f:ao},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:JB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:I5},336:{T:-1},337:{f:N5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:i7},427:{f:s7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:o7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:t7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:q5},633:{T:1},634:{T:-1},635:{T:1,f:K5},636:{T:-1},637:{f:xL},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:P7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:p7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vm={6:{f:ip},10:{f:_s},12:{f:Zt},13:{f:Zt},14:{f:zt},15:{f:zt},16:{f:Br},17:{f:zt},18:{f:zt},19:{f:Zt},20:{f:hw},21:{f:hw},23:{f:mA},24:{f:pw},25:{f:zt},26:{},27:{},28:{f:pb},29:{},34:{f:zt},35:{f:dw},38:{f:Br},39:{f:Br},40:{f:Br},41:{f:Br},42:{f:zt},43:{f:zt},47:{f:AM},49:{f:j8},51:{f:Zt},60:{},61:{f:b8},64:{f:zt},65:{f:U8},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:S8},93:{f:vb},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:gA},128:{f:rb},129:{f:I8},130:{f:Zt},131:{f:zt},132:{f:zt},133:{f:C8},134:{},140:{f:Sb},141:{f:Zt},144:{},146:{f:Cb},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:Lb},161:{f:Fb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:J8},190:{f:Z8},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:zt},222:{},224:{f:tb},225:{f:k8},226:{f:_s},227:{},229:{f:mb},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:P8},253:{f:H8},255:{f:N8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:ob},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:yb},439:{f:zt},440:{f:wb},441:{},442:{f:Hu},443:{},444:{f:Zt},445:{},446:{},448:{f:_s},449:{f:L8,r:2},450:{f:_s},512:{f:cw},513:{f:Ob},515:{f:sb},516:{f:$8},517:{f:fw},519:{f:bb},520:{f:D8},523:{},545:{f:mw},549:{f:lw},566:{},574:{f:V8},638:{f:Q8},659:{},1048:{},1054:{f:K8},1084:{},1212:{f:fb},2048:{f:Tb},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Vf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Rb,r:12},2173:{f:S5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ub,r:12},2197:{},2198:{f:x5,r:12},2199:{},2200:{},2201:{},2202:{f:hb,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:O8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Nb},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Ib},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cw},1:{},2:{f:jb},3:{f:Bb},4:{f:Vb},5:{f:fw},7:{f:Hb},8:{},9:{f:Vf},11:{},22:{f:Zt},30:{f:q8},31:{},32:{},33:{f:mw},36:{},37:{f:lw},50:{f:zb},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:Mb},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$b},223:{},234:{},354:{},421:{},518:{f:ip},521:{f:Vf},536:{f:pw},547:{f:dw},561:{},579:{},1030:{f:ip},1033:{f:Vf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function we(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&$1(r)&&t.push(r)}}function HU(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return we(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(f=t.next(4),f.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;f.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Ku(t,e,r){return t||(t=ae(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function zU(t,e,r,n){var i=ae(9);return Ku(i,t,e),oA(r,n||"b",i),i}function $U(t,e,r){var n=ae(8+2*r.length);return Ku(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function GU(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?ar(kt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?we(t,2,Wb(r,n,i)):we(t,3,Ub(r,n,i));return;case"b":case"e":we(t,5,zU(r,n,e.v,e.t));return;case"s":case"str":we(t,4,$U(r,n,(e.v||"").slice(0,255)));return}we(t,1,Ku(null,r,n))}function KU(t,e,r,n){var i=Array.isArray(e),s=tt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=We(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Kt(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=Ft(f)),a=l[f]+o;var h=i?(e[c]||[])[f]:e[a];h&&GU(t,h,c,f)}}}function XU(t,e){for(var r=e||{},n=dn(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return we(n,r.biff==4?1033:r.biff==3?521:9,tv(t,16,r)),KU(n,t.Sheets[t.SheetNames[i]],i,r),we(n,10),n.end()}function qU(t,e,r){we(t,49,W8({sz:12,name:"Arial"},r))}function YU(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&we(t,1054,X8(i,e[i],r))})}function QU(t,e){var r=ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),we(t,2151,r),r=ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),hA(tt(e["!ref"]||"A1"),r),r.write_shift(4,4),we(t,2152,r)}function JU(t,e){for(var r=0;r<16;++r)we(t,224,uw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){we(t,224,uw(n,0,e))})}function ZU(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];we(t,440,Eb(n)),n[1].Tooltip&&we(t,2048,kb(n))}delete e["!links"]}function ej(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&we(t,125,Pb(rd(i,n),i))})}}function tj(t,e,r,n,i){var s=16+la(i.cellXfs,e,i);if(e.v==null&&!e.bf){we(t,513,Xa(r,n,s));return}if(e.bf)we(t,6,IV(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?ar(kt(e.v)):e.v;we(t,515,ab(r,n,a,s));break;case"b":case"e":we(t,517,ib(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=cv(i.Strings,e.v,i.revStrings);we(t,253,z8(r,n,o,s))}else we(t,516,G8(r,n,(e.v||"").slice(0,255),s,i));break;default:we(t,513,Xa(r,n,s))}}function rj(t,e,r){var n=dn(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,f,h="",d=[],p=tt(s["!ref"]||"A1"),v=c?65536:16384;if(p.e.c>255||p.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}we(n,2057,tv(r,16,e)),we(n,13,Vn(1)),we(n,12,Vn(100)),we(n,15,qr(!0)),we(n,17,qr(!1)),we(n,16,Ga(.001)),we(n,95,qr(!0)),we(n,42,qr(!1)),we(n,43,qr(!1)),we(n,130,Vn(1)),we(n,128,nb()),we(n,131,qr(!1)),we(n,132,qr(!1)),c&&ej(n,s["!cols"]),we(n,512,Y8(p,e)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=Kt(m);for(var _=p.s.c;_<=p.e.c;++_){m===p.s.r&&(d[_]=Ft(_)),f=d[_]+h;var y=l?(s[m]||[])[_]:s[f];y&&(tj(n,y,m,_,e),c&&y.l&&s["!links"].push([f,y.l]))}}var E=o.CodeName||o.name||i;return c&&we(n,574,B8((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&we(n,229,gb(s["!merges"])),c&&ZU(n,s),we(n,442,lA(E)),c&&QU(n,s),we(n,10),n.end()}function nj(t,e,r){var n=dn(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(we(n,2057,tv(t,5,r)),r.bookType=="xla"&&we(n,135),we(n,225,o?Vn(1200):null),we(n,193,i8(2)),l&&we(n,191),l&&we(n,192),we(n,226),we(n,92,A8("SheetJS",r)),we(n,66,Vn(o?1200:1252)),o&&we(n,353,Vn(0)),o&&we(n,448),we(n,317,Db(t.SheetNames.length)),o&&t.vbaraw&&we(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";we(n,442,lA(c))}we(n,156,Vn(17)),we(n,25,qr(!1)),we(n,18,qr(!1)),we(n,19,Vn(0)),o&&we(n,431,qr(!1)),o&&we(n,444,Vn(0)),we(n,61,M8()),we(n,64,qr(!1)),we(n,141,Vn(0)),we(n,34,qr(L7(t)=="true")),we(n,14,qr(!0)),o&&we(n,439,qr(!1)),we(n,218,Vn(0)),qU(n,t,r),YU(n,t.SSF,r),JU(n,r),o&&we(n,352,qr(!1));var f=n.end(),h=dn();o&&we(h,140,Ab()),o&&r.Strings&&HU(h,252,F8(r.Strings)),we(h,10);var d=h.end(),p=dn(),v=0,m=0;for(m=0;m<t.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var _=f.length+v+d.length;for(m=0;m<t.SheetNames.length;++m){var y=s[m]||{};we(p,133,R8({pos:_,hs:y.Hidden||0,dt:0,name:t.SheetNames[m]},r)),_+=e[m].length}var E=p.end();if(v!=E.length)throw new Error("BS8 "+v+" != "+E.length);var x=[];return f.length&&x.push(f),E.length&&x.push(E),d.length&&x.push(d),fr(x)}function ij(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=St(De)),t&&t.SSF&&(Il(),qh(t.SSF),r.revssf=Qh(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pv(r),r.cellXfs=[],la(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=rj(i,r,t);return n.unshift(nj(t,n,r)),fr(n)}function tI(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=pn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return ij(t,e);case 4:case 3:case 2:return XU(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Sw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=W6(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<l.length;++a){var m=l[a].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var E=y[o].trim();if(E.match(/<t[dh]/i)){for(var x=E,F=0;x.charAt(0)=="<"&&(F=x.indexOf(">"))>-1;)x=x.slice(F+1);for(var U=0;U<v.length;++U){var b=v[U];b.s.c==f&&b.s.r<c&&c<=b.e.r&&(f=b.e.c+1,U=-1)}var w=Le(E.slice(0,E.indexOf(">")));d=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||d>1)&&v.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var k=w.t||w["data-t"]||"";if(!x.length){f+=d;continue}if(x=SS(x),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!x.length){f+=d;continue}var S={t:"s",v:x};r.raw||!x.trim().length||k=="s"||(x==="TRUE"?S={t:"b",v:!0}:x==="FALSE"?S={t:"b",v:!1}:isNaN(ii(x))?isNaN(gl(x).getDate())||(S={t:"d",v:kt(x)},r.cellDates||(S={t:"n",v:ar(S.v)}),S.z=r.dateNF||De[14]):S={t:"n",v:ii(x)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=S):n[Oe({r:c,c:f})]=S,f+=d}}}}return n["!ref"]=We(p),v.length&&(n["!merges"]=v),n}function sj(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=Oe({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||W1(h.w||(ss(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+f,s.push(ye("td",d,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var aj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',oj="</body></html>";function lj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return oa(Sw(r[0],e),e);var n=vv();return r.forEach(function(i,s){_v(n,Sw(i,e),"Sheet"+(s+1))}),n}function cj(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function rI(t,e){var r=e||{},n=r.header!=null?r.header:aj,i=r.footer!=null?r.footer:oj,s=[n],a=pn(t["!ref"]);r.dense=Array.isArray(t),s.push(cj(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(sj(t,a,o,r));return s.push("</table>"+i),s.join("")}function nI(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Nt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=pn(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),v=0,m=0,_=0,y=0,E=0,x=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&m<l;++v){var F=o[v];if(Aw(F)){if(n.display)continue;p[m]={hidden:!0}}var U=F.children;for(_=y=0;_<U.length;++_){var b=U[_];if(!(n.display&&Aw(b))){var w=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):SS(b.innerHTML),k=b.getAttribute("data-z")||b.getAttribute("z");for(d=0;d<h.length;++d){var S=h[d];S.s.c==y+s&&S.s.r<m+i&&m+i<=S.e.r&&(y=S.e.c+1-s,d=-1)}x=+b.getAttribute("colspan")||1,((E=+b.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:m+i,c:y+s},e:{r:m+i+(E||1)-1,c:y+s+(x||1)-1}});var C={t:"s",v:w},P=b.getAttribute("data-t")||b.getAttribute("t")||"";w!=null&&(w.length==0?C.t=P||"z":n.raw||w.trim().length==0||P=="s"||(w==="TRUE"?C={t:"b",v:!0}:w==="FALSE"?C={t:"b",v:!1}:isNaN(ii(w))?isNaN(gl(w).getDate())||(C={t:"d",v:kt(w)},n.cellDates||(C={t:"n",v:ar(C.v)}),C.z=n.dateNF||De[14]):C={t:"n",v:ii(w)})),C.z===void 0&&k!=null&&(C.z=k);var A="",R=b.getElementsByTagName("A");if(R&&R.length)for(var de=0;de<R.length&&!(R[de].hasAttribute("href")&&(A=R[de].getAttribute("href"),A.charAt(0)!="#"));++de);A&&A.charAt(0)!="#"&&(C.l={Target:A}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][y+s]=C):t[Oe({c:y+s,r:m+i})]=C,c.e.c<y+s&&(c.e.c=y+s),y+=x}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=We(c),m>=l&&(t["!fullref"]=We((c.e.r=o.length-v+m-1+i,c))),t}function iI(t,e){var r=e||{},n=r.dense?[]:{};return nI(n,t,e)}function uj(t,e){return oa(iI(t,e),e)}function Aw(t){var e="",r=fj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function fj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function hj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=et(e.replace(/<[^>]*>/g,""));return[r]}var Iw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function sI(t,e){var r=e||{},n=H1(t),i=[],s,a,o={name:""},l="",c=0,f,h,d={},p=[],v=r.dense?[]:{},m,_,y={value:""},E="",x=0,F=[],U=-1,b=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},C=[],P={},A=0,R=0,de=[],ue=1,Z=1,te=[],re={Names:[]},H={},se=["",""],oe=[],L={},K="",z=0,G=!1,ee=!1,me=0;for(lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=lu.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?v["!ref"]=We(w):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(v["!fullref"]=v["!ref"],w.e.r=r.sheetRows-1,v["!ref"]=We(w)),C.length&&(v["!merges"]=C),de.length&&(v["!rows"]=de),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),d[f.name]=v,ee=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Le(m[0],!1),U=b=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,v=r.dense?[]:{},C=[],de=[],ee=!0);break;case"table-row-group":m[1]==="/"?--k:++k;break;case"table-row":case"":if(m[1]==="/"){U+=ue,ue=1;break}if(h=Le(m[0],!1),h.?U=h.-1:U==-1&&(U=0),ue=+h["number-rows-repeated"]||1,ue<10)for(me=0;me<ue;++me)k>0&&(de[U+me]={level:k});b=-1;break;case"covered-table-cell":m[1]!=="/"&&++b,r.sheetStubs&&(r.dense?(v[U]||(v[U]=[]),v[U][b]={t:"z"}):v[Oe({r:U,c:b})]={t:"z"}),E="",F=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++b,y=Le(m[0],!1),Z=parseInt(y["number-columns-repeated"]||"1",10),_={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(_.f=Ew(et(y.formula))),(y.||y["value-type"])=="string"&&(_.t="s",_.v=et(y["string-value"]||""),r.dense?(v[U]||(v[U]=[]),v[U][b]=_):v[Oe({r:U,c:b})]=_),b+=Z-1;else if(m[1]!=="/"){++b,E="",x=0,F=[],Z=1;var xe=ue?U+ue-1:U;if(b>w.e.c&&(w.e.c=b),b<w.s.c&&(w.s.c=b),U<w.s.r&&(w.s.r=U),xe>w.e.r&&(w.e.r=xe),y=Le(m[0],!1),oe=[],L={},_={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=et(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(A=parseInt(y["number-matrix-rows-spanned"],10)||0,R=parseInt(y["number-matrix-columns-spanned"],10)||0,P={s:{r:U,c:b},e:{r:U+A-1,c:b+R-1}},_.F=We(P),te.push([P,_.F])),y.formula)_.f=Ew(y.formula);else for(me=0;me<te.length;++me)U>=te[me][0].s.r&&U<=te[me][0].e.r&&b>=te[me][0].s.c&&b<=te[me][0].e.c&&(_.F=te[me][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(A=parseInt(y["number-rows-spanned"],10)||0,R=parseInt(y["number-columns-spanned"],10)||0,P={s:{r:U,c:b},e:{r:U+A-1,c:b+R-1}},C.push(P)),y["number-columns-repeated"]&&(Z=parseInt(y["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=wt(y["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(y.value);break;case"percentage":_.t="n",_.v=parseFloat(y.value);break;case"currency":_.t="n",_.v=parseFloat(y.value);break;case"date":_.t="d",_.v=kt(y["date-value"]),r.cellDates||(_.t="n",_.v=ar(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=B6(y["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Jh(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(y.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",y["string-value"]!=null&&(E=et(y["string-value"]),F=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(G=!1,_.t==="s"&&(_.v=E||"",F.length&&(_.R=F),G=x==0),H.Target&&(_.l=H),oe.length>0&&(_.c=oe,oe=[]),E&&r.cellText!==!1&&(_.w=E),G&&(_.t="z",delete _.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=U))for(var ge=0;ge<ue;++ge){if(Z=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(v[U+ge]||(v[U+ge]=[]),v[U+ge][b]=ge==0?_:St(_);--Z>0;)v[U+ge][b+Z]=St(_);else for(v[Oe({r:U+ge,c:b})]=_;--Z>0;)v[Oe({r:U+ge,c:b+Z})]=St(_);w.e.c<=b&&(w.e.c=b)}Z=parseInt(y["number-columns-repeated"]||"1",10),b+=Z-1,Z=0,_={},E="",F=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;L.t=E,F.length&&(L.R=F),L.a=K,oe.push(L)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);K="",z=0,E="",x=0,F=[];break;case"creator":m[1]==="/"?K=n.slice(z,m.index):z=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);E="",x=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Le(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Le(m[0],!1),l+=Iw[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Le(m[0],!1),l+=Iw[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":a=Le(m[0],!1),se=sp(a["cell-range-address"]);var fe={Name:a.name,Ref:se[0]+"!"+se[1]};ee&&(fe.Sheet=p.length),re.Names.push(fe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var Be=hj(n.slice(x,m.index));E=(E.length>0?E+`
`:"")+Be[0]}else Le(m[0],!1),x=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{se=sp(Le(m[0])["target-range-address"]),d[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(H=Le(m[0],!1),!H.href)break;H.Target=et(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(se=sp(H.Target.slice(1)),H.Target="#"+se[0]+"!"+se[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var W={Sheets:d,SheetNames:p,Workbook:re};return r.bookSheets&&delete W.Sheets,W}function Cw(t,e){e=e||{},Mn(t,"META-INF/manifest.xml")&&BL(Jt(t,"META-INF/manifest.xml"),e);var r=En(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=sI(pt(r),e);return Mn(t,"meta.xml")&&(n.Props=qS(Jt(t,"meta.xml"))),n}function Rw(t,e){return sI(t,e)}var dj=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ou({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xt+e}}(),Pw=function(){var t=function(s){return ut(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+ut(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=pn(s["!ref"]||"A1"),d=s["!merges"]||[],p=0,v=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",_=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)l.push(e);for(;f<=h.e.c;++f){var y=!1,E={},x="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>f)&&!(d[p].s.r>c)&&!(d[p].e.c<f)&&!(d[p].e.r<c)){(d[p].s.c!=f||d[p].s.r!=c)&&(y=!0),E["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,E["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(y){l.push(r);continue}var F=Oe({r:c,c:f}),U=v?(s[c]||[])[f]:s[F];if(U&&U.f&&(E["table:formula"]=ut(DV(U.f)),U.F&&U.F.slice(0,F.length)==F)){var b=pn(U.F);E["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,E["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(!U){l.push(e);continue}switch(U.t){case"b":x=U.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=U.v?"true":"false";break;case"n":x=U.w||String(U.v||0),E["office:value-type"]="float",E["office:value"]=U.v||0;break;case"s":case"str":x=U.v==null?"":U.v,E["office:value-type"]="string";break;case"d":x=U.w||kt(U.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=kt(U.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(x);if(U.l&&U.l.Target){var k=U.l.Target;k=k.charAt(0)=="#"?"#"+OV(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),w=ye("text:a",w,{"xlink:href":k.replace(/&/g,"&amp;")})}l.push("          "+ye("table:table-cell",ye("text:p",w,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Js(h),h.ods=o;var d=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var h=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Xt],c=ou({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=ou({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(XS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function aI(t,e){if(e.bookType=="fods")return Pw(t,e);var r=B1(),n="",i=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,Pw(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,dj(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,Xt+XS()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,WL(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,UL(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function qa(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Bm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):pt(aa(t))}function pj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):wn(_i(t))}function mj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ea(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Fw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function gj(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function vj(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function mu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function lt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function jt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function nt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=mu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=mu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function vr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(lt(n*8+i.type)),i.type==2&&e.push(lt(i.data.length)),e.push(i.data))})}),ea(e)}function hv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Ln(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=mu(t,n),s=nt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:jt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=nt(o.data),c=jt(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=jt(s[3][0].data)>>>0>0),r.push(a)}return r}function _o(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:lt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:lt(a.data.length)}],n[2].push({data:vr(a.meta),type:2})});var s=vr(n);e.push(lt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),ea(e)}function _j(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=mu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ea(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var f=ea(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function bn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(_j(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ea(e)}function xo(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=lt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return ea(e)}function xj(t,e,r,n){var i=qa(t),s=i.getUint32(4,!0),a=(n>1?12:8)+Fw(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Fw(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function yj(t,e,r){var n=qa(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);i&1&&(l=gj(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function op(t,e){var r=new Uint8Array(32),n=qa(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,vj(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function lp(t,e){var r=new Uint8Array(32),n=qa(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function wj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return xj(t,e,r,t[0]);case 5:return yj(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Or(t){var e=nt(t);return mu(e[1][0].data)}function Nw(t,e){var r=nt(e.data),n=jt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=nt(a.data),l=jt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Bm(o[3][0].data);break;case 8:{var c=t[Or(o[9][0].data)][0],f=nt(c.data),h=t[Or(f[1][0].data)][0],d=jt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=nt(h.data);s[l]=p[3].map(function(v){return Bm(v.data)}).join("")}break}}),s}function Ej(t,e){var r,n,i,s,a,o,l,c,f,h,d,p,v,m,_=nt(t),y=jt(_[1][0].data)>>>0,E=jt(_[2][0].data)>>>0,x=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&jt(_[8][0].data)>0||!1,F,U;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)F=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,U=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=_[4])==null?void 0:f[0])!=null&&h.data&&e!=1)F=(p=(d=_[4])==null?void 0:d[0])==null?void 0:p.data,U=(m=(v=_[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var b=x?4:1,w=qa(F),k=[],S=0;S<F.length/2;++S){var C=w.getUint16(S*2,!0);C<65535&&k.push([S,C])}if(k.length!=E)throw"Expected ".concat(E," cells, found ").concat(k.length);var P=[];for(S=0;S<k.length-1;++S)P[k[S][0]]=U.subarray(k[S][1]*b,k[S+1][1]*b);return k.length>=1&&(P[k[k.length-1][0]]=U.subarray(k[k.length-1][1]*b)),{R:y,cells:P}}function Tj(t,e){var r,n=nt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?jt(n[7][0].data)>>>0>0?1:0:-1,s=hv(n[5],function(a){return Ej(a,i)});return{nrows:jt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function kj(t,e,r){var n,i=nt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(jt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(jt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=We(s);var a=nt(i[4][0].data),o=Nw(t,t[Or(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Nw(t,t[Or(a[17][0].data)][0]):[],c=nt(a[3][0].data),f=0;c[1].forEach(function(h){var d=nt(h.data),p=t[Or(d[2][0].data)][0],v=jt(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=Tj(t,p);m.data.forEach(function(_,y){_.forEach(function(E,x){var F=Oe({r:f+y,c:x}),U=wj(E,o,l);U&&(r[F]=U)})}),f+=m.nrows})}function Sj(t,e){var r=nt(e.data),n={"!ref":"A1"},i=t[Or(r[2][0].data)],s=jt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return kj(t,i[0],n),n}function Aj(t,e){var r,n=nt(e.data),i={name:(r=n[1])!=null&&r[0]?Bm(n[1][0].data):"",sheets:[]},s=hv(n[2],Or);return s.forEach(function(a){t[a].forEach(function(o){var l=jt(o.meta[1][0].data);l==6e3&&i.sheets.push(Sj(t,o))})}),i}function Ij(t,e){var r=vv(),n=nt(e.data),i=hv(n[1],Or);if(i.forEach(function(s){t[s].forEach(function(a){var o=jt(a.meta[1][0].data);if(o==2){var l=Aj(t,a);l.sheets.forEach(function(c,f){_v(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function cp(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=bn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=Ln(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&jt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var f=jt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Ij(s,o)}function Cj(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&jt(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=qa(t[7][0].data),f=0,h=[],d=qa(t[4][0].data),p=0,v=[],m=0;m<e.length;++m){if(e[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,f,!0),d.setUint16(m*2,p,!0);var _,y;switch(typeof e[m]){case"string":_=op({t:"s",v:e[m]},r),y=lp({t:"s",v:e[m]},r);break;case"number":_=op({t:"n",v:e[m]},r),y=lp({t:"n",v:e[m]},r);break;case"boolean":_=op({t:"b",v:e[m]},r),y=lp({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(_),f+=_.length,v.push(y),p+=y.length,++l}for(t[2][0].data=lt(l);m<t[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return t[6][0].data=ea(h),t[3][0].data=ea(v),l}function Rj(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=pn(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(We(n)));var s=hh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(K){return K.forEach(function(z){typeof z=="string"&&a.push(z)})});var o={},l=[],c=Pe.read(e.numbers,{type:"base64"});c.FileIndex.map(function(K,z){return[K,c.FullPaths[z]]}).forEach(function(K){var z=K[0],G=K[1];if(z.type==2&&z.name.match(/\.iwa/)){var ee=z.content,me=bn(ee),xe=Ln(me);xe.forEach(function(ge){l.push(ge.id),o[ge.id]={deps:[],location:G,type:jt(ge.messages[0].meta[1][0].data)}})}}),l.sort(function(K,z){return K-z});var f=l.filter(function(K){return K>1}).map(function(K){return[K,lt(K)]});c.FileIndex.map(function(K,z){return[K,c.FullPaths[z]]}).forEach(function(K){var z=K[0];if(K[1],!!z.name.match(/\.iwa/)){var G=Ln(bn(z.content));G.forEach(function(ee){ee.messages.forEach(function(me){f.forEach(function(xe){ee.messages.some(function(ge){return jt(ge.meta[1][0].data)!=11006&&mj(ge.data,xe[1])})&&o[xe[0]].deps.push(ee.id)})})})}});for(var h=Pe.find(c,o[1].location),d=Ln(bn(h.content)),p,v=0;v<d.length;++v){var m=d[v];m.id==1&&(p=m)}var _=Or(nt(p.messages[0].data)[1][0].data);for(h=Pe.find(c,o[_].location),d=Ln(bn(h.content)),v=0;v<d.length;++v)m=d[v],m.id==_&&(p=m);for(_=Or(nt(p.messages[0].data)[2][0].data),h=Pe.find(c,o[_].location),d=Ln(bn(h.content)),v=0;v<d.length;++v)m=d[v],m.id==_&&(p=m);for(_=Or(nt(p.messages[0].data)[2][0].data),h=Pe.find(c,o[_].location),d=Ln(bn(h.content)),v=0;v<d.length;++v)m=d[v],m.id==_&&(p=m);var y=nt(p.messages[0].data);{y[6][0].data=lt(n.e.r+1),y[7][0].data=lt(n.e.c+1);var E=Or(y[46][0].data),x=Pe.find(c,o[E].location),F=Ln(bn(x.content));{for(var U=0;U<F.length&&F[U].id!=E;++U);if(F[U].id!=E)throw"Bad ColumnRowUIDMapArchive";var b=nt(F[U].messages[0].data);b[1]=[],b[2]=[],b[3]=[];for(var w=0;w<=n.e.c;++w){var k=[];k[1]=k[2]=[{type:0,data:lt(w+420690)}],b[1].push({type:2,data:vr(k)}),b[2].push({type:0,data:lt(w)}),b[3].push({type:0,data:lt(w)})}b[4]=[],b[5]=[],b[6]=[];for(var S=0;S<=n.e.r;++S)k=[],k[1]=k[2]=[{type:0,data:lt(S+726270)}],b[4].push({type:2,data:vr(k)}),b[5].push({type:0,data:lt(S)}),b[6].push({type:0,data:lt(S)});F[U].messages[0].data=vr(b)}x.content=xo(_o(F)),x.size=x.content.length,delete y[46];var C=nt(y[4][0].data);{C[7][0].data=lt(n.e.r+1);var P=nt(C[1][0].data),A=Or(P[2][0].data);x=Pe.find(c,o[A].location),F=Ln(bn(x.content));{if(F[0].id!=A)throw"Bad HeaderStorageBucket";var R=nt(F[0].messages[0].data);for(S=0;S<s.length;++S){var de=nt(R[2][0].data);de[1][0].data=lt(S),de[4][0].data=lt(s[S].length),R[2][S]={type:R[2][0].type,data:vr(de)}}F[0].messages[0].data=vr(R)}x.content=xo(_o(F)),x.size=x.content.length;var ue=Or(C[2][0].data);x=Pe.find(c,o[ue].location),F=Ln(bn(x.content));{if(F[0].id!=ue)throw"Bad HeaderStorageBucket";for(R=nt(F[0].messages[0].data),w=0;w<=n.e.c;++w)de=nt(R[2][0].data),de[1][0].data=lt(w),de[4][0].data=lt(n.e.r+1),R[2][w]={type:R[2][0].type,data:vr(de)};F[0].messages[0].data=vr(R)}x.content=xo(_o(F)),x.size=x.content.length;var Z=Or(C[4][0].data);(function(){for(var K=Pe.find(c,o[Z].location),z=Ln(bn(K.content)),G,ee=0;ee<z.length;++ee){var me=z[ee];me.id==Z&&(G=me)}var xe=nt(G.messages[0].data);{xe[3]=[];var ge=[];a.forEach(function(W,at){ge[1]=[{type:0,data:lt(at)}],ge[2]=[{type:0,data:lt(1)}],ge[3]=[{type:2,data:pj(W)}],xe[3].push({type:2,data:vr(ge)})})}G.messages[0].data=vr(xe);var fe=_o(z),Be=xo(fe);K.content=Be,K.size=K.content.length})();var te=nt(C[3][0].data);{var re=te[1][0];delete te[2];var H=nt(re.data);{var se=Or(H[2][0].data);(function(){for(var K=Pe.find(c,o[se].location),z=Ln(bn(K.content)),G,ee=0;ee<z.length;++ee){var me=z[ee];me.id==se&&(G=me)}var xe=nt(G.messages[0].data);{delete xe[6],delete te[7];var ge=new Uint8Array(xe[5][0].data);xe[5]=[];for(var fe=0,Be=0;Be<=n.e.r;++Be){var W=nt(ge);fe+=Cj(W,s[Be],a),W[1][0].data=lt(Be),xe[5].push({data:vr(W),type:2})}xe[1]=[{type:0,data:lt(n.e.c+1)}],xe[2]=[{type:0,data:lt(n.e.r+1)}],xe[3]=[{type:0,data:lt(fe)}],xe[4]=[{type:0,data:lt(n.e.r+1)}]}G.messages[0].data=vr(xe);var at=_o(z),Ke=xo(at);K.content=Ke,K.size=K.content.length})()}re.data=vr(H)}C[3][0].data=vr(te)}y[4][0].data=vr(C)}p.messages[0].data=vr(y);var oe=_o(d),L=xo(oe);return h.content=L,h.size=h.content.length,c}function oI(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function dv(t){oI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function pv(t){oI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Pj(t){return Xe.WS.indexOf(t)>-1?"sheet":t==Xe.CS?"chart":t==Xe.DS?"dialog":t==Xe.MS?"macro":t&&t.length?t:"sheet"}function Fj(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Pj(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Nj(t,e,r,n,i,s,a,o,l,c,f,h){try{s[n]=Ic(En(t,r,!0),e);var d=Jt(t,e),p;switch(o){case"sheet":p=eU(d,e,i,l,s[n],c,f,h);break;case"chart":if(p=tU(d,e,i,l,s[n],c,f,h),!p||!p["!drawel"])break;var v=cc(p["!drawel"].Target,e),m=cu(v),_=j5(En(t,v,!0),Ic(En(t,m,!0),v)),y=cc(_,v),E=cu(y);p=C7(En(t,y,!0),y,l,Ic(En(t,E,!0),y),c,p);break;case"macro":p=rU(d,e,i,l,s[n],c,f,h);break;case"dialog":p=nU(d,e,i,l,s[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var x=[];s&&s[n]&&Wt(s[n]).forEach(function(F){var U="";if(s[n][F].Type==Xe.CMNT){U=cc(s[n][F].Target,e);var b=oU(Jt(t,U,!0),U,l);if(!b||!b.length)return;vw(p,b,!1)}s[n][F].Type==Xe.TCMNT&&(U=cc(s[n][F].Target,e),x=x.concat(H5(Jt(t,U,!0),l)))}),x&&x.length&&vw(p,x,!0,l.people||[])}catch(F){if(l.WTF)throw F}}function Dn(t){return t.charAt(0)=="/"?t.slice(1):t}function Dj(t,e){if(Il(),e=e||{},dv(e),Mn(t,"META-INF/manifest.xml")||Mn(t,"objectdata.xml"))return Cw(t,e);if(Mn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof cp<"u"){if(t.FileIndex)return cp(t);var r=Pe.utils.cfb_new();return Vy(t).forEach(function(de){ze(r,de,z6(t,de))}),cp(r)}throw new Error("Unsupported NUMBERS file")}if(!Mn(t,"[Content_Types].xml"))throw Mn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Mn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Vy(t),i=ML(En(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Jt(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Jt(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Cc=[],i.sst)try{Cc=aU(Jt(t,Dn(i.sst)),i.sst,e)}catch(de){if(e.WTF)throw de}e.cellStyles&&i.themes.length&&(l=sU(En(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=iU(Jt(t,Dn(i.style)),i.style,l,e))}i.links.map(function(de){try{var ue=Ic(En(t,cu(Dn(de))),de);return cU(Jt(t,Dn(de)),ue,de,e)}catch{}});var f=Z7(Jt(t,Dn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=Jt(t,Dn(i.coreprops[0]),!0),d&&(h=qS(d)),i.extprops.length!==0&&(d=Jt(t,Dn(i.extprops[0]),!0),d&&zL(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=En(t,Dn(i.custprops[0]),!0),d&&(p=GL(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(ue){return ue.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(v.Props=h,v.Custprops=p),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var m={};e.bookDeps&&i.calcchain&&(m=lU(Jt(t,Dn(i.calcchain)),i.calcchain));var _=0,y={},E,x;{var F=f.Sheets;h.Worksheets=F.length,h.SheetNames=[];for(var U=0;U!=F.length;++U)h.SheetNames[U]=F[U].name}var b=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");Mn(t,k)||(k="xl/_rels/workbook."+b+".rels");var S=Ic(En(t,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=uU(Jt(t,Dn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=$5(Jt(t,Dn(i.people[0])),e)),S&&(S=Fj(S,f.Sheets));var C=Jt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=h.Worksheets;++_){var P="sheet";if(S&&S[_]?(E="xl/"+S[_][1].replace(/[\/]?xl\//,""),Mn(t,E)||(E=S[_][1]),Mn(t,E)||(E=k.replace(/_rels\/.*$/,"")+S[_][1]),P=S[_][2]):(E="xl/worksheets/sheet"+(_+1-C)+"."+b,E=E.replace(/sheet0\./,"sheet.")),x=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(h.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var A=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==_&&(A=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[_].toLowerCase()&&(A=1);if(!A)continue e}}Nj(t,E,x,h.SheetNames[_],_,y,a,P,e,f,l,c)}return v={Directory:i,Workbook:f,Props:h,Custprops:p,Deps:m,Sheets:a,SheetNames:h.SheetNames,Strings:Cc,Styles:c,Themes:l,SSF:St(De)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(de,ue){de=de.replace(/^Root Entry[\/]/,""),v.keys.push(de),v.files[de]=t.FileIndex[ue]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=Jt(t,Dn(i.vba[0]),!0):i.defaults&&i.defaults.bin===Z5&&(v.vbaraw=Jt(t,"xl/vbaProject.bin",!0))),v}function Oj(t,e){var r=e||{},n="Workbook",i=Pe.find(t,n);try{if(n="/!DataSpaces/Version",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(uM(i.content),n="/!DataSpaces/DataSpaceMap",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=hM(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=dM(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);mM(i.content)}catch{}if(n="/EncryptionInfo",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=gM(i.content);if(n="/EncryptedPackage",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Lj(t,e){return e.bookType=="ods"?aI(t,e):e.bookType=="numbers"?Rj(t,e):e.bookType=="xlsb"?bj(t,e):Mj(t,e)}function bj(t,e){Vo=1024,t&&!t.SSF&&(t.SSF=St(De)),t&&t.SSF&&(Il(),qh(t.SSF),e.revssf=Qh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=OA.indexOf(e.bookType)>-1,i=Z1();pv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],la(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,YS(t.Props,e)),i.coreprops.push(a),ct(e.rels,2,a,Xe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,ZS(t.Props)),i.extprops.push(a),ct(e.rels,3,a,Xe.EXT_PROPS),t.Custprops!==t.Props&&Wt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,eA(t.Custprops)),i.custprops.push(a),ct(e.rels,4,a,Xe.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,hU(o-1,a,e,t,f)),i.sheets.push(a),ct(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Xe.WS[0])}if(h){var p=h["!comments"],v=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,ze(s,m,mU(p,m)),i.comments.push(m),ct(f,-1,"../comments"+o+"."+r,Xe.CMNT),v=!0),h["!legacy"]&&v&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",NA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&ze(s,cu(a),Yo(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,pU(e.Strings,a,e)),i.strs.push(a),ct(e.wbrels,-1,"sharedStrings."+r,Xe.SST)),a="xl/workbook."+r,ze(s,a,fU(t,a)),i.workbooks.push(a),ct(e.rels,1,a,Xe.WB),a="xl/theme/theme1.xml",ze(s,a,sv(t.Themes,e)),i.themes.push(a),ct(e.wbrels,-1,"theme/theme1.xml",Xe.THEME),a="xl/styles."+r,ze(s,a,dU(t,a,e)),i.styles.push(a),ct(e.wbrels,-1,"styles."+r,Xe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ct(e.wbrels,-1,"vbaProject.bin",Xe.VBA)),a="xl/metadata."+r,ze(s,a,gU(a)),i.metadata.push(a),ct(e.wbrels,-1,"metadata."+r,Xe.XLMETA),ze(s,"[Content_Types].xml",KS(i,e)),ze(s,"_rels/.rels",Yo(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",Yo(e.wbrels)),delete e.revssf,delete e.ssf,s}function Mj(t,e){Vo=1024,t&&!t.SSF&&(t.SSF=St(De)),t&&t.SSF&&(Il(),qh(t.SSF),e.revssf=Qh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=OA.indexOf(e.bookType)>-1,i=Z1();pv(e=e||{});var s=B1(),a="",o=0;if(e.cellXfs=[],la(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",ze(s,a,YS(t.Props,e)),i.coreprops.push(a),ct(e.rels,2,a,Xe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,ze(s,a,ZS(t.Props)),i.extprops.push(a),ct(e.rels,3,a,Xe.EXT_PROPS),t.Custprops!==t.Props&&Wt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",ze(s,a,eA(t.Custprops)),i.custprops.push(a),ct(e.rels,4,a,Xe.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ze(s,a,$A(o-1,e,t,h)),i.sheets.push(a),ct(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Xe.WS[0])}if(d){var v=d["!comments"],m=!1,_="";if(v&&v.length>0){var y=!1;v.forEach(function(E){E[1].forEach(function(x){x.T==!0&&(y=!0)})}),y&&(_="xl/threadedComments/threadedComment"+o+"."+r,ze(s,_,z5(v,f,e)),i.threadedcomments.push(_),ct(h,-1,"../threadedComments/threadedComment"+o+"."+r,Xe.TCMNT)),_="xl/comments"+o+"."+r,ze(s,_,DA(v)),i.comments.push(_),ct(h,-1,"../comments"+o+"."+r,Xe.CMNT),m=!0}d["!legacy"]&&m&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",NA(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&ze(s,cu(a),Yo(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,ze(s,a,yA(e.Strings,e)),i.strs.push(a),ct(e.wbrels,-1,"sharedStrings."+r,Xe.SST)),a="xl/workbook."+r,ze(s,a,YA(t)),i.workbooks.push(a),ct(e.rels,1,a,Xe.WB),a="xl/theme/theme1.xml",ze(s,a,sv(t.Themes,e)),i.themes.push(a),ct(e.wbrels,-1,"theme/theme1.xml",Xe.THEME),a="xl/styles."+r,ze(s,a,CA(t,e)),i.styles.push(a),ct(e.wbrels,-1,"styles."+r,Xe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",ze(s,a,t.vbaraw),i.vba.push(a),ct(e.wbrels,-1,"vbaProject.bin",Xe.VBA)),a="xl/metadata."+r,ze(s,a,FA()),i.metadata.push(a),ct(e.wbrels,-1,"metadata."+r,Xe.XLMETA),f.length>1&&(a="xl/persons/person.xml",ze(s,a,G5(f)),i.people.push(a),ct(e.wbrels,-1,"persons/person.xml",Xe.PEOPLE)),ze(s,"[Content_Types].xml",KS(i,e)),ze(s,"_rels/.rels",Yo(e.rels)),ze(s,"xl/_rels/workbook."+r+".rels",Yo(e.wbrels)),delete e.revssf,delete e.ssf,s}function mv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=In(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Vj(t,e){return Pe.find(t,"EncryptedPackage")?Oj(t,e):eI(t,e)}function Bj(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ge&&Buffer.isBuffer(t)?"buffer":"base64"),r=ES(n,i),Dj(r,i)}function lI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Mm(t.slice(r),e);default:break e}return vl.to_workbook(t,e)}function Uj(t,e){var r="",n=mv(t,e);switch(e.type){case"base64":r=In(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=$a(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pt(r)),e.type="binary",lI(r,e)}function jj(t,e){var r=t;return e.type=="base64"&&(r=In(r)),r=nu.utils.decode(1200,r.slice(2),"str"),e.type="binary",lI(r,e)}function Wj(t){return t.match(/[^\x00-\x7F]/)?_i(t):t}function up(t,e,r,n){return n?(r.type="string",vl.to_workbook(t,r)):vl.to_workbook(e,r)}function fh(t,e){O1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return fh(new Uint8Array(t),(r=St(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Jo={},r.dateNF&&(Jo.dateNF=r.dateNF),r.type||(r.type=Ge&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ge?"buffer":"binary",n=b6(t),typeof Uint8Array<"u"&&!Ge&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Wj(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=St(r),r.type="array",fh(L1(n),r)}switch((i=mv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Vj(Pe.read(n,r),r);break;case 9:if(i[1]<=8)return eI(n,r);break;case 60:return Mm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Kb(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return _A.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?Bj(n,r):up(t,n,r,s);case 239:return i[3]===60?Mm(n,r):up(t,n,r,s);case 255:if(i[1]===254)return jj(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Pa.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Pa.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return bm.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return SA.to_workbook(n,r);break;case 10:case 13:case 32:return Uj(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Gb.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?bm.to_workbook(n,r):up(t,n,r,s)}function cI(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Uu(e.file,Pe.write(t,{type:Ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pe.write(t,e)}function Hj(t,e){var r=St(e||{}),n=Lj(t,r);return zj(n,r)}function zj(t,e){var r={},n=Ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Pe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Xh(i))}return e.password&&typeof encrypt_agile<"u"?cI(encrypt_agile(i,e.password),e):e.type==="file"?Uu(e.file,i):e.type=="string"?pt(i):i}function $j(t,e){var r=e||{},n=WU(t,r);return cI(n,r)}function pi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return iu(_i(n));case"binary":return _i(n);case"string":return t;case"file":return Uu(e.file,n,"utf8");case"buffer":return Ge?cs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pi(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Gj(t,e){switch(e.type){case"base64":return iu(t);case"binary":return t;case"string":return t;case"file":return Uu(e.file,t,"binary");case"buffer":return Ge?cs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Wf(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?iu(r):e.type=="string"?pt(r):r;case"file":return Uu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function uI(t,e){O1(),V7(t);var r=St(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=uI(t,r);return r.type="array",Xh(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return pi(LU(t,r),r);case"slk":case"sylk":return pi(vA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return pi(rI(t.Sheets[t.SheetNames[i]],r),r);case"txt":return Gj(hI(t.Sheets[t.SheetNames[i]],r),r);case"csv":return pi(gv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return pi(_A.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Wf(bm.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return pi(vl.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return pi(SA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return pi(xA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return pi(aI(t,r),r);case"wk1":return Wf(Pa.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Wf(Pa.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Wf(tI(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),$j(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Hj(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Kj(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function fI(t,e,r){var n={};return n.type="file",n.file=e,Kj(n),uI(t,n)}function Xj(t,e,r,n,i,s,a,o){var l=Kt(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var v=a?t[r][p]:t[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(f&&m===null)d[s[p]]=null;else continue;else d[s[p]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:ss(v,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function hh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=tt(f);break;case"number":l=tt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var h=Kt(l.s.r),d=[],p=[],v=0,m=0,_=Array.isArray(t),y=l.s.r,E=0,x={};_&&!t[y]&&(t[y]=[]);var F=c.skipHidden&&t["!cols"]||[],U=c.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(F[E]||{}).hidden)switch(d[E]=Ft(E),r=_?t[y][E]:t[d[E]+h],n){case 1:s[E]=E-l.s.c;break;case 2:s[E]=d[E];break;case 3:s[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ss(r,null,c),m=x[a]||0,!m)x[a]=1;else{do o=a+"_"+m++;while(x[o]);x[a]=m,x[o]=1}s[E]=o}for(y=l.s.r+i;y<=l.e.r;++y)if(!(U[y]||{}).hidden){var b=Xj(t,l,y,d,n,s,_,c);(b.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=b.row)}return p.length=v,p}var Dw=/"/g;function qj(t,e,r,n,i,s,a,o){for(var l=!0,c=[],f="",h=Kt(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:ss(p,null,o));for(var v=0,m=0;v!==f.length;++v)if((m=f.charCodeAt(v))===i||m===s||m===34||o.forceQuotes){f='"'+f.replace(Dw,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Dw,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function gv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=tt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(d[v]||{}).hidden||(h[v]=Ft(v));for(var m=0,_=i.s.r;_<=i.e.r;++_)(p[_]||{}).hidden||(f=qj(t,i,_,h,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function hI(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=gv(t,e);return r}function Yj(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=tt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ft(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=Kt(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function dI(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Nt(n.origin):n.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=tt(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,_){Wt(m).forEach(function(y){(p=d.indexOf(y))==-1&&(d[p=d.length]=y);var E=m[y],x="z",F="",U=Oe({c:o+p,r:a+_+i});c=gu(s,U),E&&typeof E=="object"&&!(E instanceof Date)?s[U]=E:(typeof E=="number"?x="n":typeof E=="boolean"?x="b":typeof E=="string"?x="s":E instanceof Date?(x="d",n.cellDates||(x="n",E=ar(E)),F=n.dateNF||De[14]):E===null&&n.nullError&&(x="e",E=0),c?(c.t=x,c.v=E,delete c.w,delete c.R,F&&(c.z=F)):s[U]=c={t:x,v:E},F&&(c.z=F))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var v=Kt(a);if(i)for(p=0;p<d.length;++p)s[Ft(p+o)+v]={t:"s",v:d[p]};return s["!ref"]=We(f),s}function Qj(t,e){return dI(null,t,e)}function gu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Nt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?gu(t,Oe(e)):gu(t,Oe({r:e,c:r||0}))}function Jj(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function vv(){return{SheetNames:[],Sheets:{}}}function _v(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(qA(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Zj(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Jj(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function eW(t,e){return t.z=e,t}function pI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function tW(t,e,r){return pI(t,"#"+e,r)}function rW(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function nW(t,e,r,n){for(var i=typeof e!="string"?e:tt(e),s=typeof e=="string"?e:We(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=gu(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Na={encode_col:Ft,encode_row:Kt,encode_cell:Oe,encode_range:We,decode_col:K1,decode_row:G1,split_cell:pL,decode_cell:Nt,decode_range:pn,format_cell:ss,sheet_add_aoa:US,sheet_add_json:dI,sheet_add_dom:nI,aoa_to_sheet:Cl,json_to_sheet:Qj,table_to_sheet:iI,table_to_book:uj,sheet_to_csv:gv,sheet_to_txt:hI,sheet_to_json:hh,sheet_to_html:rI,sheet_to_formulae:Yj,sheet_to_row_object_array:hh,sheet_get_cell:gu,book_new:vv,book_append_sheet:_v,book_set_sheet_visibility:Zj,cell_set_number_format:eW,cell_set_hyperlink:pI,cell_set_internal_link:tW,cell_add_comment:rW,sheet_set_array_formula:nW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iW={apiKey:"AIzaSyBSYlhken9G5cTpzmQCDA1tUGTo5ztr2gI",authDomain:"appchamcong-2ef18.firebaseapp.com",projectId:"appchamcong-2ef18",storageBucket:"appchamcong-2ef18.firebasestorage.app",messagingSenderId:"651193311180",appId:"1:651193311180:web:2ca1d59ad92e7ddd628769",measurementId:"G-RZWQEWMXTQ"},mI=Mg(iW),dt=WO(mI),zi=VT(mI),xv=(t,e)=>Array.from({length:new Date(e,t,0).getDate()},(r,n)=>n+1),Hf=(t,e,r)=>["CN","T2","T3","T4","T5","T6","T7"][new Date(r,e-1,t).getDay()],yv=(t,e)=>[...t].sort((r,n)=>{if(e==="name"){const i=r.name.split(" ").pop(),s=n.name.split(" ").pop();return i.localeCompare(s)}else{const i={"Trng Khoa":1,"Ph Khoa":2,"Bc s":3,"iu dng":4,"Y t":5};return(i[r.position]||99)-(i[n.position]||99)}}),wv=({userRole:t,onLogout:e,onOpenChangePass:r,isOpen:n,onClose:i})=>M.jsxs(M.Fragment,{children:[n&&M.jsx("div",{className:"sidebar-overlay",onClick:i}),M.jsxs("div",{className:`sidebar ${n?"open":""}`,children:[M.jsxs("div",{className:"sidebar-header",children:[M.jsx("span",{children:" HospitalApp"}),M.jsx("span",{onClick:i,style:{cursor:"pointer",fontSize:24,display:window.innerWidth>768?"none":"block"},children:""})]}),M.jsxs("div",{className:"menu-item active",children:[" ",t==="ADMIN"?"Qun Tr":"Trang Ch"]}),M.jsx("div",{className:"menu-item",onClick:()=>{r(),i()},children:" i Mt Khu"}),M.jsx("div",{style:{marginTop:"auto",padding:"20px"},children:M.jsx("button",{onClick:e,className:"btn btn-logout",style:{width:"100%"},children:"ng Xut"})})]})]}),Ev=({title:t,email:e,notifications:r=[],onMenuClick:n})=>{const[i,s]=Ne.useState(!1),[a,o]=Ne.useState(0);Ne.useEffect(()=>{o(r.length)},[r]);const l=async()=>{if(s(!i),!i&&r.length>0){o(0);const c=n6(dt);r.forEach(f=>{const h=ln(dt,"requests",f.id);c.update(h,{isRead:!0})}),await c.commit()}};return M.jsxs("div",{className:"top-header",children:[M.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[M.jsx("button",{className:"menu-btn",onClick:n,children:""}),M.jsx("h2",{style:{margin:0,fontSize:"16px",color:"#334155"},children:t})]}),M.jsxs("div",{style:{display:"flex",alignItems:"center",gap:15},children:[M.jsxs("div",{className:"notification-container",children:[M.jsxs("div",{className:"notification-bell",onClick:l,children:[" ",a>0&&M.jsx("span",{className:"badge",children:a})]}),i&&M.jsxs("div",{className:"notification-dropdown",children:[M.jsxs("div",{style:{fontWeight:"bold",padding:10,borderBottom:"1px solid #eee"},children:["Thng bo mi (",r.length,")"]}),r.length===0&&M.jsx("div",{style:{padding:15,color:"#888",textAlign:"center"},children:"Khng c thng bo mi"}),r.map((c,f)=>M.jsxs("div",{className:"notif-item",children:[M.jsxs("div",{style:{fontWeight:"bold",color:c.status==="APPROVED"?"green":"red"},children:[c.status==="APPROVED"?"  duyt":" T chi",": ",c.empName]}),M.jsxs("div",{style:{fontSize:12,color:"#555"},children:["Ngy ",c.day,"/",c.month,"  ",M.jsx("b",{children:c.requestType}),c.status==="REJECTED"&&M.jsxs("div",{children:["L do: ",c.rejectReason]})]})]},f))]})]}),M.jsx("div",{style:{fontSize:"13px",fontWeight:500,display:window.innerWidth<500?"none":"block"},children:e})]})]})},sW=({isOpen:t,onClose:e,onSubmit:r,dateInfo:n})=>{const[i,s]=Ne.useState(""),[a,o]=Ne.useState("X");return t?M.jsx("div",{className:"modal-overlay",children:M.jsxs("div",{className:"modal-content",children:[M.jsx("h3",{children:" Gi yu cu"}),M.jsxs("p",{style:{fontSize:13,color:"#666",marginBottom:10},children:["Ngy: ",n.day,"/",n.month,"/",n.year]}),M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Sa thnh:"}),M.jsxs("select",{className:"select-box",style:{width:"100%"},value:a,onChange:l=>o(l.target.value),children:[M.jsx("option",{value:"X",children:" i lm (X)"}),M.jsx("option",{value:"P",children:" Ngh php (P)"}),M.jsx("option",{value:"KP",children:" Khng php (KP)"})]})]}),M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"L do:"}),M.jsx("input",{className:"login-input",value:i,onChange:l=>s(l.target.value),placeholder:"Nhp l do..."})]}),M.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:20},children:[M.jsx("button",{className:"btn",onClick:e,style:{background:"#f1f5f9",color:"#333"},children:"Hy"}),M.jsx("button",{className:"btn btn-primary",onClick:()=>r(a,i),children:"Gi"})]})]})}):null},aW=({isOpen:t,onClose:e,absentList:r,deptName:n})=>t?M.jsx("div",{className:"modal-overlay",children:M.jsxs("div",{className:"modal-content modal-lg",children:[M.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:15},children:[M.jsx("h3",{children:" Bo co vng mt"}),M.jsx("button",{onClick:e,style:{border:"none",background:"none",fontSize:20},children:""})]}),M.jsxs("div",{style:{padding:15,background:"white",border:"1px solid #eee"},children:[M.jsxs("div",{className:"capture-header",style:{textAlign:"center",marginBottom:20,borderBottom:"2px solid #2563eb",paddingBottom:10},children:[M.jsx("div",{style:{fontSize:20,fontWeight:"bold",textTransform:"uppercase"},children:"BO CO QUN S"}),M.jsxs("div",{style:{fontWeight:"bold",marginTop:5},children:["Khoa: ",n||"Ton vin"]}),M.jsxs("div",{style:{fontSize:14,color:"#666"},children:["Ngy: ",new Date().getDate(),"/",new Date().getMonth()+1,"/",new Date().getFullYear()]})]}),M.jsxs("table",{className:"request-table",style:{width:"100%",borderCollapse:"collapse"},children:[M.jsx("thead",{children:M.jsxs("tr",{style:{background:"#f1f5f9",borderBottom:"2px solid #333"},children:[M.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"H tn"}),M.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"Chc v"}),M.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"Trng thi"})]})}),M.jsx("tbody",{children:r.length===0?M.jsx("tr",{children:M.jsx("td",{colSpan:3,style:{textAlign:"center",padding:20},children:"i lm y ! "})}):r.map((i,s)=>M.jsxs("tr",{children:[M.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:i.name}),M.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:i.position}),M.jsx("td",{style:{padding:8,border:"1px solid #ddd",textAlign:"center",fontWeight:"bold",color:i.status==="P"?"#a16207":"#b91c1c"},children:i.status==="P"?"Ngh php":"Vng / KP"})]},s))})]})]})]})}):null,oW=({isOpen:t,onClose:e,onLogout:r})=>{const[n,i]=Ne.useState(""),[s,a]=Ne.useState(""),o=async l=>{if(l.preventDefault(),!!zi.currentUser)try{await VF(zi.currentUser,Ja.credential(zi.currentUser.email,n)),await WF(zi.currentUser,s),alert("Thnh cng! ng nhp li."),e(),r()}catch(c){alert("Li: "+c.message)}};return t?M.jsx("div",{className:"modal-overlay",children:M.jsxs("div",{className:"modal-content",children:[M.jsx("h3",{children:" i Mt Khu"}),M.jsxs("form",{onSubmit:o,children:[M.jsx("div",{className:"form-group",children:M.jsx("input",{className:"login-input",type:"password",placeholder:"Mt khu c",value:n,onChange:l=>i(l.target.value),required:!0})}),M.jsx("div",{className:"form-group",children:M.jsx("input",{className:"login-input",type:"password",placeholder:"Mt khu mi",value:s,onChange:l=>a(l.target.value),required:!0})}),M.jsx("button",{className:"btn btn-primary",style:{width:"100%"},children:"Lu"}),M.jsx("button",{type:"button",className:"btn",onClick:e,style:{width:"100%",marginTop:10,background:"#f1f5f9",color:"#333"},children:"Hy"})]})]})}):null},gI=({employees:t,attendanceData:e,onCellClick:r,month:n,year:i,pendingKeys:s=[]})=>{const a=xv(n,i);return M.jsx("div",{className:"matrix-wrapper",children:M.jsxs("table",{className:"matrix-table",children:[M.jsxs("thead",{children:[M.jsxs("tr",{children:[M.jsx("th",{style:{height:35}}),a.map(o=>M.jsx("th",{className:`th-day-name ${["T7","CN"].includes(Hf(o,n,i))?"bg-weekend":""}`,children:Hf(o,n,i)},o)),M.jsx("th",{colSpan:3,style:{background:"#f1f5f9",fontSize:11},children:"TNG"})]}),M.jsxs("tr",{children:[M.jsx("th",{style:{top:41},children:"NHN VIN"}),a.map(o=>M.jsx("th",{style:{top:41},className:`th-date-num ${["T7","CN"].includes(Hf(o,n,i))?"bg-weekend":""}`,children:o},o)),M.jsx("th",{style:{top:41,color:"green"},children:"X"}),M.jsx("th",{style:{top:41,color:"#a16207"},children:"P"}),M.jsx("th",{style:{top:41,color:"red"},children:"KP"})]})]}),M.jsx("tbody",{children:t.map(o=>{let l=0,c=0,f=0;return M.jsxs("tr",{children:[M.jsx("td",{children:o.name}),a.map(h=>{const d=`${o.id}_${h}_${n}_${i}`,p=e[d]||"-";p==="X"&&l++,p==="P"&&c++,p==="KP"&&f++;let v=["T7","CN"].includes(Hf(h,n,i))?"bg-weekend":"";return p==="X"&&(v="cell-work"),p==="P"&&(v="cell-leave"),p==="KP"&&(v="cell-kp"),s.includes(d)&&(v+=" cell-pending"),M.jsx("td",{className:v,onClick:()=>r&&r(o,h,p),children:p},h)}),M.jsx("td",{style:{color:"green",fontWeight:"bold"},children:l}),M.jsx("td",{style:{color:"#a16207",fontWeight:"bold"},children:c}),M.jsx("td",{style:{color:"red",fontWeight:"bold"},children:f})]},o.id)})})]})})},lW=({userDept:t,userEmail:e,onLogout:r,onOpenChangePass:n})=>{const[i,s]=Ne.useState(!1),[a,o]=Ne.useState([]),[l,c]=Ne.useState({}),[f,h]=Ne.useState([]),[d,p]=Ne.useState([]),[v,m]=Ne.useState(new Date().getMonth()+1),[_,y]=Ne.useState(new Date().getFullYear()),[E,x]=Ne.useState({isOpen:!1,emp:null,day:null}),[F,U]=Ne.useState(""),[b,w]=Ne.useState("name"),[k,S]=Ne.useState({lockDate:2,limitHour:10});Ne.useEffect(()=>{const te=Wi(ln(dt,"settings","config"),oe=>{oe.exists()?S(oe.data()):Fs(oe.ref,{lockDate:2,limitHour:10})});Mo(sc(an(dt,"employees"),xs("dept","==",t))).then(oe=>o(oe.docs.map(L=>L.data())));const re=Wi(sc(an(dt,"attendance"),xs("dept","==",t)),oe=>{const L={};oe.forEach(K=>{const z=K.data();L[`${z.empId}_${z.day}_${z.month}_${z.year}`]=z.status}),c(L)}),H=Wi(sc(an(dt,"requests"),xs("dept","==",t),xs("status","==","PENDING")),oe=>{h(oe.docs.map(L=>{const K=L.data();return`${K.empId}_${K.day}_${K.month}_${K.year}`}))}),se=Wi(sc(an(dt,"requests"),xs("dept","==",t),xs("status","in",["APPROVED","REJECTED"]),xs("isRead","==",!1)),oe=>p(oe.docs.map(L=>({id:L.id,...L.data()}))));return()=>{re(),H(),se(),te()}},[t]);const P=((te,re)=>{const H=te===12?re+1:re,se=te===12?1:te+1,oe=new Date(H,se-1,k.lockDate);return oe.setHours(23,59,59),new Date>oe})(v,_),A=yv(a.filter(te=>te.name.toLowerCase().includes(F.toLowerCase())||te.id.toLowerCase().includes(F.toLowerCase())),b),R=(te,re,H)=>{if(P)return alert(`  kha s (Ngy ${k.lockDate})!`);const se=new Date(_,v-1,re),oe=new Date;if(oe.setHours(0,0,0,0),se>oe)return alert("Khng chm cng tng lai!");if(se<oe||se.getTime()===oe.getTime()&&new Date().getHours()>=k.limitHour)x({isOpen:!0,emp:te,day:re,month:v,year:_});else{let L=H==="X"?"P":H==="P"?"KP":H==="KP"?"-":"X";Fs(ln(dt,"attendance",`${te.id}_${re}_${v}_${_}`),{empId:te.id,day:re,month:v,year:_,dept:te.dept,status:L})}},de=async()=>{if(P)return alert(" kha s!");if(new Date().getHours()>=k.limitHour)return alert(`Qu ${k.limitHour}h sng!`);if(!confirm("Chm tt c i lm?"))return;const te=new Date().getDate(),re=A.map(H=>{const se=`${H.id}_${te}_${v}_${_}`;return l[se]?Promise.resolve():Fs(ln(dt,"attendance",se),{empId:H.id,day:te,month:v,year:_,dept:H.dept,status:"X"})});await Promise.all(re),alert("Xong!")},ue=async(te,re)=>{await t6(an(dt,"requests"),{empId:E.emp.id,empName:E.emp.name,dept:t,day:E.day,month:E.month,year:E.year,reason:re,requestType:te,status:"PENDING",isRead:!1}),alert(" gi yu cu!"),x({isOpen:!1,emp:null,day:null})},Z=()=>{const te=xv(v,_),re=a.map(se=>{const oe={"M NV":se.id,"Tn NV":se.name};let L=0,K=0,z=0;return te.forEach(G=>{const ee=l[`${se.id}_${G}_${v}_${_}`]||"-";oe[`Ngy ${G}`]=ee,ee==="X"&&L++,ee==="P"&&K++,ee==="KP"&&z++}),oe["Tng Cng"]=L,oe.Php=K,oe.KP=z,oe}),H=Na.book_new();Na.book_append_sheet(H,Na.json_to_sheet(re),"ChamCong"),fI(H,`ChamCong_${t}_T${v}.xlsx`)};return M.jsxs("div",{className:"app-container",children:[M.jsx(wv,{userRole:"KHOA",isOpen:i,onClose:()=>s(!1),onLogout:r,onOpenChangePass:n}),M.jsxs("div",{className:"main-content",children:[M.jsx(Ev,{title:`Khoa: ${t}`,email:e,notifications:d,onMenuClick:()=>s(!0)}),M.jsx("div",{className:"dashboard-content",children:M.jsxs("div",{className:"card",children:[M.jsxs("div",{className:"toolbar",children:[M.jsxs("div",{className:"search-box",children:[M.jsx("span",{className:"search-icon",children:""}),M.jsx("input",{className:"search-input",placeholder:"Tm kim...",value:F,onChange:te=>U(te.target.value)})]}),M.jsxs("select",{className:"sort-select",value:b,onChange:te=>w(te.target.value),children:[M.jsx("option",{value:"name",children:"Tn A-Z"}),M.jsx("option",{value:"position",children:"Chc v"})]}),!P&&M.jsx("button",{className:"btn btn-primary",onClick:de,children:" Chm nhanh"})]}),P&&M.jsxs("div",{className:"lock-badge",children:[M.jsx("span",{className:"lock-icon",children:""})," Thng ny  kha s (Ngy ",k.lockDate,")."]}),M.jsxs("div",{className:"control-bar",children:[M.jsxs("div",{className:"filter-group",children:[M.jsx("select",{className:"select-box",value:v,onChange:te=>m(Number(te.target.value)),children:Array.from({length:12},(te,re)=>re+1).map(te=>M.jsxs("option",{value:te,children:["Thng ",te]},te))}),M.jsx("select",{className:"select-box",value:_,onChange:te=>y(Number(te.target.value)),children:Array.from({length:5},(te,re)=>2026+re).map(te=>M.jsx("option",{value:te,children:te},te))})]}),M.jsx("button",{className:"btn btn-success",onClick:Z,children:" Excel"})]}),M.jsx(gI,{employees:A,attendanceData:l,onCellClick:R,month:v,year:_,pendingKeys:f})]})})]}),M.jsx(sW,{isOpen:E.isOpen,onClose:()=>x({...E,isOpen:!1}),onSubmit:ue,dateInfo:E})]})},cW=({userEmail:t,onLogout:e,onOpenChangePass:r})=>{const[n,i]=Ne.useState(!1),[s,a]=Ne.useState([]),[o,l]=Ne.useState([]),[c,f]=Ne.useState({}),[h,d]=Ne.useState([]),[p,v]=Ne.useState(""),[m,_]=Ne.useState(new Date().getMonth()+1),[y,E]=Ne.useState(new Date().getFullYear()),[x,F]=Ne.useState(""),[U,b]=Ne.useState("name"),[w,k]=Ne.useState(!1),[S,C]=Ne.useState([]);Ne.useEffect(()=>{Mo(an(dt,"employees")).then(re=>{const H=re.docs.map(oe=>oe.data());a(H);const se=[...new Set(H.map(oe=>oe.dept))];l(se),se.length>0&&v(se[0])});const Z=Wi(an(dt,"attendance"),re=>{const H={};re.forEach(se=>{const oe=se.data();H[`${oe.empId}_${oe.day}_${oe.month}_${oe.year}`]=oe.status}),f(H)}),te=Wi(sc(an(dt,"requests"),xs("status","==","PENDING")),re=>d(re.docs.map(H=>({id:H.id,...H.data()}))));return()=>{Z(),te()}},[]);const P=async Z=>{confirm(`Duyt cho ${Z.empName} sa thnh ${Z.requestType}?`)&&(await ky(ln(dt,"requests",Z.id),{status:"APPROVED"}),await Fs(ln(dt,"attendance",`${Z.empId}_${Z.day}_${Z.month||1}_${Z.year||2026}`),{empId:Z.empId,day:Z.day,month:Z.month,year:Z.year,dept:Z.dept,status:Z.requestType||"X"}),alert(" duyt!"))},A=async Z=>{const te=prompt("L do t chi:","Khng hp l");te!==null&&(await ky(ln(dt,"requests",Z.id),{status:"REJECTED",rejectReason:te}),alert(" t chi!"))},R=()=>{const Z=new Date,te=Z.getDate(),re=Z.getMonth()+1,H=Z.getFullYear(),se=[];s.filter(L=>L.dept===p).forEach(L=>{const K=`${L.id}_${te}_${re}_${H}`;c[K]!=="X"&&se.push({...L,status:c[K]||"KP"})}),C(se),k(!0)},de=yv(s.filter(Z=>Z.dept===p&&(Z.name.toLowerCase().includes(x.toLowerCase())||Z.id.toLowerCase().includes(x.toLowerCase()))),U),ue=()=>{const Z=xv(m,y),te=de.map(H=>{const se={"M NV":H.id,"Tn NV":H.name};let oe=0,L=0,K=0;return Z.forEach(z=>{const G=c[`${H.id}_${z}_${m}_${y}`]||"-";se[`Ngy ${z}`]=G,G==="X"&&oe++,G==="P"&&L++,G==="KP"&&K++}),se["Tng Cng"]=oe,se.Php=L,se.KP=K,se}),re=Na.book_new();Na.book_append_sheet(re,Na.json_to_sheet(te),"ChamCong"),fI(re,`CC_${p}_T${m}.xlsx`)};return M.jsxs("div",{className:"app-container",children:[M.jsx(wv,{userRole:"GIAMDOC",isOpen:n,onClose:()=>i(!1),onLogout:e,onOpenChangePass:r}),M.jsxs("div",{className:"main-content",children:[M.jsx(Ev,{title:"Gim c",email:t,onMenuClick:()=>i(!0)}),M.jsxs("div",{className:"dashboard-content",children:[M.jsx("div",{style:{marginBottom:20},children:M.jsx("button",{className:"btn btn-primary",onClick:R,children:" Xem vng hm nay"})}),h.length>0&&M.jsxs("div",{className:"card",style:{borderLeft:"5px solid #2563eb"},children:[M.jsxs("h3",{children:[" Yu cu ch duyt (",h.length,")"]}),M.jsx("div",{style:{overflowX:"auto"},children:M.jsxs("table",{className:"request-table",children:[M.jsx("thead",{children:M.jsxs("tr",{children:[M.jsx("th",{children:"Khoa"}),M.jsx("th",{children:"Nhn vin"}),M.jsx("th",{children:"Ngy"}),M.jsx("th",{children:"Xin i"}),M.jsx("th",{children:"L do"}),M.jsx("th",{style:{textAlign:"right"},children:"Thao tc"})]})}),M.jsx("tbody",{children:h.map(Z=>M.jsxs("tr",{children:[M.jsx("td",{"data-label":"Khoa",children:Z.dept}),M.jsx("td",{"data-label":"NV",children:Z.empName}),M.jsxs("td",{"data-label":"Ngy",children:[Z.day,"/",Z.month]}),M.jsx("td",{"data-label":"i thnh",style:{fontWeight:"bold",color:Z.requestType==="KP"?"red":"green"},children:Z.requestType}),M.jsx("td",{"data-label":"L do",children:Z.reason}),M.jsxs("td",{"data-label":"Thao tc",style:{textAlign:"right"},children:[M.jsx("button",{className:"btn btn-success",style:{marginRight:5},onClick:()=>P(Z),children:"Duyt"}),M.jsx("button",{className:"btn btn-danger",onClick:()=>A(Z),children:"T chi"})]})]},Z.id))})]})})]}),M.jsxs("div",{className:"card",children:[M.jsxs("div",{className:"toolbar",children:[M.jsxs("div",{className:"search-box",children:[M.jsx("span",{className:"search-icon",children:""}),M.jsx("input",{className:"search-input",placeholder:"Tm trong khoa...",value:x,onChange:Z=>F(Z.target.value)})]}),M.jsxs("select",{className:"sort-select",value:U,onChange:Z=>b(Z.target.value),children:[M.jsx("option",{value:"name",children:"Tn A-Z"}),M.jsx("option",{value:"position",children:"Chc v"})]})]}),M.jsxs("div",{className:"control-bar",children:[M.jsxs("div",{className:"filter-group",children:[M.jsx("label",{children:"Khoa:"}),M.jsx("select",{className:"select-box",value:p,onChange:Z=>v(Z.target.value),children:o.map(Z=>M.jsx("option",{value:Z,children:Z},Z))}),M.jsx("label",{children:"Thng:"}),M.jsx("select",{className:"select-box",value:m,onChange:Z=>_(Number(Z.target.value)),children:Array.from({length:12},(Z,te)=>te+1).map(Z=>M.jsx("option",{value:Z,children:Z},Z))})]}),M.jsx("button",{className:"btn btn-success",onClick:ue,children:" Excel"})]}),M.jsx(gI,{employees:de,attendanceData:c,month:m,year:y})]})]})]}),M.jsx(aW,{isOpen:w,onClose:()=>k(!1),absentList:S,deptName:p})]})},uW=({userEmail:t,onLogout:e,onOpenChangePass:r})=>{const[n,i]=Ne.useState(!1),[s,a]=Ne.useState("employees"),[o,l]=Ne.useState([]),[c,f]=Ne.useState([]),[h,d]=Ne.useState(""),[p,v]=Ne.useState("name"),[m,_]=Ne.useState({lockDate:2,limitHour:10}),[y,E]=Ne.useState({email:"",pass:"",role:"KHOA",dept:""}),[x,F]=Ne.useState(!1);Ne.useEffect(()=>{const A=Wi(ln(dt,"settings","config"),ue=>{ue.exists()?_(ue.data()):Fs(ue.ref,{lockDate:2,limitHour:10})}),R=Wi(an(dt,"employees"),ue=>l(ue.docs.map(Z=>Z.data()))),de=Wi(an(dt,"users"),ue=>f(ue.docs.map(Z=>({id:Z.id,...Z.data()}))));return()=>{R(),de(),A()}},[]);const U=async A=>{if(confirm(`Gi email t li mt khu cho ${A}?`))try{await BF(zi,A),alert("  gi email thnh cng! Vui lng kim tra hp th.")}catch(R){alert("Li: "+R.message)}},b=async()=>{await Fs(ln(dt,"settings","config"),m),alert("Cp nht cu hnh thnh cng!")},w=async()=>{alert("ang ti d liu backup...");const A=await Mo(an(dt,"employees")),R=await Mo(an(dt,"attendance")),de=await Mo(an(dt,"requests")),ue=await Mo(an(dt,"users")),Z={employees:A.docs.map(se=>se.data()),attendance:R.docs.map(se=>se.data()),requests:de.docs.map(se=>se.data()),users:ue.docs.map(se=>se.data()),settings:m,backupDate:new Date().toISOString()},te=new Blob([JSON.stringify(Z,null,2)],{type:"application/json"}),re=URL.createObjectURL(te),H=document.createElement("a");H.href=re,H.download=`backup_hospital_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H)},k=async A=>{if(A.preventDefault(),y.role==="KHOA"&&!y.dept)return alert("Vui lng nhp tn Khoa!");F(!0);let R=null;try{R=Mg(Vg().options,"SecondaryApp");const de=VT(R),ue=await UF(de,y.email,y.pass);await Fs(ln(dt,"users",ue.user.uid),{email:y.email,role:y.role,dept:y.role==="KHOA"?y.dept:"",createdAt:new Date().toISOString()}),await fm(de),alert(`  to ti khon: ${y.email}`),E({email:"",pass:"",role:"KHOA",dept:""})}catch(de){alert("Li: "+de.message)}finally{R&&RP(R),F(!1)}},S=A=>{const R=A.target.files[0];if(!R)return;const de=new FileReader;de.onload=async ue=>{const Z=Na.sheet_to_json(fh(ue.target.result,{type:"binary"}).Sheets[fh(ue.target.result,{type:"binary"}).SheetNames[0]]),te=o.map(H=>H.id);let re=0;for(let H of Z)!H.MaNV||te.includes(String(H.MaNV))||(await Fs(ln(dt,"employees",String(H.MaNV)),{id:String(H.MaNV),name:H.TenNV,dept:H.Khoa,position:H.ChucVu}),re++);alert(` thm ${re} nhn vin mi!`)},de.readAsBinaryString(R),A.target.value=null},C=async A=>{confirm("Xa nhn vin ny?")&&await e6(ln(dt,"employees",A))},P=yv(o.filter(A=>A.name.toLowerCase().includes(h.toLowerCase())||A.id.toLowerCase().includes(h.toLowerCase())||A.dept.toLowerCase().includes(h.toLowerCase())),p);return M.jsxs("div",{className:"app-container",children:[M.jsx(wv,{userRole:"ADMIN",isOpen:n,onClose:()=>i(!1),onLogout:e,onOpenChangePass:r}),M.jsxs("div",{className:"main-content",children:[M.jsx(Ev,{title:"Qun Tr H Thng",email:t,onMenuClick:()=>i(!0)}),M.jsxs("div",{className:"dashboard-content",children:[M.jsxs("div",{style:{marginBottom:15,display:"flex",gap:10,flexWrap:"wrap"},children:[M.jsx("button",{className:`btn ${s==="employees"?"btn-primary":""}`,onClick:()=>a("employees"),style:{background:s!=="employees"?"#fff":""},children:"Nhn vin"}),M.jsx("button",{className:`btn ${s==="accounts"?"btn-primary":""}`,onClick:()=>a("accounts"),style:{background:s!=="accounts"?"#fff":""},children:"DS Ti khon"}),M.jsx("button",{className:`btn ${s==="create_acc"?"btn-primary":""}`,onClick:()=>a("create_acc"),style:{background:s!=="create_acc"?"#fff":""},children:" To Ti Khon"}),M.jsx("button",{className:`btn ${s==="config"?"btn-primary":""}`,onClick:()=>a("config"),style:{background:s!=="config"?"#fff":""},children:"Cu hnh & Backup"})]}),s==="config"&&M.jsxs("div",{className:"card",children:[M.jsx("h3",{children:" Cu hnh h thng"}),M.jsxs("div",{className:"config-panel",children:[M.jsxs("div",{className:"config-row",children:[M.jsx("label",{children:"Gi gii hn (h):"}),M.jsx("input",{type:"number",className:"config-input",value:m.limitHour,onChange:A=>_({...m,limitHour:Number(A.target.value)})}),M.jsx("span",{style:{fontSize:13,color:"#666"},children:"(Sau gi ny nhn vin khng c t chm)"})]}),M.jsxs("div",{className:"config-row",children:[M.jsx("label",{children:"Ngy kha s (DL):"}),M.jsx("input",{type:"number",className:"config-input",value:m.lockDate,onChange:A=>_({...m,lockDate:Number(A.target.value)})}),M.jsx("span",{style:{fontSize:13,color:"#666"},children:"(Ngy ca thng sau s kha thng trc)"})]}),M.jsx("button",{className:"btn btn-success",onClick:b,style:{marginTop:10},children:"Lu Cu Hnh"})]}),M.jsx("h3",{children:" Sao lu d liu"}),M.jsx("p",{style:{fontSize:13,color:"#666"},children:"Ti ton b d liu v my tnh."}),M.jsx("button",{className:"btn btn-primary",onClick:w,children:" Ti Backup JSON"})]}),s==="create_acc"&&M.jsxs("div",{className:"card",style:{maxWidth:500},children:[M.jsx("h3",{children:" Cp ti khon mi"}),M.jsxs("form",{onSubmit:k,children:[M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Email ng nhp:"}),M.jsx("input",{className:"login-input",type:"email",placeholder:"VD: noitimmach@bvien.com",value:y.email,onChange:A=>E({...y,email:A.target.value}),required:!0})]}),M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Mt khu:"}),M.jsx("input",{className:"login-input",type:"text",placeholder:"Nhp mt khu...",value:y.pass,onChange:A=>E({...y,pass:A.target.value}),required:!0})]}),M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Loi ti khon:"}),M.jsxs("select",{className:"select-box",style:{width:"100%"},value:y.role,onChange:A=>E({...y,role:A.target.value}),children:[M.jsx("option",{value:"KHOA",children:"Khoa / Phng ban"}),M.jsx("option",{value:"GIAMDOC",children:"Gim c (Xem tt c)"}),M.jsx("option",{value:"ADMIN",children:"Admin (Qun tr)"})]})]}),y.role==="KHOA"&&M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Tn Khoa (Hin th):"}),M.jsx("input",{className:"login-input",type:"text",placeholder:"VD: Khoa Ni, Phng K Ton...",value:y.dept,onChange:A=>E({...y,dept:A.target.value}),required:!0})]}),M.jsx("button",{className:"btn btn-success",style:{width:"100%",marginTop:10},disabled:x,children:x?"ang to...":"To Ti Khon"})]})]}),s==="employees"&&M.jsxs("div",{className:"card",children:[M.jsxs("div",{className:"toolbar",children:[M.jsxs("div",{className:"search-box",children:[M.jsx("span",{className:"search-icon",children:""}),M.jsx("input",{className:"search-input",placeholder:"Tm tn, m, hoc khoa...",value:h,onChange:A=>d(A.target.value)})]}),M.jsxs("select",{className:"sort-select",value:p,onChange:A=>v(A.target.value),children:[M.jsx("option",{value:"name",children:"Tn A-Z"}),M.jsx("option",{value:"position",children:"Chc v"})]}),M.jsxs("label",{className:"btn btn-primary",style:{cursor:"pointer",marginLeft:"auto"},children:[" Import Excel",M.jsx("input",{type:"file",hidden:!0,onChange:S})]})]}),M.jsx("div",{style:{maxHeight:"60vh",overflow:"auto"},children:M.jsxs("table",{className:"request-table",children:[M.jsx("thead",{children:M.jsxs("tr",{children:[M.jsx("th",{children:"M"}),M.jsx("th",{children:"Tn"}),M.jsx("th",{children:"Khoa"}),M.jsx("th",{children:"Chc V"}),M.jsx("th",{style:{textAlign:"right"},children:"Thao tc"})]})}),M.jsx("tbody",{children:P.map(A=>M.jsxs("tr",{children:[M.jsx("td",{children:A.id}),M.jsx("td",{children:A.name}),M.jsx("td",{children:A.dept}),M.jsx("td",{children:A.position}),M.jsx("td",{style:{textAlign:"right"},children:M.jsx("button",{className:"btn btn-logout",onClick:()=>C(A.id),children:"Xa"})})]},A.id))})]})})]}),s==="accounts"&&M.jsxs("div",{className:"card",children:[M.jsxs("h3",{children:["Danh sch ti khon (",c.length,")"]}),M.jsxs("table",{className:"request-table",style:{marginTop:10},children:[M.jsx("thead",{children:M.jsxs("tr",{children:[M.jsx("th",{children:"Email (ID)"}),M.jsx("th",{children:"Quyn"}),M.jsx("th",{children:"Tn Khoa"}),M.jsx("th",{children:"Mt khu"})]})}),M.jsx("tbody",{children:c.map(A=>M.jsxs("tr",{children:[M.jsxs("td",{children:[A.email," ",M.jsx("br",{}),M.jsx("span",{style:{fontSize:11,color:"#888"},children:A.id})]}),M.jsx("td",{children:M.jsx("span",{style:{fontWeight:"bold",color:A.role==="ADMIN"?"red":A.role==="GIAMDOC"?"purple":"blue"},children:A.role})}),M.jsx("td",{children:A.dept||"-"}),M.jsx("td",{children:M.jsx("button",{className:"btn btn-primary",style:{fontSize:12,padding:"5px 10px"},onClick:()=>U(A.email),children:" Reset"})})]},A.id))})]})]})]})]})]})};function fW(){const[t,e]=Ne.useState(null),[r,n]=Ne.useState(null),[i,s]=Ne.useState(!1),[a,o]=Ne.useState(localStorage.getItem("savedEmail")||""),[l,c]=Ne.useState("");Ne.useEffect(()=>GF(zi,async h=>{if(h){const d=await ZO(ln(dt,"users",h.uid));d.exists()?(e(h),n(d.data())):(await fm(zi),e(null),n(null))}else e(null),n(null)}),[]);const f=()=>{t!=null&&t.email&&localStorage.setItem("savedEmail",t.email),fm(zi),window.location.reload()};if(!t){const h=async d=>{d.preventDefault();try{await jF(zi,a,l)}catch(p){alert(p.message)}};return M.jsx("div",{className:"login-container",children:M.jsxs("form",{onSubmit:h,className:"login-card",children:[M.jsx("div",{style:{textAlign:"center",marginBottom:20,fontSize:24},children:" Hospital Login"}),M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Email:"}),M.jsx("input",{className:"login-input",type:"email",value:a,onChange:d=>o(d.target.value),required:!0})]}),M.jsxs("div",{className:"form-group",children:[M.jsx("label",{children:"Mt khu:"}),M.jsx("input",{className:"login-input",type:"password",value:l,onChange:d=>c(d.target.value),required:!0})]}),M.jsx("button",{className:"btn btn-primary",style:{width:"100%",fontSize:"16px",padding:12},children:"NG NHP"})]})})}return r?M.jsxs(M.Fragment,{children:[r.role==="KHOA"&&M.jsx(lW,{userDept:r.dept,userEmail:t.email,onLogout:f,onOpenChangePass:()=>s(!0)}),r.role==="GIAMDOC"&&M.jsx(cW,{userEmail:t.email,onLogout:f,onOpenChangePass:()=>s(!0)}),r.role==="ADMIN"&&M.jsx(uW,{userEmail:t.email,onLogout:f,onOpenChangePass:()=>s(!0)}),M.jsx(oW,{isOpen:i,onClose:()=>s(!1),onLogout:f})]}):M.jsx("div",{className:"loading-screen",children:" ang ti d liu..."})}G2(document.getElementById("root")).render(M.jsx(Ne.StrictMode,{children:M.jsx(fW,{})}));
